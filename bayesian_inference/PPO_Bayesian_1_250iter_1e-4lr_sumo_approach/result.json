{"episode_reward_max": 117.7112089005379, "episode_reward_min": -299.7782895634153, "episode_reward_mean": -82.76662406289336, "episode_len_mean": 338.62068965517244, "episodes_this_iter": 29, "policy_reward_mean": {"av": -42.10933504954223}, "custom_metrics": {"num_ped_collisions_mean": 0.3103448275862069, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.10344827586206896, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4218650946980897, "avg_speed_min": 1.3062750209969285, "avg_speed_max": 3.978399120298918, "avg_rl_veh_arrival_mean": 418.00574712643675, "avg_rl_veh_arrival_min": 153.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 11.27515152165456, "mean_processing_ms": 4.041031036648464, "mean_inference_ms": 1.228484734231879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11394, "num_steps_sampled": 11394, "sample_time_ms": 47131.535, "grad_time_ms": 873.955, "update_time_ms": 459.255, "opt_peak_throughput": 13037.291, "sample_peak_throughput": 241.749, "opt_samples": 11394.0, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-05, "total_loss": 3081.98583984375, "policy_loss": 8.00761604309082, "vf_loss": 3073.979736328125, "vf_explained_var": 8.356571197509766e-05, "kl": 0.0012009775964543223, "entropy": 1.4163919687271118, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11394, "done": false, "timesteps_total": 11394, "episodes_total": 29, "training_iteration": 1, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-18-07", "timestamp": 1585333087, "time_this_iter_s": 48.50335741043091, "time_total_s": 48.50335741043091, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159f620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 48.50335741043091, "timesteps_since_restore": 11394, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 69.18142857142857, "ram_util_percent": 84.5442857142857}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 117.7112089005379, "episode_reward_min": -299.7782895634153, "episode_reward_mean": -93.63169302927588, "episode_len_mean": 309.1470588235294, "episodes_this_iter": 39, "policy_reward_mean": {"av": -45.80543256108461}, "custom_metrics": {"num_ped_collisions_mean": 0.20588235294117646, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.29411764705882354, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5506683119903295, "avg_speed_min": 1.2303143523243918, "avg_speed_max": 4.148708519961539, "avg_rl_veh_arrival_mean": 358.4828431372549, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.8192333353684, "mean_processing_ms": 4.254075601281558, "mean_inference_ms": 1.183924053791806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22996, "num_steps_sampled": 22996, "sample_time_ms": 38926.049, "grad_time_ms": 718.323, "update_time_ms": 232.968, "opt_peak_throughput": 16006.73, "sample_peak_throughput": 295.381, "opt_samples": 11498.0, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-05, "total_loss": 3099.845947265625, "policy_loss": 12.89838695526123, "vf_loss": 3086.947265625, "vf_explained_var": 0.0004254579544067383, "kl": 0.00248526013456285, "entropy": 1.4396324157714844, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11602, "done": false, "timesteps_total": 22996, "episodes_total": 68, "training_iteration": 2, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-18-39", "timestamp": 1585333119, "time_this_iter_s": 31.31694746017456, "time_total_s": 79.82030487060547, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d76a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d71e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 79.82030487060547, "timesteps_since_restore": 22996, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 54.577777777777776, "ram_util_percent": 87.25555555555553}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 120.19505319925243, "episode_reward_min": -299.5565406197628, "episode_reward_mean": -79.38339668236131, "episode_len_mean": 313.36, "episodes_this_iter": 35, "policy_reward_mean": {"av": -38.53562945745695}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.3, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6080272983149775, "avg_speed_min": 1.2303143523243918, "avg_speed_max": 4.148708519961539, "avg_rl_veh_arrival_mean": 344.075, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.42444161668407, "mean_processing_ms": 4.304961534081591, "mean_inference_ms": 1.1444030227102835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34380, "num_steps_sampled": 34380, "sample_time_ms": 34791.916, "grad_time_ms": 599.967, "update_time_ms": 159.353, "opt_peak_throughput": 19101.043, "sample_peak_throughput": 329.387, "opt_samples": 11460.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-05, "total_loss": 2033.564453125, "policy_loss": 1.5556106567382812, "vf_loss": 2032.0089111328125, "vf_explained_var": 0.0007842779159545898, "kl": 0.0008918138337321579, "entropy": 1.449510097503662, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11384, "done": false, "timesteps_total": 34380, "episodes_total": 103, "training_iteration": 3, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-19-06", "timestamp": 1585333146, "time_this_iter_s": 26.917531490325928, "time_total_s": 106.7378363609314, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d69d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e99d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9f28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 106.7378363609314, "timesteps_since_restore": 34380, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.59743589743589, "ram_util_percent": 87.2153846153846}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3774700268995, "episode_reward_min": -299.6406920361733, "episode_reward_mean": -45.665228807806486, "episode_len_mean": 334.26, "episodes_this_iter": 27, "policy_reward_mean": {"av": -21.8493917740701}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.29, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7331103177763185, "avg_speed_min": 1.2303143523243918, "avg_speed_max": 4.5575245634964405, "avg_rl_veh_arrival_mean": 327.5783333333334, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.799041803689832, "mean_processing_ms": 4.333770614384742, "mean_inference_ms": 1.0711072167967643}, "off_policy_estimator": {}, "info": {"num_steps_trained": 45679, "num_steps_sampled": 45679, "sample_time_ms": 31165.409, "grad_time_ms": 519.329, "update_time_ms": 122.983, "opt_peak_throughput": 21989.414, "sample_peak_throughput": 366.424, "opt_samples": 11419.75, "learner": {"av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-05, "total_loss": 1556.6162109375, "policy_loss": -12.079230308532715, "vf_loss": 1568.6953125, "vf_explained_var": 0.0013963580131530762, "kl": 0.002540482906624675, "entropy": 1.4333620071411133, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11299, "done": false, "timesteps_total": 45679, "episodes_total": 130, "training_iteration": 4, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-19-27", "timestamp": 1585333167, "time_this_iter_s": 20.59206795692444, "time_total_s": 127.32990431785583, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f9d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fd90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027bd90>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027bb70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 127.32990431785583, "timesteps_since_restore": 45679, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.151724137931026, "ram_util_percent": 87.03793103448275}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3774700268995, "episode_reward_min": -299.8058887862191, "episode_reward_mean": -24.197465584707835, "episode_len_mean": 358.03, "episodes_this_iter": 32, "policy_reward_mean": {"av": -12.282977454166415}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.21, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8392559396297536, "avg_speed_min": 1.627715171165471, "avg_speed_max": 4.5575245634964405, "avg_rl_veh_arrival_mean": 332.715, "avg_rl_veh_arrival_min": 79.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.068058445021785, "mean_processing_ms": 4.2019153971150836, "mean_inference_ms": 0.9900360443487501}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57160, "num_steps_sampled": 57160, "sample_time_ms": 29652.966, "grad_time_ms": 502.411, "update_time_ms": 100.993, "opt_peak_throughput": 22754.271, "sample_peak_throughput": 385.526, "opt_samples": 11432.0, "learner": {"av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-05, "total_loss": 2801.4794921875, "policy_loss": 2.158740520477295, "vf_loss": 2799.32080078125, "vf_explained_var": 0.0015184283256530762, "kl": 0.0023907667491585016, "entropy": 1.434524655342102, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11481, "done": false, "timesteps_total": 57160, "episodes_total": 162, "training_iteration": 5, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-19-51", "timestamp": 1585333191, "time_this_iter_s": 24.082406282424927, "time_total_s": 151.41231060028076, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00212f28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d71e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 151.41231060028076, "timesteps_since_restore": 57160, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.63142857142857, "ram_util_percent": 86.94571428571427}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3774700268995, "episode_reward_min": -299.8058887862191, "episode_reward_mean": -8.0797880133094, "episode_len_mean": 376.09, "episodes_this_iter": 31, "policy_reward_mean": {"av": -4.08070101682293}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9492837192657424, "avg_speed_min": 1.6944947214450172, "avg_speed_max": 4.5575245634964405, "avg_rl_veh_arrival_mean": 326.45, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.516053640942843, "mean_processing_ms": 4.053324988785688, "mean_inference_ms": 0.9246940286387744}, "off_policy_estimator": {}, "info": {"num_steps_trained": 68646, "num_steps_sampled": 68646, "sample_time_ms": 28675.747, "grad_time_ms": 476.596, "update_time_ms": 87.547, "opt_peak_throughput": 24005.681, "sample_peak_throughput": 398.978, "opt_samples": 11441.0, "learner": {"av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999747378752e-05, "total_loss": 2300.651611328125, "policy_loss": -4.4493865966796875, "vf_loss": 2305.1005859375, "vf_explained_var": 0.002940833568572998, "kl": 0.0014973714714869857, "entropy": 1.4232585430145264, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11486, "done": false, "timesteps_total": 68646, "episodes_total": 193, "training_iteration": 6, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-20-16", "timestamp": 1585333216, "time_this_iter_s": 24.16621708869934, "time_total_s": 175.5785276889801, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024ff28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fa60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 175.5785276889801, "timesteps_since_restore": 68646, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.55142857142857, "ram_util_percent": 86.72857142857143}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3774700268995, "episode_reward_min": -299.8058887862191, "episode_reward_mean": -10.539880953714006, "episode_len_mean": 380.98, "episodes_this_iter": 29, "policy_reward_mean": {"av": -5.46107821435959}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0376454609395207, "avg_speed_min": 1.7348935963376244, "avg_speed_max": 4.288549098817713, "avg_rl_veh_arrival_mean": 329.53, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.07129163349257, "mean_processing_ms": 3.9703048438419324, "mean_inference_ms": 0.8783888736941062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 80067, "num_steps_sampled": 80067, "sample_time_ms": 27606.386, "grad_time_ms": 444.109, "update_time_ms": 77.256, "opt_peak_throughput": 25755.278, "sample_peak_throughput": 414.33, "opt_samples": 11438.143, "learner": {"av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999747378752e-05, "total_loss": 3156.40380859375, "policy_loss": -8.467629432678223, "vf_loss": 3164.86962890625, "vf_explained_var": 0.002318263053894043, "kl": 0.0015802389243617654, "entropy": 1.4037950038909912, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11421, "done": false, "timesteps_total": 80067, "episodes_total": 222, "training_iteration": 7, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-20-37", "timestamp": 1585333237, "time_this_iter_s": 21.474310636520386, "time_total_s": 197.0528383255005, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027ba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242b70>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 197.0528383255005, "timesteps_since_restore": 80067, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.76451612903226, "ram_util_percent": 86.74516129032261}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.2192972992932, "episode_reward_min": -299.9148582396506, "episode_reward_mean": -28.380910776030074, "episode_len_mean": 365.65, "episodes_this_iter": 35, "policy_reward_mean": {"av": -14.190455388015033}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1951118417615607, "avg_speed_min": 1.673520351289205, "avg_speed_max": 4.440548162577204, "avg_rl_veh_arrival_mean": 330.09333333333336, "avg_rl_veh_arrival_min": 118.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.753305826720273, "mean_processing_ms": 3.922102414904898, "mean_inference_ms": 0.8355140753513766}, "off_policy_estimator": {}, "info": {"num_steps_trained": 91611, "num_steps_sampled": 91611, "sample_time_ms": 27211.247, "grad_time_ms": 422.444, "update_time_ms": 69.516, "opt_peak_throughput": 27107.457, "sample_peak_throughput": 420.832, "opt_samples": 11451.375, "learner": {"av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999747378752e-05, "total_loss": 3163.59423828125, "policy_loss": -2.4983627796173096, "vf_loss": 3166.09228515625, "vf_explained_var": 0.004712581634521484, "kl": 0.0037328468170017004, "entropy": 1.4055901765823364, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11544, "done": false, "timesteps_total": 91611, "episodes_total": 257, "training_iteration": 8, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-21-02", "timestamp": 1585333262, "time_this_iter_s": 24.743382930755615, "time_total_s": 221.7962212562561, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7bf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7378>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 221.7962212562561, "timesteps_since_restore": 91611, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.791428571428575, "ram_util_percent": 86.81428571428573}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.11534474294467, "episode_reward_min": -299.9213557926364, "episode_reward_mean": -27.254218452524228, "episode_len_mean": 359.46, "episodes_this_iter": 32, "policy_reward_mean": {"av": -13.834628656103671}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.297546951075146, "avg_speed_min": 1.673520351289205, "avg_speed_max": 4.440548162577204, "avg_rl_veh_arrival_mean": 319.3666666666666, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.48813613217769, "mean_processing_ms": 3.895317940829112, "mean_inference_ms": 0.8021391498485536}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103093, "num_steps_sampled": 103093, "sample_time_ms": 26583.653, "grad_time_ms": 414.348, "update_time_ms": 63.43, "opt_peak_throughput": 27645.278, "sample_peak_throughput": 430.896, "opt_samples": 11454.778, "learner": {"av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999747378752e-05, "total_loss": 2760.0458984375, "policy_loss": -10.516464233398438, "vf_loss": 2770.561767578125, "vf_explained_var": 0.005429565906524658, "kl": 0.0013661381090059876, "entropy": 1.3906580209732056, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11482, "done": false, "timesteps_total": 103093, "episodes_total": 289, "training_iteration": 9, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-21-25", "timestamp": 1585333285, "time_this_iter_s": 21.950953483581543, "time_total_s": 243.74717473983765, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d6d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d6950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 243.74717473983765, "timesteps_since_restore": 103093, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.784375, "ram_util_percent": 86.89687500000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.31288926927448, "episode_reward_min": -299.9213557926364, "episode_reward_mean": -7.707957096808689, "episode_len_mean": 372.45, "episodes_this_iter": 24, "policy_reward_mean": {"av": -3.9126685770602494}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.429231444732925, "avg_speed_min": 1.673520351289205, "avg_speed_max": 4.440548162577204, "avg_rl_veh_arrival_mean": 299.39166666666665, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.330396318814715, "mean_processing_ms": 3.864230665988653, "mean_inference_ms": 0.7799936629692441}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113201, "num_steps_sampled": 113201, "sample_time_ms": 25668.25, "grad_time_ms": 400.038, "update_time_ms": 58.405, "opt_peak_throughput": 28297.588, "sample_peak_throughput": 441.016, "opt_samples": 11320.1, "learner": {"av": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999747378752e-05, "total_loss": 2287.917724609375, "policy_loss": -22.39056396484375, "vf_loss": 2310.308349609375, "vf_explained_var": 0.005679965019226074, "kl": 0.003683709306642413, "entropy": 1.3593584299087524, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10108, "done": false, "timesteps_total": 113201, "episodes_total": 313, "training_iteration": 10, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-21-43", "timestamp": 1585333303, "time_this_iter_s": 17.723104238510132, "time_total_s": 261.4702789783478, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab06a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00274950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 261.4702789783478, "timesteps_since_restore": 113201, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.59615384615385, "ram_util_percent": 86.83846153846154}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.31288926927448, "episode_reward_min": -299.9213557926364, "episode_reward_mean": -9.83631735994262, "episode_len_mean": 365.97, "episodes_this_iter": 26, "policy_reward_mean": {"av": -4.9930544974328}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5444072214080182, "avg_speed_min": 1.9315033859909652, "avg_speed_max": 4.396498245396382, "avg_rl_veh_arrival_mean": 284.2, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.17706428262339, "mean_processing_ms": 3.8670749285557626, "mean_inference_ms": 0.7595219766935821}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123338, "num_steps_sampled": 123338, "sample_time_ms": 22912.77, "grad_time_ms": 332.002, "update_time_ms": 13.918, "opt_peak_throughput": 33717.887, "sample_peak_throughput": 488.566, "opt_samples": 11194.4, "learner": {"av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999747378752e-05, "total_loss": 3112.070068359375, "policy_loss": -11.118886947631836, "vf_loss": 3123.18896484375, "vf_explained_var": 0.005036354064941406, "kl": 0.0023300040047615767, "entropy": 1.3842073678970337, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10137, "done": false, "timesteps_total": 123338, "episodes_total": 339, "training_iteration": 11, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-22-03", "timestamp": 1585333323, "time_this_iter_s": 19.797189950942993, "time_total_s": 281.26746892929077, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fbf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f8c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 281.26746892929077, "timesteps_since_restore": 123338, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.78928571428572, "ram_util_percent": 86.84642857142856}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.32039843605872, "episode_reward_min": -299.2503529986183, "episode_reward_mean": 18.064868774954313, "episode_len_mean": 394.69, "episodes_this_iter": 26, "policy_reward_mean": {"av": 9.169984149723001}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.629029031457317, "avg_speed_min": 2.6206077503139387, "avg_speed_max": 4.610351076515554, "avg_rl_veh_arrival_mean": 270.61, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.025575477050273, "mean_processing_ms": 3.8261175600961166, "mean_inference_ms": 0.7410636766491814}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133681, "num_steps_sampled": 133681, "sample_time_ms": 21784.465, "grad_time_ms": 299.019, "update_time_ms": 14.85, "opt_peak_throughput": 37016.063, "sample_peak_throughput": 508.091, "opt_samples": 11068.5, "learner": {"av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 3111.90234375, "policy_loss": -13.085793495178223, "vf_loss": 3124.987548828125, "vf_explained_var": 0.005235850811004639, "kl": 0.005849563982337713, "entropy": 1.3669122457504272, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10343, "done": false, "timesteps_total": 133681, "episodes_total": 365, "training_iteration": 12, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-22-23", "timestamp": 1585333343, "time_this_iter_s": 19.718928813934326, "time_total_s": 300.9863977432251, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 300.9863977432251, "timesteps_since_restore": 133681, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.96206896551724, "ram_util_percent": 86.9344827586207}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.32039843605872, "episode_reward_min": -299.9246976481541, "episode_reward_mean": 4.364729789077702, "episode_len_mean": 381.38, "episodes_this_iter": 31, "policy_reward_mean": {"av": 2.2383229687577977}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.698327759173925, "avg_speed_min": 2.5791132007880346, "avg_speed_max": 4.610351076515554, "avg_rl_veh_arrival_mean": 269.17333333333335, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.912698918241518, "mean_processing_ms": 3.801617001719628, "mean_inference_ms": 0.7241657498474605}, "off_policy_estimator": {}, "info": {"num_steps_trained": 143826, "num_steps_sampled": 143826, "sample_time_ms": 21442.973, "grad_time_ms": 296.287, "update_time_ms": 15.124, "opt_peak_throughput": 36939.182, "sample_peak_throughput": 510.405, "opt_samples": 10944.6, "learner": {"av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 4463.14111328125, "policy_loss": -2.0227811336517334, "vf_loss": 4465.1630859375, "vf_explained_var": 0.009101152420043945, "kl": 0.0009180851047858596, "entropy": 1.3799090385437012, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10145, "done": false, "timesteps_total": 143826, "episodes_total": 396, "training_iteration": 13, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-22-46", "timestamp": 1585333366, "time_this_iter_s": 23.50542640686035, "time_total_s": 324.49182415008545, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00212488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212f28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 324.49182415008545, "timesteps_since_restore": 143826, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.25294117647059, "ram_util_percent": 86.93235294117648}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.32039843605872, "episode_reward_min": -299.9246976481541, "episode_reward_mean": -14.659020352448838, "episode_len_mean": 357.14, "episodes_this_iter": 25, "policy_reward_mean": {"av": -7.715273869709917}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.695807449333932, "avg_speed_min": 2.5791132007880346, "avg_speed_max": 4.612420610254341, "avg_rl_veh_arrival_mean": 270.08166666666665, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.858586481086925, "mean_processing_ms": 3.8030606352746137, "mean_inference_ms": 0.7152293596208342}, "off_policy_estimator": {}, "info": {"num_steps_trained": 153926, "num_steps_sampled": 153926, "sample_time_ms": 21366.887, "grad_time_ms": 289.972, "update_time_ms": 15.225, "opt_peak_throughput": 37330.209, "sample_peak_throughput": 506.611, "opt_samples": 10824.7, "learner": {"av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 3011.098388671875, "policy_loss": -16.974702835083008, "vf_loss": 3028.072021484375, "vf_explained_var": 0.010677516460418701, "kl": 0.0016934798331931233, "entropy": 1.3852108716964722, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10100, "done": false, "timesteps_total": 153926, "episodes_total": 421, "training_iteration": 14, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-23-06", "timestamp": 1585333386, "time_this_iter_s": 19.778728246688843, "time_total_s": 344.2705523967743, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 344.2705523967743, "timesteps_since_restore": 153926, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.77142857142858, "ram_util_percent": 87.03214285714284}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.32039843605872, "episode_reward_min": -299.9246976481541, "episode_reward_mean": -6.992389675840543, "episode_len_mean": 366.48, "episodes_this_iter": 27, "policy_reward_mean": {"av": -3.7193562105534763}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7347618622214775, "avg_speed_min": 2.157572954571104, "avg_speed_max": 4.696269113822539, "avg_rl_veh_arrival_mean": 272.19, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.799541178253308, "mean_processing_ms": 3.7835308711830975, "mean_inference_ms": 0.7067109282877854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 164055, "num_steps_sampled": 164055, "sample_time_ms": 21023.219, "grad_time_ms": 266.375, "update_time_ms": 15.449, "opt_peak_throughput": 40129.554, "sample_peak_throughput": 508.462, "opt_samples": 10689.5, "learner": {"av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 2979.099609375, "policy_loss": -18.85352897644043, "vf_loss": 2997.95361328125, "vf_explained_var": 0.01157611608505249, "kl": 0.00480300048366189, "entropy": 1.3770228624343872, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10129, "done": false, "timesteps_total": 164055, "episodes_total": 448, "training_iteration": 15, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-23-27", "timestamp": 1585333407, "time_this_iter_s": 20.394256830215454, "time_total_s": 364.66480922698975, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020fbf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f0d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 364.66480922698975, "timesteps_since_restore": 164055, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 45.09333333333334, "ram_util_percent": 87.05}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.4933745926704, "episode_reward_min": -299.9246976481541, "episode_reward_mean": 2.7012544349659464, "episode_len_mean": 371.74, "episodes_this_iter": 29, "policy_reward_mean": {"av": 1.4601375324140278}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7386779541371946, "avg_speed_min": 2.157572954571104, "avg_speed_max": 4.696269113822539, "avg_rl_veh_arrival_mean": 271.8233333333334, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.759336081128957, "mean_processing_ms": 3.7776001494437694, "mean_inference_ms": 0.6988001936029284}, "off_policy_estimator": {}, "info": {"num_steps_trained": 175650, "num_steps_sampled": 175650, "sample_time_ms": 21134.091, "grad_time_ms": 253.894, "update_time_ms": 14.847, "opt_peak_throughput": 42145.093, "sample_peak_throughput": 506.31, "opt_samples": 10700.4, "learner": {"av": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999747378752e-05, "total_loss": 3395.628173828125, "policy_loss": -12.034632682800293, "vf_loss": 3407.662109375, "vf_explained_var": 0.012467145919799805, "kl": 0.0019049968104809523, "entropy": 1.363890528678894, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11595, "done": false, "timesteps_total": 175650, "episodes_total": 477, "training_iteration": 16, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-23-52", "timestamp": 1585333432, "time_this_iter_s": 25.14800524711609, "time_total_s": 389.81281447410583, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002209d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 389.81281447410583, "timesteps_since_restore": 175650, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 46.73055555555556, "ram_util_percent": 87.04444444444442}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.4933745926704, "episode_reward_min": -299.9145278598937, "episode_reward_mean": 12.742475843915022, "episode_len_mean": 382.64, "episodes_this_iter": 28, "policy_reward_mean": {"av": 6.742050711066151}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.723719623551036, "avg_speed_min": 2.157572954571104, "avg_speed_max": 4.698197889535997, "avg_rl_veh_arrival_mean": 278.6333333333333, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.7320751182647225, "mean_processing_ms": 3.767988038482252, "mean_inference_ms": 0.6922456473427713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 185810, "num_steps_sampled": 185810, "sample_time_ms": 21102.888, "grad_time_ms": 247.933, "update_time_ms": 13.756, "opt_peak_throughput": 42649.844, "sample_peak_throughput": 501.083, "opt_samples": 10574.3, "learner": {"av": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 2423.274169921875, "policy_loss": -15.381422996520996, "vf_loss": 2438.654296875, "vf_explained_var": 0.012286841869354248, "kl": 0.002452466869726777, "entropy": 1.3786190748214722, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10160, "done": false, "timesteps_total": 185810, "episodes_total": 505, "training_iteration": 17, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-24-14", "timestamp": 1585333454, "time_this_iter_s": 21.08329463005066, "time_total_s": 410.8961091041565, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00241488>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 410.8961091041565, "timesteps_since_restore": 185810, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.53, "ram_util_percent": 87.03}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.4933745926704, "episode_reward_min": -299.9145278598937, "episode_reward_mean": -7.680500037907219, "episode_len_mean": 350.71, "episodes_this_iter": 35, "policy_reward_mean": {"av": -3.8790404231854607}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7052988397033317, "avg_speed_min": 2.3547538411911995, "avg_speed_max": 4.698197889535997, "avg_rl_veh_arrival_mean": 267.1116666666667, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.711769943359393, "mean_processing_ms": 3.762946322672459, "mean_inference_ms": 0.6874671936240203}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196067, "num_steps_sampled": 196067, "sample_time_ms": 21191.122, "grad_time_ms": 240.728, "update_time_ms": 13.77, "opt_peak_throughput": 43391.717, "sample_peak_throughput": 492.923, "opt_samples": 10445.6, "learner": {"av": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 4865.3466796875, "policy_loss": -0.6734561920166016, "vf_loss": 4866.0185546875, "vf_explained_var": 0.014107167720794678, "kl": 0.0035844240337610245, "entropy": 1.3609867095947266, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10257, "done": false, "timesteps_total": 196067, "episodes_total": 540, "training_iteration": 18, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-24-40", "timestamp": 1585333480, "time_this_iter_s": 25.55166268348694, "time_total_s": 436.44777178764343, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159f730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 436.44777178764343, "timesteps_since_restore": 196067, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.23513513513514, "ram_util_percent": 86.96756756756757}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.4933745926704, "episode_reward_min": -299.80583315568043, "episode_reward_mean": -0.8175760589450104, "episode_len_mean": 360.41, "episodes_this_iter": 25, "policy_reward_mean": {"av": -0.404740623240104}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.21, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7610694750474143, "avg_speed_min": 2.7685269755915085, "avg_speed_max": 4.754993908244889, "avg_rl_veh_arrival_mean": 249.85, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.70133781100117, "mean_processing_ms": 3.7739603844734586, "mean_inference_ms": 0.6826944362921459}, "off_policy_estimator": {}, "info": {"num_steps_trained": 206423, "num_steps_sampled": 206423, "sample_time_ms": 20988.687, "grad_time_ms": 231.395, "update_time_ms": 13.371, "opt_peak_throughput": 44655.316, "sample_peak_throughput": 492.313, "opt_samples": 10333.0, "learner": {"av": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 2363.832763671875, "policy_loss": -22.907163619995117, "vf_loss": 2386.7392578125, "vf_explained_var": 0.031093180179595947, "kl": 0.006600094027817249, "entropy": 1.3460454940795898, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10356, "done": false, "timesteps_total": 206423, "episodes_total": 565, "training_iteration": 19, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-25-00", "timestamp": 1585333500, "time_this_iter_s": 19.83478808403015, "time_total_s": 456.2825598716736, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7400>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002417b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 456.2825598716736, "timesteps_since_restore": 206423, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.69310344827586, "ram_util_percent": 86.88275862068967}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.34227277173937, "episode_reward_min": -299.80583315568043, "episode_reward_mean": -3.598887694463878, "episode_len_mean": 360.79, "episodes_this_iter": 28, "policy_reward_mean": {"av": -1.781627571516769}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.2, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8567631546739016, "avg_speed_min": 2.7685269755915085, "avg_speed_max": 4.912993969604973, "avg_rl_veh_arrival_mean": 253.19166666666663, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.6821675835120145, "mean_processing_ms": 3.7774655349183166, "mean_inference_ms": 0.6767296569477432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 216963, "num_steps_sampled": 216963, "sample_time_ms": 21189.147, "grad_time_ms": 224.356, "update_time_ms": 13.644, "opt_peak_throughput": 46248.852, "sample_peak_throughput": 489.694, "opt_samples": 10376.2, "learner": {"av": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 5139.14501953125, "policy_loss": -12.434694290161133, "vf_loss": 5151.57763671875, "vf_explained_var": 0.01160651445388794, "kl": 0.0025456231087446213, "entropy": 1.331344723701477, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10540, "done": false, "timesteps_total": 216963, "episodes_total": 593, "training_iteration": 20, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-25-19", "timestamp": 1585333519, "time_this_iter_s": 19.664803504943848, "time_total_s": 475.94736337661743, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00a93ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00a93f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00a93c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7840>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 475.94736337661743, "timesteps_since_restore": 216963, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.76428571428573, "ram_util_percent": 86.91785714285716}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.34227277173937, "episode_reward_min": -299.71465708712856, "episode_reward_mean": 17.782662976219097, "episode_len_mean": 384.06, "episodes_this_iter": 28, "policy_reward_mean": {"av": 9.509445441828392}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.9455314833892574, "avg_speed_min": 0.820893295272379, "avg_speed_max": 4.941417146587982, "avg_rl_veh_arrival_mean": 238.70833333333331, "avg_rl_veh_arrival_min": 85.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.641549419064484, "mean_processing_ms": 3.781264806210969, "mean_inference_ms": 0.6694329152665693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 227563, "num_steps_sampled": 227563, "sample_time_ms": 21161.724, "grad_time_ms": 232.88, "update_time_ms": 12.85, "opt_peak_throughput": 44754.856, "sample_peak_throughput": 492.517, "opt_samples": 10422.5, "learner": {"av": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2502.796875, "policy_loss": -20.770326614379883, "vf_loss": 2523.566650390625, "vf_explained_var": 0.02911686897277832, "kl": 0.002170136198401451, "entropy": 1.3438117504119873, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10600, "done": false, "timesteps_total": 227563, "episodes_total": 621, "training_iteration": 21, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-25-39", "timestamp": 1585333539, "time_this_iter_s": 19.61978578567505, "time_total_s": 495.5671491622925, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fd90>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 495.5671491622925, "timesteps_since_restore": 227563, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 47.546428571428564, "ram_util_percent": 86.95714285714287}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.34227277173937, "episode_reward_min": -299.71465708712856, "episode_reward_mean": 10.289852865067395, "episode_len_mean": 372.08, "episodes_this_iter": 31, "policy_reward_mean": {"av": 5.249924931156837}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.9511922877458283, "avg_speed_min": 0.7382318389969474, "avg_speed_max": 4.941417146587982, "avg_rl_veh_arrival_mean": 236.87, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.611874124652081, "mean_processing_ms": 3.77407256707853, "mean_inference_ms": 0.6622635909043797}, "off_policy_estimator": {}, "info": {"num_steps_trained": 238279, "num_steps_sampled": 238279, "sample_time_ms": 21489.947, "grad_time_ms": 235.31, "update_time_ms": 12.41, "opt_peak_throughput": 44451.229, "sample_peak_throughput": 486.73, "opt_samples": 10459.8, "learner": {"av": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2696.38916015625, "policy_loss": -12.510307312011719, "vf_loss": 2708.897216796875, "vf_explained_var": 0.027985215187072754, "kl": 0.003511967835947871, "entropy": 1.3663300275802612, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10716, "done": false, "timesteps_total": 238279, "episodes_total": 652, "training_iteration": 22, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-26-03", "timestamp": 1585333563, "time_this_iter_s": 23.024471521377563, "time_total_s": 518.59162068367, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f1e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 518.59162068367, "timesteps_since_restore": 238279, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 44.45757575757576, "ram_util_percent": 86.97272727272727}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.32791949330027, "episode_reward_min": -299.66245220253165, "episode_reward_mean": -0.0028630685612759522, "episode_len_mean": 358.91, "episodes_this_iter": 27, "policy_reward_mean": {"av": -0.0014173606739010967}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.925808565357035, "avg_speed_min": 0.7382318389969474, "avg_speed_max": 4.941417146587982, "avg_rl_veh_arrival_mean": 244.67666666666665, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.599839207591595, "mean_processing_ms": 3.7815143388160584, "mean_inference_ms": 0.6573673075266897}, "off_policy_estimator": {}, "info": {"num_steps_trained": 248292, "num_steps_sampled": 248292, "sample_time_ms": 21605.798, "grad_time_ms": 222.786, "update_time_ms": 12.33, "opt_peak_throughput": 46890.769, "sample_peak_throughput": 483.509, "opt_samples": 10446.6, "learner": {"av": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 3294.360595703125, "policy_loss": -13.85670280456543, "vf_loss": 3308.2177734375, "vf_explained_var": 0.02657526731491089, "kl": 0.002496150089427829, "entropy": 1.3456199169158936, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10013, "done": false, "timesteps_total": 248292, "episodes_total": 679, "training_iteration": 23, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-26-27", "timestamp": 1585333587, "time_this_iter_s": 24.505785703659058, "time_total_s": 543.0974063873291, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e7400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e72f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001aed08>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001aed90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 543.0974063873291, "timesteps_since_restore": 248292, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 44.44444444444445, "ram_util_percent": 87.05833333333332}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3258013861937, "episode_reward_min": -299.39127623951265, "episode_reward_mean": -1.6535666463348475, "episode_len_mean": 373.9, "episodes_this_iter": 28, "policy_reward_mean": {"av": -0.7949839645840637}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.972967948679314, "avg_speed_min": 0.7382318389969474, "avg_speed_max": 4.840836782592181, "avg_rl_veh_arrival_mean": 249.8083333333333, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.58354932453081, "mean_processing_ms": 3.7848020870510943, "mean_inference_ms": 0.653220537619629}, "off_policy_estimator": {}, "info": {"num_steps_trained": 258639, "num_steps_sampled": 258639, "sample_time_ms": 21743.689, "grad_time_ms": 220.671, "update_time_ms": 11.302, "opt_peak_throughput": 47452.021, "sample_peak_throughput": 481.579, "opt_samples": 10471.3, "learner": {"av": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 3602.99365234375, "policy_loss": -15.195212364196777, "vf_loss": 3618.189208984375, "vf_explained_var": 0.024114489555358887, "kl": 0.0028825774788856506, "entropy": 1.3459362983703613, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10347, "done": false, "timesteps_total": 258639, "episodes_total": 707, "training_iteration": 24, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-26-49", "timestamp": 1585333609, "time_this_iter_s": 21.135443449020386, "time_total_s": 564.2328498363495, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001b20d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001b2158>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001b21e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001b2268>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001b28c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 564.2328498363495, "timesteps_since_restore": 258639, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 52.16774193548388, "ram_util_percent": 87.09032258064514}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3258013861937, "episode_reward_min": -299.39127623951265, "episode_reward_mean": -4.416654071399842, "episode_len_mean": 373.71, "episodes_this_iter": 28, "policy_reward_mean": {"av": -2.1233913804806943}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.018216064102864, "avg_speed_min": 2.824280098151816, "avg_speed_max": 4.824234744697282, "avg_rl_veh_arrival_mean": 259.23833333333334, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.566354969178978, "mean_processing_ms": 3.780782831269014, "mean_inference_ms": 0.6492180658064796}, "off_policy_estimator": {}, "info": {"num_steps_trained": 269219, "num_steps_sampled": 269219, "sample_time_ms": 21951.938, "grad_time_ms": 221.42, "update_time_ms": 11.535, "opt_peak_throughput": 47495.211, "sample_peak_throughput": 479.065, "opt_samples": 10516.4, "learner": {"av": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 3499.10107421875, "policy_loss": -17.29421615600586, "vf_loss": 3516.394775390625, "vf_explained_var": 0.025696218013763428, "kl": 0.0036247004754841328, "entropy": 1.3365873098373413, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10580, "done": false, "timesteps_total": 269219, "episodes_total": 735, "training_iteration": 25, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-27-12", "timestamp": 1585333632, "time_this_iter_s": 22.493897914886475, "time_total_s": 586.726747751236, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e76a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7ea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e77b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020fbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 586.726747751236, "timesteps_since_restore": 269219, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 44.478125000000006, "ram_util_percent": 87.084375}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3140911596143, "episode_reward_min": -299.39127623951265, "episode_reward_mean": 10.736323454699688, "episode_len_mean": 388.86, "episodes_this_iter": 21, "policy_reward_mean": {"av": 5.13699686827736}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.036371884192155, "avg_speed_min": 2.824280098151816, "avg_speed_max": 4.824234744697282, "avg_rl_veh_arrival_mean": 260.3566666666667, "avg_rl_veh_arrival_min": 104.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.558931160797986, "mean_processing_ms": 3.777338253380302, "mean_inference_ms": 0.6461858225999962}, "off_policy_estimator": {}, "info": {"num_steps_trained": 279738, "num_steps_sampled": 279738, "sample_time_ms": 21219.351, "grad_time_ms": 220.27, "update_time_ms": 11.332, "opt_peak_throughput": 47254.648, "sample_peak_throughput": 490.533, "opt_samples": 10408.8, "learner": {"av": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 2335.4716796875, "policy_loss": -30.08958625793457, "vf_loss": 2365.560546875, "vf_explained_var": 0.021075308322906494, "kl": 0.0016151858726516366, "entropy": 1.3178915977478027, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10519, "done": false, "timesteps_total": 279738, "episodes_total": 756, "training_iteration": 26, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-27-30", "timestamp": 1585333650, "time_this_iter_s": 17.807133197784424, "time_total_s": 604.5338809490204, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab06a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 604.5338809490204, "timesteps_since_restore": 279738, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 51.37692307692308, "ram_util_percent": 87.11923076923075}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3140911596143, "episode_reward_min": -395.57139690217326, "episode_reward_mean": 15.150290908381708, "episode_len_mean": 392.53, "episodes_this_iter": 31, "policy_reward_mean": {"av": 7.6516620749402575}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.073299884226816, "avg_speed_min": 2.75708033311542, "avg_speed_max": 4.824234744697282, "avg_rl_veh_arrival_mean": 259.355, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.5262751218949, "mean_processing_ms": 3.7569118332648226, "mean_inference_ms": 0.6414688222560244}, "off_policy_estimator": {}, "info": {"num_steps_trained": 290197, "num_steps_sampled": 290197, "sample_time_ms": 21275.155, "grad_time_ms": 222.703, "update_time_ms": 12.414, "opt_peak_throughput": 46872.705, "sample_peak_throughput": 490.652, "opt_samples": 10438.7, "learner": {"av": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 4357.80224609375, "policy_loss": -11.685376167297363, "vf_loss": 4369.48583984375, "vf_explained_var": 0.021902740001678467, "kl": 0.00829371903091669, "entropy": 1.2928777933120728, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10459, "done": false, "timesteps_total": 290197, "episodes_total": 787, "training_iteration": 27, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-27-52", "timestamp": 1585333672, "time_this_iter_s": 21.686295747756958, "time_total_s": 626.2201766967773, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae6a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 626.2201766967773, "timesteps_since_restore": 290197, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 46.687096774193556, "ram_util_percent": 87.09677419354838}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.3140911596143, "episode_reward_min": -395.57139690217326, "episode_reward_mean": 20.059771781554055, "episode_len_mean": 393.46, "episodes_this_iter": 26, "policy_reward_mean": {"av": 9.881660976135002}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.090766672817648, "avg_speed_min": 2.75708033311542, "avg_speed_max": 5.055666755636419, "avg_rl_veh_arrival_mean": 251.8, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.507881624262065, "mean_processing_ms": 3.743556758794749, "mean_inference_ms": 0.6368552432199448}, "off_policy_estimator": {}, "info": {"num_steps_trained": 300663, "num_steps_sampled": 300663, "sample_time_ms": 20661.708, "grad_time_ms": 222.367, "update_time_ms": 12.137, "opt_peak_throughput": 47037.646, "sample_peak_throughput": 506.231, "opt_samples": 10459.6, "learner": {"av": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 2315.853271484375, "policy_loss": -20.932363510131836, "vf_loss": 2336.785400390625, "vf_explained_var": 0.04134416580200195, "kl": 0.0026066594291478395, "entropy": 1.3019518852233887, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10466, "done": false, "timesteps_total": 300663, "episodes_total": 813, "training_iteration": 28, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-28-12", "timestamp": 1585333692, "time_this_iter_s": 19.41609835624695, "time_total_s": 645.6362750530243, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220ae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002207b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020fd08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 645.6362750530243, "timesteps_since_restore": 300663, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 47.832142857142856, "ram_util_percent": 86.96785714285716}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.33367171700442, "episode_reward_min": -395.57139690217326, "episode_reward_mean": 20.974202068020922, "episode_len_mean": 389.46, "episodes_this_iter": 26, "policy_reward_mean": {"av": 10.181651489330546}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.065053702377835, "avg_speed_min": 2.047318899599707, "avg_speed_max": 5.055666755636419, "avg_rl_veh_arrival_mean": 244.35833333333332, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.493670819863764, "mean_processing_ms": 3.72718193525689, "mean_inference_ms": 0.6348176801642968}, "off_policy_estimator": {}, "info": {"num_steps_trained": 310680, "num_steps_sampled": 310680, "sample_time_ms": 20887.942, "grad_time_ms": 216.884, "update_time_ms": 12.652, "opt_peak_throughput": 48070.409, "sample_peak_throughput": 499.125, "opt_samples": 10425.7, "learner": {"av": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 2325.932861328125, "policy_loss": -19.51704978942871, "vf_loss": 2345.449462890625, "vf_explained_var": 0.034589946269989014, "kl": 0.006100072525441647, "entropy": 1.311889886856079, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10017, "done": false, "timesteps_total": 310680, "episodes_total": 839, "training_iteration": 29, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-28-34", "timestamp": 1585333714, "time_this_iter_s": 22.030215740203857, "time_total_s": 667.6664907932281, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020f9d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020fd90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00274bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 667.6664907932281, "timesteps_since_restore": 310680, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 47.234375, "ram_util_percent": 86.946875}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.33367171700442, "episode_reward_min": -395.57139690217326, "episode_reward_mean": 12.086414656555032, "episode_len_mean": 384.28, "episodes_this_iter": 29, "policy_reward_mean": {"av": 5.867191580851956}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.110309440177195, "avg_speed_min": 2.047318899599707, "avg_speed_max": 5.055666755636419, "avg_rl_veh_arrival_mean": 246.515, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.482820528227288, "mean_processing_ms": 3.732269931458553, "mean_inference_ms": 0.6300719742299109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 321568, "num_steps_sampled": 321568, "sample_time_ms": 21125.502, "grad_time_ms": 215.642, "update_time_ms": 12.718, "opt_peak_throughput": 48508.645, "sample_peak_throughput": 495.16, "opt_samples": 10460.5, "learner": {"av": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3074.79736328125, "policy_loss": -24.79322052001953, "vf_loss": 3099.590087890625, "vf_explained_var": 0.030820190906524658, "kl": 0.004500093404203653, "entropy": 1.2976988554000854, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10888, "done": false, "timesteps_total": 321568, "episodes_total": 868, "training_iteration": 30, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-28-56", "timestamp": 1585333736, "time_this_iter_s": 22.027966737747192, "time_total_s": 689.6944575309753, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0e18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 689.6944575309753, "timesteps_since_restore": 321568, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 42.915625000000006, "ram_util_percent": 86.984375}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.82465511698794, "episode_reward_min": -299.9179587779043, "episode_reward_mean": 8.178615073076642, "episode_len_mean": 375.7, "episodes_this_iter": 28, "policy_reward_mean": {"av": 3.876120887714048}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.080107088872821, "avg_speed_min": 2.047318899599707, "avg_speed_max": 5.055666755636419, "avg_rl_veh_arrival_mean": 244.95833333333331, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.476567457703618, "mean_processing_ms": 3.7384642995967208, "mean_inference_ms": 0.6272208313866694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 331812, "num_steps_sampled": 331812, "sample_time_ms": 21425.214, "grad_time_ms": 206.57, "update_time_ms": 13.524, "opt_peak_throughput": 50466.651, "sample_peak_throughput": 486.572, "opt_samples": 10424.9, "learner": {"av": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 2901.56396484375, "policy_loss": -13.248186111450195, "vf_loss": 2914.8125, "vf_explained_var": 0.029005229473114014, "kl": 0.0014742454513907433, "entropy": 1.3226481676101685, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10244, "done": false, "timesteps_total": 331812, "episodes_total": 896, "training_iteration": 31, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-29-19", "timestamp": 1585333759, "time_this_iter_s": 22.518078088760376, "time_total_s": 712.2125356197357, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f8c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 712.2125356197357, "timesteps_since_restore": 331812, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 45.996875, "ram_util_percent": 87.12499999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.82465511698794, "episode_reward_min": -300.0, "episode_reward_mean": 2.784879057991386, "episode_len_mean": 375.32, "episodes_this_iter": 27, "policy_reward_mean": {"av": 1.392439528995693}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.108305432680105, "avg_speed_min": 2.047318899599707, "avg_speed_max": 5.204278355289557, "avg_rl_veh_arrival_mean": 253.52666666666667, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.455255158171249, "mean_processing_ms": 3.737588433159964, "mean_inference_ms": 0.6243235791192305}, "off_policy_estimator": {}, "info": {"num_steps_trained": 342506, "num_steps_sampled": 342506, "sample_time_ms": 21055.967, "grad_time_ms": 199.545, "update_time_ms": 13.805, "opt_peak_throughput": 52232.291, "sample_peak_throughput": 495.0, "opt_samples": 10422.7, "learner": {"av": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3004.40185546875, "policy_loss": -19.14520835876465, "vf_loss": 3023.547607421875, "vf_explained_var": 0.026886463165283203, "kl": 0.004610456991940737, "entropy": 1.295922040939331, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10694, "done": false, "timesteps_total": 342506, "episodes_total": 923, "training_iteration": 32, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-29-38", "timestamp": 1585333778, "time_this_iter_s": 19.24436640739441, "time_total_s": 731.4569020271301, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e7f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7b70>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ae400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 731.4569020271301, "timesteps_since_restore": 342506, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 46.85000000000001, "ram_util_percent": 87.21785714285713}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.82465511698794, "episode_reward_min": -300.0, "episode_reward_mean": -4.376563676541426, "episode_len_mean": 375.43, "episodes_this_iter": 27, "policy_reward_mean": {"av": -2.2103856952229433}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.119468618665683, "avg_speed_min": 3.0188108615848623, "avg_speed_max": 5.204278355289557, "avg_rl_veh_arrival_mean": 256.28, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.441708347260924, "mean_processing_ms": 3.733515087264168, "mean_inference_ms": 0.6213212617284977}, "off_policy_estimator": {}, "info": {"num_steps_trained": 352966, "num_steps_sampled": 352966, "sample_time_ms": 20757.345, "grad_time_ms": 197.337, "update_time_ms": 13.094, "opt_peak_throughput": 53043.263, "sample_peak_throughput": 504.274, "opt_samples": 10467.4, "learner": {"av": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 2897.0673828125, "policy_loss": -19.06338119506836, "vf_loss": 2916.12939453125, "vf_explained_var": 0.029646456241607666, "kl": 0.00675205560401082, "entropy": 1.3043172359466553, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10460, "done": false, "timesteps_total": 352966, "episodes_total": 950, "training_iteration": 33, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-30-00", "timestamp": 1585333800, "time_this_iter_s": 21.488391876220703, "time_total_s": 752.9452939033508, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae2f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 752.9452939033508, "timesteps_since_restore": 352966, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 43.96129032258065, "ram_util_percent": 87.09032258064514}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 171.82465511698794, "episode_reward_min": -300.0, "episode_reward_mean": 1.9985564658357111, "episode_len_mean": 387.69, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.9893843890275792}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.168733240432529, "avg_speed_min": 0.7129447794266712, "avg_speed_max": 5.204278355289557, "avg_rl_veh_arrival_mean": 258.335, "avg_rl_veh_arrival_min": 107.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.428450700084881, "mean_processing_ms": 3.724124088930094, "mean_inference_ms": 0.6188969349895219}, "off_policy_estimator": {}, "info": {"num_steps_trained": 363818, "num_steps_sampled": 363818, "sample_time_ms": 20803.83, "grad_time_ms": 202.163, "update_time_ms": 13.254, "opt_peak_throughput": 52026.847, "sample_peak_throughput": 505.575, "opt_samples": 10517.9, "learner": {"av": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 4604.65380859375, "policy_loss": -15.786835670471191, "vf_loss": 4620.43603515625, "vf_explained_var": 0.030775070190429688, "kl": 0.002563048619776964, "entropy": 1.306115984916687, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10852, "done": false, "timesteps_total": 363818, "episodes_total": 977, "training_iteration": 34, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-30-22", "timestamp": 1585333822, "time_this_iter_s": 21.63094210624695, "time_total_s": 774.5762360095978, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab06a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 774.5762360095978, "timesteps_since_restore": 363818, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 48.02580645161291, "ram_util_percent": 87.16451612903222}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 165.5548318281096, "episode_reward_min": -300.0, "episode_reward_mean": 2.4512114686607593, "episode_len_mean": 390.91, "episodes_this_iter": 29, "policy_reward_mean": {"av": 1.195712911541833}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.229016430600956, "avg_speed_min": 0.7129447794266712, "avg_speed_max": 5.375774095458716, "avg_rl_veh_arrival_mean": 258.34000000000003, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.412845920033744, "mean_processing_ms": 3.7143401496260844, "mean_inference_ms": 0.6161904193535837}, "off_policy_estimator": {}, "info": {"num_steps_trained": 374704, "num_steps_sampled": 374704, "sample_time_ms": 20862.516, "grad_time_ms": 204.325, "update_time_ms": 12.87, "opt_peak_throughput": 51626.066, "sample_peak_throughput": 505.62, "opt_samples": 10548.5, "learner": {"av": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3141.64453125, "policy_loss": -16.639480590820312, "vf_loss": 3158.283203125, "vf_explained_var": 0.028348326683044434, "kl": 0.0043160803616046906, "entropy": 1.2975119352340698, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10886, "done": false, "timesteps_total": 374704, "episodes_total": 1006, "training_iteration": 35, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-30-45", "timestamp": 1585333845, "time_this_iter_s": 23.088396072387695, "time_total_s": 797.6646320819855, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020fae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f0d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 797.6646320819855, "timesteps_since_restore": 374704, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 46.24411764705882, "ram_util_percent": 87.22647058823529}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -1.0, "episode_len_mean": 383.34, "episodes_this_iter": 26, "policy_reward_mean": {"av": -0.4854368932038835}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.283103261157461, "avg_speed_min": 0.7129447794266712, "avg_speed_max": 5.534364042985089, "avg_rl_veh_arrival_mean": 253.31333333333336, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.397574786218124, "mean_processing_ms": 3.7104004418535914, "mean_inference_ms": 0.6144990634502895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 385088, "num_steps_sampled": 385088, "sample_time_ms": 20948.57, "grad_time_ms": 199.879, "update_time_ms": 12.406, "opt_peak_throughput": 52706.918, "sample_peak_throughput": 502.898, "opt_samples": 10535.0, "learner": {"av": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3594.89501953125, "policy_loss": -13.277246475219727, "vf_loss": 3608.171630859375, "vf_explained_var": 0.018883228302001953, "kl": 0.010950516909360886, "entropy": 1.296100378036499, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10384, "done": false, "timesteps_total": 385088, "episodes_total": 1032, "training_iteration": 36, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-31-04", "timestamp": 1585333864, "time_this_iter_s": 18.620014190673828, "time_total_s": 816.2846462726593, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027bd08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bd90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 816.2846462726593, "timesteps_since_restore": 385088, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.8962962962963, "ram_util_percent": 87.21851851851852}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 10.0, "episode_len_mean": 391.81, "episodes_this_iter": 30, "policy_reward_mean": {"av": 5.05050505050505}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.360953853306341, "avg_speed_min": 2.7862114927862547, "avg_speed_max": 5.534364042985089, "avg_rl_veh_arrival_mean": 240.1, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.382893360339885, "mean_processing_ms": 3.711473182431857, "mean_inference_ms": 0.6110081349210785}, "off_policy_estimator": {}, "info": {"num_steps_trained": 396205, "num_steps_sampled": 396205, "sample_time_ms": 20504.154, "grad_time_ms": 201.133, "update_time_ms": 11.228, "opt_peak_throughput": 52705.37, "sample_peak_throughput": 517.007, "opt_samples": 10600.8, "learner": {"av": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3168.8525390625, "policy_loss": -22.062944412231445, "vf_loss": 3190.916259765625, "vf_explained_var": 0.024971842765808105, "kl": 0.002072426723316312, "entropy": 1.2849258184432983, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11117, "done": false, "timesteps_total": 396205, "episodes_total": 1062, "training_iteration": 37, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-31-22", "timestamp": 1585333882, "time_this_iter_s": 17.261494874954224, "time_total_s": 833.5461411476135, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002207b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 833.5461411476135, "timesteps_since_restore": 396205, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 52.36, "ram_util_percent": 87.244}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 10.5, "episode_len_mean": 391.51, "episodes_this_iter": 27, "policy_reward_mean": {"av": 5.49738219895288}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.403743670881104, "avg_speed_min": 2.7862114927862547, "avg_speed_max": 5.534364042985089, "avg_rl_veh_arrival_mean": 226.83, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.368597537630053, "mean_processing_ms": 3.711817922520767, "mean_inference_ms": 0.6079275181611693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 407084, "num_steps_sampled": 407084, "sample_time_ms": 20660.162, "grad_time_ms": 210.345, "update_time_ms": 11.383, "opt_peak_throughput": 50593.57, "sample_peak_throughput": 515.102, "opt_samples": 10642.1, "learner": {"av": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2029.250732421875, "policy_loss": -21.420063018798828, "vf_loss": 2050.669921875, "vf_explained_var": 0.044403135776519775, "kl": 0.0071051460690796375, "entropy": 1.2706515789031982, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10879, "done": false, "timesteps_total": 407084, "episodes_total": 1089, "training_iteration": 38, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-31-43", "timestamp": 1585333903, "time_this_iter_s": 21.085649728775024, "time_total_s": 854.6317908763885, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e96a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 854.6317908763885, "timesteps_since_restore": 407084, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 46.99666666666666, "ram_util_percent": 87.23999999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 7.5, "episode_len_mean": 398.82, "episodes_this_iter": 25, "policy_reward_mean": {"av": 3.9682539682539684}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.346820519693682, "avg_speed_min": 2.7862114927862547, "avg_speed_max": 5.534364042985089, "avg_rl_veh_arrival_mean": 239.45166666666668, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.360072216207662, "mean_processing_ms": 3.7024865500393718, "mean_inference_ms": 0.6055942895589824}, "off_policy_estimator": {}, "info": {"num_steps_trained": 417568, "num_steps_sampled": 417568, "sample_time_ms": 20433.101, "grad_time_ms": 211.023, "update_time_ms": 10.3, "opt_peak_throughput": 50652.202, "sample_peak_throughput": 523.112, "opt_samples": 10688.8, "learner": {"av": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2553.017333984375, "policy_loss": -17.766536712646484, "vf_loss": 2570.784423828125, "vf_explained_var": 0.03650176525115967, "kl": 0.0038797520101070404, "entropy": 1.2867218255996704, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10484, "done": false, "timesteps_total": 417568, "episodes_total": 1114, "training_iteration": 39, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-32-03", "timestamp": 1585333923, "time_this_iter_s": 19.760576009750366, "time_total_s": 874.3923668861389, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e9ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e98c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 874.3923668861389, "timesteps_since_restore": 417568, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 47.61034482758621, "ram_util_percent": 87.03103448275861}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 10.5, "episode_len_mean": 394.39, "episodes_this_iter": 28, "policy_reward_mean": {"av": 5.526315789473684}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.295342134231961, "avg_speed_min": 2.7862114927862547, "avg_speed_max": 5.197521255175166, "avg_rl_veh_arrival_mean": 234.26, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.3450258565672355, "mean_processing_ms": 3.7031305199952094, "mean_inference_ms": 0.6019118198745002}, "off_policy_estimator": {}, "info": {"num_steps_trained": 428079, "num_steps_sampled": 428079, "sample_time_ms": 20214.298, "grad_time_ms": 212.433, "update_time_ms": 10.121, "opt_peak_throughput": 50138.648, "sample_peak_throughput": 526.909, "opt_samples": 10651.1, "learner": {"av": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2031.7532958984375, "policy_loss": -20.111886978149414, "vf_loss": 2051.864501953125, "vf_explained_var": 0.054705917835235596, "kl": 0.0020187220070511103, "entropy": 1.28373122215271, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10511, "done": false, "timesteps_total": 428079, "episodes_total": 1142, "training_iteration": 40, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-32-24", "timestamp": 1585333944, "time_this_iter_s": 19.85141634941101, "time_total_s": 894.2437832355499, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7b70>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 894.2437832355499, "timesteps_since_restore": 428079, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 46.80714285714286, "ram_util_percent": 87.08214285714284}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 0.0, "episode_len_mean": 384.59, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.278278157950278, "avg_speed_min": 2.31590355618215, "avg_speed_max": 5.202001784633492, "avg_rl_veh_arrival_mean": 239.58166666666665, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.3350491349366225, "mean_processing_ms": 3.6974949556741836, "mean_inference_ms": 0.5998788229317049}, "off_policy_estimator": {}, "info": {"num_steps_trained": 438976, "num_steps_sampled": 438976, "sample_time_ms": 20085.641, "grad_time_ms": 215.475, "update_time_ms": 9.526, "opt_peak_throughput": 49733.77, "sample_peak_throughput": 533.535, "opt_samples": 10716.4, "learner": {"av": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 4849.150390625, "policy_loss": -9.278910636901855, "vf_loss": 4858.4296875, "vf_explained_var": 0.03025883436203003, "kl": 0.009393269196152687, "entropy": 1.2992135286331177, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10897, "done": false, "timesteps_total": 438976, "episodes_total": 1171, "training_iteration": 41, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-32-45", "timestamp": 1585333965, "time_this_iter_s": 21.276302814483643, "time_total_s": 915.5200860500336, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002208c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212488>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 915.5200860500336, "timesteps_since_restore": 438976, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 45.60967741935484, "ram_util_percent": 87.17419354838705}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 7.5, "episode_len_mean": 389.29, "episodes_this_iter": 30, "policy_reward_mean": {"av": 3.676470588235294}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.251499595515053, "avg_speed_min": 2.31590355618215, "avg_speed_max": 5.202001784633492, "avg_rl_veh_arrival_mean": 242.6616666666667, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.328845112042415, "mean_processing_ms": 3.6909589050946727, "mean_inference_ms": 0.5970214123655033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 449844, "num_steps_sampled": 449844, "sample_time_ms": 20289.712, "grad_time_ms": 216.586, "update_time_ms": 8.604, "opt_peak_throughput": 49559.046, "sample_peak_throughput": 529.027, "opt_samples": 10733.8, "learner": {"av": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 3271.849365234375, "policy_loss": -13.936312675476074, "vf_loss": 3285.78515625, "vf_explained_var": 0.028496265411376953, "kl": 0.001792572671547532, "entropy": 1.3206144571304321, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10868, "done": false, "timesteps_total": 449844, "episodes_total": 1201, "training_iteration": 42, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-33-07", "timestamp": 1585333987, "time_this_iter_s": 21.285982847213745, "time_total_s": 936.8060688972473, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002121e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019ed08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019ed90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019ef28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 936.8060688972473, "timesteps_since_restore": 449844, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 45.99032258064516, "ram_util_percent": 87.19677419354838}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 13.0, "episode_len_mean": 394.2, "episodes_this_iter": 22, "policy_reward_mean": {"av": 6.372549019607843}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.255053740585193, "avg_speed_min": 2.31590355618215, "avg_speed_max": 5.202001784633492, "avg_rl_veh_arrival_mean": 239.92333333333332, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.315448618160169, "mean_processing_ms": 3.6928360061618495, "mean_inference_ms": 0.5960104124451027}, "off_policy_estimator": {}, "info": {"num_steps_trained": 460204, "num_steps_sampled": 460204, "sample_time_ms": 19813.493, "grad_time_ms": 215.889, "update_time_ms": 9.388, "opt_peak_throughput": 49672.754, "sample_peak_throughput": 541.237, "opt_samples": 10723.8, "learner": {"av": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2431.8955078125, "policy_loss": -19.525836944580078, "vf_loss": 2451.42138671875, "vf_explained_var": 0.040017902851104736, "kl": 0.008748543448746204, "entropy": 1.2900843620300293, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10360, "done": false, "timesteps_total": 460204, "episodes_total": 1223, "training_iteration": 43, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-33-24", "timestamp": 1585334004, "time_this_iter_s": 16.72628664970398, "time_total_s": 953.5323555469513, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002207b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 953.5323555469513, "timesteps_since_restore": 460204, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 49.77916666666667, "ram_util_percent": 87.12916666666666}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 7.5, "episode_len_mean": 394.85, "episodes_this_iter": 27, "policy_reward_mean": {"av": 3.712871287128713}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.259008287027461, "avg_speed_min": 2.62026338479695, "avg_speed_max": 5.202001784633492, "avg_rl_veh_arrival_mean": 249.595, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.2972597015815746, "mean_processing_ms": 3.689511990522484, "mean_inference_ms": 0.5940833673737649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 470879, "num_steps_sampled": 470879, "sample_time_ms": 19554.298, "grad_time_ms": 222.877, "update_time_ms": 10.122, "opt_peak_throughput": 48035.814, "sample_peak_throughput": 547.506, "opt_samples": 10706.1, "learner": {"av": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 1966.664794921875, "policy_loss": -20.541406631469727, "vf_loss": 1987.2056884765625, "vf_explained_var": 0.04293721914291382, "kl": 0.0015578410821035504, "entropy": 1.2930325269699097, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10675, "done": false, "timesteps_total": 470879, "episodes_total": 1250, "training_iteration": 44, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-33-43", "timestamp": 1585334023, "time_this_iter_s": 19.132831811904907, "time_total_s": 972.6651873588562, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e7b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 972.6651873588562, "timesteps_since_restore": 470879, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 47.45714285714286, "ram_util_percent": 87.16785714285712}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 12.0, "episode_len_mean": 398.46, "episodes_this_iter": 26, "policy_reward_mean": {"av": 6.0}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.189545605009261, "avg_speed_min": 2.7494907736952863, "avg_speed_max": 5.101440325399393, "avg_rl_veh_arrival_mean": 249.83, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.284153872316342, "mean_processing_ms": 3.6839477926695703, "mean_inference_ms": 0.5926486904355197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 481281, "num_steps_sampled": 481281, "sample_time_ms": 19336.677, "grad_time_ms": 225.973, "update_time_ms": 10.466, "opt_peak_throughput": 47163.677, "sample_peak_throughput": 551.165, "opt_samples": 10657.7, "learner": {"av": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3359.3447265625, "policy_loss": -12.604216575622559, "vf_loss": 3371.9462890625, "vf_explained_var": 0.03103536367416382, "kl": 0.0015186159871518612, "entropy": 1.3214068412780762, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10402, "done": false, "timesteps_total": 481281, "episodes_total": 1276, "training_iteration": 45, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-34-04", "timestamp": 1585334044, "time_this_iter_s": 20.959981441497803, "time_total_s": 993.625168800354, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024ff28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fa60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 993.625168800354, "timesteps_since_restore": 481281, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 44.50000000000001, "ram_util_percent": 87.13333333333328}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 11.5, "episode_len_mean": 395.04, "episodes_this_iter": 30, "policy_reward_mean": {"av": 5.721393034825871}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.162572890415459, "avg_speed_min": 2.321393877071146, "avg_speed_max": 5.101440325399393, "avg_rl_veh_arrival_mean": 235.26166666666666, "avg_rl_veh_arrival_min": 97.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.265730565834633, "mean_processing_ms": 3.6836427049407656, "mean_inference_ms": 0.5903056588475735}, "off_policy_estimator": {}, "info": {"num_steps_trained": 491779, "num_steps_sampled": 491779, "sample_time_ms": 19544.943, "grad_time_ms": 226.718, "update_time_ms": 11.187, "opt_peak_throughput": 47058.986, "sample_peak_throughput": 545.875, "opt_samples": 10669.1, "learner": {"av": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3068.831787109375, "policy_loss": -6.941457748413086, "vf_loss": 3075.77197265625, "vf_explained_var": 0.043862342834472656, "kl": 0.005146130453795195, "entropy": 1.3027660846710205, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10498, "done": false, "timesteps_total": 491779, "episodes_total": 1306, "training_iteration": 46, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-34-25", "timestamp": 1585334065, "time_this_iter_s": 20.713582277297974, "time_total_s": 1014.338751077652, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1014.338751077652, "timesteps_since_restore": 491779, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 43.526666666666664, "ram_util_percent": 87.15999999999995}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 6.0, "episode_len_mean": 391.4, "episodes_this_iter": 26, "policy_reward_mean": {"av": 2.912621359223301}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.18959532392793, "avg_speed_min": 2.321393877071146, "avg_speed_max": 5.101440325399393, "avg_rl_veh_arrival_mean": 238.38333333333335, "avg_rl_veh_arrival_min": 97.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.255299837267511, "mean_processing_ms": 3.6772442593253105, "mean_inference_ms": 0.5878128755610684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502497, "num_steps_sampled": 502497, "sample_time_ms": 19695.662, "grad_time_ms": 224.48, "update_time_ms": 11.234, "opt_peak_throughput": 47350.304, "sample_peak_throughput": 539.672, "opt_samples": 10629.2, "learner": {"av": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 2688.050537109375, "policy_loss": -19.195327758789062, "vf_loss": 2707.243896484375, "vf_explained_var": 0.05273216962814331, "kl": 0.003487979294732213, "entropy": 1.2816113233566284, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10718, "done": false, "timesteps_total": 502497, "episodes_total": 1332, "training_iteration": 47, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-34-44", "timestamp": 1585334084, "time_this_iter_s": 18.725698947906494, "time_total_s": 1033.0644500255585, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002208c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220d90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1033.0644500255585, "timesteps_since_restore": 502497, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 48.51851851851851, "ram_util_percent": 87.18888888888888}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.0, "episode_len_mean": 387.56, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.9803921568627451}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.10507562795448, "avg_speed_min": 0.6100416269878466, "avg_speed_max": 5.045170868628519, "avg_rl_veh_arrival_mean": 242.19499999999996, "avg_rl_veh_arrival_min": 97.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.252476881501809, "mean_processing_ms": 3.677500967157779, "mean_inference_ms": 0.5863501204338655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 512726, "num_steps_sampled": 512726, "sample_time_ms": 19538.624, "grad_time_ms": 222.331, "update_time_ms": 11.301, "opt_peak_throughput": 47515.687, "sample_peak_throughput": 540.683, "opt_samples": 10564.2, "learner": {"av": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3002.984375, "policy_loss": -9.4341459274292, "vf_loss": 3012.418701171875, "vf_explained_var": 0.03747963905334473, "kl": 0.008591401390731335, "entropy": 1.3185871839523315, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10229, "done": false, "timesteps_total": 512726, "episodes_total": 1358, "training_iteration": 48, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-35-04", "timestamp": 1585334104, "time_this_iter_s": 19.495984315872192, "time_total_s": 1052.5604343414307, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150bc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150be18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b1e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d6840>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1052.5604343414307, "timesteps_since_restore": 512726, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 47.58571428571428, "ram_util_percent": 87.28928571428573}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 1.5, "episode_len_mean": 379.53, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.7352941176470589}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.0856649366460145, "avg_speed_min": 0.6100416269878466, "avg_speed_max": 5.045170868628519, "avg_rl_veh_arrival_mean": 239.9933333333333, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.243403965940231, "mean_processing_ms": 3.6795399660288513, "mean_inference_ms": 0.5846819092245181}, "off_policy_estimator": {}, "info": {"num_steps_trained": 523462, "num_steps_sampled": 523462, "sample_time_ms": 19520.309, "grad_time_ms": 215.763, "update_time_ms": 11.963, "opt_peak_throughput": 49078.851, "sample_peak_throughput": 542.481, "opt_samples": 10589.4, "learner": {"av": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 2979.6279296875, "policy_loss": -20.831674575805664, "vf_loss": 3000.45751953125, "vf_explained_var": 0.036213815212249756, "kl": 0.012700703926384449, "entropy": 1.2888656854629517, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10736, "done": false, "timesteps_total": 523462, "episodes_total": 1386, "training_iteration": 49, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-35-24", "timestamp": 1585334124, "time_this_iter_s": 19.512150287628174, "time_total_s": 1072.0725846290588, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220ae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fa60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7488>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1072.0725846290588, "timesteps_since_restore": 523462, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 47.214285714285715, "ram_util_percent": 87.35714285714288}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 11.0, "episode_len_mean": 396.14, "episodes_this_iter": 24, "policy_reward_mean": {"av": 5.670103092783505}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.146349882751763, "avg_speed_min": 0.6100416269878466, "avg_speed_max": 5.292757313571192, "avg_rl_veh_arrival_mean": 253.42166666666668, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.226643618485153, "mean_processing_ms": 3.6715816410049276, "mean_inference_ms": 0.5838809242782634}, "off_policy_estimator": {}, "info": {"num_steps_trained": 533769, "num_steps_sampled": 533769, "sample_time_ms": 19286.257, "grad_time_ms": 212.956, "update_time_ms": 12.08, "opt_peak_throughput": 49629.971, "sample_peak_throughput": 548.007, "opt_samples": 10569.0, "learner": {"av": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 1762.5341796875, "policy_loss": -18.65538787841797, "vf_loss": 1781.1888427734375, "vf_explained_var": 0.055287063121795654, "kl": 0.009406080469489098, "entropy": 1.2748007774353027, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10307, "done": false, "timesteps_total": 533769, "episodes_total": 1410, "training_iteration": 50, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-35-41", "timestamp": 1585334141, "time_this_iter_s": 17.48313283920288, "time_total_s": 1089.5557174682617, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae2f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d66a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1089.5557174682617, "timesteps_since_restore": 533769, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 46.896153846153844, "ram_util_percent": 87.41538461538464}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -2.0, "episode_len_mean": 379.25, "episodes_this_iter": 32, "policy_reward_mean": {"av": -1.0416666666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.134034618664817, "avg_speed_min": 0.6100416269878466, "avg_speed_max": 5.292757313571192, "avg_rl_veh_arrival_mean": 252.95, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.218895227131497, "mean_processing_ms": 3.671582767343489, "mean_inference_ms": 0.5813046531414482}, "off_policy_estimator": {}, "info": {"num_steps_trained": 544299, "num_steps_sampled": 544299, "sample_time_ms": 19399.889, "grad_time_ms": 210.335, "update_time_ms": 11.697, "opt_peak_throughput": 50074.022, "sample_peak_throughput": 542.905, "opt_samples": 10532.3, "learner": {"av": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3933.740478515625, "policy_loss": -9.771092414855957, "vf_loss": 3943.509765625, "vf_explained_var": 0.031181037425994873, "kl": 0.0040971958078444, "entropy": 1.259618878364563, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10530, "done": false, "timesteps_total": 544299, "episodes_total": 1442, "training_iteration": 51, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-36-04", "timestamp": 1585334164, "time_this_iter_s": 22.356065034866333, "time_total_s": 1111.911782503128, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002207b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d68c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fa60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1111.911782503128, "timesteps_since_restore": 544299, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 42.8875, "ram_util_percent": 87.271875}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -4.5, "episode_len_mean": 381.21, "episodes_this_iter": 27, "policy_reward_mean": {"av": -2.33160621761658}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.267681951431152, "avg_speed_min": 2.8687008984600264, "avg_speed_max": 5.292757313571192, "avg_rl_veh_arrival_mean": 253.14166666666665, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.200975496043632, "mean_processing_ms": 3.6663913796187897, "mean_inference_ms": 0.5790779051655308}, "off_policy_estimator": {}, "info": {"num_steps_trained": 554863, "num_steps_sampled": 554863, "sample_time_ms": 19218.602, "grad_time_ms": 218.488, "update_time_ms": 11.695, "opt_peak_throughput": 48066.208, "sample_peak_throughput": 546.445, "opt_samples": 10501.9, "learner": {"av": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3939.105712890625, "policy_loss": -13.804935455322266, "vf_loss": 3952.9091796875, "vf_explained_var": 0.02777993679046631, "kl": 0.0026077409274876118, "entropy": 1.3147530555725098, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10564, "done": false, "timesteps_total": 554863, "episodes_total": 1469, "training_iteration": 52, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-36-24", "timestamp": 1585334184, "time_this_iter_s": 19.566646814346313, "time_total_s": 1131.4784293174744, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002418c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00241840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1131.4784293174744, "timesteps_since_restore": 554863, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.728571428571435, "ram_util_percent": 87.14999999999996}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -10.0, "episode_len_mean": 379.34, "episodes_this_iter": 28, "policy_reward_mean": {"av": -5.025125628140704}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.267283097614106, "avg_speed_min": 2.8407307871676446, "avg_speed_max": 5.292757313571192, "avg_rl_veh_arrival_mean": 253.14833333333337, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.193845308669081, "mean_processing_ms": 3.666687807874128, "mean_inference_ms": 0.5777664318147662}, "off_policy_estimator": {}, "info": {"num_steps_trained": 565636, "num_steps_sampled": 565636, "sample_time_ms": 19773.204, "grad_time_ms": 225.833, "update_time_ms": 11.749, "opt_peak_throughput": 46685.799, "sample_peak_throughput": 533.206, "opt_samples": 10543.2, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3505.197998046875, "policy_loss": -15.349788665771484, "vf_loss": 3520.546875, "vf_explained_var": 0.04390525817871094, "kl": 0.007485865615308285, "entropy": 1.315862774848938, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10773, "done": false, "timesteps_total": 565636, "episodes_total": 1497, "training_iteration": 53, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-36-47", "timestamp": 1585334207, "time_this_iter_s": 22.375476121902466, "time_total_s": 1153.8539054393768, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001f4ea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1153.8539054393768, "timesteps_since_restore": 565636, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.109375, "ram_util_percent": 87.56875}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.5, "episode_len_mean": 375.82, "episodes_this_iter": 28, "policy_reward_mean": {"av": -3.75}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2850476951101655, "avg_speed_min": 2.8407307871676446, "avg_speed_max": 5.176561354156141, "avg_rl_veh_arrival_mean": 248.05166666666665, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.192973252430241, "mean_processing_ms": 3.665223921181112, "mean_inference_ms": 0.5773290724472151}, "off_policy_estimator": {}, "info": {"num_steps_trained": 576991, "num_steps_sampled": 576991, "sample_time_ms": 19989.376, "grad_time_ms": 213.124, "update_time_ms": 12.0, "opt_peak_throughput": 49788.93, "sample_peak_throughput": 530.842, "opt_samples": 10611.2, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2743.58984375, "policy_loss": -25.483680725097656, "vf_loss": 2769.07275390625, "vf_explained_var": 0.02903193235397339, "kl": 0.006418929900974035, "entropy": 1.2365474700927734, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11355, "done": false, "timesteps_total": 576991, "episodes_total": 1525, "training_iteration": 54, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-37-08", "timestamp": 1585334228, "time_this_iter_s": 21.152493238449097, "time_total_s": 1175.006398677826, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024f488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fa60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024ff28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1175.006398677826, "timesteps_since_restore": 576991, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 46.396774193548396, "ram_util_percent": 88.28387096774198}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 3.5, "episode_len_mean": 395.24, "episodes_this_iter": 24, "policy_reward_mean": {"av": 1.7857142857142858}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.323326871652284, "avg_speed_min": 2.8407307871676446, "avg_speed_max": 5.2131984911936575, "avg_rl_veh_arrival_mean": 253.48500000000004, "avg_rl_veh_arrival_min": 94.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.183359919444578, "mean_processing_ms": 3.6563826919523796, "mean_inference_ms": 0.5762787036414376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 587434, "num_steps_sampled": 587434, "sample_time_ms": 19800.515, "grad_time_ms": 204.35, "update_time_ms": 11.624, "opt_peak_throughput": 51946.722, "sample_peak_throughput": 536.112, "opt_samples": 10615.3, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2708.971435546875, "policy_loss": -20.385976791381836, "vf_loss": 2729.35693359375, "vf_explained_var": 0.05588734149932861, "kl": 0.010075285099446774, "entropy": 1.2312127351760864, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10443, "done": false, "timesteps_total": 587434, "episodes_total": 1549, "training_iteration": 55, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-37-27", "timestamp": 1585334247, "time_this_iter_s": 18.96842622756958, "time_total_s": 1193.9748249053955, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7d90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d72f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d70d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ca268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1193.9748249053955, "timesteps_since_restore": 587434, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 47.029629629629625, "ram_util_percent": 88.18888888888888}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 12.0, "episode_len_mean": 402.84, "episodes_this_iter": 29, "policy_reward_mean": {"av": 6.25}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4398022652767235, "avg_speed_min": 2.8407307871676446, "avg_speed_max": 5.4077285826001855, "avg_rl_veh_arrival_mean": 235.62333333333336, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.167579178835921, "mean_processing_ms": 3.64876433594462, "mean_inference_ms": 0.5742277523019879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 598501, "num_steps_sampled": 598501, "sample_time_ms": 19694.691, "grad_time_ms": 202.805, "update_time_ms": 11.867, "opt_peak_throughput": 52622.853, "sample_peak_throughput": 541.882, "opt_samples": 10672.2, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2254.215576171875, "policy_loss": -14.038272857666016, "vf_loss": 2268.253173828125, "vf_explained_var": 0.048959434032440186, "kl": 0.008058699779212475, "entropy": 1.2318060398101807, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11067, "done": false, "timesteps_total": 598501, "episodes_total": 1578, "training_iteration": 56, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-37-47", "timestamp": 1585334267, "time_this_iter_s": 19.645928144454956, "time_total_s": 1213.6207530498505, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0e18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab06a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e77b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1213.6207530498505, "timesteps_since_restore": 598501, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 47.196551724137926, "ram_util_percent": 88.13103448275861}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.0, "episode_len_mean": 396.57, "episodes_this_iter": 29, "policy_reward_mean": {"av": 2.0408163265306123}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.508434789201854, "avg_speed_min": 2.933946486543402, "avg_speed_max": 5.4077285826001855, "avg_rl_veh_arrival_mean": 245.04166666666663, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.155782177001562, "mean_processing_ms": 3.6445969014108783, "mean_inference_ms": 0.5721564811739913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 609510, "num_steps_sampled": 609510, "sample_time_ms": 19805.375, "grad_time_ms": 203.48, "update_time_ms": 12.839, "opt_peak_throughput": 52591.488, "sample_peak_throughput": 540.323, "opt_samples": 10701.3, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 6769.86328125, "policy_loss": -7.766355037689209, "vf_loss": 6777.6298828125, "vf_explained_var": 0.02420985698699951, "kl": 0.008655251935124397, "entropy": 1.215354561805725, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11009, "done": false, "timesteps_total": 609510, "episodes_total": 1607, "training_iteration": 57, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-38-07", "timestamp": 1585334287, "time_this_iter_s": 19.848469972610474, "time_total_s": 1233.469223022461, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00241840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002418c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241400>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002410d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ca400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1233.469223022461, "timesteps_since_restore": 609510, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 50.23214285714287, "ram_util_percent": 87.225}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.63, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5311329641980365, "avg_speed_min": 2.8023359631611453, "avg_speed_max": 5.586257855465294, "avg_rl_veh_arrival_mean": 241.255, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.139034336014721, "mean_processing_ms": 3.644843680602372, "mean_inference_ms": 0.5701345695413008}, "off_policy_estimator": {}, "info": {"num_steps_trained": 620207, "num_steps_sampled": 620207, "sample_time_ms": 19770.915, "grad_time_ms": 194.5, "update_time_ms": 13.051, "opt_peak_throughput": 55260.082, "sample_peak_throughput": 543.632, "opt_samples": 10748.1, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3661.525634765625, "policy_loss": -14.259672164916992, "vf_loss": 3675.78466796875, "vf_explained_var": 0.02794748544692993, "kl": 0.008533135987818241, "entropy": 1.2282384634017944, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10697, "done": false, "timesteps_total": 620207, "episodes_total": 1633, "training_iteration": 58, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-38-27", "timestamp": 1585334307, "time_this_iter_s": 19.045000791549683, "time_total_s": 1252.5142238140106, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ca598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ca620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ca730>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ca7b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cae18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1252.5142238140106, "timesteps_since_restore": 620207, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 49.107142857142854, "ram_util_percent": 87.13214285714284}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.5, "episode_len_mean": 397.87, "episodes_this_iter": 24, "policy_reward_mean": {"av": 4.25}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.528303196471519, "avg_speed_min": 2.8023359631611453, "avg_speed_max": 5.586257855465294, "avg_rl_veh_arrival_mean": 244.15, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.1306343534320105, "mean_processing_ms": 3.6467019357568025, "mean_inference_ms": 0.5687057456544132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 630629, "num_steps_sampled": 630629, "sample_time_ms": 19642.267, "grad_time_ms": 197.916, "update_time_ms": 12.25, "opt_peak_throughput": 54147.691, "sample_peak_throughput": 545.594, "opt_samples": 10716.7, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3073.836669921875, "policy_loss": -17.747304916381836, "vf_loss": 3091.58203125, "vf_explained_var": 0.017517268657684326, "kl": 0.016965916380286217, "entropy": 1.1555004119873047, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10422, "done": false, "timesteps_total": 630629, "episodes_total": 1657, "training_iteration": 59, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-38-45", "timestamp": 1585334325, "time_this_iter_s": 18.2659649848938, "time_total_s": 1270.7801887989044, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d72f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d70d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e77b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1270.7801887989044, "timesteps_since_restore": 630629, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 49.73076923076922, "ram_util_percent": 87.35769230769232}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 14.5, "episode_len_mean": 401.35, "episodes_this_iter": 27, "policy_reward_mean": {"av": 7.038834951456311}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.527289707705229, "avg_speed_min": 2.4468571631556806, "avg_speed_max": 5.586257855465294, "avg_rl_veh_arrival_mean": 242.35, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.125442180406436, "mean_processing_ms": 3.643322933995554, "mean_inference_ms": 0.5674066445141227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 641503, "num_steps_sampled": 641503, "sample_time_ms": 19945.657, "grad_time_ms": 204.67, "update_time_ms": 12.201, "opt_peak_throughput": 52637.831, "sample_peak_throughput": 540.138, "opt_samples": 10773.4, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3275.360107421875, "policy_loss": -18.527942657470703, "vf_loss": 3293.8876953125, "vf_explained_var": 0.030951738357543945, "kl": 0.005415141116827726, "entropy": 1.1905454397201538, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10874, "done": false, "timesteps_total": 641503, "episodes_total": 1684, "training_iteration": 60, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-39-06", "timestamp": 1585334346, "time_this_iter_s": 20.6032133102417, "time_total_s": 1291.3834021091461, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024fa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024ff28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1291.3834021091461, "timesteps_since_restore": 641503, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 49.14333333333334, "ram_util_percent": 87.04333333333332}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 15.5, "episode_len_mean": 400.43, "episodes_this_iter": 31, "policy_reward_mean": {"av": 7.416267942583732}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.523453652903401, "avg_speed_min": 2.4468571631556806, "avg_speed_max": 5.598078589479079, "avg_rl_veh_arrival_mean": 232.305, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.119252266861339, "mean_processing_ms": 3.638827273994291, "mean_inference_ms": 0.5650277181427694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 652393, "num_steps_sampled": 652393, "sample_time_ms": 19745.143, "grad_time_ms": 201.41, "update_time_ms": 13.049, "opt_peak_throughput": 53668.602, "sample_peak_throughput": 547.446, "opt_samples": 10809.4, "learner": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4171.384765625, "policy_loss": -9.777835845947266, "vf_loss": 4181.1630859375, "vf_explained_var": 0.025557518005371094, "kl": 0.0036691329441964626, "entropy": 1.2467787265777588, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10890, "done": false, "timesteps_total": 652393, "episodes_total": 1715, "training_iteration": 61, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-39-27", "timestamp": 1585334367, "time_this_iter_s": 20.328545808792114, "time_total_s": 1311.7119479179382, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001562f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156a60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1311.7119479179382, "timesteps_since_restore": 652393, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.94827586206897, "ram_util_percent": 86.7344827586207}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 18.0, "episode_len_mean": 403.89, "episodes_this_iter": 26, "policy_reward_mean": {"av": 8.823529411764707}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.538556625009394, "avg_speed_min": 2.4468571631556806, "avg_speed_max": 5.598078589479079, "avg_rl_veh_arrival_mean": 232.77333333333337, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.108908758555811, "mean_processing_ms": 3.6337537680117307, "mean_inference_ms": 0.562971995891374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 663432, "num_steps_sampled": 663432, "sample_time_ms": 19337.829, "grad_time_ms": 200.155, "update_time_ms": 13.866, "opt_peak_throughput": 54242.424, "sample_peak_throughput": 561.433, "opt_samples": 10856.9, "learner": {"av": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3008.112548828125, "policy_loss": -20.50351333618164, "vf_loss": 3028.61474609375, "vf_explained_var": 0.02659749984741211, "kl": 0.010135764256119728, "entropy": 1.1931688785552979, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11039, "done": false, "timesteps_total": 663432, "episodes_total": 1741, "training_iteration": 62, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-39-42", "timestamp": 1585334382, "time_this_iter_s": 15.476983547210693, "time_total_s": 1327.188931465149, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b2f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1327.188931465149, "timesteps_since_restore": 663432, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 45.70434782608696, "ram_util_percent": 86.73478260869564}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 13.0, "episode_len_mean": 401.44, "episodes_this_iter": 28, "policy_reward_mean": {"av": 6.7357512953367875}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.550501954693313, "avg_speed_min": 2.4468571631556806, "avg_speed_max": 5.598078589479079, "avg_rl_veh_arrival_mean": 228.51333333333332, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.0943889348947184, "mean_processing_ms": 3.63161490145705, "mean_inference_ms": 0.5604518221826885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 674598, "num_steps_sampled": 674598, "sample_time_ms": 18782.021, "grad_time_ms": 192.647, "update_time_ms": 13.652, "opt_peak_throughput": 56560.43, "sample_peak_throughput": 580.14, "opt_samples": 10896.2, "learner": {"av": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3842.642578125, "policy_loss": -14.807497024536133, "vf_loss": 3857.451416015625, "vf_explained_var": 0.05704277753829956, "kl": 0.03178277239203453, "entropy": 1.14584481716156, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11166, "done": false, "timesteps_total": 674598, "episodes_total": 1769, "training_iteration": 63, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-39-59", "timestamp": 1585334399, "time_this_iter_s": 16.716733694076538, "time_total_s": 1343.9056651592255, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00241488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002418c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241400>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001f4ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1343.9056651592255, "timesteps_since_restore": 674598, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 45.387499999999996, "ram_util_percent": 86.05}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -1.0, "episode_len_mean": 383.06, "episodes_this_iter": 33, "policy_reward_mean": {"av": -0.5235602094240838}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.44416694391604, "avg_speed_min": 2.821545167366192, "avg_speed_max": 5.598078589479079, "avg_rl_veh_arrival_mean": 219.82333333333332, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.071072831729931, "mean_processing_ms": 3.6257415960236847, "mean_inference_ms": 0.5577142278511787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 685344, "num_steps_sampled": 685344, "sample_time_ms": 18714.512, "grad_time_ms": 190.707, "update_time_ms": 13.333, "opt_peak_throughput": 56816.437, "sample_peak_throughput": 578.978, "opt_samples": 10835.3, "learner": {"av": {"cur_kl_coeff": 2.728484213739002e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4506.013671875, "policy_loss": 2.253403902053833, "vf_loss": 4503.763671875, "vf_explained_var": 0.02813267707824707, "kl": 0.003699783468618989, "entropy": 1.27072012424469, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10746, "done": false, "timesteps_total": 685344, "episodes_total": 1802, "training_iteration": 64, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-40-20", "timestamp": 1585334420, "time_this_iter_s": 20.46293544769287, "time_total_s": 1364.3686006069183, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156e18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156f28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1364.3686006069183, "timesteps_since_restore": 685344, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 38.58620689655172, "ram_util_percent": 86.751724137931}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.5, "episode_len_mean": 368.86, "episodes_this_iter": 29, "policy_reward_mean": {"av": -4.5212765957446805}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.311685377742376, "avg_speed_min": 2.4589605628307525, "avg_speed_max": 5.4751731744919585, "avg_rl_veh_arrival_mean": 228.15333333333336, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.044429098068931, "mean_processing_ms": 3.623337124737525, "mean_inference_ms": 0.5554103090727422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 695973, "num_steps_sampled": 695973, "sample_time_ms": 18423.666, "grad_time_ms": 189.911, "update_time_ms": 13.312, "opt_peak_throughput": 57152.537, "sample_peak_throughput": 589.128, "opt_samples": 10853.9, "learner": {"av": {"cur_kl_coeff": 1.364242106869501e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2700.637939453125, "policy_loss": -18.951919555664062, "vf_loss": 2719.58984375, "vf_explained_var": 0.05047750473022461, "kl": 0.007031335961073637, "entropy": 1.2553566694259644, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10629, "done": false, "timesteps_total": 695973, "episodes_total": 1831, "training_iteration": 65, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-40-36", "timestamp": 1585334436, "time_this_iter_s": 16.061557292938232, "time_total_s": 1380.4301578998566, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001567b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001566a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1380.4301578998566, "timesteps_since_restore": 695973, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 38.40416666666667, "ram_util_percent": 86.78333333333335}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -17.0, "episode_len_mean": 354.37, "episodes_this_iter": 28, "policy_reward_mean": {"av": -8.854166666666666}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.232692489351656, "avg_speed_min": 2.4589605628307525, "avg_speed_max": 5.4751731744919585, "avg_rl_veh_arrival_mean": 235.82666666666665, "avg_rl_veh_arrival_min": 63.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.021894773347387, "mean_processing_ms": 3.625155828821586, "mean_inference_ms": 0.5527545911353975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 706889, "num_steps_sampled": 706889, "sample_time_ms": 18105.713, "grad_time_ms": 189.944, "update_time_ms": 12.851, "opt_peak_throughput": 57063.154, "sample_peak_throughput": 598.64, "opt_samples": 10838.8, "learner": {"av": {"cur_kl_coeff": 1.364242106869501e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2603.920166015625, "policy_loss": -24.719961166381836, "vf_loss": 2628.64013671875, "vf_explained_var": 0.05975687503814697, "kl": 0.006722528487443924, "entropy": 1.1626492738723755, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10916, "done": false, "timesteps_total": 706889, "episodes_total": 1859, "training_iteration": 66, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-40-53", "timestamp": 1585334453, "time_this_iter_s": 16.46898889541626, "time_total_s": 1396.8991467952728, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d76a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7bf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fb70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1396.8991467952728, "timesteps_since_restore": 706889, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 39.53043478260869, "ram_util_percent": 86.70000000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -12.5, "episode_len_mean": 361.92, "episodes_this_iter": 29, "policy_reward_mean": {"av": -6.410256410256411}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.228429412439544, "avg_speed_min": 2.4589605628307525, "avg_speed_max": 5.342963232413567, "avg_rl_veh_arrival_mean": 248.4716666666667, "avg_rl_veh_arrival_min": 63.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 6.004069015082006, "mean_processing_ms": 3.621794123933542, "mean_inference_ms": 0.5504422209896292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 717798, "num_steps_sampled": 717798, "sample_time_ms": 18080.214, "grad_time_ms": 188.107, "update_time_ms": 12.474, "opt_peak_throughput": 57567.144, "sample_peak_throughput": 598.931, "opt_samples": 10828.8, "learner": {"av": {"cur_kl_coeff": 1.364242106869501e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4911.8544921875, "policy_loss": -9.78309440612793, "vf_loss": 4921.638671875, "vf_explained_var": 0.0440942645072937, "kl": 0.011242687702178955, "entropy": 1.2190505266189575, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10909, "done": false, "timesteps_total": 717798, "episodes_total": 1888, "training_iteration": 67, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-41-13", "timestamp": 1585334473, "time_this_iter_s": 19.56788730621338, "time_total_s": 1416.4670341014862, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159f620>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d6950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1416.4670341014862, "timesteps_since_restore": 717798, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 36.18620689655172, "ram_util_percent": 86.72413793103446}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 0.0, "episode_len_mean": 378.69, "episodes_this_iter": 31, "policy_reward_mean": {"av": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.316514100783435, "avg_speed_min": 2.4589605628307525, "avg_speed_max": 5.342963232413567, "avg_rl_veh_arrival_mean": 244.42333333333335, "avg_rl_veh_arrival_min": 63.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.982702167734804, "mean_processing_ms": 3.6173185903913083, "mean_inference_ms": 0.5471748324819607}, "off_policy_estimator": {}, "info": {"num_steps_trained": 729061, "num_steps_sampled": 729061, "sample_time_ms": 17948.442, "grad_time_ms": 188.462, "update_time_ms": 11.185, "opt_peak_throughput": 57759.213, "sample_peak_throughput": 606.482, "opt_samples": 10885.4, "learner": {"av": {"cur_kl_coeff": 1.364242106869501e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3793.27490234375, "policy_loss": -19.311824798583984, "vf_loss": 3812.586669921875, "vf_explained_var": 0.050196945667266846, "kl": 0.022257331758737564, "entropy": 1.165863037109375, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11263, "done": false, "timesteps_total": 729061, "episodes_total": 1919, "training_iteration": 68, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-41-31", "timestamp": 1585334491, "time_this_iter_s": 17.715997457504272, "time_total_s": 1434.1830315589905, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b2f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150bc80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150be18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1434.1830315589905, "timesteps_since_restore": 729061, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 37.087999999999994, "ram_util_percent": 86.70800000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -9.5, "episode_len_mean": 369.38, "episodes_this_iter": 29, "policy_reward_mean": {"av": -4.702970297029703}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.307098753426129, "avg_speed_min": 2.77693041888304, "avg_speed_max": 5.282667568647895, "avg_rl_veh_arrival_mean": 240.23, "avg_rl_veh_arrival_min": 63.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.960048287163536, "mean_processing_ms": 3.6131495691934727, "mean_inference_ms": 0.5451508611330493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 739908, "num_steps_sampled": 739908, "sample_time_ms": 18004.664, "grad_time_ms": 190.251, "update_time_ms": 12.169, "opt_peak_throughput": 57439.507, "sample_peak_throughput": 606.948, "opt_samples": 10927.9, "learner": {"av": {"cur_kl_coeff": 2.04636302477898e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3159.33837890625, "policy_loss": -7.794357776641846, "vf_loss": 3167.133056640625, "vf_explained_var": 0.029322028160095215, "kl": 0.004776305984705687, "entropy": 1.2059779167175293, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10847, "done": false, "timesteps_total": 739908, "episodes_total": 1948, "training_iteration": 69, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-41-50", "timestamp": 1585334510, "time_this_iter_s": 18.85410499572754, "time_total_s": 1453.037136554718, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fa60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241400>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002418c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d76a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1453.037136554718, "timesteps_since_restore": 739908, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 34.94814814814815, "ram_util_percent": 86.5925925925926}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.5, "episode_len_mean": 381.86, "episodes_this_iter": 27, "policy_reward_mean": {"av": 2.6699029126213594}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.342195291366576, "avg_speed_min": 2.105670272408828, "avg_speed_max": 5.282667568647895, "avg_rl_veh_arrival_mean": 233.15833333333333, "avg_rl_veh_arrival_min": 84.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.938746494498137, "mean_processing_ms": 3.613494386580724, "mean_inference_ms": 0.5426203644487534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 750792, "num_steps_sampled": 750792, "sample_time_ms": 17595.906, "grad_time_ms": 182.248, "update_time_ms": 11.072, "opt_peak_throughput": 59967.306, "sample_peak_throughput": 621.105, "opt_samples": 10928.9, "learner": {"av": {"cur_kl_coeff": 1.02318151238949e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1650.72021484375, "policy_loss": -24.68614387512207, "vf_loss": 1675.4063720703125, "vf_explained_var": 0.06241881847381592, "kl": 0.00946078635752201, "entropy": 1.071854591369629, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10884, "done": false, "timesteps_total": 750792, "episodes_total": 1975, "training_iteration": 70, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-42-06", "timestamp": 1585334526, "time_this_iter_s": 16.41746759414673, "time_total_s": 1469.4546041488647, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d79d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d72f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d70d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1469.4546041488647, "timesteps_since_restore": 750792, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 37.61666666666667, "ram_util_percent": 86.5625}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 25.5, "episode_len_mean": 398.6, "episodes_this_iter": 25, "policy_reward_mean": {"av": 11.971830985915492}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.518964006428195, "avg_speed_min": 2.105670272408828, "avg_speed_max": 5.3925973303425545, "avg_rl_veh_arrival_mean": 227.82499999999996, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.91953447407129, "mean_processing_ms": 3.6102133245395716, "mean_inference_ms": 0.5404678318610183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 761899, "num_steps_sampled": 761899, "sample_time_ms": 17185.757, "grad_time_ms": 197.477, "update_time_ms": 11.0, "opt_peak_throughput": 55452.445, "sample_peak_throughput": 637.19, "opt_samples": 10950.6, "learner": {"av": {"cur_kl_coeff": 1.02318151238949e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1974.739013671875, "policy_loss": -27.676698684692383, "vf_loss": 2002.41552734375, "vf_explained_var": 0.034716784954071045, "kl": 0.0017034237971529365, "entropy": 1.1155705451965332, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11107, "done": false, "timesteps_total": 761899, "episodes_total": 2000, "training_iteration": 71, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-42-23", "timestamp": 1585334543, "time_this_iter_s": 16.39923596382141, "time_total_s": 1485.8538401126862, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001568c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001569d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1485.8538401126862, "timesteps_since_restore": 761899, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 40.42916666666667, "ram_util_percent": 86.58333333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 32.0, "episode_len_mean": 405.97, "episodes_this_iter": 29, "policy_reward_mean": {"av": 15.458937198067632}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.542972149568714, "avg_speed_min": 2.105670272408828, "avg_speed_max": 5.3925973303425545, "avg_rl_veh_arrival_mean": 216.34833333333333, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.89818480322582, "mean_processing_ms": 3.6078886229733547, "mean_inference_ms": 0.5381424983225978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 772512, "num_steps_sampled": 772512, "sample_time_ms": 17275.213, "grad_time_ms": 185.844, "update_time_ms": 11.045, "opt_peak_throughput": 58694.474, "sample_peak_throughput": 631.425, "opt_samples": 10908.0, "learner": {"av": {"cur_kl_coeff": 5.11590756194745e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2103.483642578125, "policy_loss": -11.998866081237793, "vf_loss": 2115.482421875, "vf_explained_var": 0.062090516090393066, "kl": 0.0027273495215922594, "entropy": 1.1825886964797974, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10613, "done": false, "timesteps_total": 772512, "episodes_total": 2029, "training_iteration": 72, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-42-39", "timestamp": 1585334559, "time_this_iter_s": 16.263131141662598, "time_total_s": 1502.1169712543488, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d76a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7b70>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002410d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1502.1169712543488, "timesteps_since_restore": 772512, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 36.53478260869565, "ram_util_percent": 86.59999999999997}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 31.0, "episode_len_mean": 400.74, "episodes_this_iter": 26, "policy_reward_mean": {"av": 14.97584541062802}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5974364691686835, "avg_speed_min": 2.105670272408828, "avg_speed_max": 5.637299338867385, "avg_rl_veh_arrival_mean": 216.75333333333333, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.878944143114925, "mean_processing_ms": 3.6018724433363967, "mean_inference_ms": 0.5352464378371843}, "off_policy_estimator": {}, "info": {"num_steps_trained": 783364, "num_steps_sampled": 783364, "sample_time_ms": 17047.747, "grad_time_ms": 183.862, "update_time_ms": 10.18, "opt_peak_throughput": 59156.325, "sample_peak_throughput": 638.008, "opt_samples": 10876.6, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 1894.4056396484375, "policy_loss": -22.920671463012695, "vf_loss": 1917.3260498046875, "vf_explained_var": 0.06720227003097534, "kl": 0.016973989084362984, "entropy": 1.0760657787322998, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10852, "done": false, "timesteps_total": 783364, "episodes_total": 2055, "training_iteration": 73, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-42-54", "timestamp": 1585334574, "time_this_iter_s": 14.410290002822876, "time_total_s": 1516.5272612571716, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00241598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002417b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159f8c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024fa60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1516.5272612571716, "timesteps_since_restore": 783364, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.890476190476186, "ram_util_percent": 86.57619047619045}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 27.0, "episode_len_mean": 402.25, "episodes_this_iter": 28, "policy_reward_mean": {"av": 13.846153846153847}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.58540419661508, "avg_speed_min": 2.141425283322688, "avg_speed_max": 5.637299338867385, "avg_rl_veh_arrival_mean": 210.59166666666664, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.852240966044012, "mean_processing_ms": 3.5987840431962512, "mean_inference_ms": 0.5324249480777938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 794610, "num_steps_sampled": 794610, "sample_time_ms": 16574.004, "grad_time_ms": 183.557, "update_time_ms": 10.26, "opt_peak_throughput": 59527.08, "sample_peak_throughput": 659.261, "opt_samples": 10926.6, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 3554.721435546875, "policy_loss": -19.02178192138672, "vf_loss": 3573.74169921875, "vf_explained_var": 0.043151140213012695, "kl": 0.011560829356312752, "entropy": 1.073535442352295, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11246, "done": false, "timesteps_total": 794610, "episodes_total": 2083, "training_iteration": 74, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-43-10", "timestamp": 1585334590, "time_this_iter_s": 15.724919319152832, "time_total_s": 1532.2521805763245, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024fbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f7b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f2f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1532.2521805763245, "timesteps_since_restore": 794610, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 38.5304347826087, "ram_util_percent": 86.60434782608692}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 18.0, "episode_len_mean": 391.02, "episodes_this_iter": 29, "policy_reward_mean": {"av": 9.375}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.539613048474943, "avg_speed_min": 2.44126928835034, "avg_speed_max": 5.637299338867385, "avg_rl_veh_arrival_mean": 206.56333333333336, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.829571136625454, "mean_processing_ms": 3.593858490482451, "mean_inference_ms": 0.5292554801957595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 806249, "num_steps_sampled": 806249, "sample_time_ms": 16681.12, "grad_time_ms": 180.467, "update_time_ms": 10.386, "opt_peak_throughput": 61105.913, "sample_peak_throughput": 661.083, "opt_samples": 11027.6, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2310.533935546875, "policy_loss": -25.523540496826172, "vf_loss": 2336.05712890625, "vf_explained_var": 0.043221116065979004, "kl": 0.01791761815547943, "entropy": 1.0642307996749878, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11639, "done": false, "timesteps_total": 806249, "episodes_total": 2112, "training_iteration": 75, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-43-27", "timestamp": 1585334607, "time_this_iter_s": 17.09052014350891, "time_total_s": 1549.3427007198334, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00241840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002410d0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1549.3427007198334, "timesteps_since_restore": 806249, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 36.088, "ram_util_percent": 86.58799999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 13.5, "episode_len_mean": 392.31, "episodes_this_iter": 27, "policy_reward_mean": {"av": 6.994818652849741}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.495170975291159, "avg_speed_min": 2.44126928835034, "avg_speed_max": 5.637299338867385, "avg_rl_veh_arrival_mean": 208.51, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.799477290853929, "mean_processing_ms": 3.5907404567333185, "mean_inference_ms": 0.525794418218613}, "off_policy_estimator": {}, "info": {"num_steps_trained": 817108, "num_steps_sampled": 817108, "sample_time_ms": 16736.533, "grad_time_ms": 181.801, "update_time_ms": 10.518, "opt_peak_throughput": 60626.295, "sample_peak_throughput": 658.553, "opt_samples": 11021.9, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2432.5458984375, "policy_loss": -9.969176292419434, "vf_loss": 2442.514404296875, "vf_explained_var": 0.041024208068847656, "kl": 0.008688228204846382, "entropy": 1.136529564857483, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10859, "done": false, "timesteps_total": 817108, "episodes_total": 2139, "training_iteration": 76, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-43-45", "timestamp": 1585334625, "time_this_iter_s": 17.030791759490967, "time_total_s": 1566.3734924793243, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d71e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d72f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019eea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1566.3734924793243, "timesteps_since_restore": 817108, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 35.862500000000004, "ram_util_percent": 86.63749999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.5, "episode_len_mean": 387.43, "episodes_this_iter": 28, "policy_reward_mean": {"av": 2.849740932642487}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.466693401105749, "avg_speed_min": 2.4541640110771428, "avg_speed_max": 5.591327383281632, "avg_rl_veh_arrival_mean": 223.62333333333336, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.778165811456099, "mean_processing_ms": 3.5885638815735774, "mean_inference_ms": 0.5227438632895808}, "off_policy_estimator": {}, "info": {"num_steps_trained": 827585, "num_steps_sampled": 827585, "sample_time_ms": 16410.069, "grad_time_ms": 180.104, "update_time_ms": 10.903, "opt_peak_throughput": 60957.568, "sample_peak_throughput": 669.022, "opt_samples": 10978.7, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 3680.874755859375, "policy_loss": -13.117254257202148, "vf_loss": 3693.99072265625, "vf_explained_var": 0.03326594829559326, "kl": 0.011340947821736336, "entropy": 1.0719038248062134, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10477, "done": false, "timesteps_total": 827585, "episodes_total": 2167, "training_iteration": 77, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-44-01", "timestamp": 1585334641, "time_this_iter_s": 16.285303592681885, "time_total_s": 1582.6587960720062, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002121e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00212f28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002207b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e98c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1582.6587960720062, "timesteps_since_restore": 827585, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.545833333333334, "ram_util_percent": 86.59166666666665}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.5, "episode_len_mean": 369.13, "episodes_this_iter": 33, "policy_reward_mean": {"av": -3.826530612244898}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.330489657674196, "avg_speed_min": 2.1109494800916653, "avg_speed_max": 5.591327383281632, "avg_rl_veh_arrival_mean": 233.74833333333336, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.7551442085912825, "mean_processing_ms": 3.585258598174271, "mean_inference_ms": 0.5198932396135885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 838291, "num_steps_sampled": 838291, "sample_time_ms": 16434.887, "grad_time_ms": 179.08, "update_time_ms": 11.806, "opt_peak_throughput": 60995.075, "sample_peak_throughput": 664.623, "opt_samples": 10923.0, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 4901.9755859375, "policy_loss": -4.701808452606201, "vf_loss": 4906.67822265625, "vf_explained_var": 0.05021071434020996, "kl": 0.01459385734051466, "entropy": 1.1890960931777954, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10706, "done": false, "timesteps_total": 838291, "episodes_total": 2200, "training_iteration": 78, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-44-19", "timestamp": 1585334659, "time_this_iter_s": 17.966930150985718, "time_total_s": 1600.625726222992, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d72f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d71e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024f2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1600.625726222992, "timesteps_since_restore": 838291, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 33.00769230769231, "ram_util_percent": 86.58846153846153}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.5, "episode_len_mean": 358.93, "episodes_this_iter": 28, "policy_reward_mean": {"av": -3.676470588235294}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.251283760978736, "avg_speed_min": 2.1109494800916653, "avg_speed_max": 5.758371507880653, "avg_rl_veh_arrival_mean": 229.865, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.733732685278714, "mean_processing_ms": 3.583142194786725, "mean_inference_ms": 0.517952038977809}, "off_policy_estimator": {}, "info": {"num_steps_trained": 849186, "num_steps_sampled": 849186, "sample_time_ms": 16143.561, "grad_time_ms": 178.991, "update_time_ms": 11.902, "opt_peak_throughput": 61052.27, "sample_peak_throughput": 676.914, "opt_samples": 10927.8, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 1899.0902099609375, "policy_loss": -15.606911659240723, "vf_loss": 1914.69580078125, "vf_explained_var": 0.05363231897354126, "kl": 0.0070163714699447155, "entropy": 1.0651756525039673, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10895, "done": false, "timesteps_total": 849186, "episodes_total": 2228, "training_iteration": 79, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-44-35", "timestamp": 1585334675, "time_this_iter_s": 15.933359622955322, "time_total_s": 1616.5590858459473, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e98c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e91e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e96a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1616.5590858459473, "timesteps_since_restore": 849186, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 40.004347826086956, "ram_util_percent": 86.60434782608694}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -2.5, "episode_len_mean": 358.63, "episodes_this_iter": 29, "policy_reward_mean": {"av": -1.2254901960784315}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.262808283667108, "avg_speed_min": 2.1109494800916653, "avg_speed_max": 5.758371507880653, "avg_rl_veh_arrival_mean": 224.07833333333332, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.715481143814733, "mean_processing_ms": 3.5786270270489897, "mean_inference_ms": 0.5163159834214153}, "off_policy_estimator": {}, "info": {"num_steps_trained": 859573, "num_steps_sampled": 859573, "sample_time_ms": 16273.651, "grad_time_ms": 183.094, "update_time_ms": 11.836, "opt_peak_throughput": 59412.612, "sample_peak_throughput": 668.449, "opt_samples": 10878.1, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 3170.088134765625, "policy_loss": -13.282772064208984, "vf_loss": 3183.371826171875, "vf_explained_var": 0.04051166772842407, "kl": 0.0123807517811656, "entropy": 1.1484369039535522, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10387, "done": false, "timesteps_total": 859573, "episodes_total": 2257, "training_iteration": 80, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-44-53", "timestamp": 1585334693, "time_this_iter_s": 17.75370740890503, "time_total_s": 1634.3127932548523, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b2f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027be18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1634.3127932548523, "timesteps_since_restore": 859573, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 36.032, "ram_util_percent": 86.58799999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 14.5, "episode_len_mean": 376.79, "episodes_this_iter": 30, "policy_reward_mean": {"av": 7.28643216080402}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.380371234580664, "avg_speed_min": 2.146302202206883, "avg_speed_max": 5.758371507880653, "avg_rl_veh_arrival_mean": 219.52, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.699835158774676, "mean_processing_ms": 3.578765368809097, "mean_inference_ms": 0.5151224599096601}, "off_policy_estimator": {}, "info": {"num_steps_trained": 871039, "num_steps_sampled": 871039, "sample_time_ms": 16440.255, "grad_time_ms": 166.143, "update_time_ms": 11.951, "opt_peak_throughput": 65690.244, "sample_peak_throughput": 663.858, "opt_samples": 10914.0, "learner": {"av": {"cur_kl_coeff": 2.557953780973725e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 1671.5662841796875, "policy_loss": -26.420310974121094, "vf_loss": 1697.9869384765625, "vf_explained_var": 0.055806517601013184, "kl": 0.0035780579783022404, "entropy": 1.0658676624298096, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11466, "done": false, "timesteps_total": 871039, "episodes_total": 2287, "training_iteration": 81, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-45-12", "timestamp": 1585334712, "time_this_iter_s": 17.878840684890747, "time_total_s": 1652.191633939743, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024fa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024f2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d72f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1652.191633939743, "timesteps_since_restore": 871039, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 37.91153846153846, "ram_util_percent": 86.64999999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 23.0, "episode_len_mean": 391.31, "episodes_this_iter": 25, "policy_reward_mean": {"av": 11.6751269035533}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.439088959428696, "avg_speed_min": 2.146302202206883, "avg_speed_max": 5.758371507880653, "avg_rl_veh_arrival_mean": 222.47, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.681278952223554, "mean_processing_ms": 3.5745084351034806, "mean_inference_ms": 0.5129149127729541}, "off_policy_estimator": {}, "info": {"num_steps_trained": 881977, "num_steps_sampled": 881977, "sample_time_ms": 16271.173, "grad_time_ms": 160.542, "update_time_ms": 11.745, "opt_peak_throughput": 68184.776, "sample_peak_throughput": 672.754, "opt_samples": 10946.5, "learner": {"av": {"cur_kl_coeff": 1.2789768904868624e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2699.614990234375, "policy_loss": -20.802152633666992, "vf_loss": 2720.417236328125, "vf_explained_var": 0.037590086460113525, "kl": 0.0029704421758651733, "entropy": 1.0981767177581787, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10938, "done": false, "timesteps_total": 881977, "episodes_total": 2312, "training_iteration": 82, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-45-26", "timestamp": 1585334726, "time_this_iter_s": 14.50175929069519, "time_total_s": 1666.6933932304382, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212f28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002121e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027bae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1666.6933932304382, "timesteps_since_restore": 881977, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 37.833333333333336, "ram_util_percent": 86.71428571428571}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 21.5, "episode_len_mean": 398.69, "episodes_this_iter": 30, "policy_reward_mean": {"av": 11.375661375661375}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.452315499483327, "avg_speed_min": 2.146302202206883, "avg_speed_max": 5.824851171651043, "avg_rl_veh_arrival_mean": 229.37166666666664, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.664958538571114, "mean_processing_ms": 3.5753596267068817, "mean_inference_ms": 0.5110428828741734}, "off_policy_estimator": {}, "info": {"num_steps_trained": 892659, "num_steps_sampled": 892659, "sample_time_ms": 16616.888, "grad_time_ms": 158.365, "update_time_ms": 12.495, "opt_peak_throughput": 69014.468, "sample_peak_throughput": 657.734, "opt_samples": 10929.5, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2650.937744140625, "policy_loss": -11.231411933898926, "vf_loss": 2662.1689453125, "vf_explained_var": 0.05484926700592041, "kl": 0.006737247575074434, "entropy": 1.1637635231018066, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10682, "done": false, "timesteps_total": 892659, "episodes_total": 2342, "training_iteration": 83, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-45-44", "timestamp": 1585334744, "time_this_iter_s": 17.849021196365356, "time_total_s": 1684.5424144268036, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bf28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00a93d90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00a93f28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00a93ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ae6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1684.5424144268036, "timesteps_since_restore": 892659, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 32.107692307692304, "ram_util_percent": 86.76923076923077}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 15.0, "episode_len_mean": 395.65, "episodes_this_iter": 27, "policy_reward_mean": {"av": 7.731958762886598}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.432852082496823, "avg_speed_min": 2.0086982738883647, "avg_speed_max": 5.824851171651043, "avg_rl_veh_arrival_mean": 237.34333333333333, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.641668221037056, "mean_processing_ms": 3.5737565992447093, "mean_inference_ms": 0.5085926796211211}, "off_policy_estimator": {}, "info": {"num_steps_trained": 903093, "num_steps_sampled": 903093, "sample_time_ms": 16804.532, "grad_time_ms": 158.764, "update_time_ms": 11.479, "opt_peak_throughput": 68329.761, "sample_peak_throughput": 645.558, "opt_samples": 10848.3, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4057.052490234375, "policy_loss": -12.999892234802246, "vf_loss": 4070.05029296875, "vf_explained_var": 0.03973180055618286, "kl": 0.0061881826259195805, "entropy": 1.150477647781372, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10434, "done": false, "timesteps_total": 903093, "episodes_total": 2369, "training_iteration": 84, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-46-02", "timestamp": 1585334762, "time_this_iter_s": 17.582966089248657, "time_total_s": 1702.1253805160522, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019e620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019ee18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019e598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019eb70>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024fa60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1702.1253805160522, "timesteps_since_restore": 903093, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.82, "ram_util_percent": 86.73599999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 7.0, "episode_len_mean": 384.69, "episodes_this_iter": 29, "policy_reward_mean": {"av": 3.5353535353535355}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.360944889902056, "avg_speed_min": 2.0086982738883647, "avg_speed_max": 5.824851171651043, "avg_rl_veh_arrival_mean": 236.1916666666667, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.619662156805008, "mean_processing_ms": 3.5729387850339425, "mean_inference_ms": 0.5062210607035335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 914245, "num_steps_sampled": 914245, "sample_time_ms": 16707.909, "grad_time_ms": 159.938, "update_time_ms": 11.509, "opt_peak_throughput": 67523.614, "sample_peak_throughput": 646.377, "opt_samples": 10799.6, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2895.845458984375, "policy_loss": -15.704930305480957, "vf_loss": 2911.550048828125, "vf_explained_var": 0.04124927520751953, "kl": 0.006408645771443844, "entropy": 1.1322072744369507, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11152, "done": false, "timesteps_total": 914245, "episodes_total": 2398, "training_iteration": 85, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-46-18", "timestamp": 1585334778, "time_this_iter_s": 16.144322633743286, "time_total_s": 1718.2697031497955, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024f7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024fea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1718.2697031497955, "timesteps_since_restore": 914245, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 36.9625, "ram_util_percent": 86.72916666666667}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 16.5, "episode_len_mean": 385.15, "episodes_this_iter": 27, "policy_reward_mean": {"av": 8.375634517766498}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.348302090496427, "avg_speed_min": 2.0086982738883647, "avg_speed_max": 5.824851171651043, "avg_rl_veh_arrival_mean": 223.6, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.600305439762349, "mean_processing_ms": 3.5700433841953476, "mean_inference_ms": 0.5043461674496309}, "off_policy_estimator": {}, "info": {"num_steps_trained": 924913, "num_steps_sampled": 924913, "sample_time_ms": 16694.18, "grad_time_ms": 155.918, "update_time_ms": 11.53, "opt_peak_throughput": 69141.985, "sample_peak_throughput": 645.764, "opt_samples": 10780.5, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2343.12158203125, "policy_loss": -19.553203582763672, "vf_loss": 2362.675537109375, "vf_explained_var": 0.051743507385253906, "kl": 0.00522420322522521, "entropy": 1.0972400903701782, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10668, "done": false, "timesteps_total": 924913, "episodes_total": 2425, "training_iteration": 86, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-46-36", "timestamp": 1585334796, "time_this_iter_s": 16.853283643722534, "time_total_s": 1735.122986793518, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7b70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e7048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7730>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1735.122986793518, "timesteps_since_restore": 924913, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 38.85, "ram_util_percent": 86.85416666666667}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -1.0, "episode_len_mean": 369.11, "episodes_this_iter": 35, "policy_reward_mean": {"av": -0.49261083743842365}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.304805845803327, "avg_speed_min": 2.5538611028913016, "avg_speed_max": 5.586205688559317, "avg_rl_veh_arrival_mean": 231.76166666666668, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.584285185793615, "mean_processing_ms": 3.565544242346833, "mean_inference_ms": 0.5023589709848136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 935922, "num_steps_sampled": 935922, "sample_time_ms": 16922.331, "grad_time_ms": 154.647, "update_time_ms": 10.559, "opt_peak_throughput": 70054.223, "sample_peak_throughput": 640.201, "opt_samples": 10833.7, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 5591.72998046875, "policy_loss": 1.8189537525177002, "vf_loss": 5589.91259765625, "vf_explained_var": 0.03577530384063721, "kl": 0.010378910228610039, "entropy": 1.2200652360916138, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11009, "done": false, "timesteps_total": 935922, "episodes_total": 2460, "training_iteration": 87, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-46-54", "timestamp": 1585334814, "time_this_iter_s": 18.544737339019775, "time_total_s": 1753.6677241325378, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024fc80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f7b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d72f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1753.6677241325378, "timesteps_since_restore": 935922, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 31.92222222222222, "ram_util_percent": 86.99629629629632}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -18.5, "episode_len_mean": 352.79, "episodes_this_iter": 28, "policy_reward_mean": {"av": -9.296482412060302}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.272276870396741, "avg_speed_min": 2.5538611028913016, "avg_speed_max": 5.586205688559317, "avg_rl_veh_arrival_mean": 236.41500000000005, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.573044173823059, "mean_processing_ms": 3.5662681288954023, "mean_inference_ms": 0.5009167092893739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 946410, "num_steps_sampled": 946410, "sample_time_ms": 17006.708, "grad_time_ms": 154.058, "update_time_ms": 10.495, "opt_peak_throughput": 70180.764, "sample_peak_throughput": 635.743, "opt_samples": 10811.9, "learner": {"av": {"cur_kl_coeff": 6.394884452434312e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3449.38671875, "policy_loss": -9.572598457336426, "vf_loss": 3458.958251953125, "vf_explained_var": 0.03937405347824097, "kl": 0.0046422649174928665, "entropy": 1.1948567628860474, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10488, "done": false, "timesteps_total": 946410, "episodes_total": 2488, "training_iteration": 88, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-47-13", "timestamp": 1585334833, "time_this_iter_s": 18.797572135925293, "time_total_s": 1772.4652962684631, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d79d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027ba60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bf28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1772.4652962684631, "timesteps_since_restore": 946410, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.4, "ram_util_percent": 86.86666666666669}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -23.0, "episode_len_mean": 348.94, "episodes_this_iter": 30, "policy_reward_mean": {"av": -11.5}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.251704861259264, "avg_speed_min": 2.539474186240109, "avg_speed_max": 5.586205688559317, "avg_rl_veh_arrival_mean": 249.4233333333333, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.558464859150581, "mean_processing_ms": 3.5636202756823163, "mean_inference_ms": 0.499393439518464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 957175, "num_steps_sampled": 957175, "sample_time_ms": 17014.146, "grad_time_ms": 147.076, "update_time_ms": 10.224, "opt_peak_throughput": 73423.986, "sample_peak_throughput": 634.701, "opt_samples": 10798.9, "learner": {"av": {"cur_kl_coeff": 3.197442226217156e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3182.817138671875, "policy_loss": -14.022546768188477, "vf_loss": 3196.83984375, "vf_explained_var": 0.04505455493927002, "kl": 0.0080277593806386, "entropy": 1.172811508178711, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10765, "done": false, "timesteps_total": 957175, "episodes_total": 2518, "training_iteration": 89, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-47-29", "timestamp": 1585334849, "time_this_iter_s": 15.928069353103638, "time_total_s": 1788.3933656215668, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002429d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002748c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1788.3933656215668, "timesteps_since_restore": 957175, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.03913043478261, "ram_util_percent": 86.86086956521741}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -1.5, "episode_len_mean": 361.43, "episodes_this_iter": 32, "policy_reward_mean": {"av": -0.7575757575757576}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.293903407130542, "avg_speed_min": 2.539474186240109, "avg_speed_max": 5.400229421061374, "avg_rl_veh_arrival_mean": 228.84166666666667, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.537535284039727, "mean_processing_ms": 3.5671862273089867, "mean_inference_ms": 0.49730977097317214}, "off_policy_estimator": {}, "info": {"num_steps_trained": 967919, "num_steps_sampled": 967919, "sample_time_ms": 16887.907, "grad_time_ms": 143.166, "update_time_ms": 10.206, "opt_peak_throughput": 75678.712, "sample_peak_throughput": 641.56, "opt_samples": 10834.6, "learner": {"av": {"cur_kl_coeff": 3.197442226217156e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2786.27392578125, "policy_loss": -9.756424903869629, "vf_loss": 2796.0302734375, "vf_explained_var": 0.06657141447067261, "kl": 0.005558481905609369, "entropy": 1.1593859195709229, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10744, "done": false, "timesteps_total": 967919, "episodes_total": 2550, "training_iteration": 90, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-47-46", "timestamp": 1585334866, "time_this_iter_s": 16.441874980926514, "time_total_s": 1804.8352406024933, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d72f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d71e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d66a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024f2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1804.8352406024933, "timesteps_since_restore": 967919, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 34.34166666666667, "ram_util_percent": 86.87916666666668}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -14.5, "episode_len_mean": 349.51, "episodes_this_iter": 28, "policy_reward_mean": {"av": -7.213930348258707}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.234610603470244, "avg_speed_min": 2.539474186240109, "avg_speed_max": 5.338868860882762, "avg_rl_veh_arrival_mean": 238.15333333333336, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.514375312242708, "mean_processing_ms": 3.56544465551684, "mean_inference_ms": 0.49526443835657136}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978777, "num_steps_sampled": 978777, "sample_time_ms": 16867.711, "grad_time_ms": 146.041, "update_time_ms": 10.438, "opt_peak_throughput": 73772.199, "sample_peak_throughput": 638.723, "opt_samples": 10773.8, "learner": {"av": {"cur_kl_coeff": 3.197442226217156e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2400.405029296875, "policy_loss": -20.468360900878906, "vf_loss": 2420.8720703125, "vf_explained_var": 0.09102141857147217, "kl": 0.026519697159528732, "entropy": 1.1082392930984497, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10858, "done": false, "timesteps_total": 978777, "episodes_total": 2578, "training_iteration": 91, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-48-04", "timestamp": 1585334884, "time_this_iter_s": 17.717210292816162, "time_total_s": 1822.5524508953094, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019e598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019eb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019eea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002740d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1822.5524508953094, "timesteps_since_restore": 978777, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.908, "ram_util_percent": 86.87600000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.0, "episode_len_mean": 375.87, "episodes_this_iter": 27, "policy_reward_mean": {"av": 1.9704433497536946}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.300076676172514, "avg_speed_min": 2.072028020322034, "avg_speed_max": 5.492982598284789, "avg_rl_veh_arrival_mean": 232.78666666666663, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.501354006824835, "mean_processing_ms": 3.560904362707007, "mean_inference_ms": 0.4936141373300359}, "off_policy_estimator": {}, "info": {"num_steps_trained": 989536, "num_steps_sampled": 989536, "sample_time_ms": 17076.318, "grad_time_ms": 152.456, "update_time_ms": 10.76, "opt_peak_throughput": 70550.816, "sample_peak_throughput": 629.872, "opt_samples": 10755.9, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2408.473388671875, "policy_loss": -14.932271957397461, "vf_loss": 2423.4052734375, "vf_explained_var": 0.057167649269104004, "kl": 0.005525995511561632, "entropy": 1.0772892236709595, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10759, "done": false, "timesteps_total": 989536, "episodes_total": 2605, "training_iteration": 92, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-48-21", "timestamp": 1585334901, "time_this_iter_s": 16.666656494140625, "time_total_s": 1839.21910738945, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274b70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020fbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f9d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1839.21910738945, "timesteps_since_restore": 989536, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 32.56666666666666, "ram_util_percent": 86.8125}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.5, "episode_len_mean": 382.87, "episodes_this_iter": 29, "policy_reward_mean": {"av": 4.2288557213930345}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.364106491650135, "avg_speed_min": 2.072028020322034, "avg_speed_max": 5.492982598284789, "avg_rl_veh_arrival_mean": 230.03, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.482474693573815, "mean_processing_ms": 3.5561227641154782, "mean_inference_ms": 0.4913265343842326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1000130, "num_steps_sampled": 1000130, "sample_time_ms": 16834.465, "grad_time_ms": 152.552, "update_time_ms": 9.89, "opt_peak_throughput": 70448.607, "sample_peak_throughput": 638.399, "opt_samples": 10747.1, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2802.26025390625, "policy_loss": -11.8587646484375, "vf_loss": 2814.118408203125, "vf_explained_var": 0.04894167184829712, "kl": 0.014512150548398495, "entropy": 1.110058307647705, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10594, "done": false, "timesteps_total": 1000130, "episodes_total": 2634, "training_iteration": 93, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-48-37", "timestamp": 1585334917, "time_this_iter_s": 15.435551881790161, "time_total_s": 1854.6546592712402, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019ee18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024f2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1854.6546592712402, "timesteps_since_restore": 1000130, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.7608695652174, "ram_util_percent": 86.78695652173914}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 17.0, "episode_len_mean": 393.31, "episodes_this_iter": 23, "policy_reward_mean": {"av": 8.374384236453203}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.460083854953503, "avg_speed_min": 2.072028020322034, "avg_speed_max": 5.492982598284789, "avg_rl_veh_arrival_mean": 233.40666666666667, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.467945019170925, "mean_processing_ms": 3.550834751052852, "mean_inference_ms": 0.48979239752826476}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1010760, "num_steps_sampled": 1010760, "sample_time_ms": 16408.571, "grad_time_ms": 154.886, "update_time_ms": 9.861, "opt_peak_throughput": 69513.586, "sample_peak_throughput": 656.163, "opt_samples": 10766.7, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2097.5322265625, "policy_loss": -25.55647087097168, "vf_loss": 2123.089599609375, "vf_explained_var": 0.0392494797706604, "kl": 0.007379889953881502, "entropy": 0.9222311973571777, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10630, "done": false, "timesteps_total": 1010760, "episodes_total": 2657, "training_iteration": 94, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-48-50", "timestamp": 1585334930, "time_this_iter_s": 13.35908818244934, "time_total_s": 1868.0137474536896, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002426a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002429d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1868.0137474536896, "timesteps_since_restore": 1010760, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 42.40526315789473, "ram_util_percent": 86.81052631578946}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 23.5, "episode_len_mean": 407.53, "episodes_this_iter": 30, "policy_reward_mean": {"av": 11.809045226130653}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.548813707757527, "avg_speed_min": 2.653102206251711, "avg_speed_max": 5.344332275786131, "avg_rl_veh_arrival_mean": 229.145, "avg_rl_veh_arrival_min": 93.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.452138824992982, "mean_processing_ms": 3.5494122319851464, "mean_inference_ms": 0.4877843642105653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1022617, "num_steps_sampled": 1022617, "sample_time_ms": 16314.462, "grad_time_ms": 154.92, "update_time_ms": 8.729, "opt_peak_throughput": 69953.414, "sample_peak_throughput": 664.27, "opt_samples": 10837.2, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2658.892578125, "policy_loss": -22.46798324584961, "vf_loss": 2681.3603515625, "vf_explained_var": 0.05096560716629028, "kl": 0.013284510001540184, "entropy": 0.990027666091919, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11857, "done": false, "timesteps_total": 1022617, "episodes_total": 2687, "training_iteration": 95, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-49-06", "timestamp": 1585334946, "time_this_iter_s": 15.183050632476807, "time_total_s": 1883.1967980861664, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1883.1967980861664, "timesteps_since_restore": 1022617, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 37.51818181818182, "ram_util_percent": 86.81363636363636}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 29.0, "episode_len_mean": 414.86, "episodes_this_iter": 24, "policy_reward_mean": {"av": 14.646464646464647}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.522229431474608, "avg_speed_min": 2.653102206251711, "avg_speed_max": 5.411263201191369, "avg_rl_veh_arrival_mean": 228.69166666666663, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.4343233709732885, "mean_processing_ms": 3.545186389511144, "mean_inference_ms": 0.4864892842143716}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1033928, "num_steps_sampled": 1033928, "sample_time_ms": 16074.551, "grad_time_ms": 160.842, "update_time_ms": 7.9, "opt_peak_throughput": 67777.518, "sample_peak_throughput": 678.184, "opt_samples": 10901.5, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2603.87646484375, "policy_loss": -26.40711212158203, "vf_loss": 2630.283447265625, "vf_explained_var": 0.02773892879486084, "kl": 0.009943748824298382, "entropy": 0.9896016716957092, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11311, "done": false, "timesteps_total": 1033928, "episodes_total": 2711, "training_iteration": 96, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-49-20", "timestamp": 1585334960, "time_this_iter_s": 14.522208213806152, "time_total_s": 1897.7190062999725, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d72f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d79d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024fbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1897.7190062999725, "timesteps_since_restore": 1033928, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 39.71904761904762, "ram_util_percent": 86.73333333333332}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 15.0, "episode_len_mean": 392.08, "episodes_this_iter": 34, "policy_reward_mean": {"av": 7.772020725388601}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.497322897121716, "avg_speed_min": 2.8983265974443206, "avg_speed_max": 5.570603095254734, "avg_rl_veh_arrival_mean": 225.16666666666663, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.418043275775111, "mean_processing_ms": 3.5421656257566365, "mean_inference_ms": 0.4848555865601976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1044906, "num_steps_sampled": 1044906, "sample_time_ms": 15910.422, "grad_time_ms": 157.133, "update_time_ms": 8.823, "opt_peak_throughput": 69357.728, "sample_peak_throughput": 684.985, "opt_samples": 10898.4, "learner": {"av": {"cur_kl_coeff": 4.796163551083971e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3940.806884765625, "policy_loss": -3.6716256141662598, "vf_loss": 3944.478271484375, "vf_explained_var": 0.0446704626083374, "kl": 0.004765042569488287, "entropy": 1.0983024835586548, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10978, "done": false, "timesteps_total": 1044906, "episodes_total": 2745, "training_iteration": 97, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-49-38", "timestamp": 1585334978, "time_this_iter_s": 16.874595880508423, "time_total_s": 1914.593602180481, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019eb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019eea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019e598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d66a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1914.593602180481, "timesteps_since_restore": 1044906, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 33.199999999999996, "ram_util_percent": 86.72400000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -25.0, "episode_len_mean": 349.53, "episodes_this_iter": 35, "policy_reward_mean": {"av": -12.437810945273633}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.348470075762219, "avg_speed_min": 2.7981060789380123, "avg_speed_max": 5.570603095254734, "avg_rl_veh_arrival_mean": 242.79333333333335, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.398185156201646, "mean_processing_ms": 3.539638986720281, "mean_inference_ms": 0.48315001992944795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1055703, "num_steps_sampled": 1055703, "sample_time_ms": 16161.775, "grad_time_ms": 156.798, "update_time_ms": 8.975, "opt_peak_throughput": 69703.278, "sample_peak_throughput": 676.244, "opt_samples": 10929.3, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 6015.49169921875, "policy_loss": 4.9469380378723145, "vf_loss": 6010.54345703125, "vf_explained_var": 0.028652071952819824, "kl": 0.016725901514291763, "entropy": 1.1724233627319336, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10797, "done": false, "timesteps_total": 1055703, "episodes_total": 2780, "training_iteration": 98, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-49-59", "timestamp": 1585334999, "time_this_iter_s": 21.30857563018799, "time_total_s": 1935.902177810669, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cc400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ccc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1935.902177810669, "timesteps_since_restore": 1055703, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 28.683333333333334, "ram_util_percent": 86.81000000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -42.5, "episode_len_mean": 332.17, "episodes_this_iter": 30, "policy_reward_mean": {"av": -20.73170731707317}, "custom_metrics": {"num_ped_collisions_mean": 0.21, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2756028628222, "avg_speed_min": 2.4779448856003654, "avg_speed_max": 5.570603095254734, "avg_rl_veh_arrival_mean": 257.075, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.383523631214814, "mean_processing_ms": 3.539843420744569, "mean_inference_ms": 0.48168815651729824}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1066294, "num_steps_sampled": 1066294, "sample_time_ms": 16303.893, "grad_time_ms": 162.624, "update_time_ms": 8.209, "opt_peak_throughput": 67098.824, "sample_peak_throughput": 669.282, "opt_samples": 10911.9, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4654.0390625, "policy_loss": -7.8504557609558105, "vf_loss": 4661.89013671875, "vf_explained_var": 0.033083558082580566, "kl": 0.012654815800487995, "entropy": 1.0922869443893433, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10591, "done": false, "timesteps_total": 1066294, "episodes_total": 2810, "training_iteration": 99, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-50-17", "timestamp": 1585335017, "time_this_iter_s": 17.400023698806763, "time_total_s": 1953.3022015094757, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024f7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f2f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d72f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1953.3022015094757, "timesteps_since_restore": 1066294, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 34.4, "ram_util_percent": 86.808}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -34.0, "episode_len_mean": 341.49, "episodes_this_iter": 30, "policy_reward_mean": {"av": -16.19047619047619}, "custom_metrics": {"num_ped_collisions_mean": 0.21, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.236598377894605, "avg_speed_min": 2.4779448856003654, "avg_speed_max": 5.54596299906433, "avg_rl_veh_arrival_mean": 263.135, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.370786051809657, "mean_processing_ms": 3.5430788976204393, "mean_inference_ms": 0.4801710404588896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1077126, "num_steps_sampled": 1077126, "sample_time_ms": 16214.322, "grad_time_ms": 160.598, "update_time_ms": 9.205, "opt_peak_throughput": 68000.389, "sample_peak_throughput": 673.522, "opt_samples": 10920.7, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2923.555908203125, "policy_loss": -9.5372953414917, "vf_loss": 2933.092041015625, "vf_explained_var": 0.05563861131668091, "kl": 0.006880877073854208, "entropy": 1.0980061292648315, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10832, "done": false, "timesteps_total": 1077126, "episodes_total": 2840, "training_iteration": 100, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-50-32", "timestamp": 1585335032, "time_this_iter_s": 15.538275003433228, "time_total_s": 1968.840476512909, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00242a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002426a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002429d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cce18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1968.840476512909, "timesteps_since_restore": 1077126, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 33.947826086956525, "ram_util_percent": 86.84347826086956}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -12.5, "episode_len_mean": 353.71, "episodes_this_iter": 28, "policy_reward_mean": {"av": -5.924170616113744}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.26754314274011, "avg_speed_min": 2.4779448856003654, "avg_speed_max": 5.502897711990109, "avg_rl_veh_arrival_mean": 238.455, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.358567142693838, "mean_processing_ms": 3.5449330632170275, "mean_inference_ms": 0.47847787566733574}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1087580, "num_steps_sampled": 1087580, "sample_time_ms": 16012.517, "grad_time_ms": 159.6, "update_time_ms": 8.183, "opt_peak_throughput": 68172.379, "sample_peak_throughput": 679.487, "opt_samples": 10880.3, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3081.479736328125, "policy_loss": -12.573331832885742, "vf_loss": 3094.051513671875, "vf_explained_var": 0.03566920757293701, "kl": 0.0067963795736432076, "entropy": 1.058966040611267, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10454, "done": false, "timesteps_total": 1087580, "episodes_total": 2868, "training_iteration": 101, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-50-48", "timestamp": 1585335048, "time_this_iter_s": 15.66412878036499, "time_total_s": 1984.504605293274, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00241ae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024f7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024fa60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ccf28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017b598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1984.504605293274, "timesteps_since_restore": 1087580, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 34.5, "ram_util_percent": 86.9}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.5, "episode_len_mean": 370.23, "episodes_this_iter": 28, "policy_reward_mean": {"av": -1.7156862745098038}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.37246888814877, "avg_speed_min": 2.452106243746198, "avg_speed_max": 5.575363064988016, "avg_rl_veh_arrival_mean": 245.85333333333332, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.344335777017261, "mean_processing_ms": 3.5427634465307527, "mean_inference_ms": 0.47680184566344996}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1098654, "num_steps_sampled": 1098654, "sample_time_ms": 15902.048, "grad_time_ms": 159.543, "update_time_ms": 7.001, "opt_peak_throughput": 68394.279, "sample_peak_throughput": 686.188, "opt_samples": 10911.8, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3415.289794921875, "policy_loss": -18.89042854309082, "vf_loss": 3434.1787109375, "vf_explained_var": 0.04994302988052368, "kl": 0.014137732796370983, "entropy": 1.0171540975570679, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11074, "done": false, "timesteps_total": 1098654, "episodes_total": 2896, "training_iteration": 102, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-51-04", "timestamp": 1585335064, "time_this_iter_s": 15.549935102462769, "time_total_s": 2000.0545403957367, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cc840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc1e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016ae18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2000.0545403957367, "timesteps_since_restore": 1098654, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 36.03636363636363, "ram_util_percent": 86.8909090909091}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 17.5, "episode_len_mean": 393.81, "episodes_this_iter": 26, "policy_reward_mean": {"av": 8.793969849246231}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.481415986705015, "avg_speed_min": 2.452106243746198, "avg_speed_max": 5.575363064988016, "avg_rl_veh_arrival_mean": 231.5233333333333, "avg_rl_veh_arrival_min": 73.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.326886757813872, "mean_processing_ms": 3.538462271684357, "mean_inference_ms": 0.47496344502520016}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1109515, "num_steps_sampled": 1109515, "sample_time_ms": 15702.09, "grad_time_ms": 158.678, "update_time_ms": 8.133, "opt_peak_throughput": 68935.272, "sample_peak_throughput": 696.627, "opt_samples": 10938.5, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2304.19775390625, "policy_loss": -19.84554672241211, "vf_loss": 2324.043701171875, "vf_explained_var": 0.04018157720565796, "kl": 0.015155836008489132, "entropy": 0.9342074990272522, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10861, "done": false, "timesteps_total": 1109515, "episodes_total": 2922, "training_iteration": 103, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-51-18", "timestamp": 1585335078, "time_this_iter_s": 13.426403999328613, "time_total_s": 2013.4809443950653, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f9d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fbf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020fa60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f0d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00274ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2013.4809443950653, "timesteps_since_restore": 1109515, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 35.725, "ram_util_percent": 86.88500000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.5, "episode_len_mean": 393.51, "episodes_this_iter": 28, "policy_reward_mean": {"av": 2.8205128205128207}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.466377409381092, "avg_speed_min": 1.9583957053955137, "avg_speed_max": 5.575363064988016, "avg_rl_veh_arrival_mean": 245.00833333333335, "avg_rl_veh_arrival_min": 79.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.313037114173917, "mean_processing_ms": 3.5365987458679835, "mean_inference_ms": 0.4733060583922801}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1120082, "num_steps_sampled": 1120082, "sample_time_ms": 16053.027, "grad_time_ms": 156.112, "update_time_ms": 8.181, "opt_peak_throughput": 70028.034, "sample_peak_throughput": 681.006, "opt_samples": 10932.2, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4691.74365234375, "policy_loss": -7.9117255210876465, "vf_loss": 4699.65771484375, "vf_explained_var": 0.038299381732940674, "kl": 0.006337897386401892, "entropy": 1.086257815361023, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10567, "done": false, "timesteps_total": 1120082, "episodes_total": 2950, "training_iteration": 104, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-51-35", "timestamp": 1585335095, "time_this_iter_s": 16.828510999679565, "time_total_s": 2030.3094553947449, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274b70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002748c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2030.3094553947449, "timesteps_since_restore": 1120082, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 34.52083333333333, "ram_util_percent": 86.95416666666665}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 9.5, "episode_len_mean": 404.79, "episodes_this_iter": 23, "policy_reward_mean": {"av": 4.72636815920398}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.457526325488188, "avg_speed_min": 1.9583957053955137, "avg_speed_max": 5.463800199812474, "avg_rl_veh_arrival_mean": 257.6333333333334, "avg_rl_veh_arrival_min": 112.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.30081684431091, "mean_processing_ms": 3.5364371028871244, "mean_inference_ms": 0.47259530711245773}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1130504, "num_steps_sampled": 1130504, "sample_time_ms": 16007.221, "grad_time_ms": 162.193, "update_time_ms": 9.213, "opt_peak_throughput": 66517.828, "sample_peak_throughput": 673.99, "opt_samples": 10788.7, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2873.580810546875, "policy_loss": -16.07479476928711, "vf_loss": 2889.655517578125, "vf_explained_var": 0.04508942365646362, "kl": 0.0069012511521577835, "entropy": 1.083138346672058, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10422, "done": false, "timesteps_total": 1130504, "episodes_total": 2973, "training_iteration": 105, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-51-50", "timestamp": 1585335110, "time_this_iter_s": 14.815406799316406, "time_total_s": 2045.1248621940613, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00242730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242ae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2045.1248621940613, "timesteps_since_restore": 1130504, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 35.72380952380953, "ram_util_percent": 86.8809523809524}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 21.0, "episode_len_mean": 412.0, "episodes_this_iter": 29, "policy_reward_mean": {"av": 10.606060606060606}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4938263692942515, "avg_speed_min": 1.9583957053955137, "avg_speed_max": 5.606668857101153, "avg_rl_veh_arrival_mean": 240.9033333333333, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.286653312547572, "mean_processing_ms": 3.5301190948142818, "mean_inference_ms": 0.4712852291237528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1141751, "num_steps_sampled": 1141751, "sample_time_ms": 16021.775, "grad_time_ms": 151.861, "update_time_ms": 9.891, "opt_peak_throughput": 71000.946, "sample_peak_throughput": 672.978, "opt_samples": 10782.3, "learner": {"av": {"cur_kl_coeff": 2.3980817755419855e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1845.798583984375, "policy_loss": -22.34577178955078, "vf_loss": 1868.144775390625, "vf_explained_var": 0.10315871238708496, "kl": 0.003583825659006834, "entropy": 1.0082569122314453, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11247, "done": false, "timesteps_total": 1141751, "episodes_total": 3002, "training_iteration": 106, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-52-05", "timestamp": 1585335125, "time_this_iter_s": 14.551131248474121, "time_total_s": 2059.6759934425354, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002740d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00274620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f1e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2059.6759934425354, "timesteps_since_restore": 1141751, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 37.900000000000006, "ram_util_percent": 86.87619047619049}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.5, "episode_len_mean": 395.96, "episodes_this_iter": 26, "policy_reward_mean": {"av": 4.25}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.433763733380755, "avg_speed_min": 1.9583957053955137, "avg_speed_max": 5.606668857101153, "avg_rl_veh_arrival_mean": 242.07666666666668, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.272529800658452, "mean_processing_ms": 3.5280800930852716, "mean_inference_ms": 0.46999858111522896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1152329, "num_steps_sampled": 1152329, "sample_time_ms": 15917.41, "grad_time_ms": 155.015, "update_time_ms": 9.96, "opt_peak_throughput": 69298.331, "sample_peak_throughput": 674.877, "opt_samples": 10742.3, "learner": {"av": {"cur_kl_coeff": 1.1990408877709927e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2191.37353515625, "policy_loss": -16.970367431640625, "vf_loss": 2208.343505859375, "vf_explained_var": 0.08965188264846802, "kl": 0.006971916649490595, "entropy": 1.0780445337295532, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10578, "done": false, "timesteps_total": 1152329, "episodes_total": 3028, "training_iteration": 107, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-52-21", "timestamp": 1585335141, "time_this_iter_s": 15.8739652633667, "time_total_s": 2075.549958705902, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016aae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016ab70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016abf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016ad08>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2075.549958705902, "timesteps_since_restore": 1152329, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 33.665217391304346, "ram_util_percent": 86.84782608695652}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 21.5, "episode_len_mean": 399.91, "episodes_this_iter": 29, "policy_reward_mean": {"av": 10.238095238095237}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.454330612664447, "avg_speed_min": 2.1381072364062708, "avg_speed_max": 5.606668857101153, "avg_rl_veh_arrival_mean": 230.89333333333332, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.258080066471426, "mean_processing_ms": 3.524746355846905, "mean_inference_ms": 0.46878357520893005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1162969, "num_steps_sampled": 1162969, "sample_time_ms": 15512.928, "grad_time_ms": 171.335, "update_time_ms": 8.994, "opt_peak_throughput": 62606.134, "sample_peak_throughput": 691.462, "opt_samples": 10726.6, "learner": {"av": {"cur_kl_coeff": 1.1990408877709927e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2958.351318359375, "policy_loss": -8.37270736694336, "vf_loss": 2966.72265625, "vf_explained_var": 0.04606813192367554, "kl": 0.003361990675330162, "entropy": 1.068241000175476, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10640, "done": false, "timesteps_total": 1162969, "episodes_total": 3057, "training_iteration": 108, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-52-38", "timestamp": 1585335158, "time_this_iter_s": 17.438950538635254, "time_total_s": 2092.9889092445374, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cc158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc0d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2092.9889092445374, "timesteps_since_restore": 1162969, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 33.348, "ram_util_percent": 86.852}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 23.0, "episode_len_mean": 400.84, "episodes_this_iter": 29, "policy_reward_mean": {"av": 11.27450980392157}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5157359043097465, "avg_speed_min": 2.7005898481356763, "avg_speed_max": 5.606668857101153, "avg_rl_veh_arrival_mean": 219.73500000000004, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.2435354974488595, "mean_processing_ms": 3.5215369347415315, "mean_inference_ms": 0.4674854076419128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1174132, "num_steps_sampled": 1174132, "sample_time_ms": 15331.409, "grad_time_ms": 167.774, "update_time_ms": 9.002, "opt_peak_throughput": 64275.703, "sample_peak_throughput": 703.38, "opt_samples": 10783.8, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2400.94091796875, "policy_loss": -15.857627868652344, "vf_loss": 2416.798095703125, "vf_explained_var": 0.05827850103378296, "kl": 0.005814248695969582, "entropy": 1.0187888145446777, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11163, "done": false, "timesteps_total": 1174132, "episodes_total": 3086, "training_iteration": 109, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-52-54", "timestamp": 1585335174, "time_this_iter_s": 15.549487352371216, "time_total_s": 2108.5383965969086, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020f950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020fe18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002740d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2108.5383965969086, "timesteps_since_restore": 1174132, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 34.00434782608696, "ram_util_percent": 86.88695652173915}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 6.0, "episode_len_mean": 382.76, "episodes_this_iter": 29, "policy_reward_mean": {"av": 2.898550724637681}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.430482325557547, "avg_speed_min": 2.7005898481356763, "avg_speed_max": 5.574368538982429, "avg_rl_veh_arrival_mean": 227.38666666666668, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.233831172974565, "mean_processing_ms": 3.517383609186638, "mean_inference_ms": 0.4663592667615578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1185108, "num_steps_sampled": 1185108, "sample_time_ms": 15392.457, "grad_time_ms": 168.89, "update_time_ms": 9.074, "opt_peak_throughput": 63936.182, "sample_peak_throughput": 701.525, "opt_samples": 10798.2, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3631.970703125, "policy_loss": -8.46080493927002, "vf_loss": 3640.431396484375, "vf_explained_var": 0.03786134719848633, "kl": 0.008392248302698135, "entropy": 1.0249778032302856, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10976, "done": false, "timesteps_total": 1185108, "episodes_total": 3115, "training_iteration": 110, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-53-11", "timestamp": 1585335191, "time_this_iter_s": 16.173713445663452, "time_total_s": 2124.712110042572, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274b70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002748c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e70d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2124.712110042572, "timesteps_since_restore": 1185108, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 38.01304347826087, "ram_util_percent": 86.95652173913045}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 15.5, "episode_len_mean": 387.39, "episodes_this_iter": 27, "policy_reward_mean": {"av": 7.908163265306122}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.450556817199796, "avg_speed_min": 2.7005898481356763, "avg_speed_max": 5.574368538982429, "avg_rl_veh_arrival_mean": 219.89, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.223717459386774, "mean_processing_ms": 3.513735790261285, "mean_inference_ms": 0.46531911316345625}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1196083, "num_steps_sampled": 1196083, "sample_time_ms": 15267.75, "grad_time_ms": 166.129, "update_time_ms": 8.878, "opt_peak_throughput": 65312.332, "sample_peak_throughput": 710.668, "opt_samples": 10850.3, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1410.80029296875, "policy_loss": -22.23723793029785, "vf_loss": 1433.0379638671875, "vf_explained_var": 0.10622948408126831, "kl": 0.008501434698700905, "entropy": 0.9153509736061096, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10975, "done": false, "timesteps_total": 1196083, "episodes_total": 3142, "training_iteration": 111, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-53-25", "timestamp": 1585335205, "time_this_iter_s": 14.392775535583496, "time_total_s": 2139.1048855781555, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001aed90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2139.1048855781555, "timesteps_since_restore": 1196083, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 37.28571428571429, "ram_util_percent": 86.90476190476193}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 7.5, "episode_len_mean": 388.86, "episodes_this_iter": 28, "policy_reward_mean": {"av": 3.8860103626943006}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.387938075294688, "avg_speed_min": 2.92554616489536, "avg_speed_max": 5.574368538982429, "avg_rl_veh_arrival_mean": 219.59, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.211032607214192, "mean_processing_ms": 3.50804299051606, "mean_inference_ms": 0.4641178991013862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1206635, "num_steps_sampled": 1206635, "sample_time_ms": 15527.322, "grad_time_ms": 165.113, "update_time_ms": 10.203, "opt_peak_throughput": 65398.112, "sample_peak_throughput": 695.426, "opt_samples": 10798.1, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2499.476806640625, "policy_loss": -1.870205044746399, "vf_loss": 2501.34521484375, "vf_explained_var": 0.04851013422012329, "kl": 0.010721679776906967, "entropy": 1.1231186389923096, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10552, "done": false, "timesteps_total": 1206635, "episodes_total": 3170, "training_iteration": 112, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-53-44", "timestamp": 1585335224, "time_this_iter_s": 18.13578510284424, "time_total_s": 2157.2406706809998, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00274ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2157.2406706809998, "timesteps_since_restore": 1206635, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 34.86923076923077, "ram_util_percent": 86.9346153846154}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -6.5, "episode_len_mean": 365.48, "episodes_this_iter": 31, "policy_reward_mean": {"av": -3.2338308457711444}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.21, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.329422582215832, "avg_speed_min": 2.889081899359031, "avg_speed_max": 5.574368538982429, "avg_rl_veh_arrival_mean": 220.50833333333335, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.202498039331134, "mean_processing_ms": 3.5087169218142997, "mean_inference_ms": 0.46367486970177113}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1217706, "num_steps_sampled": 1217706, "sample_time_ms": 15945.087, "grad_time_ms": 168.669, "update_time_ms": 9.129, "opt_peak_throughput": 64143.817, "sample_peak_throughput": 678.522, "opt_samples": 10819.1, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3401.408203125, "policy_loss": -10.558842658996582, "vf_loss": 3411.967041015625, "vf_explained_var": 0.06469756364822388, "kl": 0.008091016672551632, "entropy": 1.0428181886672974, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11071, "done": false, "timesteps_total": 1217706, "episodes_total": 3201, "training_iteration": 113, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-54-01", "timestamp": 1585335241, "time_this_iter_s": 17.629090547561646, "time_total_s": 2174.8697612285614, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ccf28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc0d0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002121e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2174.8697612285614, "timesteps_since_restore": 1217706, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 32.81923076923077, "ram_util_percent": 86.89230769230772}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -5.5, "episode_len_mean": 369.45, "episodes_this_iter": 31, "policy_reward_mean": {"av": -2.7777777777777777}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.21, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.292285058687945, "avg_speed_min": 2.280818197774634, "avg_speed_max": 5.425921796784328, "avg_rl_veh_arrival_mean": 218.99, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.190941177171047, "mean_processing_ms": 3.5075542719796933, "mean_inference_ms": 0.4625960573704477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1229061, "num_steps_sampled": 1229061, "sample_time_ms": 15966.988, "grad_time_ms": 165.998, "update_time_ms": 10.177, "opt_peak_throughput": 65650.892, "sample_peak_throughput": 682.527, "opt_samples": 10897.9, "learner": {"av": {"cur_kl_coeff": 5.995204438854964e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3024.696533203125, "policy_loss": -12.752657890319824, "vf_loss": 3037.44873046875, "vf_explained_var": 0.0647473931312561, "kl": 0.004601268097758293, "entropy": 1.0214143991470337, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11355, "done": false, "timesteps_total": 1229061, "episodes_total": 3232, "training_iteration": 114, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-54-19", "timestamp": 1585335259, "time_this_iter_s": 17.032788276672363, "time_total_s": 2191.9025495052338, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027bf28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027ba60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2191.9025495052338, "timesteps_since_restore": 1229061, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 35.62083333333334, "ram_util_percent": 86.96250000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -10.0, "episode_len_mean": 369.01, "episodes_this_iter": 28, "policy_reward_mean": {"av": -5.1020408163265305}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.362649953530356, "avg_speed_min": 2.280818197774634, "avg_speed_max": 5.554852888593326, "avg_rl_veh_arrival_mean": 235.585, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.17761626651394, "mean_processing_ms": 3.509799989358101, "mean_inference_ms": 0.4607350314355799}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1239880, "num_steps_sampled": 1239880, "sample_time_ms": 15952.426, "grad_time_ms": 159.663, "update_time_ms": 9.874, "opt_peak_throughput": 68504.334, "sample_peak_throughput": 685.639, "opt_samples": 10937.6, "learner": {"av": {"cur_kl_coeff": 2.997602219427482e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2847.697265625, "policy_loss": -17.98233413696289, "vf_loss": 2865.678955078125, "vf_explained_var": 0.0570145845413208, "kl": 0.013162491843104362, "entropy": 0.9275477528572083, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10819, "done": false, "timesteps_total": 1239880, "episodes_total": 3260, "training_iteration": 115, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-54-33", "timestamp": 1585335273, "time_this_iter_s": 14.583613634109497, "time_total_s": 2206.4861631393433, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae6a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ae598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae0d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001aed90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2206.4861631393433, "timesteps_since_restore": 1239880, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 35.48571428571429, "ram_util_percent": 86.97619047619048}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -16.0, "episode_len_mean": 360.15, "episodes_this_iter": 34, "policy_reward_mean": {"av": -8.080808080808081}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.334055976928074, "avg_speed_min": 2.280818197774634, "avg_speed_max": 5.554852888593326, "avg_rl_veh_arrival_mean": 244.1483333333333, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.1642167858779695, "mean_processing_ms": 3.5110850750746714, "mean_inference_ms": 0.4589138107072172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1250952, "num_steps_sampled": 1250952, "sample_time_ms": 16254.944, "grad_time_ms": 163.322, "update_time_ms": 10.093, "opt_peak_throughput": 66862.347, "sample_peak_throughput": 671.802, "opt_samples": 10920.1, "learner": {"av": {"cur_kl_coeff": 2.997602219427482e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4422.83544921875, "policy_loss": -7.8288960456848145, "vf_loss": 4430.6650390625, "vf_explained_var": 0.034318625926971436, "kl": 0.009138822555541992, "entropy": 1.0171939134597778, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11072, "done": false, "timesteps_total": 1250952, "episodes_total": 3294, "training_iteration": 116, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-54-51", "timestamp": 1585335291, "time_this_iter_s": 17.61506748199463, "time_total_s": 2224.101230621338, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274b70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002741e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027bea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2224.101230621338, "timesteps_since_restore": 1250952, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 33.01538461538461, "ram_util_percent": 86.97692307692309}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -6.5, "episode_len_mean": 376.48, "episodes_this_iter": 27, "policy_reward_mean": {"av": -3.2663316582914574}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3763656911593385, "avg_speed_min": 2.34359476859911, "avg_speed_max": 5.554852888593326, "avg_rl_veh_arrival_mean": 249.9633333333333, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.1554459143183315, "mean_processing_ms": 3.509311206853697, "mean_inference_ms": 0.4577287297244327}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1262195, "num_steps_sampled": 1262195, "sample_time_ms": 16250.377, "grad_time_ms": 168.423, "update_time_ms": 9.047, "opt_peak_throughput": 65231.995, "sample_peak_throughput": 676.083, "opt_samples": 10986.6, "learner": {"av": {"cur_kl_coeff": 2.997602219427482e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2682.732421875, "policy_loss": -17.473661422729492, "vf_loss": 2700.2060546875, "vf_explained_var": 0.03894996643066406, "kl": 0.00803843792527914, "entropy": 0.986605167388916, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11243, "done": false, "timesteps_total": 1262195, "episodes_total": 3321, "training_iteration": 117, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-55-07", "timestamp": 1585335307, "time_this_iter_s": 15.863962888717651, "time_total_s": 2239.9651935100555, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9ae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e98c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2239.9651935100555, "timesteps_since_restore": 1262195, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 39.995652173913044, "ram_util_percent": 86.97826086956522}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -31.0, "episode_len_mean": 332.95, "episodes_this_iter": 38, "policy_reward_mean": {"av": -15.270935960591133}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.2, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.176319106952991, "avg_speed_min": 2.34359476859911, "avg_speed_max": 5.379752777768732, "avg_rl_veh_arrival_mean": 243.1, "avg_rl_veh_arrival_min": 76.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.147664158123333, "mean_processing_ms": 3.5148231278955406, "mean_inference_ms": 0.45633138179056687}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1272649, "num_steps_sampled": 1272649, "sample_time_ms": 16481.094, "grad_time_ms": 153.384, "update_time_ms": 9.941, "opt_peak_throughput": 71506.809, "sample_peak_throughput": 665.49, "opt_samples": 10968.0, "learner": {"av": {"cur_kl_coeff": 2.997602219427482e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4625.0400390625, "policy_loss": 4.661962032318115, "vf_loss": 4620.37548828125, "vf_explained_var": 0.059376418590545654, "kl": 0.01740173250436783, "entropy": 1.1893835067749023, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10454, "done": false, "timesteps_total": 1272649, "episodes_total": 3359, "training_iteration": 118, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-55-27", "timestamp": 1585335327, "time_this_iter_s": 19.58405590057373, "time_total_s": 2259.5492494106293, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274b70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00274950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020fa60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2259.5492494106293, "timesteps_since_restore": 1272649, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 30.900000000000002, "ram_util_percent": 86.98928571428571}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -40.5, "episode_len_mean": 318.75, "episodes_this_iter": 36, "policy_reward_mean": {"av": -19.471153846153847}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.22, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.143031633330116, "avg_speed_min": 2.5893861900449084, "avg_speed_max": 5.379752777768732, "avg_rl_veh_arrival_mean": 243.85666666666668, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.138347136137367, "mean_processing_ms": 3.521308594254957, "mean_inference_ms": 0.4551932777237958}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1283373, "num_steps_sampled": 1283373, "sample_time_ms": 16948.48, "grad_time_ms": 158.053, "update_time_ms": 10.805, "opt_peak_throughput": 69116.608, "sample_peak_throughput": 644.547, "opt_samples": 10924.1, "learner": {"av": {"cur_kl_coeff": 2.997602219427482e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 5341.669921875, "policy_loss": 9.644423484802246, "vf_loss": 5332.02490234375, "vf_explained_var": 0.06360363960266113, "kl": 0.004152144771069288, "entropy": 1.1855181455612183, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10724, "done": false, "timesteps_total": 1283373, "episodes_total": 3395, "training_iteration": 119, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-55-48", "timestamp": 1585335348, "time_this_iter_s": 20.285797834396362, "time_total_s": 2279.8350472450256, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002121e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2279.8350472450256, "timesteps_since_restore": 1283373, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 33.741379310344826, "ram_util_percent": 86.74827586206892}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -29.5, "episode_len_mean": 326.73, "episodes_this_iter": 25, "policy_reward_mean": {"av": -13.915094339622641}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.23, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.162118087989795, "avg_speed_min": 2.5791435853132567, "avg_speed_max": 5.379752777768732, "avg_rl_veh_arrival_mean": 234.86333333333332, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.133761056079352, "mean_processing_ms": 3.522480657584794, "mean_inference_ms": 0.4545330310395998}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1293809, "num_steps_sampled": 1293809, "sample_time_ms": 16832.286, "grad_time_ms": 159.008, "update_time_ms": 9.748, "opt_peak_throughput": 68361.907, "sample_peak_throughput": 645.789, "opt_samples": 10870.1, "learner": {"av": {"cur_kl_coeff": 1.498801109713741e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1891.827880859375, "policy_loss": -19.8677921295166, "vf_loss": 1911.6949462890625, "vf_explained_var": 0.09330159425735474, "kl": 0.012468560598790646, "entropy": 0.9201828837394714, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10436, "done": false, "timesteps_total": 1293809, "episodes_total": 3420, "training_iteration": 120, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-56-03", "timestamp": 1585335363, "time_this_iter_s": 14.996130466461182, "time_total_s": 2294.831177711487, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220d90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002417b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2294.831177711487, "timesteps_since_restore": 1293809, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 37.11363636363636, "ram_util_percent": 86.68181818181819}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -17.5, "episode_len_mean": 343.58, "episodes_this_iter": 30, "policy_reward_mean": {"av": -8.215962441314554}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.271613014830069, "avg_speed_min": 2.5791435853132567, "avg_speed_max": 5.400352237675266, "avg_rl_veh_arrival_mean": 236.84333333333333, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.127447208073685, "mean_processing_ms": 3.5236058148425093, "mean_inference_ms": 0.45422873558953397}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1304798, "num_steps_sampled": 1304798, "sample_time_ms": 17217.848, "grad_time_ms": 158.493, "update_time_ms": 10.657, "opt_peak_throughput": 68592.813, "sample_peak_throughput": 631.409, "opt_samples": 10871.5, "learner": {"av": {"cur_kl_coeff": 1.498801109713741e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3037.19384765625, "policy_loss": -20.74199676513672, "vf_loss": 3057.935546875, "vf_explained_var": 0.07081907987594604, "kl": 0.012137996964156628, "entropy": 0.9097474217414856, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10989, "done": false, "timesteps_total": 1304798, "episodes_total": 3450, "training_iteration": 121, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-56-21", "timestamp": 1585335381, "time_this_iter_s": 18.24908709526062, "time_total_s": 2313.0802648067474, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f8c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020fbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00274950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2313.0802648067474, "timesteps_since_restore": 1304798, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 33.676923076923075, "ram_util_percent": 86.67692307692307}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -5.5, "episode_len_mean": 365.35, "episodes_this_iter": 28, "policy_reward_mean": {"av": -2.5943396226415096}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.365319518200904, "avg_speed_min": 2.5791435853132567, "avg_speed_max": 5.400352237675266, "avg_rl_veh_arrival_mean": 237.60666666666668, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.123495841674421, "mean_processing_ms": 3.5200989420800477, "mean_inference_ms": 0.4538853791084778}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1315985, "num_steps_sampled": 1315985, "sample_time_ms": 17093.551, "grad_time_ms": 161.727, "update_time_ms": 10.234, "opt_peak_throughput": 67613.992, "sample_peak_throughput": 639.715, "opt_samples": 10935.0, "learner": {"av": {"cur_kl_coeff": 1.498801109713741e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3316.343505859375, "policy_loss": -18.215091705322266, "vf_loss": 3334.55908203125, "vf_explained_var": 0.05914491415023804, "kl": 0.004619692452251911, "entropy": 0.9003281593322754, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11187, "done": false, "timesteps_total": 1315985, "episodes_total": 3478, "training_iteration": 122, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-56-38", "timestamp": 1585335398, "time_this_iter_s": 16.923060178756714, "time_total_s": 2330.003324985504, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001aed90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001ae0d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ae598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002418c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2330.003324985504, "timesteps_since_restore": 1315985, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 39.892, "ram_util_percent": 86.77199999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -12.0, "episode_len_mean": 368.14, "episodes_this_iter": 34, "policy_reward_mean": {"av": -5.769230769230769}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.38018987872266, "avg_speed_min": 2.2736717892946383, "avg_speed_max": 5.400352237675266, "avg_rl_veh_arrival_mean": 250.52666666666664, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.1131154986127765, "mean_processing_ms": 3.521819230725854, "mean_inference_ms": 0.4532006478873133}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1327205, "num_steps_sampled": 1327205, "sample_time_ms": 17072.066, "grad_time_ms": 165.104, "update_time_ms": 11.118, "opt_peak_throughput": 66321.062, "sample_peak_throughput": 641.393, "opt_samples": 10949.9, "learner": {"av": {"cur_kl_coeff": 7.494005548568705e-17, "cur_lr": 9.999999747378752e-05, "total_loss": 5821.84375, "policy_loss": -0.37590789794921875, "vf_loss": 5822.21728515625, "vf_explained_var": 0.059311628341674805, "kl": 0.025869516655802727, "entropy": 1.1386768817901611, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11220, "done": false, "timesteps_total": 1327205, "episodes_total": 3512, "training_iteration": 123, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-56-56", "timestamp": 1585335416, "time_this_iter_s": 17.459375381469727, "time_total_s": 2347.462700366974, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019eea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019e598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019eb70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019ec80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024f7b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2347.462700366974, "timesteps_since_restore": 1327205, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 33.84400000000001, "ram_util_percent": 86.63999999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -26.5, "episode_len_mean": 355.85, "episodes_this_iter": 33, "policy_reward_mean": {"av": -12.990196078431373}, "custom_metrics": {"num_ped_collisions_mean": 0.22, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.298816191280207, "avg_speed_min": 2.2736717892946383, "avg_speed_max": 5.378885206076335, "avg_rl_veh_arrival_mean": 264.31166666666667, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.102427058901424, "mean_processing_ms": 3.5214946404291254, "mean_inference_ms": 0.45193074511963827}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1338113, "num_steps_sampled": 1338113, "sample_time_ms": 17211.985, "grad_time_ms": 164.833, "update_time_ms": 11.323, "opt_peak_throughput": 66159.055, "sample_peak_throughput": 633.582, "opt_samples": 10905.2, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4305.32177734375, "policy_loss": -10.309465408325195, "vf_loss": 4315.630859375, "vf_explained_var": 0.07972639799118042, "kl": 0.008419201709330082, "entropy": 1.0842057466506958, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10908, "done": false, "timesteps_total": 1338113, "episodes_total": 3545, "training_iteration": 124, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-57-15", "timestamp": 1585335435, "time_this_iter_s": 18.43309736251831, "time_total_s": 2365.895797729492, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00274a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274b70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002740d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00274510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020fb70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2365.895797729492, "timesteps_since_restore": 1338113, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 33.65384615384616, "ram_util_percent": 86.66923076923075}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -57.0, "episode_len_mean": 312.18, "episodes_this_iter": 39, "policy_reward_mean": {"av": -27.536231884057973}, "custom_metrics": {"num_ped_collisions_mean": 0.24, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.123862774156383, "avg_speed_min": 2.2736717892946383, "avg_speed_max": 5.36971157551406, "avg_rl_veh_arrival_mean": 264.5683333333334, "avg_rl_veh_arrival_min": 94.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.093380914970604, "mean_processing_ms": 3.5266396483599003, "mean_inference_ms": 0.45045270481706223}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1348876, "num_steps_sampled": 1348876, "sample_time_ms": 17832.003, "grad_time_ms": 169.129, "update_time_ms": 11.714, "opt_peak_throughput": 64445.314, "sample_peak_throughput": 611.238, "opt_samples": 10899.6, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 5153.49755859375, "policy_loss": 4.226448059082031, "vf_loss": 5149.26953125, "vf_explained_var": 0.05558598041534424, "kl": 0.013605817221105099, "entropy": 1.2681801319122314, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10763, "done": false, "timesteps_total": 1348876, "episodes_total": 3584, "training_iteration": 125, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-57-36", "timestamp": 1585335456, "time_this_iter_s": 20.84501838684082, "time_total_s": 2386.740816116333, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fc80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fe18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0020f158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020f9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024fc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2386.740816116333, "timesteps_since_restore": 1348876, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 33.61333333333333, "ram_util_percent": 86.68333333333331}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -41.0, "episode_len_mean": 327.3, "episodes_this_iter": 29, "policy_reward_mean": {"av": -19.806763285024154}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.183476847276123, "avg_speed_min": 2.5474773741378542, "avg_speed_max": 5.214660580628228, "avg_rl_veh_arrival_mean": 253.9633333333333, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.084881865570325, "mean_processing_ms": 3.525037263070584, "mean_inference_ms": 0.449698947362595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1359739, "num_steps_sampled": 1359739, "sample_time_ms": 17589.895, "grad_time_ms": 172.402, "update_time_ms": 11.638, "opt_peak_throughput": 63100.881, "sample_peak_throughput": 618.463, "opt_samples": 10878.7, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2334.275146484375, "policy_loss": -17.212181091308594, "vf_loss": 2351.487548828125, "vf_explained_var": 0.08843868970870972, "kl": 0.009321868419647217, "entropy": 0.9745324850082397, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10863, "done": false, "timesteps_total": 1359739, "episodes_total": 3613, "training_iteration": 126, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-57-51", "timestamp": 1585335471, "time_this_iter_s": 15.22832989692688, "time_total_s": 2401.96914601326, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00274a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00274950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001569d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2401.96914601326, "timesteps_since_restore": 1359739, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 37.2409090909091, "ram_util_percent": 86.66818181818184}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -33.0, "episode_len_mean": 335.9, "episodes_this_iter": 27, "policy_reward_mean": {"av": -15.714285714285714}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.21, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2192907912000805, "avg_speed_min": 2.5474773741378542, "avg_speed_max": 5.23649756365508, "avg_rl_veh_arrival_mean": 244.0283333333333, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.082476740988303, "mean_processing_ms": 3.526697698032092, "mean_inference_ms": 0.4494043661631592}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1370338, "num_steps_sampled": 1370338, "sample_time_ms": 17468.791, "grad_time_ms": 167.098, "update_time_ms": 12.71, "opt_peak_throughput": 64718.319, "sample_peak_throughput": 619.064, "opt_samples": 10814.3, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3170.283203125, "policy_loss": -14.710326194763184, "vf_loss": 3184.992919921875, "vf_explained_var": 0.08158588409423828, "kl": 0.009011429734528065, "entropy": 1.0404348373413086, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10599, "done": false, "timesteps_total": 1370338, "episodes_total": 3640, "training_iteration": 127, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-58-06", "timestamp": 1585335486, "time_this_iter_s": 14.606542825698853, "time_total_s": 2416.5756888389587, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001566a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001567b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156620>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2416.5756888389587, "timesteps_since_restore": 1370338, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 38.05714285714286, "ram_util_percent": 86.67619047619048}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 11.5, "episode_len_mean": 379.39, "episodes_this_iter": 25, "policy_reward_mean": {"av": 5.324074074074074}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.320789660666726, "avg_speed_min": 2.447876074830031, "avg_speed_max": 5.251322149418319, "avg_rl_veh_arrival_mean": 221.95833333333337, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.076068113161948, "mean_processing_ms": 3.5266769813056174, "mean_inference_ms": 0.4480461238023544}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1381061, "num_steps_sampled": 1381061, "sample_time_ms": 17145.141, "grad_time_ms": 168.399, "update_time_ms": 12.75, "opt_peak_throughput": 64377.945, "sample_peak_throughput": 632.319, "opt_samples": 10841.2, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1477.7303466796875, "policy_loss": -23.865856170654297, "vf_loss": 1501.5966796875, "vf_explained_var": 0.1649293303489685, "kl": 0.014260279946029186, "entropy": 1.0121649503707886, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10723, "done": false, "timesteps_total": 1381061, "episodes_total": 3665, "training_iteration": 128, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-58-23", "timestamp": 1585335503, "time_this_iter_s": 16.36372447013855, "time_total_s": 2432.9394133090973, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001568c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002429d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002202f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2432.9394133090973, "timesteps_since_restore": 1381061, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.975, "ram_util_percent": 86.66666666666667}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 29.5, "episode_len_mean": 408.1, "episodes_this_iter": 25, "policy_reward_mean": {"av": 13.981042654028435}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4193946260443555, "avg_speed_min": 2.447876074830031, "avg_speed_max": 5.251322149418319, "avg_rl_veh_arrival_mean": 228.67, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.067541689046172, "mean_processing_ms": 3.52290653565169, "mean_inference_ms": 0.447482662526403}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1392003, "num_steps_sampled": 1392003, "sample_time_ms": 16635.693, "grad_time_ms": 164.898, "update_time_ms": 12.747, "opt_peak_throughput": 65876.977, "sample_peak_throughput": 652.994, "opt_samples": 10863.0, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1888.1749267578125, "policy_loss": -24.192365646362305, "vf_loss": 1912.367431640625, "vf_explained_var": 0.1061435341835022, "kl": 0.010295020416378975, "entropy": 0.8557190299034119, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10942, "done": false, "timesteps_total": 1392003, "episodes_total": 3690, "training_iteration": 129, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-58-38", "timestamp": 1585335518, "time_this_iter_s": 15.149994134902954, "time_total_s": 2448.0894074440002, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019ee18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019eb70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019e598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00241400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2448.0894074440002, "timesteps_since_restore": 1392003, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 39.53636363636364, "ram_util_percent": 86.6590909090909}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 27.5, "episode_len_mean": 413.36, "episodes_this_iter": 28, "policy_reward_mean": {"av": 13.285024154589372}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.373916974511235, "avg_speed_min": 2.447876074830031, "avg_speed_max": 5.251322149418319, "avg_rl_veh_arrival_mean": 233.66666666666669, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.062313020521175, "mean_processing_ms": 3.5211376281518305, "mean_inference_ms": 0.44677753888734345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1403187, "num_steps_sampled": 1403187, "sample_time_ms": 16815.225, "grad_time_ms": 167.468, "update_time_ms": 13.839, "opt_peak_throughput": 65312.832, "sample_peak_throughput": 650.47, "opt_samples": 10937.8, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 5400.87890625, "policy_loss": -7.802789688110352, "vf_loss": 5408.681640625, "vf_explained_var": 0.05548161268234253, "kl": 0.008954106830060482, "entropy": 0.9616103768348694, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11184, "done": false, "timesteps_total": 1403187, "episodes_total": 3718, "training_iteration": 130, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-58-55", "timestamp": 1585335535, "time_this_iter_s": 16.829030990600586, "time_total_s": 2464.918438434601, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001aed90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7ae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2464.918438434601, "timesteps_since_restore": 1403187, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 36.233333333333334, "ram_util_percent": 86.6083333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 11.5, "episode_len_mean": 391.82, "episodes_this_iter": 31, "policy_reward_mean": {"av": 5.665024630541872}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.262787312651119, "avg_speed_min": 2.447876074830031, "avg_speed_max": 5.251322149418319, "avg_rl_veh_arrival_mean": 239.68, "avg_rl_veh_arrival_min": 110.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.054075286054806, "mean_processing_ms": 3.514723519315811, "mean_inference_ms": 0.446066595951706}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1413476, "num_steps_sampled": 1413476, "sample_time_ms": 16727.825, "grad_time_ms": 171.588, "update_time_ms": 13.729, "opt_peak_throughput": 63336.582, "sample_peak_throughput": 649.684, "opt_samples": 10867.8, "learner": {"av": {"cur_kl_coeff": 1.1241008653725302e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3405.798828125, "policy_loss": -5.678731441497803, "vf_loss": 3411.47802734375, "vf_explained_var": 0.053375244140625, "kl": 0.021055324003100395, "entropy": 1.1158370971679688, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10289, "done": false, "timesteps_total": 1413476, "episodes_total": 3749, "training_iteration": 131, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-59-13", "timestamp": 1585335553, "time_this_iter_s": 17.41534447669983, "time_total_s": 2482.3337829113007, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002202f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220ea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020fa60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a7b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2482.3337829113007, "timesteps_since_restore": 1413476, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 35.668, "ram_util_percent": 86.71599999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.0, "episode_len_mean": 384.04, "episodes_this_iter": 28, "policy_reward_mean": {"av": 2.5641025641025643}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.261549637205403, "avg_speed_min": 2.7592822959483225, "avg_speed_max": 5.3097555972644095, "avg_rl_veh_arrival_mean": 233.275, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.049549575157116, "mean_processing_ms": 3.5134736073349275, "mean_inference_ms": 0.4455354310788284}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1424362, "num_steps_sampled": 1424362, "sample_time_ms": 16601.138, "grad_time_ms": 171.576, "update_time_ms": 13.801, "opt_peak_throughput": 63165.489, "sample_peak_throughput": 652.829, "opt_samples": 10837.7, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1703.2879638671875, "policy_loss": -21.58660888671875, "vf_loss": 1724.8740234375, "vf_explained_var": 0.0997229814529419, "kl": 0.014986502937972546, "entropy": 0.8583679795265198, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10886, "done": false, "timesteps_total": 1424362, "episodes_total": 3777, "training_iteration": 132, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-59-28", "timestamp": 1585335568, "time_this_iter_s": 15.670742273330688, "time_total_s": 2498.0045251846313, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156e18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001568c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156620>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001567b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150be18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2498.0045251846313, "timesteps_since_restore": 1424362, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 36.47826086956522, "ram_util_percent": 86.72173913043478}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -3.0, "episode_len_mean": 370.13, "episodes_this_iter": 29, "policy_reward_mean": {"av": -1.5075376884422111}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2461662991845195, "avg_speed_min": 2.7592822959483225, "avg_speed_max": 5.447979101962448, "avg_rl_veh_arrival_mean": 235.09000000000003, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.041786407265151, "mean_processing_ms": 3.5165640441167403, "mean_inference_ms": 0.44503086948536763}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1435531, "num_steps_sampled": 1435531, "sample_time_ms": 16625.018, "grad_time_ms": 168.149, "update_time_ms": 13.63, "opt_peak_throughput": 64422.518, "sample_peak_throughput": 651.584, "opt_samples": 10832.6, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4084.104736328125, "policy_loss": -9.19286060333252, "vf_loss": 4093.298828125, "vf_explained_var": 0.046437621116638184, "kl": 0.006095703691244125, "entropy": 0.8660494685173035, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11169, "done": false, "timesteps_total": 1435531, "episodes_total": 3806, "training_iteration": 133, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_11-59-46", "timestamp": 1585335586, "time_this_iter_s": 17.671836614608765, "time_total_s": 2515.67636179924, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d6c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2515.67636179924, "timesteps_since_restore": 1435531, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 34.588461538461544, "ram_util_percent": 86.7269230769231}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 3.5, "episode_len_mean": 375.79, "episodes_this_iter": 28, "policy_reward_mean": {"av": 1.794871794871795}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.275451575688291, "avg_speed_min": 2.6308553071555663, "avg_speed_max": 5.447979101962448, "avg_rl_veh_arrival_mean": 228.53833333333336, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.038131323693498, "mean_processing_ms": 3.5161898766948085, "mean_inference_ms": 0.4447730110076195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1446217, "num_steps_sampled": 1446217, "sample_time_ms": 16639.832, "grad_time_ms": 168.801, "update_time_ms": 13.376, "opt_peak_throughput": 64042.131, "sample_peak_throughput": 649.67, "opt_samples": 10810.4, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3218.773193359375, "policy_loss": -7.49669075012207, "vf_loss": 3226.26904296875, "vf_explained_var": 0.09078443050384521, "kl": 0.009693445637822151, "entropy": 0.9911877512931824, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10686, "done": false, "timesteps_total": 1446217, "episodes_total": 3834, "training_iteration": 134, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-00-05", "timestamp": 1585335605, "time_this_iter_s": 18.582245588302612, "time_total_s": 2534.2586073875427, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017b730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2534.2586073875427, "timesteps_since_restore": 1446217, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 36.49615384615385, "ram_util_percent": 86.80000000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -17.5, "episode_len_mean": 350.53, "episodes_this_iter": 38, "policy_reward_mean": {"av": -8.974358974358974}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.139818950489268, "avg_speed_min": 2.6308553071555663, "avg_speed_max": 5.447979101962448, "avg_rl_veh_arrival_mean": 236.12333333333336, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.027335730265448, "mean_processing_ms": 3.5188191327708602, "mean_inference_ms": 0.44342756378844145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1457028, "num_steps_sampled": 1457028, "sample_time_ms": 16552.645, "grad_time_ms": 166.69, "update_time_ms": 13.012, "opt_peak_throughput": 64882.11, "sample_peak_throughput": 653.382, "opt_samples": 10815.2, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4342.7236328125, "policy_loss": 5.396483421325684, "vf_loss": 4337.326171875, "vf_explained_var": 0.0846414566040039, "kl": 0.009672700427472591, "entropy": 1.220214605331421, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10811, "done": false, "timesteps_total": 1457028, "episodes_total": 3872, "training_iteration": 135, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-00-25", "timestamp": 1585335625, "time_this_iter_s": 19.93514847755432, "time_total_s": 2554.193755865097, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150be18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150bf28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150bc80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2554.193755865097, "timesteps_since_restore": 1457028, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 29.74137931034483, "ram_util_percent": 86.72068965517241}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -9.0, "episode_len_mean": 368.05, "episodes_this_iter": 23, "policy_reward_mean": {"av": -4.787234042553192}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.142830313566171, "avg_speed_min": 2.6308553071555663, "avg_speed_max": 5.447979101962448, "avg_rl_veh_arrival_mean": 237.33333333333331, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.024685080655471, "mean_processing_ms": 3.5153393460144513, "mean_inference_ms": 0.4430460923852739}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1468053, "num_steps_sampled": 1468053, "sample_time_ms": 16387.753, "grad_time_ms": 166.114, "update_time_ms": 13.052, "opt_peak_throughput": 65204.779, "sample_peak_throughput": 660.945, "opt_samples": 10831.4, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1661.3056640625, "policy_loss": -24.06789207458496, "vf_loss": 1685.37353515625, "vf_explained_var": 0.10154950618743896, "kl": 0.005935907829552889, "entropy": 0.8542968034744263, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11025, "done": false, "timesteps_total": 1468053, "episodes_total": 3895, "training_iteration": 136, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-00-39", "timestamp": 1585335639, "time_this_iter_s": 13.579607009887695, "time_total_s": 2567.7733628749847, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2567.7733628749847, "timesteps_since_restore": 1468053, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 39.07, "ram_util_percent": 86.80999999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -15.5, "episode_len_mean": 360.96, "episodes_this_iter": 27, "policy_reward_mean": {"av": -7.948717948717949}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.132883111618827, "avg_speed_min": 2.6929786575728576, "avg_speed_max": 5.239125330872389, "avg_rl_veh_arrival_mean": 244.10333333333332, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.017578860238953, "mean_processing_ms": 3.5149318009713757, "mean_inference_ms": 0.442531911448095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1478723, "num_steps_sampled": 1478723, "sample_time_ms": 16433.521, "grad_time_ms": 160.766, "update_time_ms": 12.96, "opt_peak_throughput": 67417.89, "sample_peak_throughput": 659.536, "opt_samples": 10838.5, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3228.684326171875, "policy_loss": -12.980412483215332, "vf_loss": 3241.666748046875, "vf_explained_var": 0.05676752328872681, "kl": 0.00653347373008728, "entropy": 0.860834538936615, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10670, "done": false, "timesteps_total": 1478723, "episodes_total": 3922, "training_iteration": 137, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-00-54", "timestamp": 1585335654, "time_this_iter_s": 15.009822845458984, "time_total_s": 2582.7831857204437, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ae0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002207b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002202f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017b8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2582.7831857204437, "timesteps_since_restore": 1478723, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 35.266666666666666, "ram_util_percent": 86.77619047619048}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -12.0, "episode_len_mean": 382.12, "episodes_this_iter": 31, "policy_reward_mean": {"av": -6.315789473684211}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.216119778467165, "avg_speed_min": 2.7183530066712454, "avg_speed_max": 5.239125330872389, "avg_rl_veh_arrival_mean": 256.69166666666666, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 5.008622946344528, "mean_processing_ms": 3.5144519634974434, "mean_inference_ms": 0.44118850566802736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1489641, "num_steps_sampled": 1489641, "sample_time_ms": 16425.171, "grad_time_ms": 156.98, "update_time_ms": 13.026, "opt_peak_throughput": 69167.915, "sample_peak_throughput": 661.059, "opt_samples": 10858.0, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 5297.81982421875, "policy_loss": -2.1783206462860107, "vf_loss": 5299.99853515625, "vf_explained_var": 0.053975701332092285, "kl": 0.009071999229490757, "entropy": 1.0563369989395142, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10918, "done": false, "timesteps_total": 1489641, "episodes_total": 3953, "training_iteration": 138, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-01-11", "timestamp": 1585335671, "time_this_iter_s": 16.25213122367859, "time_total_s": 2599.0353169441223, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2599.0353169441223, "timesteps_since_restore": 1489641, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 33.958333333333336, "ram_util_percent": 86.8125}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -10.0, "episode_len_mean": 382.86, "episodes_this_iter": 30, "policy_reward_mean": {"av": -4.901960784313726}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2575421597001615, "avg_speed_min": 2.7183530066712454, "avg_speed_max": 5.382094582220214, "avg_rl_veh_arrival_mean": 255.66999999999996, "avg_rl_veh_arrival_min": 115.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.999108030950657, "mean_processing_ms": 3.5121927029810127, "mean_inference_ms": 0.44036389278773613}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1500320, "num_steps_sampled": 1500320, "sample_time_ms": 16618.756, "grad_time_ms": 157.21, "update_time_ms": 13.211, "opt_peak_throughput": 68899.711, "sample_peak_throughput": 651.776, "opt_samples": 10831.7, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2691.494873046875, "policy_loss": -14.543611526489258, "vf_loss": 2706.037353515625, "vf_explained_var": 0.045640408992767334, "kl": 0.007929886691272259, "entropy": 0.9218627214431763, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10679, "done": false, "timesteps_total": 1500320, "episodes_total": 3983, "training_iteration": 139, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-01-28", "timestamp": 1585335688, "time_this_iter_s": 17.088682174682617, "time_total_s": 2616.123999118805, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150be18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150bc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150bf28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b2f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017ba60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2616.123999118805, "timesteps_since_restore": 1500320, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 32.928000000000004, "ram_util_percent": 86.85199999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -32.5, "episode_len_mean": 352.17, "episodes_this_iter": 31, "policy_reward_mean": {"av": -15.258215962441314}, "custom_metrics": {"num_ped_collisions_mean": 0.21, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.229100117643135, "avg_speed_min": 2.7394056813438263, "avg_speed_max": 5.552291156645174, "avg_rl_veh_arrival_mean": 264.20166666666665, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.98932913119945, "mean_processing_ms": 3.5130333930587843, "mean_inference_ms": 0.4393188701118465}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1511211, "num_steps_sampled": 1511211, "sample_time_ms": 16908.063, "grad_time_ms": 159.065, "update_time_ms": 12.139, "opt_peak_throughput": 67911.846, "sample_peak_throughput": 638.89, "opt_samples": 10802.4, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4709.859375, "policy_loss": -7.903923988342285, "vf_loss": 4717.7607421875, "vf_explained_var": 0.06809037923812866, "kl": 0.013646803796291351, "entropy": 0.8772447109222412, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10891, "done": false, "timesteps_total": 1511211, "episodes_total": 4014, "training_iteration": 140, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-01-48", "timestamp": 1585335708, "time_this_iter_s": 19.73499608039856, "time_total_s": 2635.8589951992035, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017bd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017bc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017bd90>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0017be18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00180510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2635.8589951992035, "timesteps_since_restore": 1511211, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 30.896428571428572, "ram_util_percent": 86.87857142857146}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -19.0, "episode_len_mean": 359.95, "episodes_this_iter": 31, "policy_reward_mean": {"av": -8.715596330275229}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.254412393309545, "avg_speed_min": 2.6957566707757943, "avg_speed_max": 5.552291156645174, "avg_rl_veh_arrival_mean": 254.605, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.980272985787298, "mean_processing_ms": 3.512489289298513, "mean_inference_ms": 0.4383464763460806}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1521806, "num_steps_sampled": 1521806, "sample_time_ms": 17003.969, "grad_time_ms": 158.289, "update_time_ms": 12.169, "opt_peak_throughput": 68438.098, "sample_peak_throughput": 637.087, "opt_samples": 10833.0, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3817.923095703125, "policy_loss": -2.5814270973205566, "vf_loss": 3820.504150390625, "vf_explained_var": 0.06531286239624023, "kl": 0.007842427119612694, "entropy": 0.9653109908103943, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10595, "done": false, "timesteps_total": 1521806, "episodes_total": 4045, "training_iteration": 141, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-02-07", "timestamp": 1585335727, "time_this_iter_s": 18.365175247192383, "time_total_s": 2654.224170446396, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017bae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017bb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017b7b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0017b840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2654.224170446396, "timesteps_since_restore": 1521806, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 31.76666666666667, "ram_util_percent": 86.85185185185189}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -26.5, "episode_len_mean": 356.62, "episodes_this_iter": 29, "policy_reward_mean": {"av": -12.325581395348838}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.229405560332091, "avg_speed_min": 1.8262437813192585, "avg_speed_max": 5.552291156645174, "avg_rl_veh_arrival_mean": 249.10500000000005, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.974793584621609, "mean_processing_ms": 3.513796192839811, "mean_inference_ms": 0.4380341627120561}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1532799, "num_steps_sampled": 1532799, "sample_time_ms": 17048.03, "grad_time_ms": 153.302, "update_time_ms": 11.912, "opt_peak_throughput": 70734.247, "sample_peak_throughput": 636.068, "opt_samples": 10843.7, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3521.06494140625, "policy_loss": -10.484335899353027, "vf_loss": 3531.549560546875, "vf_explained_var": 0.09081971645355225, "kl": 0.015517200343310833, "entropy": 1.025260329246521, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10993, "done": false, "timesteps_total": 1532799, "episodes_total": 4074, "training_iteration": 142, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-02-23", "timestamp": 1585335743, "time_this_iter_s": 16.044153213500977, "time_total_s": 2670.268323659897, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d6e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d6510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2670.268323659897, "timesteps_since_restore": 1532799, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 35.27391304347827, "ram_util_percent": 86.81304347826087}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -22.5, "episode_len_mean": 366.44, "episodes_this_iter": 27, "policy_reward_mean": {"av": -10.76555023923445}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.296279847022284, "avg_speed_min": 1.8262437813192585, "avg_speed_max": 5.6910495794321445, "avg_rl_veh_arrival_mean": 255.13333333333335, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.969764584091069, "mean_processing_ms": 3.513226485771497, "mean_inference_ms": 0.4375856081911172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1544165, "num_steps_sampled": 1544165, "sample_time_ms": 16851.149, "grad_time_ms": 155.774, "update_time_ms": 11.197, "opt_peak_throughput": 69738.062, "sample_peak_throughput": 644.668, "opt_samples": 10863.4, "learner": {"av": {"cur_kl_coeff": 1.6861511657098973e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2846.1435546875, "policy_loss": -24.93136215209961, "vf_loss": 2871.074462890625, "vf_explained_var": 0.04613298177719116, "kl": 0.022142214700579643, "entropy": 0.6746434569358826, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11366, "done": false, "timesteps_total": 1544165, "episodes_total": 4101, "training_iteration": 143, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-02-39", "timestamp": 1585335759, "time_this_iter_s": 15.707894802093506, "time_total_s": 2685.9762184619904, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b1e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150ba60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2685.9762184619904, "timesteps_since_restore": 1544165, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 34.74545454545455, "ram_util_percent": 86.82727272727273}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.5, "episode_len_mean": 386.05, "episodes_this_iter": 26, "policy_reward_mean": {"av": -1.6666666666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.381709103989933, "avg_speed_min": 1.8262437813192585, "avg_speed_max": 5.6910495794321445, "avg_rl_veh_arrival_mean": 248.18, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.961796030610856, "mean_processing_ms": 3.508851270826311, "mean_inference_ms": 0.4364656109458193}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1554967, "num_steps_sampled": 1554967, "sample_time_ms": 16437.461, "grad_time_ms": 158.164, "update_time_ms": 11.179, "opt_peak_throughput": 68757.548, "sample_peak_throughput": 661.599, "opt_samples": 10875.0, "learner": {"av": {"cur_kl_coeff": 2.529226880913744e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2275.780029296875, "policy_loss": -18.31437873840332, "vf_loss": 2294.0947265625, "vf_explained_var": 0.07635152339935303, "kl": 0.008576080203056335, "entropy": 0.823743999004364, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10802, "done": false, "timesteps_total": 1554967, "episodes_total": 4127, "training_iteration": 144, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-02-54", "timestamp": 1585335774, "time_this_iter_s": 14.47469687461853, "time_total_s": 2700.450915336609, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7268>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001569d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2700.450915336609, "timesteps_since_restore": 1554967, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 36.97142857142857, "ram_util_percent": 86.79999999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.5, "episode_len_mean": 392.68, "episodes_this_iter": 27, "policy_reward_mean": {"av": 1.2315270935960592}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4404734278168725, "avg_speed_min": 1.8262437813192585, "avg_speed_max": 5.6910495794321445, "avg_rl_veh_arrival_mean": 253.26, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.953887062899669, "mean_processing_ms": 3.5073033554471493, "mean_inference_ms": 0.4356614985366754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1565172, "num_steps_sampled": 1565172, "sample_time_ms": 16022.93, "grad_time_ms": 159.361, "update_time_ms": 10.75, "opt_peak_throughput": 67860.866, "sample_peak_throughput": 674.933, "opt_samples": 10814.4, "learner": {"av": {"cur_kl_coeff": 2.529226880913744e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2641.99658203125, "policy_loss": -14.172078132629395, "vf_loss": 2656.16796875, "vf_explained_var": 0.056757569313049316, "kl": 0.008422482758760452, "entropy": 0.6589663028717041, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10205, "done": false, "timesteps_total": 1565172, "episodes_total": 4154, "training_iteration": 145, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-03-10", "timestamp": 1585335790, "time_this_iter_s": 15.796818494796753, "time_total_s": 2716.2477338314056, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b0d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d69d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2716.2477338314056, "timesteps_since_restore": 1565172, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 31.49999999999999, "ram_util_percent": 86.82608695652173}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 19.5, "episode_len_mean": 407.58, "episodes_this_iter": 28, "policy_reward_mean": {"av": 9.653465346534654}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.513141955316604, "avg_speed_min": 2.3348508053526533, "avg_speed_max": 5.6910495794321445, "avg_rl_veh_arrival_mean": 253.19833333333335, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.946295323891522, "mean_processing_ms": 3.505401458242244, "mean_inference_ms": 0.4346871484684632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1576462, "num_steps_sampled": 1576462, "sample_time_ms": 16221.314, "grad_time_ms": 158.244, "update_time_ms": 10.531, "opt_peak_throughput": 68507.613, "sample_peak_throughput": 668.312, "opt_samples": 10840.9, "learner": {"av": {"cur_kl_coeff": 2.529226880913744e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2789.851318359375, "policy_loss": -19.841041564941406, "vf_loss": 2809.69189453125, "vf_explained_var": 0.07250702381134033, "kl": 0.02593819610774517, "entropy": 0.7545485496520996, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11290, "done": false, "timesteps_total": 1576462, "episodes_total": 4182, "training_iteration": 146, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-03-25", "timestamp": 1585335805, "time_this_iter_s": 15.543395280838013, "time_total_s": 2731.7911291122437, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fd08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fe18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017bd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2731.7911291122437, "timesteps_since_restore": 1576462, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 35.173913043478265, "ram_util_percent": 86.78260869565216}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 16.0, "episode_len_mean": 392.46, "episodes_this_iter": 29, "policy_reward_mean": {"av": 7.8431372549019605}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.450132469943314, "avg_speed_min": 2.3348508053526533, "avg_speed_max": 5.444197176595741, "avg_rl_veh_arrival_mean": 241.35166666666663, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.937696469039857, "mean_processing_ms": 3.5030742442301785, "mean_inference_ms": 0.43371174591092293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1587330, "num_steps_sampled": 1587330, "sample_time_ms": 16471.852, "grad_time_ms": 165.202, "update_time_ms": 10.443, "opt_peak_throughput": 65741.77, "sample_peak_throughput": 659.349, "opt_samples": 10860.7, "learner": {"av": {"cur_kl_coeff": 3.793840189021718e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2387.5595703125, "policy_loss": -11.144305229187012, "vf_loss": 2398.705078125, "vf_explained_var": 0.10203921794891357, "kl": 0.01025752816349268, "entropy": 0.7468441724777222, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10868, "done": false, "timesteps_total": 1587330, "episodes_total": 4211, "training_iteration": 147, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-03-43", "timestamp": 1585335823, "time_this_iter_s": 17.59257936477661, "time_total_s": 2749.3837084770203, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017be18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017b6a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0017b620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2749.3837084770203, "timesteps_since_restore": 1587330, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 33.564, "ram_util_percent": 86.80400000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.0, "episode_len_mean": 383.27, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.970873786407767}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.443403426450351, "avg_speed_min": 2.6756899056451844, "avg_speed_max": 5.444197176595741, "avg_rl_veh_arrival_mean": 254.4766666666667, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.931084001450315, "mean_processing_ms": 3.5012035442519926, "mean_inference_ms": 0.4330103774345124}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1597984, "num_steps_sampled": 1597984, "sample_time_ms": 16439.86, "grad_time_ms": 161.231, "update_time_ms": 10.119, "opt_peak_throughput": 67197.308, "sample_peak_throughput": 659.026, "opt_samples": 10834.3, "learner": {"av": {"cur_kl_coeff": 3.793840189021718e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2845.94287109375, "policy_loss": -14.821659088134766, "vf_loss": 2860.763427734375, "vf_explained_var": 0.07052212953567505, "kl": 0.006258765701204538, "entropy": 0.7010876536369324, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10654, "done": false, "timesteps_total": 1597984, "episodes_total": 4240, "training_iteration": 148, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-03-59", "timestamp": 1585335839, "time_this_iter_s": 15.877238988876343, "time_total_s": 2765.2609474658966, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fd90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d69d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d6950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2765.2609474658966, "timesteps_since_restore": 1597984, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 33.47826086956522, "ram_util_percent": 86.78695652173911}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -1.5, "episode_len_mean": 379.62, "episodes_this_iter": 28, "policy_reward_mean": {"av": -0.7317073170731707}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.450342269487871, "avg_speed_min": 2.7364798244435207, "avg_speed_max": 5.549781153175541, "avg_rl_veh_arrival_mean": 247.36333333333334, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.92210809670782, "mean_processing_ms": 3.4997709145680314, "mean_inference_ms": 0.4320884888046856}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1609106, "num_steps_sampled": 1609106, "sample_time_ms": 16201.168, "grad_time_ms": 157.485, "update_time_ms": 10.013, "opt_peak_throughput": 69077.219, "sample_peak_throughput": 671.47, "opt_samples": 10878.6, "learner": {"av": {"cur_kl_coeff": 3.793840189021718e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4213.43994140625, "policy_loss": -13.134521484375, "vf_loss": 4226.5751953125, "vf_explained_var": 0.06741929054260254, "kl": 0.009674995206296444, "entropy": 0.7693811058998108, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11122, "done": false, "timesteps_total": 1609106, "episodes_total": 4268, "training_iteration": 149, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-04-14", "timestamp": 1585335854, "time_this_iter_s": 14.662675142288208, "time_total_s": 2779.923622608185, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150ba60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2779.923622608185, "timesteps_since_restore": 1609106, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 35.87619047619048, "ram_util_percent": 86.76666666666668}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -4.0, "episode_len_mean": 381.23, "episodes_this_iter": 28, "policy_reward_mean": {"av": -2.030456852791878}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.338793320272517, "avg_speed_min": 2.554659017169245, "avg_speed_max": 5.549781153175541, "avg_rl_veh_arrival_mean": 247.93500000000003, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.915144519927512, "mean_processing_ms": 3.498818538406162, "mean_inference_ms": 0.4314487272630189}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1619749, "num_steps_sampled": 1619749, "sample_time_ms": 15768.683, "grad_time_ms": 152.169, "update_time_ms": 10.768, "opt_peak_throughput": 71327.358, "sample_peak_throughput": 688.314, "opt_samples": 10853.8, "learner": {"av": {"cur_kl_coeff": 3.793840189021718e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 5172.55126953125, "policy_loss": -2.671377182006836, "vf_loss": 5175.220703125, "vf_explained_var": 0.059827327728271484, "kl": 0.029655635356903076, "entropy": 0.8990294933319092, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10643, "done": false, "timesteps_total": 1619749, "episodes_total": 4296, "training_iteration": 150, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-04-30", "timestamp": 1585335870, "time_this_iter_s": 15.369362592697144, "time_total_s": 2795.292985200882, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0024ff28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0024fae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0024f488>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024f620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2795.292985200882, "timesteps_since_restore": 1619749, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 35.04782608695651, "ram_util_percent": 86.80434782608695}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -2.0, "episode_len_mean": 384.29, "episodes_this_iter": 28, "policy_reward_mean": {"av": -1.015228426395939}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.290177690251491, "avg_speed_min": 2.554659017169245, "avg_speed_max": 5.549781153175541, "avg_rl_veh_arrival_mean": 247.24333333333337, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.907421405651416, "mean_processing_ms": 3.4993157631328287, "mean_inference_ms": 0.4305671757144983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1630506, "num_steps_sampled": 1630506, "sample_time_ms": 15676.907, "grad_time_ms": 152.005, "update_time_ms": 10.852, "opt_peak_throughput": 71510.635, "sample_peak_throughput": 693.377, "opt_samples": 10870.0, "learner": {"av": {"cur_kl_coeff": 5.690760151183679e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3577.736572265625, "policy_loss": -10.393129348754883, "vf_loss": 3588.12890625, "vf_explained_var": 0.06320971250534058, "kl": 0.005153553560376167, "entropy": 0.8107075095176697, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10757, "done": false, "timesteps_total": 1630506, "episodes_total": 4324, "training_iteration": 151, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-04-48", "timestamp": 1585335888, "time_this_iter_s": 17.44657874107361, "time_total_s": 2812.7395639419556, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150ba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d6950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2812.7395639419556, "timesteps_since_restore": 1630506, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 34.36, "ram_util_percent": 86.896}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.0, "episode_len_mean": 376.91, "episodes_this_iter": 27, "policy_reward_mean": {"av": -1.5384615384615385}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2453246824378255, "avg_speed_min": 1.9291120311881405, "avg_speed_max": 5.549781153175541, "avg_rl_veh_arrival_mean": 236.03166666666664, "avg_rl_veh_arrival_min": 87.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.899139109981075, "mean_processing_ms": 3.4980177832073083, "mean_inference_ms": 0.4300319675483108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1641029, "num_steps_sampled": 1641029, "sample_time_ms": 15658.758, "grad_time_ms": 154.58, "update_time_ms": 11.122, "opt_peak_throughput": 70015.603, "sample_peak_throughput": 691.179, "opt_samples": 10823.0, "learner": {"av": {"cur_kl_coeff": 5.690760151183679e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 1974.349609375, "policy_loss": -9.602825164794922, "vf_loss": 1983.9532470703125, "vf_explained_var": 0.14304137229919434, "kl": 0.015647368505597115, "entropy": 0.8336242437362671, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10523, "done": false, "timesteps_total": 1641029, "episodes_total": 4351, "training_iteration": 152, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-05-04", "timestamp": 1585335904, "time_this_iter_s": 15.904276847839355, "time_total_s": 2828.643840789795, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fd08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159ff28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159fe18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019ef28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2828.643840789795, "timesteps_since_restore": 1641029, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 33.017391304347825, "ram_util_percent": 86.88260869565218}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -16.5, "episode_len_mean": 360.46, "episodes_this_iter": 34, "policy_reward_mean": {"av": -8.12807881773399}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.181502415172921, "avg_speed_min": 1.9291120311881405, "avg_speed_max": 5.392807471563643, "avg_rl_veh_arrival_mean": 246.0066666666667, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.892202368981312, "mean_processing_ms": 3.498384550539894, "mean_inference_ms": 0.42967634874561045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1651799, "num_steps_sampled": 1651799, "sample_time_ms": 15912.152, "grad_time_ms": 153.267, "update_time_ms": 12.036, "opt_peak_throughput": 70226.521, "sample_peak_throughput": 676.426, "opt_samples": 10763.4, "learner": {"av": {"cur_kl_coeff": 5.690760151183679e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4668.33251953125, "policy_loss": -3.295462131500244, "vf_loss": 4671.62841796875, "vf_explained_var": 0.07868015766143799, "kl": 0.016127534210681915, "entropy": 0.8976302742958069, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10770, "done": false, "timesteps_total": 1651799, "episodes_total": 4385, "training_iteration": 153, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-05-22", "timestamp": 1585335922, "time_this_iter_s": 18.253000259399414, "time_total_s": 2846.8968410491943, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019e9d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00241400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002418c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2846.8968410491943, "timesteps_since_restore": 1651799, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 31.02692307692308, "ram_util_percent": 86.86923076923078}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -33.5, "episode_len_mean": 347.72, "episodes_this_iter": 32, "policy_reward_mean": {"av": -16.42156862745098}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.188033410068179, "avg_speed_min": 1.9291120311881405, "avg_speed_max": 5.392807471563643, "avg_rl_veh_arrival_mean": 249.43, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.883029043253057, "mean_processing_ms": 3.500592119999204, "mean_inference_ms": 0.42860115403955296}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1662874, "num_steps_sampled": 1662874, "sample_time_ms": 16329.817, "grad_time_ms": 154.067, "update_time_ms": 12.075, "opt_peak_throughput": 70038.959, "sample_peak_throughput": 660.797, "opt_samples": 10790.7, "learner": {"av": {"cur_kl_coeff": 5.690760151183679e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 4727.72265625, "policy_loss": -1.9117465019226074, "vf_loss": 4729.6337890625, "vf_explained_var": 0.07943111658096313, "kl": 0.011595942080020905, "entropy": 0.9346128702163696, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11075, "done": false, "timesteps_total": 1662874, "episodes_total": 4417, "training_iteration": 154, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-05-41", "timestamp": 1585335941, "time_this_iter_s": 18.65495014190674, "time_total_s": 2865.551791191101, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fd90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d6d90>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d6488>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2865.551791191101, "timesteps_since_restore": 1662874, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 34.762962962962966, "ram_util_percent": 86.87407407407409}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -23.0, "episode_len_mean": 355.94, "episodes_this_iter": 27, "policy_reward_mean": {"av": -11.004784688995215}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.228849487043067, "avg_speed_min": 1.9291120311881405, "avg_speed_max": 5.392807471563643, "avg_rl_veh_arrival_mean": 252.90833333333333, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.880003488195538, "mean_processing_ms": 3.4995396984764295, "mean_inference_ms": 0.4283262646180041}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1673705, "num_steps_sampled": 1673705, "sample_time_ms": 16270.129, "grad_time_ms": 152.816, "update_time_ms": 12.619, "opt_peak_throughput": 71021.987, "sample_peak_throughput": 667.069, "opt_samples": 10853.3, "learner": {"av": {"cur_kl_coeff": 5.690760151183679e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 2502.43359375, "policy_loss": -16.860231399536133, "vf_loss": 2519.293212890625, "vf_explained_var": 0.09361773729324341, "kl": 0.022173544391989708, "entropy": 0.7358840703964233, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10831, "done": false, "timesteps_total": 1673705, "episodes_total": 4444, "training_iteration": 155, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-05-56", "timestamp": 1585335956, "time_this_iter_s": 15.192497253417969, "time_total_s": 2880.744288444519, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b1e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b730>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b0d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2880.744288444519, "timesteps_since_restore": 1673705, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 36.85909090909091, "ram_util_percent": 86.85454545454547}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -18.5, "episode_len_mean": 367.14, "episodes_this_iter": 30, "policy_reward_mean": {"av": -9.438775510204081}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.320556973633315, "avg_speed_min": 2.0628063287495597, "avg_speed_max": 5.528222351833853, "avg_rl_veh_arrival_mean": 256.65, "avg_rl_veh_arrival_min": 94.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.876444674488675, "mean_processing_ms": 3.4980463953204963, "mean_inference_ms": 0.4279915426354997}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1684558, "num_steps_sampled": 1684558, "sample_time_ms": 16435.462, "grad_time_ms": 148.569, "update_time_ms": 12.746, "opt_peak_throughput": 72758.177, "sample_peak_throughput": 657.7, "opt_samples": 10809.6, "learner": {"av": {"cur_kl_coeff": 8.53614075617111e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3606.509521484375, "policy_loss": -13.75599479675293, "vf_loss": 3620.266357421875, "vf_explained_var": 0.07927119731903076, "kl": 0.013117569498717785, "entropy": 0.783393383026123, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10853, "done": false, "timesteps_total": 1684558, "episodes_total": 4474, "training_iteration": 156, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-06-14", "timestamp": 1585335974, "time_this_iter_s": 17.15410614013672, "time_total_s": 2897.8983945846558, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e9840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e91e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2897.8983945846558, "timesteps_since_restore": 1684558, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 34.204, "ram_util_percent": 86.86800000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.5, "episode_len_mean": 363.29, "episodes_this_iter": 34, "policy_reward_mean": {"av": -4.5212765957446805}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.339483729524272, "avg_speed_min": 2.0628063287495597, "avg_speed_max": 5.528222351833853, "avg_rl_veh_arrival_mean": 235.79666666666665, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.871719577215121, "mean_processing_ms": 3.4958167193791816, "mean_inference_ms": 0.4276764449362392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1695355, "num_steps_sampled": 1695355, "sample_time_ms": 16467.499, "grad_time_ms": 147.395, "update_time_ms": 11.82, "opt_peak_throughput": 73289.287, "sample_peak_throughput": 655.989, "opt_samples": 10802.5, "learner": {"av": {"cur_kl_coeff": 8.53614075617111e-16, "cur_lr": 9.999999747378752e-05, "total_loss": 3222.718505859375, "policy_loss": -0.90729820728302, "vf_loss": 3223.625244140625, "vf_explained_var": 0.10077857971191406, "kl": 0.023276589810848236, "entropy": 0.8423541784286499, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10797, "done": false, "timesteps_total": 1695355, "episodes_total": 4508, "training_iteration": 157, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-06-32", "timestamp": 1585335992, "time_this_iter_s": 17.894108057022095, "time_total_s": 2915.792502641678, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150ba60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c002418c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d6950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2915.792502641678, "timesteps_since_restore": 1695355, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 31.969230769230776, "ram_util_percent": 86.92692307692307}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -16.5, "episode_len_mean": 354.48, "episodes_this_iter": 26, "policy_reward_mean": {"av": -9.166666666666666}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.303870686584567, "avg_speed_min": 2.0628063287495597, "avg_speed_max": 5.528222351833853, "avg_rl_veh_arrival_mean": 232.765, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.867115245857398, "mean_processing_ms": 3.496062272268824, "mean_inference_ms": 0.42735636733225485}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1705883, "num_steps_sampled": 1705883, "sample_time_ms": 16547.362, "grad_time_ms": 146.25, "update_time_ms": 11.164, "opt_peak_throughput": 73776.849, "sample_peak_throughput": 652.062, "opt_samples": 10789.9, "learner": {"av": {"cur_kl_coeff": 1.2804210604861073e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2525.4482421875, "policy_loss": -13.380404472351074, "vf_loss": 2538.82763671875, "vf_explained_var": 0.11942130327224731, "kl": 0.025672102347016335, "entropy": 0.7663775086402893, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10528, "done": false, "timesteps_total": 1705883, "episodes_total": 4534, "training_iteration": 158, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-06-49", "timestamp": 1585336009, "time_this_iter_s": 16.65817618370056, "time_total_s": 2932.4506788253784, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159ff28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159fe18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027bd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2932.4506788253784, "timesteps_since_restore": 1705883, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 45.44583333333333, "ram_util_percent": 87.79583333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.5, "episode_len_mean": 373.24, "episodes_this_iter": 28, "policy_reward_mean": {"av": -1.9125683060109289}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.358498864041463, "avg_speed_min": 2.917875117808012, "avg_speed_max": 5.5035348935369495, "avg_rl_veh_arrival_mean": 236.79666666666665, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.863191954523587, "mean_processing_ms": 3.496628778031188, "mean_inference_ms": 0.4267911912893965}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1717101, "num_steps_sampled": 1717101, "sample_time_ms": 16672.206, "grad_time_ms": 147.897, "update_time_ms": 11.256, "opt_peak_throughput": 73020.516, "sample_peak_throughput": 647.755, "opt_samples": 10799.5, "learner": {"av": {"cur_kl_coeff": 1.920631537789602e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3314.890625, "policy_loss": -21.753583908081055, "vf_loss": 3336.642822265625, "vf_explained_var": 0.06694978475570679, "kl": 0.012558482587337494, "entropy": 0.5682191252708435, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11218, "done": false, "timesteps_total": 1717101, "episodes_total": 4562, "training_iteration": 159, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-07-05", "timestamp": 1585336025, "time_this_iter_s": 15.933082103729248, "time_total_s": 2948.3837609291077, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b620>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bf28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027bc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2948.3837609291077, "timesteps_since_restore": 1717101, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 37.51739130434783, "ram_util_percent": 88.0608695652174}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.0, "episode_len_mean": 376.38, "episodes_this_iter": 27, "policy_reward_mean": {"av": -1.6304347826086956}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.271390439409587, "avg_speed_min": 2.653803595006809, "avg_speed_max": 5.495205705045458, "avg_rl_veh_arrival_mean": 240.54, "avg_rl_veh_arrival_min": 71.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.8562588747436095, "mean_processing_ms": 3.497105792620763, "mean_inference_ms": 0.42614921463180366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1727686, "num_steps_sampled": 1727686, "sample_time_ms": 16775.174, "grad_time_ms": 146.007, "update_time_ms": 10.444, "opt_peak_throughput": 73926.13, "sample_peak_throughput": 643.433, "opt_samples": 10793.7, "learner": {"av": {"cur_kl_coeff": 1.920631537789602e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2209.066650390625, "policy_loss": -10.66152286529541, "vf_loss": 2219.727783203125, "vf_explained_var": 0.14177387952804565, "kl": 0.008855549618601799, "entropy": 0.945076584815979, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10585, "done": false, "timesteps_total": 1727686, "episodes_total": 4589, "training_iteration": 160, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-07-22", "timestamp": 1585336042, "time_this_iter_s": 16.36107349395752, "time_total_s": 2964.744834423065, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00212c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00a93c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ae400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2964.744834423065, "timesteps_since_restore": 1727686, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 32.36666666666667, "ram_util_percent": 87.825}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 18.0, "episode_len_mean": 400.72, "episodes_this_iter": 26, "policy_reward_mean": {"av": 9.72972972972973}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.332734883172062, "avg_speed_min": 2.653803595006809, "avg_speed_max": 5.495205705045458, "avg_rl_veh_arrival_mean": 235.62, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.850129473816298, "mean_processing_ms": 3.49506116528371, "mean_inference_ms": 0.4255463448496036}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1738632, "num_steps_sampled": 1738632, "sample_time_ms": 16402.31, "grad_time_ms": 139.905, "update_time_ms": 10.467, "opt_peak_throughput": 77285.288, "sample_peak_throughput": 659.212, "opt_samples": 10812.6, "learner": {"av": {"cur_kl_coeff": 1.920631537789602e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1820.799072265625, "policy_loss": -24.635644912719727, "vf_loss": 1845.4344482421875, "vf_explained_var": 0.08533680438995361, "kl": 0.020985230803489685, "entropy": 0.49580127000808716, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10946, "done": false, "timesteps_total": 1738632, "episodes_total": 4615, "training_iteration": 161, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-07-36", "timestamp": 1585336056, "time_this_iter_s": 13.65838623046875, "time_total_s": 2978.403220653534, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027bea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2978.403220653534, "timesteps_since_restore": 1738632, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 40.373684210526314, "ram_util_percent": 87.82105263157895}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 35.5, "episode_len_mean": 419.72, "episodes_this_iter": 25, "policy_reward_mean": {"av": 18.489583333333332}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.353196768859381, "avg_speed_min": 2.653803595006809, "avg_speed_max": 5.495205705045458, "avg_rl_veh_arrival_mean": 230.47333333333336, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.84322308076052, "mean_processing_ms": 3.494769163992996, "mean_inference_ms": 0.4249539714796484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1749650, "num_steps_sampled": 1749650, "sample_time_ms": 16229.173, "grad_time_ms": 135.559, "update_time_ms": 10.584, "opt_peak_throughput": 80127.922, "sample_peak_throughput": 669.295, "opt_samples": 10862.1, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1183.4593505859375, "policy_loss": -22.4710636138916, "vf_loss": 1205.9302978515625, "vf_explained_var": 0.16345351934432983, "kl": 0.012317503802478313, "entropy": 0.6402862071990967, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11018, "done": false, "timesteps_total": 1749650, "episodes_total": 4640, "training_iteration": 162, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-07-50", "timestamp": 1585336070, "time_this_iter_s": 14.117816686630249, "time_total_s": 2992.521037340164, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d6510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d6e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d66a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00241400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2992.521037340164, "timesteps_since_restore": 1749650, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 37.89523809523809, "ram_util_percent": 87.76190476190477}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 33.5, "episode_len_mean": 413.48, "episodes_this_iter": 26, "policy_reward_mean": {"av": 17.357512953367877}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.297041331900926, "avg_speed_min": 2.7292101007425345, "avg_speed_max": 5.402039411336292, "avg_rl_veh_arrival_mean": 221.14333333333332, "avg_rl_veh_arrival_min": 75.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.8379269737816974, "mean_processing_ms": 3.4918031414610504, "mean_inference_ms": 0.42444280570147563}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1760243, "num_steps_sampled": 1760243, "sample_time_ms": 15965.418, "grad_time_ms": 128.32, "update_time_ms": 10.747, "opt_peak_throughput": 84510.565, "sample_peak_throughput": 679.243, "opt_samples": 10844.4, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2863.766357421875, "policy_loss": -9.952550888061523, "vf_loss": 2873.71875, "vf_explained_var": 0.10192269086837769, "kl": 0.009232228621840477, "entropy": 0.6551236510276794, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10593, "done": false, "timesteps_total": 1760243, "episodes_total": 4666, "training_iteration": 163, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-08-06", "timestamp": 1585336086, "time_this_iter_s": 15.529049396514893, "time_total_s": 3008.050086736679, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150ba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b1e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150bbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001aef28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3008.050086736679, "timesteps_since_restore": 1760243, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 36.43636363636363, "ram_util_percent": 87.73181818181818}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 45.5, "episode_len_mean": 429.64, "episodes_this_iter": 26, "policy_reward_mean": {"av": 23.333333333333332}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.360227589625154, "avg_speed_min": 2.6117410979057363, "avg_speed_max": 5.402039411336292, "avg_rl_veh_arrival_mean": 217.58833333333337, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.8305645323154796, "mean_processing_ms": 3.4891363375691227, "mean_inference_ms": 0.4236158599306579}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1771630, "num_steps_sampled": 1771630, "sample_time_ms": 15704.581, "grad_time_ms": 127.643, "update_time_ms": 9.762, "opt_peak_throughput": 85203.572, "sample_peak_throughput": 692.511, "opt_samples": 10875.6, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2269.102294921875, "policy_loss": -20.431127548217773, "vf_loss": 2289.533447265625, "vf_explained_var": 0.06236445903778076, "kl": 0.012489897198975086, "entropy": 0.694936215877533, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11387, "done": false, "timesteps_total": 1771630, "episodes_total": 4692, "training_iteration": 164, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-08-22", "timestamp": 1585336102, "time_this_iter_s": 16.028486490249634, "time_total_s": 3024.0785732269287, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00212048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00a93c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159fd90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3024.0785732269287, "timesteps_since_restore": 1771630, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 33.829166666666666, "ram_util_percent": 87.64583333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 41.5, "episode_len_mean": 424.82, "episodes_this_iter": 27, "policy_reward_mean": {"av": 20.85427135678392}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3569248134301946, "avg_speed_min": 1.0917873682433268, "avg_speed_max": 5.40806505260988, "avg_rl_veh_arrival_mean": 217.72, "avg_rl_veh_arrival_min": 84.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.825907120468304, "mean_processing_ms": 3.4865956213089446, "mean_inference_ms": 0.42314830984095836}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1782664, "num_steps_sampled": 1782664, "sample_time_ms": 15652.671, "grad_time_ms": 129.69, "update_time_ms": 9.907, "opt_peak_throughput": 84014.879, "sample_peak_throughput": 696.105, "opt_samples": 10895.9, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2425.192138671875, "policy_loss": -16.759033203125, "vf_loss": 2441.951171875, "vf_explained_var": 0.0843396782875061, "kl": 0.01099417358636856, "entropy": 0.5888854265213013, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11034, "done": false, "timesteps_total": 1782664, "episodes_total": 4719, "training_iteration": 165, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-08-37", "timestamp": 1585336117, "time_this_iter_s": 14.706247329711914, "time_total_s": 3038.7848205566406, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e9ae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b9d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b730>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c002426a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3038.7848205566406, "timesteps_since_restore": 1782664, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 37.58571428571429, "ram_util_percent": 87.63809523809523}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 36.5, "episode_len_mean": 417.25, "episodes_this_iter": 28, "policy_reward_mean": {"av": 18.34170854271357}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.366481180912483, "avg_speed_min": 1.0917873682433268, "avg_speed_max": 5.477996494626142, "avg_rl_veh_arrival_mean": 219.94333333333333, "avg_rl_veh_arrival_min": 84.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.8190318254117965, "mean_processing_ms": 3.483218083875031, "mean_inference_ms": 0.42258184879550603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1793706, "num_steps_sampled": 1793706, "sample_time_ms": 15428.29, "grad_time_ms": 131.784, "update_time_ms": 10.013, "opt_peak_throughput": 82823.102, "sample_peak_throughput": 707.454, "opt_samples": 10914.8, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1695.648193359375, "policy_loss": -16.03204917907715, "vf_loss": 1711.6795654296875, "vf_explained_var": 0.12666070461273193, "kl": 0.016122810542583466, "entropy": 0.7209181189537048, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11042, "done": false, "timesteps_total": 1793706, "episodes_total": 4747, "training_iteration": 166, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-08-52", "timestamp": 1585336132, "time_this_iter_s": 14.933535099029541, "time_total_s": 3053.71835565567, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002422f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00242c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242ea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ccbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3053.71835565567, "timesteps_since_restore": 1793706, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 36.36190476190476, "ram_util_percent": 87.66666666666667}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 28.0, "episode_len_mean": 408.18, "episodes_this_iter": 27, "policy_reward_mean": {"av": 14.35897435897436}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.364139355149132, "avg_speed_min": 1.0917873682433268, "avg_speed_max": 5.597669348794653, "avg_rl_veh_arrival_mean": 222.7266666666667, "avg_rl_veh_arrival_min": 84.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.812410097830943, "mean_processing_ms": 3.4807853121618875, "mean_inference_ms": 0.4219793945530995}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1804603, "num_steps_sampled": 1804603, "sample_time_ms": 15242.266, "grad_time_ms": 129.069, "update_time_ms": 11.12, "opt_peak_throughput": 84643.242, "sample_peak_throughput": 716.744, "opt_samples": 10924.8, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1788.5126953125, "policy_loss": -17.561941146850586, "vf_loss": 1806.073486328125, "vf_explained_var": 0.1142953634262085, "kl": 0.010207390412688255, "entropy": 0.6989848017692566, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10897, "done": false, "timesteps_total": 1804603, "episodes_total": 4774, "training_iteration": 167, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-09-08", "timestamp": 1585336148, "time_this_iter_s": 16.0200457572937, "time_total_s": 3069.738401412964, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e9268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e9158>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b268>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159fea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3069.738401412964, "timesteps_since_restore": 1804603, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 34.19583333333333, "ram_util_percent": 87.67916666666666}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 28.5, "episode_len_mean": 402.9, "episodes_this_iter": 28, "policy_reward_mean": {"av": 14.615384615384615}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.370377573706495, "avg_speed_min": 1.0917873682433268, "avg_speed_max": 5.597669348794653, "avg_rl_veh_arrival_mean": 217.46833333333336, "avg_rl_veh_arrival_min": 84.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.806572424870758, "mean_processing_ms": 3.477979177620332, "mean_inference_ms": 0.42135770662839844}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1815770, "num_steps_sampled": 1815770, "sample_time_ms": 15151.567, "grad_time_ms": 138.576, "update_time_ms": 11.078, "opt_peak_throughput": 79297.332, "sample_peak_throughput": 725.252, "opt_samples": 10988.7, "learner": {"av": {"cur_kl_coeff": 2.8809475184426395e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1793.040771484375, "policy_loss": -18.314834594726562, "vf_loss": 1811.35498046875, "vf_explained_var": 0.08111333847045898, "kl": 0.031024672091007233, "entropy": 0.46063709259033203, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11167, "done": false, "timesteps_total": 1815770, "episodes_total": 4802, "training_iteration": 168, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-09-24", "timestamp": 1585336164, "time_this_iter_s": 15.845472812652588, "time_total_s": 3085.5838742256165, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fe18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00212c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00212048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212f28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3085.5838742256165, "timesteps_since_restore": 1815770, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 34.213043478260865, "ram_util_percent": 87.6913043478261}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.5, "episode_len_mean": 389.56, "episodes_this_iter": 32, "policy_reward_mean": {"av": 2.34375}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.340288231344564, "avg_speed_min": 2.299484266911877, "avg_speed_max": 5.597669348794653, "avg_rl_veh_arrival_mean": 228.57166666666663, "avg_rl_veh_arrival_min": 97.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.79955421556223, "mean_processing_ms": 3.4761944769582778, "mean_inference_ms": 0.42069919733143835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1826560, "num_steps_sampled": 1826560, "sample_time_ms": 15407.283, "grad_time_ms": 136.168, "update_time_ms": 11.015, "opt_peak_throughput": 80385.384, "sample_peak_throughput": 710.437, "opt_samples": 10945.9, "learner": {"av": {"cur_kl_coeff": 4.3214210659057225e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4230.51416015625, "policy_loss": 2.842046022415161, "vf_loss": 4227.67138671875, "vf_explained_var": 0.07458120584487915, "kl": 0.028855061158537865, "entropy": 0.7852995991706848, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10790, "done": false, "timesteps_total": 1826560, "episodes_total": 4834, "training_iteration": 169, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-09-43", "timestamp": 1585336183, "time_this_iter_s": 18.46258234977722, "time_total_s": 3104.0464565753937, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a7b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016ad08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016aae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016af28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3104.0464565753937, "timesteps_since_restore": 1826560, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 30.519230769230766, "ram_util_percent": 87.69999999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -9.5, "episode_len_mean": 363.35, "episodes_this_iter": 30, "policy_reward_mean": {"av": -4.822335025380711}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.243281335890847, "avg_speed_min": 2.081742449117225, "avg_speed_max": 5.512877550567307, "avg_rl_veh_arrival_mean": 236.41166666666663, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.795283269430713, "mean_processing_ms": 3.472943448903733, "mean_inference_ms": 0.4202019638378225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837091, "num_steps_sampled": 1837091, "sample_time_ms": 15740.331, "grad_time_ms": 139.045, "update_time_ms": 12.104, "opt_peak_throughput": 78683.389, "sample_peak_throughput": 695.062, "opt_samples": 10940.5, "learner": {"av": {"cur_kl_coeff": 6.4821318106168205e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 3937.89013671875, "policy_loss": -8.795668601989746, "vf_loss": 3946.684814453125, "vf_explained_var": 0.06565195322036743, "kl": 0.03697897493839264, "entropy": 0.7998393177986145, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10531, "done": false, "timesteps_total": 1837091, "episodes_total": 4864, "training_iteration": 170, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-10-03", "timestamp": 1585336203, "time_this_iter_s": 19.746498823165894, "time_total_s": 3123.7929553985596, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159ff28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fbf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159fd90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00a93c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3123.7929553985596, "timesteps_since_restore": 1837091, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 31.434482758620685, "ram_util_percent": 87.71379310344827}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -1.5, "episode_len_mean": 374.47, "episodes_this_iter": 25, "policy_reward_mean": {"av": -0.7389162561576355}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.296102214191058, "avg_speed_min": 2.081742449117225, "avg_speed_max": 5.523455116290413, "avg_rl_veh_arrival_mean": 240.57333333333332, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.790990045657756, "mean_processing_ms": 3.472475064378328, "mean_inference_ms": 0.419845990266961}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1848244, "num_steps_sampled": 1848244, "sample_time_ms": 15775.565, "grad_time_ms": 140.588, "update_time_ms": 11.115, "opt_peak_throughput": 77966.562, "sample_peak_throughput": 694.821, "opt_samples": 10961.2, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1328.845458984375, "policy_loss": -24.232908248901367, "vf_loss": 1353.078125, "vf_explained_var": 0.08594650030136108, "kl": 0.010460566729307175, "entropy": 0.4461030662059784, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11153, "done": false, "timesteps_total": 1848244, "episodes_total": 4889, "training_iteration": 171, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-10-17", "timestamp": 1585336217, "time_this_iter_s": 14.016217231750488, "time_total_s": 3137.80917263031, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002422f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242d08>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e70d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3137.80917263031, "timesteps_since_restore": 1848244, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 40.584999999999994, "ram_util_percent": 87.665}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.5, "episode_len_mean": 379.69, "episodes_this_iter": 29, "policy_reward_mean": {"av": 1.2254901960784315}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.324713515325003, "avg_speed_min": 2.081742449117225, "avg_speed_max": 5.523455116290413, "avg_rl_veh_arrival_mean": 238.79666666666668, "avg_rl_veh_arrival_min": 69.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.787858206967183, "mean_processing_ms": 3.4752098421657136, "mean_inference_ms": 0.4193510496372052}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1859173, "num_steps_sampled": 1859173, "sample_time_ms": 16131.13, "grad_time_ms": 144.517, "update_time_ms": 10.843, "opt_peak_throughput": 75785.289, "sample_peak_throughput": 678.954, "opt_samples": 10952.3, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4491.38525390625, "policy_loss": -5.669541358947754, "vf_loss": 4497.0537109375, "vf_explained_var": 0.051722049713134766, "kl": 0.017702845856547356, "entropy": 0.6152687072753906, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10929, "done": false, "timesteps_total": 1859173, "episodes_total": 4918, "training_iteration": 172, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-10-35", "timestamp": 1585336235, "time_this_iter_s": 17.708789110183716, "time_total_s": 3155.517961740494, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e7400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e78c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e72f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3155.517961740494, "timesteps_since_restore": 1859173, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 35.032000000000004, "ram_util_percent": 87.61199999999997}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 18.5, "episode_len_mean": 402.78, "episodes_this_iter": 26, "policy_reward_mean": {"av": 8.80952380952381}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.406354470453549, "avg_speed_min": 2.88865197175167, "avg_speed_max": 5.567568042059582, "avg_rl_veh_arrival_mean": 233.61666666666667, "avg_rl_veh_arrival_min": 89.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.781742310037284, "mean_processing_ms": 3.4753066561318735, "mean_inference_ms": 0.4188663760405077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1869843, "num_steps_sampled": 1869843, "sample_time_ms": 16184.714, "grad_time_ms": 149.879, "update_time_ms": 11.017, "opt_peak_throughput": 73125.746, "sample_peak_throughput": 677.182, "opt_samples": 10960.0, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2752.964111328125, "policy_loss": -11.062897682189941, "vf_loss": 2764.02734375, "vf_explained_var": 0.06984102725982666, "kl": 0.010880416259169579, "entropy": 0.5552853345870972, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10670, "done": false, "timesteps_total": 1869843, "episodes_total": 4944, "training_iteration": 173, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-10-51", "timestamp": 1585336251, "time_this_iter_s": 16.13163924217224, "time_total_s": 3171.649600982666, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00242620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9ae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019ef28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3171.649600982666, "timesteps_since_restore": 1869843, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 32.06666666666667, "ram_util_percent": 87.6875}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 3.0, "episode_len_mean": 376.93, "episodes_this_iter": 33, "policy_reward_mean": {"av": 1.4354066985645932}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.300675838937434, "avg_speed_min": 2.0484480009360437, "avg_speed_max": 5.567568042059582, "avg_rl_veh_arrival_mean": 227.07, "avg_rl_veh_arrival_min": 76.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.77675087852172, "mean_processing_ms": 3.474672021028837, "mean_inference_ms": 0.4183911343915402}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1880796, "num_steps_sampled": 1880796, "sample_time_ms": 16469.538, "grad_time_ms": 148.069, "update_time_ms": 12.033, "opt_peak_throughput": 73726.64, "sample_peak_throughput": 662.836, "opt_samples": 10916.6, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 4125.55224609375, "policy_loss": -0.7359011173248291, "vf_loss": 4126.28662109375, "vf_explained_var": 0.07591187953948975, "kl": 0.015337686985731125, "entropy": 0.7509735226631165, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10953, "done": false, "timesteps_total": 1880796, "episodes_total": 4977, "training_iteration": 174, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-11-10", "timestamp": 1585336270, "time_this_iter_s": 18.881967067718506, "time_total_s": 3190.5315680503845, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fd90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159fd08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fbf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159ff28>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0a60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3190.5315680503845, "timesteps_since_restore": 1880796, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 33.53333333333333, "ram_util_percent": 87.72222222222223}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 0.5, "episode_len_mean": 376.83, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.25125628140703515}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.247571280164077, "avg_speed_min": 0.8503784621707787, "avg_speed_max": 5.567568042059582, "avg_rl_veh_arrival_mean": 221.65666666666667, "avg_rl_veh_arrival_min": 76.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.772932020118862, "mean_processing_ms": 3.473182461558338, "mean_inference_ms": 0.41775597473527354}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1892066, "num_steps_sampled": 1892066, "sample_time_ms": 16596.098, "grad_time_ms": 141.506, "update_time_ms": 12.003, "opt_peak_throughput": 77312.673, "sample_peak_throughput": 659.203, "opt_samples": 10940.2, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1696.0960693359375, "policy_loss": -14.663753509521484, "vf_loss": 1710.75927734375, "vf_explained_var": 0.1466631293296814, "kl": 0.011957523413002491, "entropy": 0.7610951066017151, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11270, "done": false, "timesteps_total": 1892066, "episodes_total": 5004, "training_iteration": 175, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-11-27", "timestamp": 1585336287, "time_this_iter_s": 15.894203662872314, "time_total_s": 3206.425771713257, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab09d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00274ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00180510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3206.425771713257, "timesteps_since_restore": 1892066, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 36.70434782608696, "ram_util_percent": 87.74782608695652}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 9.5, "episode_len_mean": 383.2, "episodes_this_iter": 27, "policy_reward_mean": {"av": 4.947916666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3112064072898155, "avg_speed_min": 0.8503784621707787, "avg_speed_max": 5.567568042059582, "avg_rl_veh_arrival_mean": 228.71333333333337, "avg_rl_veh_arrival_min": 76.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.768194408276574, "mean_processing_ms": 3.4723921391060775, "mean_inference_ms": 0.4173053664541526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1903179, "num_steps_sampled": 1903179, "sample_time_ms": 16644.206, "grad_time_ms": 145.23, "update_time_ms": 10.875, "opt_peak_throughput": 75379.199, "sample_peak_throughput": 657.724, "opt_samples": 10947.3, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 1675.638427734375, "policy_loss": -20.543325424194336, "vf_loss": 1696.181640625, "vf_explained_var": 0.12784630060195923, "kl": 0.012671584263443947, "entropy": 0.5207226872444153, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11113, "done": false, "timesteps_total": 1903179, "episodes_total": 5031, "training_iteration": 176, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-11-42", "timestamp": 1585336302, "time_this_iter_s": 15.449768543243408, "time_total_s": 3221.8755402565002, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab0a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3221.8755402565002, "timesteps_since_restore": 1903179, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 36.17727272727273, "ram_util_percent": 87.76818181818182}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 21.0, "episode_len_mean": 397.32, "episodes_this_iter": 26, "policy_reward_mean": {"av": 10.880829015544041}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.360963149212342, "avg_speed_min": 0.8503784621707787, "avg_speed_max": 5.560715604406189, "avg_rl_veh_arrival_mean": 227.665, "avg_rl_veh_arrival_min": 76.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.762945703470934, "mean_processing_ms": 3.46783686990431, "mean_inference_ms": 0.4167556032277748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1914330, "num_steps_sampled": 1914330, "sample_time_ms": 16599.617, "grad_time_ms": 144.013, "update_time_ms": 10.808, "opt_peak_throughput": 76192.566, "sample_peak_throughput": 661.021, "opt_samples": 10972.7, "learner": {"av": {"cur_kl_coeff": 9.723197927683468e-15, "cur_lr": 9.999999747378752e-05, "total_loss": 2577.553955078125, "policy_loss": -20.05411720275879, "vf_loss": 2597.607177734375, "vf_explained_var": 0.04821145534515381, "kl": 0.03192070871591568, "entropy": 0.39617377519607544, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11151, "done": false, "timesteps_total": 1914330, "episodes_total": 5057, "training_iteration": 177, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-11-58", "timestamp": 1585336318, "time_this_iter_s": 15.546338081359863, "time_total_s": 3237.42187833786, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002422f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00242d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00a93c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001806a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3237.42187833786, "timesteps_since_restore": 1914330, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 34.665217391304346, "ram_util_percent": 87.66521739130435}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -4.0, "episode_len_mean": 380.84, "episodes_this_iter": 33, "policy_reward_mean": {"av": -2.1164021164021163}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.283438250239814, "avg_speed_min": 0.8503784621707787, "avg_speed_max": 5.560715604406189, "avg_rl_veh_arrival_mean": 259.75666666666666, "avg_rl_veh_arrival_min": 90.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.757708769008422, "mean_processing_ms": 3.4686259042726464, "mean_inference_ms": 0.4163997234959669}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1925015, "num_steps_sampled": 1925015, "sample_time_ms": 16771.124, "grad_time_ms": 139.504, "update_time_ms": 11.888, "opt_peak_throughput": 78309.366, "sample_peak_throughput": 651.387, "opt_samples": 10924.5, "learner": {"av": {"cur_kl_coeff": 1.4584796044492254e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 5273.8818359375, "policy_loss": -1.9871649742126465, "vf_loss": 5275.8681640625, "vf_explained_var": 0.030097901821136475, "kl": 0.014586200006306171, "entropy": 0.745268702507019, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10685, "done": false, "timesteps_total": 1925015, "episodes_total": 5090, "training_iteration": 178, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-12-16", "timestamp": 1585336336, "time_this_iter_s": 17.524845123291016, "time_total_s": 3254.946723461151, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00180950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001808c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001809d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00180a60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00117158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3254.946723461151, "timesteps_since_restore": 1925015, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 32.644, "ram_util_percent": 87.69599999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -0.5, "episode_len_mean": 387.94, "episodes_this_iter": 25, "policy_reward_mean": {"av": -0.25125628140703515}, "custom_metrics": {"num_ped_collisions_mean": 0.18, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.352418836461362, "avg_speed_min": 1.9796716417438442, "avg_speed_max": 5.560715604406189, "avg_rl_veh_arrival_mean": 261.0566666666667, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.751639578684168, "mean_processing_ms": 3.465098620717305, "mean_inference_ms": 0.4157809328035435}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1935526, "num_steps_sampled": 1935526, "sample_time_ms": 16518.722, "grad_time_ms": 154.115, "update_time_ms": 11.841, "opt_peak_throughput": 70704.34, "sample_peak_throughput": 659.652, "opt_samples": 10896.6, "learner": {"av": {"cur_kl_coeff": 1.4584796044492254e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 3489.931640625, "policy_loss": -8.485657691955566, "vf_loss": 3498.417724609375, "vf_explained_var": 0.05323636531829834, "kl": 0.01184932328760624, "entropy": 0.5784600973129272, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10511, "done": false, "timesteps_total": 1935526, "episodes_total": 5115, "training_iteration": 179, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-12-32", "timestamp": 1585336352, "time_this_iter_s": 16.10185742378235, "time_total_s": 3271.0485808849335, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e7ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e7620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016aae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3271.0485808849335, "timesteps_since_restore": 1935526, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 33.98695652173913, "ram_util_percent": 87.40869565217392}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -11.0, "episode_len_mean": 376.51, "episodes_this_iter": 31, "policy_reward_mean": {"av": -5.445544554455446}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.287194080936054, "avg_speed_min": 1.9796716417438442, "avg_speed_max": 5.45154618707737, "avg_rl_veh_arrival_mean": 255.57333333333332, "avg_rl_veh_arrival_min": 92.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.748186122235387, "mean_processing_ms": 3.466446822388645, "mean_inference_ms": 0.4157882191102989}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1946631, "num_steps_sampled": 1946631, "sample_time_ms": 16278.714, "grad_time_ms": 154.864, "update_time_ms": 10.993, "opt_peak_throughput": 70733.139, "sample_peak_throughput": 672.903, "opt_samples": 10954.0, "learner": {"av": {"cur_kl_coeff": 1.4584796044492254e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2505.806396484375, "policy_loss": -9.97634506225586, "vf_loss": 2515.78271484375, "vf_explained_var": 0.08591234683990479, "kl": 0.010579333640635014, "entropy": 0.5575579404830933, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11105, "done": false, "timesteps_total": 1946631, "episodes_total": 5146, "training_iteration": 180, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-12-50", "timestamp": 1585336370, "time_this_iter_s": 17.344790935516357, "time_total_s": 3288.39337182045, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3288.39337182045, "timesteps_since_restore": 1946631, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 33.612, "ram_util_percent": 86.97200000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 6.5, "episode_len_mean": 389.63, "episodes_this_iter": 31, "policy_reward_mean": {"av": 3.1553398058252426}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.408214614750241, "avg_speed_min": 2.692763390501715, "avg_speed_max": 5.459366263811671, "avg_rl_veh_arrival_mean": 240.595, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.742988108968263, "mean_processing_ms": 3.4652209017700044, "mean_inference_ms": 0.4151685871144277}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1957849, "num_steps_sampled": 1957849, "sample_time_ms": 16684.318, "grad_time_ms": 159.5, "update_time_ms": 11.137, "opt_peak_throughput": 68718.052, "sample_peak_throughput": 656.934, "opt_samples": 10960.5, "learner": {"av": {"cur_kl_coeff": 1.4584796044492254e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2896.71630859375, "policy_loss": -17.65110206604004, "vf_loss": 2914.366455078125, "vf_explained_var": 0.07700669765472412, "kl": 0.014588852412998676, "entropy": 0.3377766013145447, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11218, "done": false, "timesteps_total": 1957849, "episodes_total": 5177, "training_iteration": 181, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-13-08", "timestamp": 1585336388, "time_this_iter_s": 18.12092614173889, "time_total_s": 3306.5142979621887, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cce18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc9d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc1e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00242ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3306.5142979621887, "timesteps_since_restore": 1957849, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 32.75185185185185, "ram_util_percent": 87.0}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.0, "episode_len_mean": 380.47, "episodes_this_iter": 27, "policy_reward_mean": {"av": 2.4154589371980677}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.442820174976212, "avg_speed_min": 2.879242173930336, "avg_speed_max": 5.500397375035217, "avg_rl_veh_arrival_mean": 240.09166666666667, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.738436731444178, "mean_processing_ms": 3.466325692590822, "mean_inference_ms": 0.41486807318633767}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1968665, "num_steps_sampled": 1968665, "sample_time_ms": 16416.211, "grad_time_ms": 165.729, "update_time_ms": 11.489, "opt_peak_throughput": 66066.789, "sample_peak_throughput": 666.975, "opt_samples": 10949.2, "learner": {"av": {"cur_kl_coeff": 1.4584796044492254e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2108.466064453125, "policy_loss": -16.578859329223633, "vf_loss": 2125.044677734375, "vf_explained_var": 0.08979159593582153, "kl": 0.026219382882118225, "entropy": 0.27375200390815735, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10816, "done": false, "timesteps_total": 1968665, "episodes_total": 5204, "training_iteration": 182, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-13-23", "timestamp": 1585336403, "time_this_iter_s": 15.10788106918335, "time_total_s": 3321.622179031372, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00242ae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00242a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d66a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d6510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001aed08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3321.622179031372, "timesteps_since_restore": 1968665, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 37.347619047619055, "ram_util_percent": 86.9857142857143}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -6.0, "episode_len_mean": 366.11, "episodes_this_iter": 30, "policy_reward_mean": {"av": -2.926829268292683}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.422521284258979, "avg_speed_min": 2.5672410423620953, "avg_speed_max": 5.500397375035217, "avg_rl_veh_arrival_mean": 244.02, "avg_rl_veh_arrival_min": 72.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.733635496161029, "mean_processing_ms": 3.4632619193718117, "mean_inference_ms": 0.41435257146851795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1979354, "num_steps_sampled": 1979354, "sample_time_ms": 16389.325, "grad_time_ms": 161.394, "update_time_ms": 11.161, "opt_peak_throughput": 67853.354, "sample_peak_throughput": 668.185, "opt_samples": 10951.1, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 5394.75830078125, "policy_loss": 2.9835829734802246, "vf_loss": 5391.7744140625, "vf_explained_var": 0.06427603960037231, "kl": 0.010721839964389801, "entropy": 0.5481322407722473, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10689, "done": false, "timesteps_total": 1979354, "episodes_total": 5234, "training_iteration": 183, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-13-39", "timestamp": 1585336419, "time_this_iter_s": 15.819380044937134, "time_total_s": 3337.441559076309, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cc950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ccb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cca60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc8c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016ad90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3337.441559076309, "timesteps_since_restore": 1979354, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 35.06956521739131, "ram_util_percent": 87.0304347826087}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.0, "episode_len_mean": 381.84, "episodes_this_iter": 25, "policy_reward_mean": {"av": 1.9704433497536946}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.414267186766549, "avg_speed_min": 2.5672410423620953, "avg_speed_max": 5.500397375035217, "avg_rl_veh_arrival_mean": 241.47833333333335, "avg_rl_veh_arrival_min": 88.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.728493751849748, "mean_processing_ms": 3.46370821614375, "mean_inference_ms": 0.4135522956933288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1990205, "num_steps_sampled": 1990205, "sample_time_ms": 15997.709, "grad_time_ms": 162.356, "update_time_ms": 10.073, "opt_peak_throughput": 67388.482, "sample_peak_throughput": 683.904, "opt_samples": 10940.9, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 1591.278076171875, "policy_loss": -20.683536529541016, "vf_loss": 1611.961181640625, "vf_explained_var": 0.10584414005279541, "kl": 0.008033640682697296, "entropy": 0.2846369743347168, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10851, "done": false, "timesteps_total": 1990205, "episodes_total": 5259, "training_iteration": 184, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-13-55", "timestamp": 1585336435, "time_this_iter_s": 14.959121227264404, "time_total_s": 3352.4006803035736, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016aa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016af28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016ad08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3352.4006803035736, "timesteps_since_restore": 1990205, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 34.836363636363636, "ram_util_percent": 87.05909090909087}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 17.0, "episode_len_mean": 401.85, "episodes_this_iter": 26, "policy_reward_mean": {"av": 8.542713567839195}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.436455864854871, "avg_speed_min": 2.5672410423620953, "avg_speed_max": 5.500397375035217, "avg_rl_veh_arrival_mean": 239.26833333333335, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.724404193580805, "mean_processing_ms": 3.461203998645372, "mean_inference_ms": 0.4128626119710321}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2001655, "num_steps_sampled": 2001655, "sample_time_ms": 15827.551, "grad_time_ms": 160.653, "update_time_ms": 10.103, "opt_peak_throughput": 68214.695, "sample_peak_throughput": 692.394, "opt_samples": 10958.9, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 1986.7054443359375, "policy_loss": -21.433103561401367, "vf_loss": 2008.1392822265625, "vf_explained_var": 0.08661174774169922, "kl": 0.015346942469477654, "entropy": 0.28530001640319824, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11450, "done": false, "timesteps_total": 2001655, "episodes_total": 5285, "training_iteration": 185, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-14-09", "timestamp": 1585336449, "time_this_iter_s": 14.17818570137024, "time_total_s": 3366.578866004944, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00ab06a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0d08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ae598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3366.578866004944, "timesteps_since_restore": 2001655, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 41.794999999999995, "ram_util_percent": 87.035}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 9.0, "episode_len_mean": 392.26, "episodes_this_iter": 30, "policy_reward_mean": {"av": 4.545454545454546}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.389201650345224, "avg_speed_min": 2.5672410423620953, "avg_speed_max": 5.535746551689634, "avg_rl_veh_arrival_mean": 231.15666666666667, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.719725230787283, "mean_processing_ms": 3.460921568299905, "mean_inference_ms": 0.41221330981608345}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2012023, "num_steps_sampled": 2012023, "sample_time_ms": 15987.734, "grad_time_ms": 159.37, "update_time_ms": 11.048, "opt_peak_throughput": 68296.257, "sample_peak_throughput": 680.797, "opt_samples": 10884.4, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2278.11279296875, "policy_loss": -4.663755416870117, "vf_loss": 2282.776123046875, "vf_explained_var": 0.06839126348495483, "kl": 0.01001258660107851, "entropy": 0.6205931901931763, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10368, "done": false, "timesteps_total": 2012023, "episodes_total": 5315, "training_iteration": 186, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-14-26", "timestamp": 1585336466, "time_this_iter_s": 17.054444551467896, "time_total_s": 3383.6333105564117, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016ad90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016ab70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016ae18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016abf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ccae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3383.6333105564117, "timesteps_since_restore": 2012023, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 30.412, "ram_util_percent": 87.01999999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 24.0, "episode_len_mean": 398.79, "episodes_this_iter": 29, "policy_reward_mean": {"av": 12.06030150753769}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4372057189335, "avg_speed_min": 2.673017258093304, "avg_speed_max": 5.535746551689634, "avg_rl_veh_arrival_mean": 220.41333333333333, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.715667113284079, "mean_processing_ms": 3.460335527232272, "mean_inference_ms": 0.41180137508746073}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2022752, "num_steps_sampled": 2022752, "sample_time_ms": 16153.422, "grad_time_ms": 163.138, "update_time_ms": 11.201, "opt_peak_throughput": 66460.411, "sample_peak_throughput": 671.201, "opt_samples": 10842.2, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2154.912109375, "policy_loss": -12.121232032775879, "vf_loss": 2167.0322265625, "vf_explained_var": 0.09973686933517456, "kl": 0.019010407850146294, "entropy": 0.3891521990299225, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10729, "done": false, "timesteps_total": 2022752, "episodes_total": 5344, "training_iteration": 187, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-14-44", "timestamp": 1585336484, "time_this_iter_s": 17.253877639770508, "time_total_s": 3400.8871881961823, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ccb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cce18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001ccbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00a93c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3400.8871881961823, "timesteps_since_restore": 2022752, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 36.28, "ram_util_percent": 87.06}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -6.0, "episode_len_mean": 365.44, "episodes_this_iter": 30, "policy_reward_mean": {"av": -2.898550724637681}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.312553135336982, "avg_speed_min": 2.6617057755713454, "avg_speed_max": 5.535746551689634, "avg_rl_veh_arrival_mean": 233.52, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.713883275146101, "mean_processing_ms": 3.462218499330345, "mean_inference_ms": 0.4112733112840871}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2033425, "num_steps_sampled": 2033425, "sample_time_ms": 16266.412, "grad_time_ms": 164.413, "update_time_ms": 11.033, "opt_peak_throughput": 65937.57, "sample_peak_throughput": 666.465, "opt_samples": 10841.0, "learner": {"av": {"cur_kl_coeff": 2.187719406673838e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 5334.77001953125, "policy_loss": 4.2044267654418945, "vf_loss": 5330.56494140625, "vf_explained_var": 0.0687410831451416, "kl": 0.17210069298744202, "entropy": 0.6433840990066528, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10673, "done": false, "timesteps_total": 2033425, "episodes_total": 5374, "training_iteration": 188, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-15-03", "timestamp": 1585336503, "time_this_iter_s": 18.668195962905884, "time_total_s": 3419.555384159088, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3419.555384159088, "timesteps_since_restore": 2033425, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 33.64074074074073, "ram_util_percent": 87.21851851851852}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -11.0, "episode_len_mean": 366.94, "episodes_this_iter": 29, "policy_reward_mean": {"av": -5.583756345177665}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.269496763719703, "avg_speed_min": 2.5547524276680265, "avg_speed_max": 5.754560897523912, "avg_rl_veh_arrival_mean": 243.69833333333332, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.710314242045008, "mean_processing_ms": 3.4613173931763983, "mean_inference_ms": 0.41129321958928244}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2044301, "num_steps_sampled": 2044301, "sample_time_ms": 16248.989, "grad_time_ms": 148.49, "update_time_ms": 11.036, "opt_peak_throughput": 73254.327, "sample_peak_throughput": 669.426, "opt_samples": 10877.5, "learner": {"av": {"cur_kl_coeff": 3.281579110010757e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2929.744140625, "policy_loss": -12.99341869354248, "vf_loss": 2942.737060546875, "vf_explained_var": 0.06301707029342651, "kl": 0.061616554856300354, "entropy": 0.46400660276412964, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10876, "done": false, "timesteps_total": 2044301, "episodes_total": 5403, "training_iteration": 189, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-15-19", "timestamp": 1585336519, "time_this_iter_s": 15.751042604446411, "time_total_s": 3435.3064267635345, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001ccae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001cc8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cca60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0a60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016ae18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3435.3064267635345, "timesteps_since_restore": 2044301, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 34.00869565217391, "ram_util_percent": 87.24347826086957}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -17.0, "episode_len_mean": 365.43, "episodes_this_iter": 29, "policy_reward_mean": {"av": -8.5}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.274443448284703, "avg_speed_min": 2.5547524276680265, "avg_speed_max": 5.754560897523912, "avg_rl_veh_arrival_mean": 255.54166666666663, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.706298909429766, "mean_processing_ms": 3.4594185313178736, "mean_inference_ms": 0.41083721659898415}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2055027, "num_steps_sampled": 2055027, "sample_time_ms": 16269.946, "grad_time_ms": 153.066, "update_time_ms": 11.812, "opt_peak_throughput": 70816.492, "sample_peak_throughput": 666.235, "opt_samples": 10839.6, "learner": {"av": {"cur_kl_coeff": 4.922368665016136e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2418.483642578125, "policy_loss": -7.5157036781311035, "vf_loss": 2425.998779296875, "vf_explained_var": 0.09861743450164795, "kl": 0.02474229596555233, "entropy": 0.4196324944496155, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10726, "done": false, "timesteps_total": 2055027, "episodes_total": 5432, "training_iteration": 190, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-15-36", "timestamp": 1585336536, "time_this_iter_s": 17.592702865600586, "time_total_s": 3452.899129629135, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016aae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016af28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d6510>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b7b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3452.899129629135, "timesteps_since_restore": 2055027, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 35.900000000000006, "ram_util_percent": 87.28400000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -5.5, "episode_len_mean": 378.27, "episodes_this_iter": 27, "policy_reward_mean": {"av": -2.5821596244131455}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.308309763821411, "avg_speed_min": 2.5547524276680265, "avg_speed_max": 5.754560897523912, "avg_rl_veh_arrival_mean": 247.26666666666665, "avg_rl_veh_arrival_min": 115.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.70196050121, "mean_processing_ms": 3.458402591543353, "mean_inference_ms": 0.410442836537846}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2065920, "num_steps_sampled": 2065920, "sample_time_ms": 16002.44, "grad_time_ms": 153.894, "update_time_ms": 11.678, "opt_peak_throughput": 70224.356, "sample_peak_throughput": 675.341, "opt_samples": 10807.1, "learner": {"av": {"cur_kl_coeff": 7.383552997524204e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 2802.52880859375, "policy_loss": -12.932779312133789, "vf_loss": 2815.461181640625, "vf_explained_var": 0.061319589614868164, "kl": 0.013371491804718971, "entropy": 0.3786969482898712, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10893, "done": false, "timesteps_total": 2065920, "episodes_total": 5459, "training_iteration": 191, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-15-52", "timestamp": 1585336552, "time_this_iter_s": 15.464606761932373, "time_total_s": 3468.3637363910675, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e91e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9268>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3468.3637363910675, "timesteps_since_restore": 2065920, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 35.98636363636364, "ram_util_percent": 87.25454545454546}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 11.5, "episode_len_mean": 402.21, "episodes_this_iter": 24, "policy_reward_mean": {"av": 5.528846153846154}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.399820042742385, "avg_speed_min": 2.5547524276680265, "avg_speed_max": 5.754560897523912, "avg_rl_veh_arrival_mean": 243.66333333333333, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.697498710813227, "mean_processing_ms": 3.455430234127456, "mean_inference_ms": 0.41025748948606816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2076932, "num_steps_sampled": 2076932, "sample_time_ms": 15907.187, "grad_time_ms": 149.065, "update_time_ms": 11.496, "opt_peak_throughput": 72630.886, "sample_peak_throughput": 680.617, "opt_samples": 10826.7, "learner": {"av": {"cur_kl_coeff": 7.383552997524204e-14, "cur_lr": 9.999999747378752e-05, "total_loss": 3228.757568359375, "policy_loss": -15.461893081665039, "vf_loss": 3244.2197265625, "vf_explained_var": 0.060199856758117676, "kl": 0.06459395587444305, "entropy": 0.26197341084480286, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11012, "done": false, "timesteps_total": 2076932, "episodes_total": 5483, "training_iteration": 192, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-16-06", "timestamp": 1585336566, "time_this_iter_s": 14.094910860061646, "time_total_s": 3482.458647251129, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00220598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00220510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00220bf8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00220ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00241ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3482.458647251129, "timesteps_since_restore": 2076932, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 38.42857142857143, "ram_util_percent": 87.30952380952381}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 28.0, "episode_len_mean": 416.7, "episodes_this_iter": 26, "policy_reward_mean": {"av": 13.270142180094787}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.445870601570514, "avg_speed_min": 2.682073631005247, "avg_speed_max": 5.638665277310986, "avg_rl_veh_arrival_mean": 239.20666666666668, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.6935843531718335, "mean_processing_ms": 3.4550207688592356, "mean_inference_ms": 0.4097106173391878}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2087580, "num_steps_sampled": 2087580, "sample_time_ms": 15858.01, "grad_time_ms": 150.639, "update_time_ms": 11.438, "opt_peak_throughput": 71844.741, "sample_peak_throughput": 682.469, "opt_samples": 10822.6, "learner": {"av": {"cur_kl_coeff": 1.1075329835099484e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1702.1871337890625, "policy_loss": -16.508432388305664, "vf_loss": 1718.695556640625, "vf_explained_var": 0.11282539367675781, "kl": 0.07075752317905426, "entropy": 0.1980821192264557, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10648, "done": false, "timesteps_total": 2087580, "episodes_total": 5509, "training_iteration": 193, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-16-22", "timestamp": 1585336582, "time_this_iter_s": 15.328481912612915, "time_total_s": 3497.787129163742, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027be18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016aae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3497.787129163742, "timesteps_since_restore": 2087580, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 32.949999999999996, "ram_util_percent": 87.23181818181818}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 29.0, "episode_len_mean": 420.01, "episodes_this_iter": 24, "policy_reward_mean": {"av": 13.942307692307692}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.482724225729415, "avg_speed_min": 2.682073631005247, "avg_speed_max": 5.638665277310986, "avg_rl_veh_arrival_mean": 242.90666666666667, "avg_rl_veh_arrival_min": 109.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.6900579253638, "mean_processing_ms": 3.4536259020781097, "mean_inference_ms": 0.40937257278274974}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2098137, "num_steps_sampled": 2098137, "sample_time_ms": 15827.067, "grad_time_ms": 155.831, "update_time_ms": 12.55, "opt_peak_throughput": 69262.085, "sample_peak_throughput": 681.946, "opt_samples": 10793.2, "learner": {"av": {"cur_kl_coeff": 1.661299407502287e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1825.4588623046875, "policy_loss": -8.453022956848145, "vf_loss": 1833.9129638671875, "vf_explained_var": 0.11539047956466675, "kl": 0.6066996455192566, "entropy": 0.20046676695346832, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10557, "done": false, "timesteps_total": 2098137, "episodes_total": 5533, "training_iteration": 194, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-16-37", "timestamp": 1585336597, "time_this_iter_s": 14.709153175354004, "time_total_s": 3512.496282339096, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a9d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a048>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a8c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3512.496282339096, "timesteps_since_restore": 2098137, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 40.58571428571429, "ram_util_percent": 87.3857142857143}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 26.0, "episode_len_mean": 423.15, "episodes_this_iter": 27, "policy_reward_mean": {"av": 13.197969543147208}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.499631732956439, "avg_speed_min": 2.6946172880553942, "avg_speed_max": 5.638665277310986, "avg_rl_veh_arrival_mean": 243.28333333333333, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.68557513910287, "mean_processing_ms": 3.4518171755554072, "mean_inference_ms": 0.40879943099334304}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2108938, "num_steps_sampled": 2108938, "sample_time_ms": 15845.456, "grad_time_ms": 160.909, "update_time_ms": 12.736, "opt_peak_throughput": 66673.263, "sample_peak_throughput": 677.058, "opt_samples": 10728.3, "learner": {"av": {"cur_kl_coeff": 2.491949246778702e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3219.36767578125, "policy_loss": -9.06913948059082, "vf_loss": 3228.435546875, "vf_explained_var": 0.06559580564498901, "kl": 0.012970891781151295, "entropy": 0.4681459963321686, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10801, "done": false, "timesteps_total": 2108938, "episodes_total": 5560, "training_iteration": 195, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-16-51", "timestamp": 1585336611, "time_this_iter_s": 14.428615093231201, "time_total_s": 3526.9248974323273, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001cc950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001ccae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001cc8c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001cc6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00241510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3526.9248974323273, "timesteps_since_restore": 2108938, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 34.266666666666666, "ram_util_percent": 87.37142857142857}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 19.0, "episode_len_mean": 418.14, "episodes_this_iter": 29, "policy_reward_mean": {"av": 9.844559585492227}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.499315957904171, "avg_speed_min": 2.6946172880553942, "avg_speed_max": 5.587623774933825, "avg_rl_veh_arrival_mean": 241.23833333333332, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.678351174550872, "mean_processing_ms": 3.4495873245493067, "mean_inference_ms": 0.40810357295329935}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2119975, "num_steps_sampled": 2119975, "sample_time_ms": 15666.032, "grad_time_ms": 158.852, "update_time_ms": 12.504, "opt_peak_throughput": 67957.573, "sample_peak_throughput": 689.083, "opt_samples": 10795.2, "learner": {"av": {"cur_kl_coeff": 2.491949246778702e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 3001.68701171875, "policy_loss": -11.848078727722168, "vf_loss": 3013.53466796875, "vf_explained_var": 0.08027154207229614, "kl": 0.012079160660505295, "entropy": 0.21447061002254486, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11037, "done": false, "timesteps_total": 2119975, "episodes_total": 5589, "training_iteration": 196, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-17-07", "timestamp": 1585336627, "time_this_iter_s": 15.220293283462524, "time_total_s": 3542.14519071579, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016a8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3542.14519071579, "timesteps_since_restore": 2119975, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 35.54090909090908, "ram_util_percent": 87.27727272727272}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.5, "episode_len_mean": 393.53, "episodes_this_iter": 29, "policy_reward_mean": {"av": 2.8947368421052633}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.399669785161518, "avg_speed_min": 2.638287647443219, "avg_speed_max": 5.587623774933825, "avg_rl_veh_arrival_mean": 232.415, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.673817640625757, "mean_processing_ms": 3.4469798301594397, "mean_inference_ms": 0.40768376090565783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2130952, "num_steps_sampled": 2130952, "sample_time_ms": 15609.488, "grad_time_ms": 159.156, "update_time_ms": 12.391, "opt_peak_throughput": 67983.69, "sample_peak_throughput": 693.168, "opt_samples": 10820.0, "learner": {"av": {"cur_kl_coeff": 2.491949246778702e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1622.672119140625, "policy_loss": -8.703363418579102, "vf_loss": 1631.3759765625, "vf_explained_var": 0.14445751905441284, "kl": 0.03687109053134918, "entropy": 0.5714014172554016, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10977, "done": false, "timesteps_total": 2130952, "episodes_total": 5618, "training_iteration": 197, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-17-24", "timestamp": 1585336644, "time_this_iter_s": 16.690880060195923, "time_total_s": 3558.8360707759857, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3558.8360707759857, "timesteps_since_restore": 2130952, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 34.78333333333333, "ram_util_percent": 87.29166666666667}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 0.5, "episode_len_mean": 385.9, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.25906735751295334}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.41589753705425, "avg_speed_min": 2.638287647443219, "avg_speed_max": 5.530452676914678, "avg_rl_veh_arrival_mean": 236.62333333333336, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.670993044498389, "mean_processing_ms": 3.4476871544035994, "mean_inference_ms": 0.40748229233317523}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2141866, "num_steps_sampled": 2141866, "sample_time_ms": 15413.332, "grad_time_ms": 157.938, "update_time_ms": 12.605, "opt_peak_throughput": 68660.423, "sample_peak_throughput": 703.553, "opt_samples": 10844.1, "learner": {"av": {"cur_kl_coeff": 3.737923870168053e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 2889.20703125, "policy_loss": -11.600382804870605, "vf_loss": 2900.806884765625, "vf_explained_var": 0.09259331226348877, "kl": 0.01232299767434597, "entropy": 0.2018161118030548, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10914, "done": false, "timesteps_total": 2141866, "episodes_total": 5646, "training_iteration": 198, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-17-41", "timestamp": 1585336661, "time_this_iter_s": 16.695900201797485, "time_total_s": 3575.531970977783, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019e8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019ebf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019ed08>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019ed90>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024ff28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3575.531970977783, "timesteps_since_restore": 2141866, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 34.47083333333333, "ram_util_percent": 87.325}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.5, "episode_len_mean": 380.12, "episodes_this_iter": 30, "policy_reward_mean": {"av": 2.34375}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.415655409616987, "avg_speed_min": 2.5935752091559894, "avg_speed_max": 5.530452676914678, "avg_rl_veh_arrival_mean": 230.10833333333332, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.667855887636709, "mean_processing_ms": 3.4485090464612136, "mean_inference_ms": 0.4070889385220085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2152812, "num_steps_sampled": 2152812, "sample_time_ms": 15529.692, "grad_time_ms": 162.858, "update_time_ms": 12.794, "opt_peak_throughput": 66629.217, "sample_peak_throughput": 698.732, "opt_samples": 10851.1, "learner": {"av": {"cur_kl_coeff": 3.737923870168053e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4757.921875, "policy_loss": -0.5004109740257263, "vf_loss": 4758.42138671875, "vf_explained_var": 0.07795780897140503, "kl": 0.016208253800868988, "entropy": 0.24187858402729034, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10946, "done": false, "timesteps_total": 2152812, "episodes_total": 5676, "training_iteration": 199, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-17-58", "timestamp": 1585336678, "time_this_iter_s": 16.972380876541138, "time_total_s": 3592.5043518543243, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b2f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b9d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027bea0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3592.5043518543243, "timesteps_since_restore": 2152812, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 32.648, "ram_util_percent": 87.296}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 13.5, "episode_len_mean": 387.21, "episodes_this_iter": 28, "policy_reward_mean": {"av": 6.818181818181818}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.437645947076341, "avg_speed_min": 2.5935752091559894, "avg_speed_max": 5.530452676914678, "avg_rl_veh_arrival_mean": 231.575, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.6633234653804125, "mean_processing_ms": 3.447479763596358, "mean_inference_ms": 0.40669464462078125}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2164202, "num_steps_sampled": 2164202, "sample_time_ms": 15105.042, "grad_time_ms": 151.513, "update_time_ms": 12.872, "opt_peak_throughput": 72056.532, "sample_peak_throughput": 722.772, "opt_samples": 10917.5, "learner": {"av": {"cur_kl_coeff": 3.737923870168053e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 1417.0079345703125, "policy_loss": -20.22079849243164, "vf_loss": 1437.228271484375, "vf_explained_var": 0.0020655393600463867, "kl": 0.02901691198348999, "entropy": 0.29254940152168274, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11390, "done": false, "timesteps_total": 2164202, "episodes_total": 5704, "training_iteration": 200, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-18-11", "timestamp": 1585336691, "time_this_iter_s": 13.234779834747314, "time_total_s": 3605.7391316890717, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016aae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016ad08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016af28>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0024f400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3605.7391316890717, "timesteps_since_restore": 2164202, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 40.92105263157895, "ram_util_percent": 87.3157894736842}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.5, "episode_len_mean": 375.57, "episodes_this_iter": 31, "policy_reward_mean": {"av": 2.3076923076923075}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.412992429678436, "avg_speed_min": 2.5637774855586426, "avg_speed_max": 5.530452676914678, "avg_rl_veh_arrival_mean": 234.9033333333333, "avg_rl_veh_arrival_min": 85.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.659043862689792, "mean_processing_ms": 3.4460849600556274, "mean_inference_ms": 0.40639332142329154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2174763, "num_steps_sampled": 2174763, "sample_time_ms": 15334.761, "grad_time_ms": 151.005, "update_time_ms": 13.781, "opt_peak_throughput": 72079.158, "sample_peak_throughput": 709.78, "opt_samples": 10884.3, "learner": {"av": {"cur_kl_coeff": 5.606885940777351e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4419.30859375, "policy_loss": 1.9549915790557861, "vf_loss": 4417.35205078125, "vf_explained_var": 0.05652230978012085, "kl": 0.09338045120239258, "entropy": 0.3606927692890167, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10561, "done": false, "timesteps_total": 2174763, "episodes_total": 5735, "training_iteration": 201, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-18-29", "timestamp": 1585336709, "time_this_iter_s": 17.759284734725952, "time_total_s": 3623.4984164237976, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab0d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b730>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0024fea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3623.4984164237976, "timesteps_since_restore": 2174763, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 32.45384615384615, "ram_util_percent": 87.2846153846154}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.0, "episode_len_mean": 372.19, "episodes_this_iter": 28, "policy_reward_mean": {"av": -3.6649214659685865}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.409917109273202, "avg_speed_min": 2.223228670764291, "avg_speed_max": 5.433469059309138, "avg_rl_veh_arrival_mean": 239.37333333333333, "avg_rl_veh_arrival_min": 85.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.6549551234740045, "mean_processing_ms": 3.4449555655991104, "mean_inference_ms": 0.40598669109919444}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2185733, "num_steps_sampled": 2185733, "sample_time_ms": 15556.383, "grad_time_ms": 150.007, "update_time_ms": 14.021, "opt_peak_throughput": 72530.622, "sample_peak_throughput": 699.398, "opt_samples": 10880.1, "learner": {"av": {"cur_kl_coeff": 8.410328640115483e-13, "cur_lr": 9.999999747378752e-05, "total_loss": 4252.22314453125, "policy_loss": 0.7961668372154236, "vf_loss": 4251.4248046875, "vf_explained_var": 0.061071813106536865, "kl": 0.5691487193107605, "entropy": 0.30898886919021606, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10970, "done": false, "timesteps_total": 2185733, "episodes_total": 5763, "training_iteration": 202, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-18-46", "timestamp": 1585336726, "time_this_iter_s": 16.302000284194946, "time_total_s": 3639.8004167079926, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017bb70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0017b7b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0159f950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3639.8004167079926, "timesteps_since_restore": 2185733, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 37.643478260869564, "ram_util_percent": 87.26086956521738}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.0, "episode_len_mean": 374.94, "episodes_this_iter": 30, "policy_reward_mean": {"av": -3.9603960396039604}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.37856855296844, "avg_speed_min": 2.223228670764291, "avg_speed_max": 5.433469059309138, "avg_rl_veh_arrival_mean": 242.16666666666669, "avg_rl_veh_arrival_min": 85.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.650853251519343, "mean_processing_ms": 3.4446821354167896, "mean_inference_ms": 0.4055548853181195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2196658, "num_steps_sampled": 2196658, "sample_time_ms": 15714.846, "grad_time_ms": 153.737, "update_time_ms": 14.16, "opt_peak_throughput": 70951.008, "sample_peak_throughput": 694.108, "opt_samples": 10907.8, "learner": {"av": {"cur_kl_coeff": 1.2615492418072138e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3347.371337890625, "policy_loss": -8.524392127990723, "vf_loss": 3355.896240234375, "vf_explained_var": 0.05292552709579468, "kl": 0.007913602516055107, "entropy": 0.4189390540122986, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10925, "done": false, "timesteps_total": 2196658, "episodes_total": 5793, "training_iteration": 203, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-19-03", "timestamp": 1585336743, "time_this_iter_s": 16.950465440750122, "time_total_s": 3656.7508821487427, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fd08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00ab0d90>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00ab0158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e7268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3656.7508821487427, "timesteps_since_restore": 2196658, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 35.644, "ram_util_percent": 87.28399999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.5, "episode_len_mean": 373.49, "episodes_this_iter": 29, "policy_reward_mean": {"av": -4.187192118226601}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.358292999307378, "avg_speed_min": 2.223228670764291, "avg_speed_max": 5.433469059309138, "avg_rl_veh_arrival_mean": 236.40833333333333, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.648503736048832, "mean_processing_ms": 3.4450682110660282, "mean_inference_ms": 0.4050792741926552}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2207228, "num_steps_sampled": 2207228, "sample_time_ms": 15872.154, "grad_time_ms": 144.811, "update_time_ms": 13.905, "opt_peak_throughput": 75333.187, "sample_peak_throughput": 687.311, "opt_samples": 10909.1, "learner": {"av": {"cur_kl_coeff": 1.2615492418072138e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3784.134521484375, "policy_loss": -1.537597894668579, "vf_loss": 3785.671875, "vf_explained_var": 0.059279024600982666, "kl": 0.09449881315231323, "entropy": 0.17666837573051453, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10570, "done": false, "timesteps_total": 2207228, "episodes_total": 5822, "training_iteration": 204, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-19-19", "timestamp": 1585336759, "time_this_iter_s": 16.188544034957886, "time_total_s": 3672.9394261837006, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b9d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027bea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b7b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3672.9394261837006, "timesteps_since_restore": 2207228, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 35.082608695652176, "ram_util_percent": 87.34782608695653}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.5, "episode_len_mean": 393.39, "episodes_this_iter": 26, "policy_reward_mean": {"av": 1.256281407035176}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.441488455698968, "avg_speed_min": 2.4521435146167, "avg_speed_max": 5.433560944518117, "avg_rl_veh_arrival_mean": 237.355, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.646387154694542, "mean_processing_ms": 3.4447409488356406, "mean_inference_ms": 0.40477390035902144}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2218662, "num_steps_sampled": 2218662, "sample_time_ms": 15938.842, "grad_time_ms": 145.61, "update_time_ms": 13.562, "opt_peak_throughput": 75354.752, "sample_peak_throughput": 688.406, "opt_samples": 10972.4, "learner": {"av": {"cur_kl_coeff": 1.892323971131038e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3255.83349609375, "policy_loss": -15.929305076599121, "vf_loss": 3271.761962890625, "vf_explained_var": 0.02557283639907837, "kl": 0.020876510068774223, "entropy": 0.07638218998908997, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11434, "done": false, "timesteps_total": 2218662, "episodes_total": 5848, "training_iteration": 205, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-19-35", "timestamp": 1585336775, "time_this_iter_s": 15.085548877716064, "time_total_s": 3688.0249750614166, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019e6a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159f8c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156840>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3688.0249750614166, "timesteps_since_restore": 2218662, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 39.93636363636363, "ram_util_percent": 87.36818181818184}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -7.0, "episode_len_mean": 370.58, "episodes_this_iter": 35, "policy_reward_mean": {"av": -3.4146341463414633}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.339349928046127, "avg_speed_min": 2.3461027941352763, "avg_speed_max": 5.460811835591748, "avg_rl_veh_arrival_mean": 234.86, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.644085405908302, "mean_processing_ms": 3.4466797654719254, "mean_inference_ms": 0.4046580873313861}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2229793, "num_steps_sampled": 2229793, "sample_time_ms": 16429.281, "grad_time_ms": 148.419, "update_time_ms": 13.81, "opt_peak_throughput": 73992.065, "sample_peak_throughput": 668.429, "opt_samples": 10981.8, "learner": {"av": {"cur_kl_coeff": 2.838485956696557e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 3746.995849609375, "policy_loss": -2.5814967155456543, "vf_loss": 3749.576416015625, "vf_explained_var": 0.08600825071334839, "kl": 0.012932383455336094, "entropy": 0.400858610868454, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11131, "done": false, "timesteps_total": 2229793, "episodes_total": 5883, "training_iteration": 206, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-19-55", "timestamp": 1585336795, "time_this_iter_s": 20.16193389892578, "time_total_s": 3708.1869089603424, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3708.1869089603424, "timesteps_since_restore": 2229793, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 29.103448275862068, "ram_util_percent": 87.36206896551725}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -11.0, "episode_len_mean": 357.92, "episodes_this_iter": 29, "policy_reward_mean": {"av": -5.365853658536586}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.334177029343078, "avg_speed_min": 2.3461027941352763, "avg_speed_max": 5.629355757005456, "avg_rl_veh_arrival_mean": 231.51166666666668, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.640383275714775, "mean_processing_ms": 3.4464343713640413, "mean_inference_ms": 0.40425309387474895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2240507, "num_steps_sampled": 2240507, "sample_time_ms": 16469.709, "grad_time_ms": 149.556, "update_time_ms": 13.746, "opt_peak_throughput": 73253.734, "sample_peak_throughput": 665.191, "opt_samples": 10955.5, "learner": {"av": {"cur_kl_coeff": 2.838485956696557e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 1921.639404296875, "policy_loss": -7.571499824523926, "vf_loss": 1929.21044921875, "vf_explained_var": 0.11281657218933105, "kl": 0.012155476957559586, "entropy": 0.21491673588752747, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10714, "done": false, "timesteps_total": 2240507, "episodes_total": 5912, "training_iteration": 207, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-20-12", "timestamp": 1585336812, "time_this_iter_s": 17.09454917907715, "time_total_s": 3725.2814581394196, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017bb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017b6a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0017bbf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001567b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3725.2814581394196, "timesteps_since_restore": 2240507, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 35.1875, "ram_util_percent": 87.40000000000002}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -2.5, "episode_len_mean": 369.44, "episodes_this_iter": 27, "policy_reward_mean": {"av": -1.2315270935960592}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.41814016595417, "avg_speed_min": 2.3461027941352763, "avg_speed_max": 5.629355757005456, "avg_rl_veh_arrival_mean": 230.68166666666667, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.636270909338698, "mean_processing_ms": 3.44522433710464, "mean_inference_ms": 0.4039565144271877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2251735, "num_steps_sampled": 2251735, "sample_time_ms": 16260.615, "grad_time_ms": 148.556, "update_time_ms": 13.58, "opt_peak_throughput": 73957.924, "sample_peak_throughput": 675.676, "opt_samples": 10986.9, "learner": {"av": {"cur_kl_coeff": 2.838485956696557e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 1762.9656982421875, "policy_loss": -17.4117488861084, "vf_loss": 1780.3775634765625, "vf_explained_var": 0.10628563165664673, "kl": 0.4862179756164551, "entropy": -0.10952568799257278, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11228, "done": false, "timesteps_total": 2251735, "episodes_total": 5939, "training_iteration": 208, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-20-27", "timestamp": 1585336827, "time_this_iter_s": 14.591572523117065, "time_total_s": 3739.8730306625366, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d79d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3739.8730306625366, "timesteps_since_restore": 2251735, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 35.5409090909091, "ram_util_percent": 87.27727272727272}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -3.0, "episode_len_mean": 370.64, "episodes_this_iter": 28, "policy_reward_mean": {"av": -1.4285714285714286}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3638118626701665, "avg_speed_min": 2.3461027941352763, "avg_speed_max": 5.629355757005456, "avg_rl_veh_arrival_mean": 226.32499999999996, "avg_rl_veh_arrival_min": 107.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.634877348919187, "mean_processing_ms": 3.4430667478358106, "mean_inference_ms": 0.4039773667225582}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2262457, "num_steps_sampled": 2262457, "sample_time_ms": 16491.106, "grad_time_ms": 151.002, "update_time_ms": 13.663, "opt_peak_throughput": 72611.402, "sample_peak_throughput": 664.874, "opt_samples": 10964.5, "learner": {"av": {"cur_kl_coeff": 4.257728718204401e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 2546.2158203125, "policy_loss": -2.5936522483825684, "vf_loss": 2548.809326171875, "vf_explained_var": 0.10602951049804688, "kl": 0.07213560491800308, "entropy": 0.5385069847106934, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10722, "done": false, "timesteps_total": 2262457, "episodes_total": 5967, "training_iteration": 209, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-20-47", "timestamp": 1585336847, "time_this_iter_s": 19.30909776687622, "time_total_s": 3759.182128429413, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020fa60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159f950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f620>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d66a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3759.182128429413, "timesteps_since_restore": 2262457, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 34.10740740740741, "ram_util_percent": 87.35185185185186}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 14.0, "episode_len_mean": 393.86, "episodes_this_iter": 27, "policy_reward_mean": {"av": 6.666666666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.432840883092374, "avg_speed_min": 2.484467719785744, "avg_speed_max": 5.609953970487663, "avg_rl_veh_arrival_mean": 221.04166666666669, "avg_rl_veh_arrival_min": 107.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.6297908450786505, "mean_processing_ms": 3.441883265409599, "mean_inference_ms": 0.40323807777877213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2273658, "num_steps_sampled": 2273658, "sample_time_ms": 16624.6, "grad_time_ms": 160.484, "update_time_ms": 13.814, "opt_peak_throughput": 68203.631, "sample_peak_throughput": 658.398, "opt_samples": 10945.6, "learner": {"av": {"cur_kl_coeff": 6.3865930773066015e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 1853.619140625, "policy_loss": -11.332324028015137, "vf_loss": 1864.95166015625, "vf_explained_var": 0.06806743144989014, "kl": 0.09555157274007797, "entropy": -0.04439106211066246, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11201, "done": false, "timesteps_total": 2273658, "episodes_total": 5994, "training_iteration": 210, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-21-01", "timestamp": 1585336861, "time_this_iter_s": 14.665735006332397, "time_total_s": 3773.8478634357452, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b7b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3773.8478634357452, "timesteps_since_restore": 2273658, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 37.154545454545456, "ram_util_percent": 87.34545454545456}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 35.0, "episode_len_mean": 428.78, "episodes_this_iter": 23, "policy_reward_mean": {"av": 17.24137931034483}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.512163772907289, "avg_speed_min": 2.484467719785744, "avg_speed_max": 5.609953970487663, "avg_rl_veh_arrival_mean": 223.52, "avg_rl_veh_arrival_min": 120.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.627336561869148, "mean_processing_ms": 3.44124168924689, "mean_inference_ms": 0.4030476087209019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2285270, "num_steps_sampled": 2285270, "sample_time_ms": 16203.501, "grad_time_ms": 162.965, "update_time_ms": 13.008, "opt_peak_throughput": 67810.43, "sample_peak_throughput": 681.995, "opt_samples": 11050.7, "learner": {"av": {"cur_kl_coeff": 9.579889832800337e-12, "cur_lr": 9.999999747378752e-05, "total_loss": 1084.08203125, "policy_loss": -25.517087936401367, "vf_loss": 1109.599365234375, "vf_explained_var": 0.011553764343261719, "kl": 0.08709429949522018, "entropy": 0.059263743460178375, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11612, "done": false, "timesteps_total": 2285270, "episodes_total": 6017, "training_iteration": 211, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-21-15", "timestamp": 1585336875, "time_this_iter_s": 13.55808138847351, "time_total_s": 3787.4059448242188, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150ba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b9d8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00117158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3787.4059448242188, "timesteps_since_restore": 2285270, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 48.13157894736842, "ram_util_percent": 87.31052631578946}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 41.0, "episode_len_mean": 424.66, "episodes_this_iter": 27, "policy_reward_mean": {"av": 19.806763285024154}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.518977821386294, "avg_speed_min": 2.617829567740781, "avg_speed_max": 5.36065628407172, "avg_rl_veh_arrival_mean": 222.125, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.624872123479289, "mean_processing_ms": 3.4413185824666197, "mean_inference_ms": 0.40266235723228244}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2295919, "num_steps_sampled": 2295919, "sample_time_ms": 16071.178, "grad_time_ms": 166.683, "update_time_ms": 12.659, "opt_peak_throughput": 66105.185, "sample_peak_throughput": 685.612, "opt_samples": 11018.6, "learner": {"av": {"cur_kl_coeff": 1.4369835182881374e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 3779.265380859375, "policy_loss": -7.233923435211182, "vf_loss": 3786.497802734375, "vf_explained_var": 0.06106799840927124, "kl": 0.06295923888683319, "entropy": 0.007136032450944185, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10649, "done": false, "timesteps_total": 2295919, "episodes_total": 6044, "training_iteration": 212, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-21-30", "timestamp": 1585336890, "time_this_iter_s": 15.020359754562378, "time_total_s": 3802.426304578781, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b2f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b400>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3802.426304578781, "timesteps_since_restore": 2295919, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 35.36818181818182, "ram_util_percent": 87.28636363636362}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 25.0, "episode_len_mean": 409.15, "episodes_this_iter": 31, "policy_reward_mean": {"av": 12.626262626262626}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.515636077067146, "avg_speed_min": 2.8029783922669287, "avg_speed_max": 5.408380379552744, "avg_rl_veh_arrival_mean": 230.77499999999998, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.621545659915908, "mean_processing_ms": 3.438491056000436, "mean_inference_ms": 0.40214063853332}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2306955, "num_steps_sampled": 2306955, "sample_time_ms": 16031.632, "grad_time_ms": 165.659, "update_time_ms": 12.418, "opt_peak_throughput": 66580.633, "sample_peak_throughput": 687.996, "opt_samples": 11029.7, "learner": {"av": {"cur_kl_coeff": 2.155475277432206e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 3556.23779296875, "policy_loss": -5.785075664520264, "vf_loss": 3562.02294921875, "vf_explained_var": 0.042207956314086914, "kl": 0.014540120027959347, "entropy": 0.28234776854515076, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11036, "done": false, "timesteps_total": 2306955, "episodes_total": 6075, "training_iteration": 213, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-21-47", "timestamp": 1585336907, "time_this_iter_s": 16.554631233215332, "time_total_s": 3818.9809358119965, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0020f950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0020fa60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156c80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001172f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3818.9809358119965, "timesteps_since_restore": 2306955, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 34.90833333333333, "ram_util_percent": 87.32083333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.5, "episode_len_mean": 384.98, "episodes_this_iter": 27, "policy_reward_mean": {"av": 4.207920792079208}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.461370836088644, "avg_speed_min": 2.8029783922669287, "avg_speed_max": 5.408380379552744, "avg_rl_veh_arrival_mean": 239.83666666666667, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.61850094138064, "mean_processing_ms": 3.438780561552311, "mean_inference_ms": 0.401869606198688}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2317667, "num_steps_sampled": 2317667, "sample_time_ms": 16030.751, "grad_time_ms": 170.24, "update_time_ms": 12.383, "opt_peak_throughput": 64872.525, "sample_peak_throughput": 688.92, "opt_samples": 11043.9, "learner": {"av": {"cur_kl_coeff": 2.155475277432206e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2856.843994140625, "policy_loss": -11.994433403015137, "vf_loss": 2868.83740234375, "vf_explained_var": 0.05573803186416626, "kl": 0.007452852092683315, "entropy": 0.02543111890554428, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10712, "done": false, "timesteps_total": 2317667, "episodes_total": 6102, "training_iteration": 214, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-22-04", "timestamp": 1585336924, "time_this_iter_s": 16.227208137512207, "time_total_s": 3835.2081439495087, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00117488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00117510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00117620>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001176a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00117d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3835.2081439495087, "timesteps_since_restore": 2317667, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 38.460869565217386, "ram_util_percent": 87.37391304347828}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -0.5, "episode_len_mean": 376.21, "episodes_this_iter": 28, "policy_reward_mean": {"av": -0.24509803921568626}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.42989228985849, "avg_speed_min": 2.7032588467238137, "avg_speed_max": 5.726341875209998, "avg_rl_veh_arrival_mean": 236.56666666666663, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.615840387899681, "mean_processing_ms": 3.438221895373565, "mean_inference_ms": 0.4014251135371479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2328348, "num_steps_sampled": 2328348, "sample_time_ms": 16151.097, "grad_time_ms": 172.316, "update_time_ms": 12.611, "opt_peak_throughput": 63654.151, "sample_peak_throughput": 679.124, "opt_samples": 10968.6, "learner": {"av": {"cur_kl_coeff": 2.155475277432206e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 2439.831298828125, "policy_loss": -9.517624855041504, "vf_loss": 2449.348388671875, "vf_explained_var": 0.09466743469238281, "kl": 0.016363248229026794, "entropy": 0.1960507482290268, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10681, "done": false, "timesteps_total": 2328348, "episodes_total": 6130, "training_iteration": 215, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-22-20", "timestamp": 1585336940, "time_this_iter_s": 16.311959505081177, "time_total_s": 3851.52010345459, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00ab09d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016a8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a9d8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3851.52010345459, "timesteps_since_restore": 2328348, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 32.64166666666667, "ram_util_percent": 87.3125}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.5, "episode_len_mean": 386.93, "episodes_this_iter": 27, "policy_reward_mean": {"av": 1.2254901960784315}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.413893474076599, "avg_speed_min": 2.7032588467238137, "avg_speed_max": 5.726341875209998, "avg_rl_veh_arrival_mean": 250.45333333333332, "avg_rl_veh_arrival_min": 98.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.611410026505811, "mean_processing_ms": 3.436227851583793, "mean_inference_ms": 0.40091099880163306}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2339532, "num_steps_sampled": 2339532, "sample_time_ms": 15569.418, "grad_time_ms": 167.194, "update_time_ms": 12.461, "opt_peak_throughput": 65635.538, "sample_peak_throughput": 704.837, "opt_samples": 10973.9, "learner": {"av": {"cur_kl_coeff": 2.155475277432206e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 1769.841796875, "policy_loss": -20.799633026123047, "vf_loss": 1790.6414794921875, "vf_explained_var": 0.07786393165588379, "kl": 0.0054757846519351006, "entropy": 0.027399281039834023, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11184, "done": false, "timesteps_total": 2339532, "episodes_total": 6157, "training_iteration": 216, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-22-35", "timestamp": 1585336955, "time_this_iter_s": 14.287187814712524, "time_total_s": 3865.8072912693024, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7a60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00117ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3865.8072912693024, "timesteps_since_restore": 2339532, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 38.635000000000005, "ram_util_percent": 87.30499999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.0, "episode_len_mean": 390.85, "episodes_this_iter": 27, "policy_reward_mean": {"av": 2.512562814070352}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.385142087107523, "avg_speed_min": 2.7032588467238137, "avg_speed_max": 5.726341875209998, "avg_rl_veh_arrival_mean": 247.95166666666665, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.608537275709368, "mean_processing_ms": 3.432395552722519, "mean_inference_ms": 0.4008780537879442}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2350044, "num_steps_sampled": 2350044, "sample_time_ms": 15559.76, "grad_time_ms": 168.356, "update_time_ms": 12.632, "opt_peak_throughput": 65062.857, "sample_peak_throughput": 703.976, "opt_samples": 10953.7, "learner": {"av": {"cur_kl_coeff": 2.155475277432206e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 4575.0029296875, "policy_loss": -0.3107548654079437, "vf_loss": 4575.31298828125, "vf_explained_var": 0.03947478532791138, "kl": 0.2671779990196228, "entropy": 0.3563491106033325, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10512, "done": false, "timesteps_total": 2350044, "episodes_total": 6184, "training_iteration": 217, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-22-52", "timestamp": 1585336972, "time_this_iter_s": 17.012589693069458, "time_total_s": 3882.819880962372, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001280d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00128158>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00128268>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001282f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00128950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3882.819880962372, "timesteps_since_restore": 2350044, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 33.20399999999999, "ram_util_percent": 87.32}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.0, "episode_len_mean": 387.45, "episodes_this_iter": 33, "policy_reward_mean": {"av": 1.015228426395939}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.375393401076482, "avg_speed_min": 2.9280961540696793, "avg_speed_max": 5.580954066359805, "avg_rl_veh_arrival_mean": 252.10166666666663, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.607324168975865, "mean_processing_ms": 3.4353719259192603, "mean_inference_ms": 0.40064708709389907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2360869, "num_steps_sampled": 2360869, "sample_time_ms": 15702.951, "grad_time_ms": 172.285, "update_time_ms": 12.732, "opt_peak_throughput": 63345.167, "sample_peak_throughput": 694.99, "opt_samples": 10913.4, "learner": {"av": {"cur_kl_coeff": 3.233212655939788e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 4073.063232421875, "policy_loss": -2.953213691711426, "vf_loss": 4076.01708984375, "vf_explained_var": 0.047267913818359375, "kl": 0.05024807155132294, "entropy": 0.3255528211593628, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10825, "done": false, "timesteps_total": 2360869, "episodes_total": 6217, "training_iteration": 218, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-23-08", "timestamp": 1585336988, "time_this_iter_s": 16.07528281211853, "time_total_s": 3898.8951637744904, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001179d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00117950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00117840>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001177b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3898.8951637744904, "timesteps_since_restore": 2360869, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 38.24347826086957, "ram_util_percent": 87.3391304347826}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -12.5, "episode_len_mean": 363.55, "episodes_this_iter": 31, "policy_reward_mean": {"av": -6.377551020408164}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.285717778041811, "avg_speed_min": 1.8882319308490965, "avg_speed_max": 5.460728817056728, "avg_rl_veh_arrival_mean": 250.89166666666668, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.60375614630137, "mean_processing_ms": 3.435824250213349, "mean_inference_ms": 0.4006401913402871}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2371608, "num_steps_sampled": 2371608, "sample_time_ms": 15429.679, "grad_time_ms": 167.12, "update_time_ms": 11.519, "opt_peak_throughput": 65312.966, "sample_peak_throughput": 707.409, "opt_samples": 10915.1, "learner": {"av": {"cur_kl_coeff": 4.849819157382029e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 3261.781982421875, "policy_loss": -3.4453468322753906, "vf_loss": 3265.228515625, "vf_explained_var": 0.07758814096450806, "kl": 0.024209564551711082, "entropy": 0.37985506653785706, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10739, "done": false, "timesteps_total": 2371608, "episodes_total": 6248, "training_iteration": 219, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-23-25", "timestamp": 1585337005, "time_this_iter_s": 16.509735345840454, "time_total_s": 3915.404899120331, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7ae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7b70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3915.404899120331, "timesteps_since_restore": 2371608, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 32.11666666666667, "ram_util_percent": 87.33333333333333}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -16.5, "episode_len_mean": 360.76, "episodes_this_iter": 24, "policy_reward_mean": {"av": -8.59375}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.257608201041279, "avg_speed_min": 1.8882319308490965, "avg_speed_max": 5.410609285926136, "avg_rl_veh_arrival_mean": 244.5283333333333, "avg_rl_veh_arrival_min": 68.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.60188292931742, "mean_processing_ms": 3.436529110999769, "mean_inference_ms": 0.4003705844568458}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2382256, "num_steps_sampled": 2382256, "sample_time_ms": 15432.192, "grad_time_ms": 161.656, "update_time_ms": 10.861, "opt_peak_throughput": 67178.523, "sample_peak_throughput": 703.711, "opt_samples": 10859.8, "learner": {"av": {"cur_kl_coeff": 7.274728736073044e-11, "cur_lr": 9.999999747378752e-05, "total_loss": 1632.478759765625, "policy_loss": -4.3551788330078125, "vf_loss": 1636.834228515625, "vf_explained_var": 0.10539853572845459, "kl": 10.69683837890625, "entropy": 0.12607835233211517, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10648, "done": false, "timesteps_total": 2382256, "episodes_total": 6272, "training_iteration": 220, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-23-40", "timestamp": 1585337020, "time_this_iter_s": 14.628599643707275, "time_total_s": 3930.033498764038, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001567b8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156e18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3930.033498764038, "timesteps_since_restore": 2382256, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 40.63809523809524, "ram_util_percent": 87.3809523809524}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.0, "episode_len_mean": 360.46, "episodes_this_iter": 34, "policy_reward_mean": {"av": -4.081632653061225}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.235447733958369, "avg_speed_min": 1.8882319308490965, "avg_speed_max": 5.410609285926136, "avg_rl_veh_arrival_mean": 235.95166666666668, "avg_rl_veh_arrival_min": 77.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.597278272410535, "mean_processing_ms": 3.438046909071837, "mean_inference_ms": 0.3997548314777618}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2392785, "num_steps_sampled": 2392785, "sample_time_ms": 15879.639, "grad_time_ms": 156.237, "update_time_ms": 10.803, "opt_peak_throughput": 68815.428, "sample_peak_throughput": 677.062, "opt_samples": 10751.5, "learner": {"av": {"cur_kl_coeff": 1.0912093451054261e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3458.9033203125, "policy_loss": 3.747666358947754, "vf_loss": 3455.1552734375, "vf_explained_var": 0.09129619598388672, "kl": 0.036666806787252426, "entropy": 0.6525046825408936, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10529, "done": false, "timesteps_total": 2392785, "episodes_total": 6306, "training_iteration": 221, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-23-58", "timestamp": 1585337038, "time_this_iter_s": 17.97682023048401, "time_total_s": 3948.010318994522, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f6a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017b7b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3948.010318994522, "timesteps_since_restore": 2392785, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 30.315384615384616, "ram_util_percent": 87.30384615384618}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -12.0, "episode_len_mean": 359.53, "episodes_this_iter": 33, "policy_reward_mean": {"av": -6.185567010309279}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.208223726464878, "avg_speed_min": 1.8882319308490965, "avg_speed_max": 5.410609285926136, "avg_rl_veh_arrival_mean": 248.04833333333335, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.594573657746991, "mean_processing_ms": 3.4380264812179293, "mean_inference_ms": 0.39931976845230743}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2403295, "num_steps_sampled": 2403295, "sample_time_ms": 16064.816, "grad_time_ms": 153.117, "update_time_ms": 11.005, "opt_peak_throughput": 70126.945, "sample_peak_throughput": 668.392, "opt_samples": 10737.6, "learner": {"av": {"cur_kl_coeff": 1.6368140176581392e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 5589.8427734375, "policy_loss": 5.7906575202941895, "vf_loss": 5584.05419921875, "vf_explained_var": 0.05460643768310547, "kl": 0.1612517386674881, "entropy": 0.6137747168540955, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10510, "done": false, "timesteps_total": 2403295, "episodes_total": 6339, "training_iteration": 222, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-24-15", "timestamp": 1585337055, "time_this_iter_s": 16.845022916793823, "time_total_s": 3964.855341911316, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7b70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7ae8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3964.855341911316, "timesteps_since_restore": 2403295, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 34.087999999999994, "ram_util_percent": 87.38}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -15.0, "episode_len_mean": 355.68, "episodes_this_iter": 27, "policy_reward_mean": {"av": -7.894736842105263}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.207952173874532, "avg_speed_min": 2.4271320776152057, "avg_speed_max": 5.383449479231714, "avg_rl_veh_arrival_mean": 238.39333333333332, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.59163007166932, "mean_processing_ms": 3.4392322495463064, "mean_inference_ms": 0.39901985543639656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2414616, "num_steps_sampled": 2414616, "sample_time_ms": 15934.892, "grad_time_ms": 152.692, "update_time_ms": 11.116, "opt_peak_throughput": 70508.613, "sample_peak_throughput": 675.631, "opt_samples": 10766.1, "learner": {"av": {"cur_kl_coeff": 2.455221026487209e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3024.736572265625, "policy_loss": -11.901549339294434, "vf_loss": 3036.638671875, "vf_explained_var": 0.07907330989837646, "kl": 0.016812242567539215, "entropy": 0.1890154927968979, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11321, "done": false, "timesteps_total": 2414616, "episodes_total": 6366, "training_iteration": 223, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-24-30", "timestamp": 1585337070, "time_this_iter_s": 15.244466543197632, "time_total_s": 3980.0998084545135, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b2f0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b048>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001178c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3980.0998084545135, "timesteps_since_restore": 2414616, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 40.195454545454545, "ram_util_percent": 87.37727272727274}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -8.5, "episode_len_mean": 375.08, "episodes_this_iter": 28, "policy_reward_mean": {"av": -4.56989247311828}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3143808043256495, "avg_speed_min": 2.4271320776152057, "avg_speed_max": 5.433117908990049, "avg_rl_veh_arrival_mean": 246.53666666666663, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.589037675912819, "mean_processing_ms": 3.4354745293706883, "mean_inference_ms": 0.3989505671741109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2425726, "num_steps_sampled": 2425726, "sample_time_ms": 15874.205, "grad_time_ms": 148.961, "update_time_ms": 11.307, "opt_peak_throughput": 72541.692, "sample_peak_throughput": 680.721, "opt_samples": 10805.9, "learner": {"av": {"cur_kl_coeff": 2.455221026487209e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 1839.5845947265625, "policy_loss": -13.60055160522461, "vf_loss": 1853.1846923828125, "vf_explained_var": 0.08967632055282593, "kl": 0.08642993867397308, "entropy": 0.06317337602376938, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11110, "done": false, "timesteps_total": 2425726, "episodes_total": 6394, "training_iteration": 224, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-24-46", "timestamp": 1585337086, "time_this_iter_s": 15.582197666168213, "time_total_s": 3995.6820061206818, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00117268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00117950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00117158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001171e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0017bd08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3995.6820061206818, "timesteps_since_restore": 2425726, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 33.75, "ram_util_percent": 87.36363636363637}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 0.0, "episode_len_mean": 385.8, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.406477129176694, "avg_speed_min": 2.151538553162478, "avg_speed_max": 5.433117908990049, "avg_rl_veh_arrival_mean": 242.66833333333335, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.586104110036614, "mean_processing_ms": 3.4349393772221166, "mean_inference_ms": 0.3986601903741564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2436729, "num_steps_sampled": 2436729, "sample_time_ms": 15603.925, "grad_time_ms": 142.701, "update_time_ms": 10.909, "opt_peak_throughput": 75949.558, "sample_peak_throughput": 694.575, "opt_samples": 10838.1, "learner": {"av": {"cur_kl_coeff": 3.682831539730813e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 1068.8023681640625, "policy_loss": -17.130857467651367, "vf_loss": 1085.93359375, "vf_explained_var": 0.14495527744293213, "kl": 0.5369624495506287, "entropy": -0.08119300752878189, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11003, "done": false, "timesteps_total": 2436729, "episodes_total": 6419, "training_iteration": 225, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-25-00", "timestamp": 1585337100, "time_this_iter_s": 13.542210102081299, "time_total_s": 4009.224216222763, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0017b598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0017b840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0017bae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0020fd08>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0020f158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4009.224216222763, "timesteps_since_restore": 2436729, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 38.74499999999999, "ram_util_percent": 87.35000000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 12.5, "episode_len_mean": 404.31, "episodes_this_iter": 28, "policy_reward_mean": {"av": 6.756756756756757}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.519623735002681, "avg_speed_min": 2.151538553162478, "avg_speed_max": 5.433117908990049, "avg_rl_veh_arrival_mean": 230.02833333333336, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.581641292046649, "mean_processing_ms": 3.4335552187074048, "mean_inference_ms": 0.39837401753315177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2448212, "num_steps_sampled": 2448212, "sample_time_ms": 15691.394, "grad_time_ms": 143.088, "update_time_ms": 10.436, "opt_peak_throughput": 75953.344, "sample_peak_throughput": 692.609, "opt_samples": 10868.0, "learner": {"av": {"cur_kl_coeff": 5.524247170818342e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 3380.064453125, "policy_loss": -6.703022480010986, "vf_loss": 3386.76611328125, "vf_explained_var": 0.09221553802490234, "kl": 0.19347785413265228, "entropy": 0.009443765506148338, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11483, "done": false, "timesteps_total": 2448212, "episodes_total": 6447, "training_iteration": 226, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-25-15", "timestamp": 1585337115, "time_this_iter_s": 15.158436298370361, "time_total_s": 4024.3826525211334, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001178c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001177b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b730>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150b0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4024.3826525211334, "timesteps_since_restore": 2448212, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 37.845454545454544, "ram_util_percent": 87.35000000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 30.0, "episode_len_mean": 416.66, "episodes_this_iter": 28, "policy_reward_mean": {"av": 15.625}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.537169510829652, "avg_speed_min": 2.151538553162478, "avg_speed_max": 5.518629325645342, "avg_rl_veh_arrival_mean": 234.61, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.577984389971429, "mean_processing_ms": 3.432750523963961, "mean_inference_ms": 0.3979917754617192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2459377, "num_steps_sampled": 2459377, "sample_time_ms": 15517.108, "grad_time_ms": 142.261, "update_time_ms": 10.177, "opt_peak_throughput": 76853.731, "sample_peak_throughput": 704.597, "opt_samples": 10933.3, "learner": {"av": {"cur_kl_coeff": 8.286371033783269e-10, "cur_lr": 9.999999747378752e-05, "total_loss": 2520.673583984375, "policy_loss": -13.211997985839844, "vf_loss": 2533.885498046875, "vf_explained_var": 0.07423776388168335, "kl": 0.08142230659723282, "entropy": 0.1533985137939453, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11165, "done": false, "timesteps_total": 2459377, "episodes_total": 6475, "training_iteration": 227, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-25-31", "timestamp": 1585337131, "time_this_iter_s": 15.255886554718018, "time_total_s": 4039.6385390758514, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d7ae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d7730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d7b70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001d7a60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d7488>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4039.6385390758514, "timesteps_since_restore": 2459377, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 38.13181818181818, "ram_util_percent": 87.36818181818184}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 29.5, "episode_len_mean": 415.04, "episodes_this_iter": 27, "policy_reward_mean": {"av": 15.284974093264248}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.546826027687835, "avg_speed_min": 2.151538553162478, "avg_speed_max": 5.518629325645342, "avg_rl_veh_arrival_mean": 237.03, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.574982817401628, "mean_processing_ms": 3.4309634880689974, "mean_inference_ms": 0.39764252502133246}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2470357, "num_steps_sampled": 2470357, "sample_time_ms": 15558.395, "grad_time_ms": 139.668, "update_time_ms": 9.966, "opt_peak_throughput": 78391.474, "sample_peak_throughput": 703.723, "opt_samples": 10948.8, "learner": {"av": {"cur_kl_coeff": 1.2429556273119147e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3118.144287109375, "policy_loss": -10.222138404846191, "vf_loss": 3128.364990234375, "vf_explained_var": 0.04642951488494873, "kl": 0.17693118751049042, "entropy": -0.025044601410627365, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10980, "done": false, "timesteps_total": 2470357, "episodes_total": 6502, "training_iteration": 228, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-25-48", "timestamp": 1585337148, "time_this_iter_s": 16.44966983795166, "time_total_s": 4056.088208913803, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00156c80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00156bf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019e950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4056.088208913803, "timesteps_since_restore": 2470357, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 34.36666666666667, "ram_util_percent": 87.425}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 26.5, "episode_len_mean": 407.47, "episodes_this_iter": 27, "policy_reward_mean": {"av": 13.25}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.490835811519104, "avg_speed_min": 2.6453923663424757, "avg_speed_max": 5.518629325645342, "avg_rl_veh_arrival_mean": 241.97833333333335, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.571536901611866, "mean_processing_ms": 3.4281570238113392, "mean_inference_ms": 0.3973277564976664}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2481391, "num_steps_sampled": 2481391, "sample_time_ms": 15388.739, "grad_time_ms": 144.613, "update_time_ms": 9.856, "opt_peak_throughput": 75914.776, "sample_peak_throughput": 713.398, "opt_samples": 10978.3, "learner": {"av": {"cur_kl_coeff": 1.8644334964790232e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 2595.661865234375, "policy_loss": -11.181577682495117, "vf_loss": 2606.843505859375, "vf_explained_var": 0.1382119059562683, "kl": 0.07752218097448349, "entropy": -0.03983670845627785, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11034, "done": false, "timesteps_total": 2481391, "episodes_total": 6529, "training_iteration": 229, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-26-03", "timestamp": 1585337163, "time_this_iter_s": 14.854854106903076, "time_total_s": 4070.943063020706, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159f620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fa60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4070.943063020706, "timesteps_since_restore": 2481391, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 37.05714285714286, "ram_util_percent": 87.41904761904763}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 33.0, "episode_len_mean": 409.18, "episodes_this_iter": 26, "policy_reward_mean": {"av": 16.097560975609756}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4746823831211175, "avg_speed_min": 2.625378668133844, "avg_speed_max": 5.491136665633053, "avg_rl_veh_arrival_mean": 237.5366666666667, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.568773160843854, "mean_processing_ms": 3.426691137946082, "mean_inference_ms": 0.3970119423559335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2492672, "num_steps_sampled": 2492672, "sample_time_ms": 15439.397, "grad_time_ms": 145.862, "update_time_ms": 10.357, "opt_peak_throughput": 75699.056, "sample_peak_throughput": 715.157, "opt_samples": 11041.6, "learner": {"av": {"cur_kl_coeff": 2.796650244718535e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3244.809814453125, "policy_loss": -12.374669075012207, "vf_loss": 3257.1826171875, "vf_explained_var": 0.05849289894104004, "kl": 0.009233454242348671, "entropy": 0.2219899296760559, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11281, "done": false, "timesteps_total": 2492672, "episodes_total": 6555, "training_iteration": 230, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-26-18", "timestamp": 1585337178, "time_this_iter_s": 15.15416431427002, "time_total_s": 4086.097227334976, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b6a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001179d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001178c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001177b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0019ebf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4086.097227334976, "timesteps_since_restore": 2492672, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 38.050000000000004, "ram_util_percent": 87.41818181818184}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 19.0, "episode_len_mean": 405.6, "episodes_this_iter": 30, "policy_reward_mean": {"av": 9.644670050761421}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.492886279289892, "avg_speed_min": 2.625378668133844, "avg_speed_max": 5.584330428052016, "avg_rl_veh_arrival_mean": 240.525, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.565843448323356, "mean_processing_ms": 3.4262813506189205, "mean_inference_ms": 0.39669464387350145}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2503990, "num_steps_sampled": 2503990, "sample_time_ms": 15444.41, "grad_time_ms": 146.803, "update_time_ms": 10.376, "opt_peak_throughput": 75751.326, "sample_peak_throughput": 720.034, "opt_samples": 11120.5, "learner": {"av": {"cur_kl_coeff": 2.796650244718535e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3251.29248046875, "policy_loss": -3.7622053623199463, "vf_loss": 3255.05419921875, "vf_explained_var": 0.09240168333053589, "kl": 0.028623435646295547, "entropy": 0.32873448729515076, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11318, "done": false, "timesteps_total": 2503990, "episodes_total": 6585, "training_iteration": 231, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-26-36", "timestamp": 1585337196, "time_this_iter_s": 18.050549030303955, "time_total_s": 4104.14777636528, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0019ee18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019e598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019eb70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019eea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00ab0158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4104.14777636528, "timesteps_since_restore": 2503990, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 33.95384615384616, "ram_util_percent": 87.47692307692306}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 12.5, "episode_len_mean": 396.18, "episodes_this_iter": 28, "policy_reward_mean": {"av": 6.218905472636816}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.490166340502392, "avg_speed_min": 2.625378668133844, "avg_speed_max": 5.584330428052016, "avg_rl_veh_arrival_mean": 234.41, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.563371744722073, "mean_processing_ms": 3.425245772752955, "mean_inference_ms": 0.39649464495031705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2514698, "num_steps_sampled": 2514698, "sample_time_ms": 15323.065, "grad_time_ms": 148.824, "update_time_ms": 9.979, "opt_peak_throughput": 74855.582, "sample_peak_throughput": 727.028, "opt_samples": 11140.3, "learner": {"av": {"cur_kl_coeff": 4.194975034010895e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 1876.40869140625, "policy_loss": -8.216837882995605, "vf_loss": 1884.625732421875, "vf_explained_var": 0.12150508165359497, "kl": 0.0231105238199234, "entropy": 0.13251382112503052, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10708, "done": false, "timesteps_total": 2514698, "episodes_total": 6613, "training_iteration": 232, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-26-52", "timestamp": 1585337212, "time_this_iter_s": 15.634806871414185, "time_total_s": 4119.782583236694, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b6a8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b2f0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4119.782583236694, "timesteps_since_restore": 2514698, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 37.74782608695652, "ram_util_percent": 87.66086956521738}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 5.0, "episode_len_mean": 379.69, "episodes_this_iter": 32, "policy_reward_mean": {"av": 2.5510204081632653}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.462856744006348, "avg_speed_min": 2.641494704029036, "avg_speed_max": 5.584330428052016, "avg_rl_veh_arrival_mean": 223.01833333333332, "avg_rl_veh_arrival_min": 62.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.561686953333477, "mean_processing_ms": 3.425572980680302, "mean_inference_ms": 0.3963229021203554}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2525927, "num_steps_sampled": 2525927, "sample_time_ms": 15800.934, "grad_time_ms": 146.396, "update_time_ms": 9.881, "opt_peak_throughput": 76034.234, "sample_peak_throughput": 704.458, "opt_samples": 11131.1, "learner": {"av": {"cur_kl_coeff": 6.292462995105552e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3636.277587890625, "policy_loss": -0.3779151737689972, "vf_loss": 3636.654541015625, "vf_explained_var": 0.09807497262954712, "kl": 0.047053925693035126, "entropy": 0.49039435386657715, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11229, "done": false, "timesteps_total": 2525927, "episodes_total": 6645, "training_iteration": 233, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-27-12", "timestamp": 1585337232, "time_this_iter_s": 19.993879795074463, "time_total_s": 4139.776463031769, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0159fae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0159f620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0159fa60>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0159f8c8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4139.776463031769, "timesteps_since_restore": 2525927, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 44.8, "ram_util_percent": 88.05517241379312}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 3.0, "episode_len_mean": 384.13, "episodes_this_iter": 25, "policy_reward_mean": {"av": 1.4851485148514851}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.2, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.439330373401697, "avg_speed_min": 2.641494704029036, "avg_speed_max": 5.584330428052016, "avg_rl_veh_arrival_mean": 223.76666666666668, "avg_rl_veh_arrival_min": 62.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.5598073893534, "mean_processing_ms": 3.4249873462274376, "mean_inference_ms": 0.3960854085202065}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2536684, "num_steps_sampled": 2536684, "sample_time_ms": 15720.742, "grad_time_ms": 152.332, "update_time_ms": 9.822, "opt_peak_throughput": 72839.395, "sample_peak_throughput": 705.806, "opt_samples": 11095.8, "learner": {"av": {"cur_kl_coeff": 9.438694270613723e-09, "cur_lr": 9.999999747378752e-05, "total_loss": 3810.924072265625, "policy_loss": -6.437276363372803, "vf_loss": 3817.3603515625, "vf_explained_var": 0.06120175123214722, "kl": 0.03720208629965782, "entropy": 0.23130767047405243, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10757, "done": false, "timesteps_total": 2536684, "episodes_total": 6670, "training_iteration": 234, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-27-27", "timestamp": 1585337247, "time_this_iter_s": 14.838147163391113, "time_total_s": 4154.61461019516, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c002417b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c002410d0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00241840>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00220950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4154.61461019516, "timesteps_since_restore": 2536684, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 43.76666666666667, "ram_util_percent": 87.93809523809526}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": -2.5, "episode_len_mean": 382.99, "episodes_this_iter": 27, "policy_reward_mean": {"av": -1.243781094527363}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.375997614085584, "avg_speed_min": 2.641494704029036, "avg_speed_max": 5.53004603446682, "avg_rl_veh_arrival_mean": 234.13166666666663, "avg_rl_veh_arrival_min": 62.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.558250995498311, "mean_processing_ms": 3.4239866484191372, "mean_inference_ms": 0.39596571569468375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2547516, "num_steps_sampled": 2547516, "sample_time_ms": 15912.587, "grad_time_ms": 154.546, "update_time_ms": 10.106, "opt_peak_throughput": 71685.553, "sample_peak_throughput": 696.222, "opt_samples": 11078.7, "learner": {"av": {"cur_kl_coeff": 1.4158041850009795e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 2802.330322265625, "policy_loss": -4.990649700164795, "vf_loss": 2807.321044921875, "vf_explained_var": 0.05931544303894043, "kl": 0.39161059260368347, "entropy": 0.09673193842172623, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10832, "done": false, "timesteps_total": 2547516, "episodes_total": 6697, "training_iteration": 235, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-27-43", "timestamp": 1585337263, "time_this_iter_s": 15.487226724624634, "time_total_s": 4170.101836919785, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b0d0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150be18>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bf28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4170.101836919785, "timesteps_since_restore": 2547516, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 37.05, "ram_util_percent": 87.86818181818181}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -400.0, "episode_reward_mean": 0.0, "episode_len_mean": 389.14, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.0}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.387247532543606, "avg_speed_min": 2.356439601539326, "avg_speed_max": 5.53004603446682, "avg_rl_veh_arrival_mean": 237.73666666666668, "avg_rl_veh_arrival_min": 62.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.557132602340863, "mean_processing_ms": 3.4237531000137524, "mean_inference_ms": 0.3959137131440923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2558506, "num_steps_sampled": 2558506, "sample_time_ms": 16113.68, "grad_time_ms": 156.154, "update_time_ms": 10.536, "opt_peak_throughput": 70631.69, "sample_peak_throughput": 684.474, "opt_samples": 11029.4, "learner": {"av": {"cur_kl_coeff": 2.1237061886836273e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 3094.407958984375, "policy_loss": -9.856053352355957, "vf_loss": 3104.263427734375, "vf_explained_var": 0.10469585657119751, "kl": 0.012690568342804909, "entropy": 0.14893534779548645, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10990, "done": false, "timesteps_total": 2558506, "episodes_total": 6724, "training_iteration": 236, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-28-00", "timestamp": 1585337280, "time_this_iter_s": 17.190605401992798, "time_total_s": 4187.292442321777, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0019e510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0019eb70>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0019e598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001e9268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4187.292442321777, "timesteps_since_restore": 2558506, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 33.584, "ram_util_percent": 87.81200000000001}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 14.0, "episode_len_mean": 392.8, "episodes_this_iter": 31, "policy_reward_mean": {"av": 6.666666666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.352465728205195, "avg_speed_min": 2.356439601539326, "avg_speed_max": 5.458480925730708, "avg_rl_veh_arrival_mean": 232.95, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.555378620667273, "mean_processing_ms": 3.4228064227254418, "mean_inference_ms": 0.3956860687870091}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2569534, "num_steps_sampled": 2569534, "sample_time_ms": 16487.305, "grad_time_ms": 154.436, "update_time_ms": 10.583, "opt_peak_throughput": 71328.789, "sample_peak_throughput": 668.132, "opt_samples": 11015.7, "learner": {"av": {"cur_kl_coeff": 2.1237061886836273e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 1862.8114013671875, "policy_loss": -13.433670997619629, "vf_loss": 1876.2451171875, "vf_explained_var": 0.10014224052429199, "kl": 0.03354276344180107, "entropy": 0.21933111548423767, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11028, "done": false, "timesteps_total": 2569534, "episodes_total": 6755, "training_iteration": 237, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-28-20", "timestamp": 1585337300, "time_this_iter_s": 18.990015745162964, "time_total_s": 4206.28245806694, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001e9048>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e96a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e9bf8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4206.28245806694, "timesteps_since_restore": 2569534, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 33.15925925925926, "ram_util_percent": 87.79629629629628}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 2.0, "episode_len_mean": 357.42, "episodes_this_iter": 31, "policy_reward_mean": {"av": 0.9433962264150944}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.16, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.318194739698747, "avg_speed_min": 2.356439601539326, "avg_speed_max": 5.458480925730708, "avg_rl_veh_arrival_mean": 223.26166666666666, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.554088597049752, "mean_processing_ms": 3.4232348133433272, "mean_inference_ms": 0.3955455496706595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2579887, "num_steps_sampled": 2579887, "sample_time_ms": 16584.23, "grad_time_ms": 159.467, "update_time_ms": 10.7, "opt_peak_throughput": 68685.034, "sample_peak_throughput": 660.447, "opt_samples": 10953.0, "learner": {"av": {"cur_kl_coeff": 3.185559194207599e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 2656.94189453125, "policy_loss": -2.9119949340820312, "vf_loss": 2659.851806640625, "vf_explained_var": 0.11977219581604004, "kl": 0.7045232057571411, "entropy": 0.2833654582500458, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10353, "done": false, "timesteps_total": 2579887, "episodes_total": 6786, "training_iteration": 238, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-28-37", "timestamp": 1585337317, "time_this_iter_s": 17.475618839263916, "time_total_s": 4223.758076906204, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c00156bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c00241510>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c002410d0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150ba60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4223.758076906204, "timesteps_since_restore": 2579887, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 34.207692307692305, "ram_util_percent": 87.77307692307694}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -17.0, "episode_len_mean": 329.36, "episodes_this_iter": 36, "policy_reward_mean": {"av": -7.798165137614679}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.273254119696007, "avg_speed_min": 2.694701501724064, "avg_speed_max": 5.488637789400489, "avg_rl_veh_arrival_mean": 231.61166666666665, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.550951749878248, "mean_processing_ms": 3.4272653539231293, "mean_inference_ms": 0.3948052118306697}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2590717, "num_steps_sampled": 2590717, "sample_time_ms": 17161.342, "grad_time_ms": 159.236, "update_time_ms": 11.67, "opt_peak_throughput": 68656.79, "sample_peak_throughput": 637.048, "opt_samples": 10932.6, "learner": {"av": {"cur_kl_coeff": 4.778339146582766e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 4866.61962890625, "policy_loss": 5.380790710449219, "vf_loss": 4861.23779296875, "vf_explained_var": 0.03693342208862305, "kl": 0.10007184743881226, "entropy": 0.5449213981628418, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10830, "done": false, "timesteps_total": 2590717, "episodes_total": 6822, "training_iteration": 239, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-28-58", "timestamp": 1585337338, "time_this_iter_s": 20.628364324569702, "time_total_s": 4244.386441230774, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150bc80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00212598>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4244.386441230774, "timesteps_since_restore": 2590717, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 31.900000000000002, "ram_util_percent": 87.78620689655176}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -19.5, "episode_len_mean": 334.95, "episodes_this_iter": 29, "policy_reward_mean": {"av": -9.375}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2540415576512665, "avg_speed_min": 2.583505395928087, "avg_speed_max": 5.488637789400489, "avg_rl_veh_arrival_mean": 227.985, "avg_rl_veh_arrival_min": 65.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.550795691920142, "mean_processing_ms": 3.4285506417610856, "mean_inference_ms": 0.3949907149660973}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2602045, "num_steps_sampled": 2602045, "sample_time_ms": 17354.492, "grad_time_ms": 155.106, "update_time_ms": 11.476, "opt_peak_throughput": 70514.842, "sample_peak_throughput": 630.229, "opt_samples": 10937.3, "learner": {"av": {"cur_kl_coeff": 7.167508186967098e-08, "cur_lr": 9.999999747378752e-05, "total_loss": 2663.833984375, "policy_loss": -0.9280371069908142, "vf_loss": 2664.761474609375, "vf_explained_var": 0.14127206802368164, "kl": 15.341401100158691, "entropy": -0.04688495770096779, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11328, "done": false, "timesteps_total": 2602045, "episodes_total": 6851, "training_iteration": 240, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-29-15", "timestamp": 1585337355, "time_this_iter_s": 17.040706396102905, "time_total_s": 4261.427147626877, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b8c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027bc80>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027ba60>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00180730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4261.427147626877, "timesteps_since_restore": 2602045, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 36.02, "ram_util_percent": 87.83600000000003}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": -10.0, "episode_len_mean": 362.94, "episodes_this_iter": 30, "policy_reward_mean": {"av": -4.761904761904762}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.18, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.305548373231141, "avg_speed_min": 2.583505395928087, "avg_speed_max": 5.488637789400489, "avg_rl_veh_arrival_mean": 232.16, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.549862762990224, "mean_processing_ms": 3.430325597628084, "mean_inference_ms": 0.3947208029024952}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2613453, "num_steps_sampled": 2613453, "sample_time_ms": 17316.23, "grad_time_ms": 155.098, "update_time_ms": 12.512, "opt_peak_throughput": 70576.566, "sample_peak_throughput": 632.141, "opt_samples": 10946.3, "learner": {"av": {"cur_kl_coeff": 1.0751262635722014e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2705.543701171875, "policy_loss": -11.472599029541016, "vf_loss": 2717.015869140625, "vf_explained_var": 0.1114952564239502, "kl": 0.17756666243076324, "entropy": 0.21900296211242676, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11408, "done": false, "timesteps_total": 2613453, "episodes_total": 6881, "training_iteration": 241, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-29-33", "timestamp": 1585337373, "time_this_iter_s": 17.679381608963013, "time_total_s": 4279.10652923584, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00180950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001808c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e7048>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e7268>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016ad08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4279.10652923584, "timesteps_since_restore": 2613453, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 37.524, "ram_util_percent": 87.82799999999999}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 4.0, "episode_len_mean": 385.17, "episodes_this_iter": 24, "policy_reward_mean": {"av": 2.0}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.41775776910543, "avg_speed_min": 2.583505395928087, "avg_speed_max": 5.6179780307164515, "avg_rl_veh_arrival_mean": 232.465, "avg_rl_veh_arrival_min": 78.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.5484410610313155, "mean_processing_ms": 3.4282088411907363, "mean_inference_ms": 0.39453703362382647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2624417, "num_steps_sampled": 2624417, "sample_time_ms": 17240.012, "grad_time_ms": 146.828, "update_time_ms": 12.851, "opt_peak_throughput": 74726.036, "sample_peak_throughput": 636.421, "opt_samples": 10971.9, "learner": {"av": {"cur_kl_coeff": 1.612689430885439e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2253.671142578125, "policy_loss": -3.2933740615844727, "vf_loss": 2256.965087890625, "vf_explained_var": 0.12448018789291382, "kl": 16.422121047973633, "entropy": 0.09753484278917313, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10964, "done": false, "timesteps_total": 2624417, "episodes_total": 6905, "training_iteration": 242, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-29-48", "timestamp": 1585337388, "time_this_iter_s": 14.793630123138428, "time_total_s": 4293.900159358978, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027be18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0150bbf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4293.900159358978, "timesteps_since_restore": 2624417, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 36.73636363636363, "ram_util_percent": 87.87727272727274}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 18.5, "episode_len_mean": 401.8, "episodes_this_iter": 29, "policy_reward_mean": {"av": 9.113300492610838}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4615573784429055, "avg_speed_min": 2.583505395928087, "avg_speed_max": 5.6179780307164515, "avg_rl_veh_arrival_mean": 226.185, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.545610075291546, "mean_processing_ms": 3.426074385094738, "mean_inference_ms": 0.3943979912457351}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2635178, "num_steps_sampled": 2635178, "sample_time_ms": 16688.849, "grad_time_ms": 147.125, "update_time_ms": 12.051, "opt_peak_throughput": 74257.285, "sample_peak_throughput": 654.635, "opt_samples": 10925.1, "learner": {"av": {"cur_kl_coeff": 2.419034217382432e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 3699.5224609375, "policy_loss": -5.390327453613281, "vf_loss": 3704.9169921875, "vf_explained_var": 0.0798225998878479, "kl": 0.014125104062259197, "entropy": 0.010978428646922112, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10761, "done": false, "timesteps_total": 2635178, "episodes_total": 6934, "training_iteration": 243, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-30-03", "timestamp": 1585337403, "time_this_iter_s": 14.47939157485962, "time_total_s": 4308.379550933838, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150b510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b1e0>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b158>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00156598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4308.379550933838, "timesteps_since_restore": 2635178, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 37.37142857142857, "ram_util_percent": 87.7809523809524}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 7.0, "episode_len_mean": 393.27, "episodes_this_iter": 27, "policy_reward_mean": {"av": 3.5}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.509694214219035, "avg_speed_min": 2.8369537522861448, "avg_speed_max": 5.675508846437255, "avg_rl_veh_arrival_mean": 238.44833333333335, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.5445213288457005, "mean_processing_ms": 3.425320831936877, "mean_inference_ms": 0.39413765512036997}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2645905, "num_steps_sampled": 2645905, "sample_time_ms": 17256.165, "grad_time_ms": 152.656, "update_time_ms": 11.12, "opt_peak_throughput": 71547.214, "sample_peak_throughput": 632.939, "opt_samples": 10922.1, "learner": {"av": {"cur_kl_coeff": 2.419034217382432e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2594.647216796875, "policy_loss": -3.0329017639160156, "vf_loss": 2597.679443359375, "vf_explained_var": 0.041873931884765625, "kl": 15.9087495803833, "entropy": 0.054253436625003815, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10727, "done": false, "timesteps_total": 2645905, "episodes_total": 6961, "training_iteration": 244, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-30-24", "timestamp": 1585337424, "time_this_iter_s": 20.57381772994995, "time_total_s": 4328.953368663788, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c00156510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001e9840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001e9378>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c001e96a8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4328.953368663788, "timesteps_since_restore": 2645905, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 45.29655172413793, "ram_util_percent": 87.8793103448276}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 6.0, "episode_len_mean": 387.48, "episodes_this_iter": 31, "policy_reward_mean": {"av": 3.076923076923077}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.432409227693394, "avg_speed_min": 2.045278246863479, "avg_speed_max": 5.675508846437255, "avg_rl_veh_arrival_mean": 232.26, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.54640802279537, "mean_processing_ms": 3.4268143894697682, "mean_inference_ms": 0.39416106285289965}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2656964, "num_steps_sampled": 2656964, "sample_time_ms": 17809.542, "grad_time_ms": 154.504, "update_time_ms": 10.463, "opt_peak_throughput": 70838.257, "sample_peak_throughput": 614.547, "opt_samples": 10944.8, "learner": {"av": {"cur_kl_coeff": 3.6285510418565536e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2098.758056640625, "policy_loss": -6.830575466156006, "vf_loss": 2105.587646484375, "vf_explained_var": 0.13269412517547607, "kl": 0.059322163462638855, "entropy": 0.04447653517127037, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11059, "done": false, "timesteps_total": 2656964, "episodes_total": 6992, "training_iteration": 245, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-30-45", "timestamp": 1585337445, "time_this_iter_s": 21.03668212890625, "time_total_s": 4349.990050792694, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bbf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150b268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b8c8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150bc80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0027b6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4349.990050792694, "timesteps_since_restore": 2656964, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 40.119354838709675, "ram_util_percent": 87.87096774193552}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 16.5, "episode_len_mean": 395.86, "episodes_this_iter": 27, "policy_reward_mean": {"av": 8.208955223880597}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.14, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.432580117650408, "avg_speed_min": 2.045278246863479, "avg_speed_max": 5.675508846437255, "avg_rl_veh_arrival_mean": 227.13833333333332, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.547014423210666, "mean_processing_ms": 3.4259347549918915, "mean_inference_ms": 0.3940605875124912}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2668246, "num_steps_sampled": 2668246, "sample_time_ms": 17815.922, "grad_time_ms": 170.092, "update_time_ms": 10.653, "opt_peak_throughput": 64517.949, "sample_peak_throughput": 615.966, "opt_samples": 10974.0, "learner": {"av": {"cur_kl_coeff": 5.442826704893378e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 1788.0877685546875, "policy_loss": -13.37624454498291, "vf_loss": 1801.463623046875, "vf_explained_var": 0.09107130765914917, "kl": 0.31238633394241333, "entropy": 0.0002876572252716869, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11282, "done": false, "timesteps_total": 2668246, "episodes_total": 7019, "training_iteration": 246, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-31-03", "timestamp": 1585337463, "time_this_iter_s": 17.421318531036377, "time_total_s": 4367.4113693237305, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027b400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027bae8>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027bc80>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c0016a048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4367.4113693237305, "timesteps_since_restore": 2668246, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 48.995999999999995, "ram_util_percent": 87.984}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 24.5, "episode_len_mean": 403.3, "episodes_this_iter": 27, "policy_reward_mean": {"av": 12.5}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4280496331621295, "avg_speed_min": 2.045278246863479, "avg_speed_max": 5.675508846437255, "avg_rl_veh_arrival_mean": 230.56333333333333, "avg_rl_veh_arrival_min": 109.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.549453702237282, "mean_processing_ms": 3.426397271947881, "mean_inference_ms": 0.39421298412892525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2679512, "num_steps_sampled": 2679512, "sample_time_ms": 17860.279, "grad_time_ms": 175.222, "update_time_ms": 10.087, "opt_peak_throughput": 62765.072, "sample_peak_throughput": 615.769, "opt_samples": 10997.8, "learner": {"av": {"cur_kl_coeff": 8.164240057340066e-07, "cur_lr": 9.999999747378752e-05, "total_loss": 2527.79833984375, "policy_loss": -13.205754280090332, "vf_loss": 2541.003662109375, "vf_explained_var": 0.07796114683151245, "kl": 0.08495120704174042, "entropy": 0.07754351198673248, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11266, "done": false, "timesteps_total": 2679512, "episodes_total": 7046, "training_iteration": 247, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-31-35", "timestamp": 1585337495, "time_this_iter_s": 19.473265647888184, "time_total_s": 4386.884634971619, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0016abf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0016ad90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0016a950>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0016a7b8>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001ae620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4386.884634971619, "timesteps_since_restore": 2679512, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 39.31739130434782, "ram_util_percent": 88.89565217391304}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 29.0, "episode_len_mean": 416.05, "episodes_this_iter": 25, "policy_reward_mean": {"av": 15.675675675675675}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.426671913692569, "avg_speed_min": 2.045278246863479, "avg_speed_max": 5.631072357043554, "avg_rl_veh_arrival_mean": 217.32333333333335, "avg_rl_veh_arrival_min": 109.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.550647686936293, "mean_processing_ms": 3.4247882737117465, "mean_inference_ms": 0.3943651548027185}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2690318, "num_steps_sampled": 2690318, "sample_time_ms": 17596.356, "grad_time_ms": 164.398, "update_time_ms": 9.884, "opt_peak_throughput": 67173.035, "sample_peak_throughput": 627.579, "opt_samples": 11043.1, "learner": {"av": {"cur_kl_coeff": 1.2246359801793005e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 1717.983642578125, "policy_loss": -10.890884399414062, "vf_loss": 1728.8743896484375, "vf_explained_var": 0.1214190125465393, "kl": 0.16212186217308044, "entropy": 0.07334934920072556, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10806, "done": false, "timesteps_total": 2690318, "episodes_total": 7071, "training_iteration": 248, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-31-50", "timestamp": 1585337510, "time_this_iter_s": 14.72156310081482, "time_total_s": 4401.6061980724335, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0027bea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0027b6a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0027b598>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0027b950>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c00212f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4401.6061980724335, "timesteps_since_restore": 2690318, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 44.36363636363637, "ram_util_percent": 90.10454545454546}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.5, "episode_len_mean": 390.77, "episodes_this_iter": 31, "policy_reward_mean": {"av": 4.271356783919598}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.17, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.347552836305704, "avg_speed_min": 2.81942167888664, "avg_speed_max": 5.631072357043554, "avg_rl_veh_arrival_mean": 222.06333333333333, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.552468438200172, "mean_processing_ms": 3.424242221337465, "mean_inference_ms": 0.39450532533818}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2701249, "num_steps_sampled": 2701249, "sample_time_ms": 17303.067, "grad_time_ms": 165.713, "update_time_ms": 9.602, "opt_peak_throughput": 66700.689, "sample_peak_throughput": 638.8, "opt_samples": 11053.2, "learner": {"av": {"cur_kl_coeff": 1.8369539702689508e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 3895.207763671875, "policy_loss": 4.651881694793701, "vf_loss": 3890.556396484375, "vf_explained_var": 0.06421661376953125, "kl": 0.24107369780540466, "entropy": 0.5425416827201843, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10931, "done": false, "timesteps_total": 2701249, "episodes_total": 7102, "training_iteration": 249, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-32-08", "timestamp": 1585337528, "time_this_iter_s": 17.7197003364563, "time_total_s": 4419.32589840889, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c0150bc80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c0150ba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c0150b158>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c0150b1e0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001d66a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4419.32589840889, "timesteps_since_restore": 2701249, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 38.751999999999995, "ram_util_percent": 89.67999999999998}, "num_healthy_workers": 8, "trial_id": "0392d746"}
{"episode_reward_max": 150.0, "episode_reward_min": -300.0, "episode_reward_mean": 8.0, "episode_len_mean": 391.0, "episodes_this_iter": 27, "policy_reward_mean": {"av": 4.166666666666667}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.19, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.342059684233887, "avg_speed_min": 2.893826173584512, "avg_speed_max": 5.631072357043554, "avg_rl_veh_arrival_mean": 214.03333333333336, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 4.5526153272233305, "mean_processing_ms": 3.4237698728096837, "mean_inference_ms": 0.39451642010663235}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2711897, "num_steps_sampled": 2711897, "sample_time_ms": 17119.726, "grad_time_ms": 168.902, "update_time_ms": 9.575, "opt_peak_throughput": 65038.828, "sample_peak_throughput": 641.669, "opt_samples": 10985.2, "learner": {"av": {"cur_kl_coeff": 2.755431069090264e-06, "cur_lr": 9.999999747378752e-05, "total_loss": 2407.788818359375, "policy_loss": -8.027776718139648, "vf_loss": 2415.816162109375, "vf_explained_var": 0.1338646411895752, "kl": 0.06122028827667236, "entropy": 0.03220083937048912, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 10648, "done": true, "timesteps_total": 2711897, "episodes_total": 7129, "training_iteration": 250, "experiment_id": "735ee91dcf924820b05fd0d8d4679a63", "date": "2020-03-27_12-32-23", "timestamp": 1585337543, "time_this_iter_s": 15.239644050598145, "time_total_s": 4434.565542459488, "pid": 12002, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f3c001d6d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f3c001d6488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f3c001d6e18>)", "on_sample_end": null, "on_train_result": "tune.function(<function setup_exps_PPO.<locals>.on_train_result at 0x7f3c00242ea0>)", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f3c001cc8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4434.565542459488, "timesteps_since_restore": 2711897, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 36.845454545454544, "ram_util_percent": 89.59090909090907}, "num_healthy_workers": 8, "trial_id": "0392d746"}
