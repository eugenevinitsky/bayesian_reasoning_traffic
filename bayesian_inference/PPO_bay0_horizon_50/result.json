{"episode_reward_max": 0.32343792198036714, "episode_reward_min": -2.998507125375799, "episode_reward_mean": -1.3416514544600653, "episode_len_mean": 336.1304347826087, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.998507125375799}, "policy_reward_max": {"av": 0.32343792198036714}, "policy_reward_mean": {"av": -1.3416514544600653}, "custom_metrics": {"num_ped_collisions_mean": 0.43478260869565216, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08695652173913043, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.87454006603189, "avg_speed_min": 1.5950977486051108, "avg_speed_max": 4.117759152446714, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.10512574633225, "mean_processing_ms": 3.5480050070004236, "mean_inference_ms": 0.5656881175956429}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10612, "num_steps_sampled": 10612, "sample_time_ms": 40016.693, "grad_time_ms": 2838.007, "update_time_ms": 325.948, "opt_peak_throughput": 3739.244, "sample_peak_throughput": 265.189, "opt_samples": 10612.0, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 0.12932708859443665, "policy_loss": -0.01616617850959301, "vf_loss": 0.14376267790794373, "vf_explained_var": 0.4483630657196045, "kl": 0.008652969263494015, "entropy": 1.4625589847564697, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10612, "done": false, "timesteps_total": 10612, "episodes_total": 23, "training_iteration": 1, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-42-05", "timestamp": 1588783325, "time_this_iter_s": 43.20353317260742, "time_total_s": 43.20353317260742, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714730>", "on_episode_step": "<function on_episode_step at 0x7f5984675840>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 43.20353317260742, "timesteps_since_restore": 10612, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 81.71129032258067, "ram_util_percent": 31.883870967741935}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3234961114709922, "episode_reward_min": -2.998531068483192, "episode_reward_mean": -1.3309046531132336, "episode_len_mean": 339.54716981132077, "episodes_this_iter": 30, "policy_reward_min": {"av": -2.998531068483192}, "policy_reward_max": {"av": 0.3234961114709922}, "policy_reward_mean": {"av": -1.3309046531132336}, "custom_metrics": {"num_ped_collisions_mean": 0.4528301886792453, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03773584905660377, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9308233006127424, "avg_speed_min": 1.384296100343981, "avg_speed_max": 4.39192477448195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.354467593679985, "mean_processing_ms": 3.599856371135624, "mean_inference_ms": 0.5897293257863159}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21299, "num_steps_sampled": 21299, "sample_time_ms": 37130.159, "grad_time_ms": 2948.6, "update_time_ms": 165.885, "opt_peak_throughput": 3611.714, "sample_peak_throughput": 286.815, "opt_samples": 10649.5, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 0.009433910250663757, "policy_loss": -0.010927442461252213, "vf_loss": 0.018853168934583664, "vf_explained_var": 0.9136695861816406, "kl": 0.007540928199887276, "entropy": 1.4847826957702637, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10687, "done": false, "timesteps_total": 21299, "episodes_total": 53, "training_iteration": 2, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-42-42", "timestamp": 1588783362, "time_this_iter_s": 37.32004714012146, "time_total_s": 80.52358031272888, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846769d8>", "on_episode_step": "<function on_episode_step at 0x7f59846760d0>", "on_episode_end": "<function on_episode_end at 0x7f59846e1950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460dea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 80.52358031272888, "timesteps_since_restore": 21299, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 79.72592592592594, "ram_util_percent": 33.39444444444445}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3234961114709922, "episode_reward_min": -2.998648856907221, "episode_reward_mean": -1.545648609365841, "episode_len_mean": 315.82978723404256, "episodes_this_iter": 41, "policy_reward_min": {"av": -2.998648856907221}, "policy_reward_max": {"av": 0.3234961114709922}, "policy_reward_mean": {"av": -1.545648609365841}, "custom_metrics": {"num_ped_collisions_mean": 0.5319148936170213, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02127659574468085, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.121782523738258, "avg_speed_min": 1.384296100343981, "avg_speed_max": 4.39192477448195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.59374314390892, "mean_processing_ms": 3.8516667981046906, "mean_inference_ms": 0.5702293233689681}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32901, "num_steps_sampled": 32901, "sample_time_ms": 35620.624, "grad_time_ms": 2809.911, "update_time_ms": 112.787, "opt_peak_throughput": 3902.971, "sample_peak_throughput": 307.883, "opt_samples": 10967.0, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 0.001780382706783712, "policy_loss": -0.0036745346151292324, "vf_loss": 0.004467624705284834, "vf_explained_var": 0.9923756122589111, "kl": 0.004936446901410818, "entropy": 1.5073204040527344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11602, "done": false, "timesteps_total": 32901, "episodes_total": 94, "training_iteration": 3, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-43-18", "timestamp": 1588783398, "time_this_iter_s": 35.15197825431824, "time_total_s": 115.67555856704712, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676048>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f5984675840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 115.67555856704712, "timesteps_since_restore": 32901, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.304, "ram_util_percent": 33.396}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32371767829469034, "episode_reward_min": -2.998648856907221, "episode_reward_mean": -1.5156636304250324, "episode_len_mean": 317.42, "episodes_this_iter": 31, "policy_reward_min": {"av": -2.998648856907221}, "policy_reward_max": {"av": 0.32371767829469034}, "policy_reward_mean": {"av": -1.5156636304250324}, "custom_metrics": {"num_ped_collisions_mean": 0.54, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.282518113264287, "avg_speed_min": 1.384296100343981, "avg_speed_max": 4.39192477448195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.21313835405378, "mean_processing_ms": 3.998118327345253, "mean_inference_ms": 0.5596029644374692}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43813, "num_steps_sampled": 43813, "sample_time_ms": 34602.342, "grad_time_ms": 2776.105, "update_time_ms": 86.019, "opt_peak_throughput": 3945.546, "sample_peak_throughput": 316.546, "opt_samples": 10953.25, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004464973695576191, "policy_loss": -0.008544430136680603, "vf_loss": 0.003112388076260686, "vf_explained_var": 0.9920902252197266, "kl": 0.009670729748904705, "entropy": 1.4783656597137451, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10912, "done": false, "timesteps_total": 43813, "episodes_total": 125, "training_iteration": 4, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-43-52", "timestamp": 1588783432, "time_this_iter_s": 34.23922896385193, "time_total_s": 149.91478753089905, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846769d8>", "on_episode_step": "<function on_episode_step at 0x7f5984675268>", "on_episode_end": "<function on_episode_end at 0x7f5984675b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 149.91478753089905, "timesteps_since_restore": 43813, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 80.02448979591837, "ram_util_percent": 33.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3237550585908865, "episode_reward_min": -2.998648856907221, "episode_reward_mean": -1.5044485967284438, "episode_len_mean": 310.64, "episodes_this_iter": 36, "policy_reward_min": {"av": -2.998648856907221}, "policy_reward_max": {"av": 0.3237550585908865}, "policy_reward_mean": {"av": -1.5044485967284438}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.585043293284363, "avg_speed_min": 1.641961125107654, "avg_speed_max": 4.416234493999689, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.72607546227145, "mean_processing_ms": 4.11519908955741, "mean_inference_ms": 0.5277350737585239}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55024, "num_steps_sampled": 55024, "sample_time_ms": 32940.136, "grad_time_ms": 2567.95, "update_time_ms": 69.97, "opt_peak_throughput": 4285.442, "sample_peak_throughput": 334.085, "opt_samples": 11004.8, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 0.15925176441669464, "policy_loss": -0.00331668509170413, "vf_loss": 0.16202902793884277, "vf_explained_var": 0.7597554922103882, "kl": 0.005394299980252981, "entropy": 1.4777379035949707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11211, "done": false, "timesteps_total": 55024, "episodes_total": 161, "training_iteration": 5, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-44-20", "timestamp": 1588783460, "time_this_iter_s": 28.043254613876343, "time_total_s": 177.9580421447754, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984714730>", "on_episode_end": "<function on_episode_end at 0x7f5984675048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 177.9580421447754, "timesteps_since_restore": 55024, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 73.045, "ram_util_percent": 33.4}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3237550585908865, "episode_reward_min": -2.99862419472531, "episode_reward_mean": -1.260761061295175, "episode_len_mean": 334.33, "episodes_this_iter": 31, "policy_reward_min": {"av": -2.99862419472531}, "policy_reward_max": {"av": 0.3237550585908865}, "policy_reward_mean": {"av": -1.260761061295175}, "custom_metrics": {"num_ped_collisions_mean": 0.46, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.706035670004786, "avg_speed_min": 2.0512648986920836, "avg_speed_max": 4.421015100326672, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.02963503167701, "mean_processing_ms": 4.026136280455778, "mean_inference_ms": 0.5159306743983378}, "off_policy_estimator": {}, "info": {"num_steps_trained": 66064, "num_steps_sampled": 66064, "sample_time_ms": 32008.316, "grad_time_ms": 2494.782, "update_time_ms": 59.446, "opt_peak_throughput": 4413.478, "sample_peak_throughput": 343.994, "opt_samples": 11010.667, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": -0.01626773178577423, "policy_loss": -0.020944776013493538, "vf_loss": 0.00415513850748539, "vf_explained_var": 0.9281392693519592, "kl": 0.005219058133661747, "entropy": 1.4368126392364502, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11040, "done": false, "timesteps_total": 66064, "episodes_total": 192, "training_iteration": 6, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-44-50", "timestamp": 1588783490, "time_this_iter_s": 29.49731945991516, "time_total_s": 207.45536160469055, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675268>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f59846e1a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 207.45536160469055, "timesteps_since_restore": 66064, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 75.8952380952381, "ram_util_percent": 33.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3237550585908865, "episode_reward_min": -2.9987405005834287, "episode_reward_mean": -1.2604598256043058, "episode_len_mean": 331.49, "episodes_this_iter": 33, "policy_reward_min": {"av": -2.9987405005834287}, "policy_reward_max": {"av": 0.3237550585908865}, "policy_reward_mean": {"av": -1.2604598256043058}, "custom_metrics": {"num_ped_collisions_mean": 0.45, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8089245146378734, "avg_speed_min": 2.933193167047683, "avg_speed_max": 4.421015100326672, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.896056996800944, "mean_processing_ms": 4.0148004189792115, "mean_inference_ms": 0.4932292718689293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 77027, "num_steps_sampled": 77027, "sample_time_ms": 31303.526, "grad_time_ms": 2406.309, "update_time_ms": 51.831, "opt_peak_throughput": 4572.919, "sample_peak_throughput": 351.521, "opt_samples": 11003.857, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09713750332593918, "policy_loss": -0.00370628759264946, "vf_loss": 0.10047966241836548, "vf_explained_var": 0.819399356842041, "kl": 0.003641247283667326, "entropy": 1.4426029920578003, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10963, "done": false, "timesteps_total": 77027, "episodes_total": 225, "training_iteration": 7, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-45-19", "timestamp": 1588783519, "time_this_iter_s": 28.96789240837097, "time_total_s": 236.42325401306152, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714730>", "on_episode_step": "<function on_episode_step at 0x7f5984675b70>", "on_episode_end": "<function on_episode_end at 0x7f5984675a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 236.42325401306152, "timesteps_since_restore": 77027, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 73.28809523809525, "ram_util_percent": 33.407142857142865}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236909952503514, "episode_reward_min": -2.9987405005834287, "episode_reward_mean": -1.288691111289359, "episode_len_mean": 332.34, "episodes_this_iter": 36, "policy_reward_min": {"av": -2.9987405005834287}, "policy_reward_max": {"av": 0.3236909952503514}, "policy_reward_mean": {"av": -1.288691111289359}, "custom_metrics": {"num_ped_collisions_mean": 0.47, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7952165260568647, "avg_speed_min": 2.933193167047683, "avg_speed_max": 4.629336320615554, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.857290028748583, "mean_processing_ms": 4.0374166558512625, "mean_inference_ms": 0.4705430977913255}, "off_policy_estimator": {}, "info": {"num_steps_trained": 87999, "num_steps_sampled": 87999, "sample_time_ms": 30535.417, "grad_time_ms": 2321.625, "update_time_ms": 46.06, "opt_peak_throughput": 4738.007, "sample_peak_throughput": 360.233, "opt_samples": 10999.875, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03957077115774155, "policy_loss": -0.0022197009529918432, "vf_loss": 0.04165732115507126, "vf_explained_var": 0.9425367116928101, "kl": 0.0026630982756614685, "entropy": 1.4403620958328247, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10972, "done": false, "timesteps_total": 87999, "episodes_total": 261, "training_iteration": 8, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-45-46", "timestamp": 1588783546, "time_this_iter_s": 26.904634475708008, "time_total_s": 263.32788848876953, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984675268>", "on_episode_end": "<function on_episode_end at 0x7f59846e1a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 263.32788848876953, "timesteps_since_restore": 87999, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 73.93157894736844, "ram_util_percent": 33.40000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236691114160262, "episode_reward_min": -2.9987405005834287, "episode_reward_mean": -1.4879945038703934, "episode_len_mean": 312.72, "episodes_this_iter": 36, "policy_reward_min": {"av": -2.9987405005834287}, "policy_reward_max": {"av": 0.3236691114160262}, "policy_reward_mean": {"av": -1.4879945038703934}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.724528558026239, "avg_speed_min": 2.8328510652450087, "avg_speed_max": 4.629336320615554, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.088351448122516, "mean_processing_ms": 4.094855667489486, "mean_inference_ms": 0.4532283705845558}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99144, "num_steps_sampled": 99144, "sample_time_ms": 30252.478, "grad_time_ms": 2303.062, "update_time_ms": 41.615, "opt_peak_throughput": 4783.197, "sample_peak_throughput": 364.135, "opt_samples": 11016.0, "learner": {"av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0021550972014665604, "policy_loss": -0.004375450778752565, "vf_loss": 0.0020966625306755304, "vf_explained_var": 0.9967013001441956, "kl": 0.004947667010128498, "entropy": 1.387445092201233, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11145, "done": false, "timesteps_total": 99144, "episodes_total": 297, "training_iteration": 9, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-46-16", "timestamp": 1588783576, "time_this_iter_s": 30.16094422340393, "time_total_s": 293.48883271217346, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676f28>", "on_episode_step": "<function on_episode_step at 0x7f5984676158>", "on_episode_end": "<function on_episode_end at 0x7f5984676d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846769d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 293.48883271217346, "timesteps_since_restore": 99144, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 76.86279069767443, "ram_util_percent": 33.40232558139535}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236801714209333, "episode_reward_min": -2.9986796828418263, "episode_reward_mean": -1.3194687432026841, "episode_len_mean": 332.55, "episodes_this_iter": 30, "policy_reward_min": {"av": -2.9986796828418263}, "policy_reward_max": {"av": 0.3236801714209333}, "policy_reward_mean": {"av": -1.3194687432026841}, "custom_metrics": {"num_ped_collisions_mean": 0.49, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6496610272528596, "avg_speed_min": 2.399136518363938, "avg_speed_max": 4.629336320615554, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.77887002729156, "mean_processing_ms": 4.1044754375944414, "mean_inference_ms": 0.44672066062526666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110284, "num_steps_sampled": 110284, "sample_time_ms": 30300.116, "grad_time_ms": 2318.523, "update_time_ms": 38.014, "opt_peak_throughput": 4756.65, "sample_peak_throughput": 363.972, "opt_samples": 11028.4, "learner": {"av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-06, "total_loss": -0.006933221127837896, "policy_loss": -0.009343789890408516, "vf_loss": 0.0019885480869561434, "vf_explained_var": 0.9649336338043213, "kl": 0.03376194089651108, "entropy": 1.515194058418274, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11140, "done": false, "timesteps_total": 110284, "episodes_total": 327, "training_iteration": 10, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-46-49", "timestamp": 1588783609, "time_this_iter_s": 33.20651888847351, "time_total_s": 326.695351600647, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f59846e1a60>", "on_episode_end": "<function on_episode_end at 0x7f59846e1950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846751e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 326.695351600647, "timesteps_since_restore": 110284, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.67500000000001, "ram_util_percent": 33.43958333333334}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236801714209333, "episode_reward_min": -2.9986796828418263, "episode_reward_mean": -1.4421402730718458, "episode_len_mean": 320.98, "episodes_this_iter": 35, "policy_reward_min": {"av": -2.9986796828418263}, "policy_reward_max": {"av": 0.3236801714209333}, "policy_reward_mean": {"av": -1.4421402730718458}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.546122259472651, "avg_speed_min": 2.399136518363938, "avg_speed_max": 4.2569248479990875, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.737771478590194, "mean_processing_ms": 4.1250428501194225, "mean_inference_ms": 0.4445738751871602}, "off_policy_estimator": {}, "info": {"num_steps_trained": 121530, "num_steps_sampled": 121530, "sample_time_ms": 29406.21, "grad_time_ms": 2288.993, "update_time_ms": 5.99, "opt_peak_throughput": 4845.712, "sample_peak_throughput": 377.192, "opt_samples": 11091.8, "learner": {"av": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0026479316875338554, "policy_loss": -0.004354534670710564, "vf_loss": 0.0015520204324275255, "vf_explained_var": 0.9964227080345154, "kl": 0.008244371972978115, "entropy": 1.521135926246643, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11246, "done": false, "timesteps_total": 121530, "episodes_total": 362, "training_iteration": 11, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-47-23", "timestamp": 1588783643, "time_this_iter_s": 33.63712501525879, "time_total_s": 360.33247661590576, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984676158>", "on_episode_end": "<function on_episode_end at 0x7f5984676f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846769d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 360.33247661590576, "timesteps_since_restore": 121530, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 78.27083333333333, "ram_util_percent": 33.45416666666667}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236801714209333, "episode_reward_min": -2.9986358806510465, "episode_reward_mean": -1.4421645484420702, "episode_len_mean": 321.2, "episodes_this_iter": 43, "policy_reward_min": {"av": -2.9986358806510465}, "policy_reward_max": {"av": 0.3236801714209333}, "policy_reward_mean": {"av": -1.4421645484420702}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.546375954766859, "avg_speed_min": 2.399136518363938, "avg_speed_max": 4.2569248479990875, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.495197026449322, "mean_processing_ms": 4.132004038457575, "mean_inference_ms": 0.4423517345031516}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133440, "num_steps_sampled": 133440, "sample_time_ms": 28564.637, "grad_time_ms": 2155.184, "update_time_ms": 6.036, "opt_peak_throughput": 5203.314, "sample_peak_throughput": 392.587, "opt_samples": 11214.1, "learner": {"av": {"cur_kl_coeff": 0.01875000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0029961145482957363, "policy_loss": 0.0027702052611857653, "vf_loss": 0.00015873824304435402, "vf_explained_var": 0.9998663663864136, "kl": 0.0035824854858219624, "entropy": 1.6502187252044678, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11910, "done": false, "timesteps_total": 133440, "episodes_total": 405, "training_iteration": 12, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-47-51", "timestamp": 1588783671, "time_this_iter_s": 27.566797256469727, "time_total_s": 387.8992738723755, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714730>", "on_episode_step": "<function on_episode_step at 0x7f59846e1950>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 387.8992738723755, "timesteps_since_restore": 133440, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.25641025641025, "ram_util_percent": 33.435897435897445}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32368938775839745, "episode_reward_min": -2.9986358806510465, "episode_reward_mean": -1.5313387649047205, "episode_len_mean": 311.96, "episodes_this_iter": 34, "policy_reward_min": {"av": -2.9986358806510465}, "policy_reward_max": {"av": 0.32368938775839745}, "policy_reward_mean": {"av": -1.5313387649047205}, "custom_metrics": {"num_ped_collisions_mean": 0.55, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.66107920942325, "avg_speed_min": 2.496383617084179, "avg_speed_max": 4.434697114234967, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.294175159931328, "mean_processing_ms": 4.135053554064699, "mean_inference_ms": 0.43916597975685845}, "off_policy_estimator": {}, "info": {"num_steps_trained": 144648, "num_steps_sampled": 144648, "sample_time_ms": 28038.304, "grad_time_ms": 2095.781, "update_time_ms": 5.896, "opt_peak_throughput": 5331.997, "sample_peak_throughput": 398.551, "opt_samples": 11174.7, "learner": {"av": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 0.07649557292461395, "policy_loss": -0.007261670660227537, "vf_loss": 0.08362404257059097, "vf_explained_var": 0.9189811944961548, "kl": 0.014209354296326637, "entropy": 1.6032676696777344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11208, "done": false, "timesteps_total": 144648, "episodes_total": 439, "training_iteration": 13, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-48-20", "timestamp": 1588783700, "time_this_iter_s": 29.29279375076294, "time_total_s": 417.1920676231384, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f5984675510>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 417.1920676231384, "timesteps_since_restore": 144648, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 74.1452380952381, "ram_util_percent": 33.476190476190474}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32368938775839745, "episode_reward_min": -2.998668024753903, "episode_reward_mean": -1.500773700256069, "episode_len_mean": 317.33, "episodes_this_iter": 30, "policy_reward_min": {"av": -2.998668024753903}, "policy_reward_max": {"av": 0.32368938775839745}, "policy_reward_mean": {"av": -1.500773700256069}, "custom_metrics": {"num_ped_collisions_mean": 0.54, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.614852351974829, "avg_speed_min": 2.3666269532890003, "avg_speed_max": 4.434697114234967, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.07732042786845, "mean_processing_ms": 4.15545441376182, "mean_inference_ms": 0.433867020815562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 155556, "num_steps_sampled": 155556, "sample_time_ms": 27885.967, "grad_time_ms": 2073.821, "update_time_ms": 5.982, "opt_peak_throughput": 5388.265, "sample_peak_throughput": 400.714, "opt_samples": 11174.3, "learner": {"av": {"cur_kl_coeff": 0.00937500037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 0.004486333578824997, "policy_loss": 7.47480517020449e-05, "vf_loss": 0.004374481271952391, "vf_explained_var": 0.9928041696548462, "kl": 0.003957944922149181, "entropy": 1.5864683389663696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10908, "done": false, "timesteps_total": 155556, "episodes_total": 469, "training_iteration": 14, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-48-53", "timestamp": 1588783733, "time_this_iter_s": 32.49668788909912, "time_total_s": 449.68875551223755, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984675950>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 449.68875551223755, "timesteps_since_restore": 155556, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 76.61063829787233, "ram_util_percent": 33.48297872340426}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32368938775839745, "episode_reward_min": -2.998668024753903, "episode_reward_mean": -1.2682351081671583, "episode_len_mean": 340.85, "episodes_this_iter": 34, "policy_reward_min": {"av": -2.998668024753903}, "policy_reward_max": {"av": 0.32368938775839745}, "policy_reward_mean": {"av": -1.2682351081671583}, "custom_metrics": {"num_ped_collisions_mean": 0.47, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.574138619586843, "avg_speed_min": 2.3666269532890003, "avg_speed_max": 4.434697114234967, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.064062067471106, "mean_processing_ms": 4.129231112485426, "mean_inference_ms": 0.43382787139049195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 166743, "num_steps_sampled": 166743, "sample_time_ms": 28119.866, "grad_time_ms": 2118.963, "update_time_ms": 5.96, "opt_peak_throughput": 5272.344, "sample_peak_throughput": 397.296, "opt_samples": 11171.9, "learner": {"av": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028079648036509752, "policy_loss": -0.003191830823197961, "vf_loss": 0.0003266923304181546, "vf_explained_var": 0.999352216720581, "kl": 0.012196422554552555, "entropy": 1.5374680757522583, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11187, "done": false, "timesteps_total": 166743, "episodes_total": 503, "training_iteration": 15, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-49-24", "timestamp": 1588783764, "time_this_iter_s": 30.833805561065674, "time_total_s": 480.5225610733032, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675488>", "on_episode_end": "<function on_episode_end at 0x7f5984675378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 480.5225610733032, "timesteps_since_restore": 166743, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 75.43636363636364, "ram_util_percent": 33.47727272727273}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236525925297607, "episode_reward_min": -2.998668024753903, "episode_reward_mean": -1.1891124542856266, "episode_len_mean": 351.24, "episodes_this_iter": 26, "policy_reward_min": {"av": -2.998668024753903}, "policy_reward_max": {"av": 0.3236525925297607}, "policy_reward_mean": {"av": -1.1891124542856266}, "custom_metrics": {"num_ped_collisions_mean": 0.45, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.455540840990472, "avg_speed_min": 1.8810834091623516, "avg_speed_max": 4.35752257645836, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.268869496236956, "mean_processing_ms": 4.069122363616402, "mean_inference_ms": 0.44200840143024217}, "off_policy_estimator": {}, "info": {"num_steps_trained": 177447, "num_steps_sampled": 177447, "sample_time_ms": 28729.232, "grad_time_ms": 2196.519, "update_time_ms": 5.838, "opt_peak_throughput": 5070.888, "sample_peak_throughput": 387.699, "opt_samples": 11138.3, "learner": {"av": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005724829155951738, "policy_loss": -0.007053343579173088, "vf_loss": 0.0012888610363006592, "vf_explained_var": 0.9803901314735413, "kl": 0.008458813652396202, "entropy": 1.5522469282150269, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10704, "done": false, "timesteps_total": 177447, "episodes_total": 529, "training_iteration": 16, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-50-00", "timestamp": 1588783800, "time_this_iter_s": 36.36403036117554, "time_total_s": 516.8865914344788, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675950>", "on_episode_step": "<function on_episode_step at 0x7f59846dc840>", "on_episode_end": "<function on_episode_end at 0x7f59846e1a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 516.8865914344788, "timesteps_since_restore": 177447, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 78.1403846153846, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32360236627911826, "episode_reward_min": -2.998689728364134, "episode_reward_mean": -1.1073706851009246, "episode_len_mean": 363.23, "episodes_this_iter": 33, "policy_reward_min": {"av": -2.998689728364134}, "policy_reward_max": {"av": 0.32360236627911826}, "policy_reward_mean": {"av": -1.1073706851009246}, "custom_metrics": {"num_ped_collisions_mean": 0.43, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3322608727569105, "avg_speed_min": 1.8810834091623516, "avg_speed_max": 4.35752257645836, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.420371013787356, "mean_processing_ms": 4.05621904408607, "mean_inference_ms": 0.4444904778225126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 188589, "num_steps_sampled": 188589, "sample_time_ms": 29052.365, "grad_time_ms": 2248.522, "update_time_ms": 5.757, "opt_peak_throughput": 4961.57, "sample_peak_throughput": 384.003, "opt_samples": 11156.2, "learner": {"av": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0472898930311203, "policy_loss": -0.0026105274446308613, "vf_loss": 0.049869097769260406, "vf_explained_var": 0.9644291400909424, "kl": 0.00668228417634964, "entropy": 1.619221806526184, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11142, "done": false, "timesteps_total": 188589, "episodes_total": 562, "training_iteration": 17, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-50-33", "timestamp": 1588783833, "time_this_iter_s": 32.71850299835205, "time_total_s": 549.6050944328308, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676730>", "on_episode_step": "<function on_episode_step at 0x7f5984676400>", "on_episode_end": "<function on_episode_end at 0x7f59846760d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846761e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 549.6050944328308, "timesteps_since_restore": 188589, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 77.80425531914895, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236587423500006, "episode_reward_min": -2.998689728364134, "episode_reward_mean": -1.4062664714594526, "episode_len_mean": 335.66, "episodes_this_iter": 38, "policy_reward_min": {"av": -2.998689728364134}, "policy_reward_max": {"av": 0.3236587423500006}, "policy_reward_mean": {"av": -1.4062664714594526}, "custom_metrics": {"num_ped_collisions_mean": 0.52, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.3578061442627654, "avg_speed_min": 1.8810834091623516, "avg_speed_max": 4.491666749002394, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.5784492792924, "mean_processing_ms": 4.054792812287373, "mean_inference_ms": 0.44691263440710566}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199978, "num_steps_sampled": 199978, "sample_time_ms": 29269.724, "grad_time_ms": 2275.767, "update_time_ms": 5.765, "opt_peak_throughput": 4920.495, "sample_peak_throughput": 382.576, "opt_samples": 11197.9, "learner": {"av": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-06, "total_loss": -0.00412884121760726, "policy_loss": -0.005239732097834349, "vf_loss": 0.0010840855538845062, "vf_explained_var": 0.9992884993553162, "kl": 0.005717373453080654, "entropy": 1.6523934602737427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11389, "done": false, "timesteps_total": 199978, "episodes_total": 600, "training_iteration": 18, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-51-03", "timestamp": 1588783863, "time_this_iter_s": 29.3499596118927, "time_total_s": 578.9550540447235, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f59846e1a60>", "on_episode_end": "<function on_episode_end at 0x7f59846e1950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 578.9550540447235, "timesteps_since_restore": 199978, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.92619047619048, "ram_util_percent": 33.49761904761905}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236587423500006, "episode_reward_min": -2.998689728364134, "episode_reward_mean": -1.4395219400272816, "episode_len_mean": 336.17, "episodes_this_iter": 29, "policy_reward_min": {"av": -2.998689728364134}, "policy_reward_max": {"av": 0.3236587423500006}, "policy_reward_mean": {"av": -1.4395219400272816}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.336215945960461, "avg_speed_min": 1.9980150300140411, "avg_speed_max": 4.491666749002394, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.53192584131234, "mean_processing_ms": 4.078003574841764, "mean_inference_ms": 0.4444347874731147}, "off_policy_estimator": {}, "info": {"num_steps_trained": 210572, "num_steps_sampled": 210572, "sample_time_ms": 29304.931, "grad_time_ms": 2289.369, "update_time_ms": 5.815, "opt_peak_throughput": 4867.192, "sample_peak_throughput": 380.236, "opt_samples": 11142.8, "learner": {"av": {"cur_kl_coeff": 0.004687500186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 0.1369229406118393, "policy_loss": -0.002633144846186042, "vf_loss": 0.13954362273216248, "vf_explained_var": 0.9103778600692749, "kl": 0.0026564267463982105, "entropy": 1.7066552639007568, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10594, "done": false, "timesteps_total": 210572, "episodes_total": 629, "training_iteration": 19, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-51-33", "timestamp": 1588783893, "time_this_iter_s": 30.650127172470093, "time_total_s": 609.6051812171936, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984676400>", "on_episode_end": "<function on_episode_end at 0x7f5984676730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846761e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 609.6051812171936, "timesteps_since_restore": 210572, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.175, "ram_util_percent": 33.497727272727275}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3236587423500006, "episode_reward_min": -2.9987351929530535, "episode_reward_mean": -1.4754979067661407, "episode_len_mean": 335.01, "episodes_this_iter": 31, "policy_reward_min": {"av": -2.9987351929530535}, "policy_reward_max": {"av": 0.3236587423500006}, "policy_reward_mean": {"av": -1.4754979067661407}, "custom_metrics": {"num_ped_collisions_mean": 0.54, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.353094674852444, "avg_speed_min": 1.9638156118108552, "avg_speed_max": 4.491666749002394, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.438183540184514, "mean_processing_ms": 4.074111496121064, "mean_inference_ms": 0.443728423724307}, "off_policy_estimator": {}, "info": {"num_steps_trained": 221479, "num_steps_sampled": 221479, "sample_time_ms": 29167.685, "grad_time_ms": 2270.772, "update_time_ms": 5.839, "opt_peak_throughput": 4896.793, "sample_peak_throughput": 381.227, "opt_samples": 11119.5, "learner": {"av": {"cur_kl_coeff": 0.0023437500931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 0.3310936987400055, "policy_loss": -0.00799176748842001, "vf_loss": 0.339065283536911, "vf_explained_var": 0.8195515275001526, "kl": 0.008611515164375305, "entropy": 1.768429160118103, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10907, "done": false, "timesteps_total": 221479, "episodes_total": 660, "training_iteration": 20, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-52-05", "timestamp": 1588783925, "time_this_iter_s": 31.645200967788696, "time_total_s": 641.2503821849823, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f59846e1950>", "on_episode_end": "<function on_episode_end at 0x7f5984675b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 641.2503821849823, "timesteps_since_restore": 221479, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 75.03777777777776, "ram_util_percent": 33.49777777777778}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32365971208206246, "episode_reward_min": -2.9987351929530535, "episode_reward_mean": -1.412011535020075, "episode_len_mean": 346.49, "episodes_this_iter": 33, "policy_reward_min": {"av": -2.9987351929530535}, "policy_reward_max": {"av": 0.32365971208206246}, "policy_reward_mean": {"av": -1.412011535020075}, "custom_metrics": {"num_ped_collisions_mean": 0.52, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.259488932366241, "avg_speed_min": 1.7117833064571553, "avg_speed_max": 4.881253251174317, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.470020681630885, "mean_processing_ms": 4.050181028656956, "mean_inference_ms": 0.44579263804925445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 232164, "num_steps_sampled": 232164, "sample_time_ms": 28822.835, "grad_time_ms": 2229.098, "update_time_ms": 5.777, "opt_peak_throughput": 4963.172, "sample_peak_throughput": 383.841, "opt_samples": 11063.4, "learner": {"av": {"cur_kl_coeff": 0.0023437500931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 0.07607084512710571, "policy_loss": -0.003984317649155855, "vf_loss": 0.08004894852638245, "vf_explained_var": 0.9561673998832703, "kl": 0.002653172006830573, "entropy": 1.761690378189087, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10685, "done": false, "timesteps_total": 232164, "episodes_total": 693, "training_iteration": 21, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-52-35", "timestamp": 1588783955, "time_this_iter_s": 29.771262645721436, "time_total_s": 671.0216448307037, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675bf8>", "on_episode_end": "<function on_episode_end at 0x7f5984675d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 671.0216448307037, "timesteps_since_restore": 232164, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 76.11666666666667, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32366471666326363, "episode_reward_min": -2.9987351929530535, "episode_reward_mean": -1.4578050503753115, "episode_len_mean": 344.74, "episodes_this_iter": 32, "policy_reward_min": {"av": -2.9987351929530535}, "policy_reward_max": {"av": 0.32366471666326363}, "policy_reward_mean": {"av": -1.4578050503753115}, "custom_metrics": {"num_ped_collisions_mean": 0.53, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.272691410837867, "avg_speed_min": 1.7117833064571553, "avg_speed_max": 4.881253251174317, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.374582921995298, "mean_processing_ms": 4.042263764586282, "mean_inference_ms": 0.44369865193937325}, "off_policy_estimator": {}, "info": {"num_steps_trained": 243078, "num_steps_sampled": 243078, "sample_time_ms": 29066.925, "grad_time_ms": 2248.993, "update_time_ms": 5.824, "opt_peak_throughput": 4874.981, "sample_peak_throughput": 377.192, "opt_samples": 10963.8, "learner": {"av": {"cur_kl_coeff": 0.0011718750465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03732512891292572, "policy_loss": -0.013826049864292145, "vf_loss": 0.05114008113741875, "vf_explained_var": 0.9738258123397827, "kl": 0.009465201757848263, "entropy": 1.7404789924621582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10914, "done": false, "timesteps_total": 243078, "episodes_total": 725, "training_iteration": 22, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-53-05", "timestamp": 1588783985, "time_this_iter_s": 30.2068350315094, "time_total_s": 701.2284798622131, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984675b70>", "on_episode_end": "<function on_episode_end at 0x7f59846e1a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 701.2284798622131, "timesteps_since_restore": 243078, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 71.6340909090909, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32366471666326363, "episode_reward_min": -2.9987351929530535, "episode_reward_mean": -1.5853818949003746, "episode_len_mean": 334.39, "episodes_this_iter": 30, "policy_reward_min": {"av": -2.9987351929530535}, "policy_reward_max": {"av": 0.32366471666326363}, "policy_reward_mean": {"av": -1.5853818949003746}, "custom_metrics": {"num_ped_collisions_mean": 0.57, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.269392887566446, "avg_speed_min": 1.7117833064571553, "avg_speed_max": 4.881253251174317, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.278533871314494, "mean_processing_ms": 4.063514652260108, "mean_inference_ms": 0.4412386901964716}, "off_policy_estimator": {}, "info": {"num_steps_trained": 253626, "num_steps_sampled": 253626, "sample_time_ms": 29239.995, "grad_time_ms": 2287.914, "update_time_ms": 5.939, "opt_peak_throughput": 4763.203, "sample_peak_throughput": 372.702, "opt_samples": 10897.8, "learner": {"av": {"cur_kl_coeff": 0.0011718750465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 0.025134995579719543, "policy_loss": -0.0006104611675255001, "vf_loss": 0.0257438775151968, "vf_explained_var": 0.9870982766151428, "kl": 0.0013475599698722363, "entropy": 1.7861881256103516, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10548, "done": false, "timesteps_total": 253626, "episodes_total": 755, "training_iteration": 23, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-53-37", "timestamp": 1588784017, "time_this_iter_s": 31.414053440093994, "time_total_s": 732.6425333023071, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675c80>", "on_episode_step": "<function on_episode_step at 0x7f5984675ae8>", "on_episode_end": "<function on_episode_end at 0x7f5984675840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 732.6425333023071, "timesteps_since_restore": 253626, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 74.99777777777778, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32366471666326363, "episode_reward_min": -2.9987006762480193, "episode_reward_mean": -1.416384530525095, "episode_len_mean": 354.64, "episodes_this_iter": 27, "policy_reward_min": {"av": -2.9987006762480193}, "policy_reward_max": {"av": 0.32366471666326363}, "policy_reward_mean": {"av": -1.416384530525095}, "custom_metrics": {"num_ped_collisions_mean": 0.52, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.243155049259345, "avg_speed_min": 1.3875788545712395, "avg_speed_max": 4.774558308089288, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.286779448389712, "mean_processing_ms": 4.0398089965793655, "mean_inference_ms": 0.44207601824233583}, "off_policy_estimator": {}, "info": {"num_steps_trained": 264478, "num_steps_sampled": 264478, "sample_time_ms": 29367.89, "grad_time_ms": 2300.629, "update_time_ms": 5.95, "opt_peak_throughput": 4734.444, "sample_peak_throughput": 370.888, "opt_samples": 10892.2, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.11421956866979599, "policy_loss": -0.004667934495955706, "vf_loss": 0.11888149380683899, "vf_explained_var": 0.9285619854927063, "kl": 0.010271969251334667, "entropy": 1.7778421640396118, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10852, "done": false, "timesteps_total": 264478, "episodes_total": 782, "training_iteration": 24, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-54-11", "timestamp": 1588784051, "time_this_iter_s": 33.90365266799927, "time_total_s": 766.5461859703064, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714730>", "on_episode_step": "<function on_episode_step at 0x7f59846dc840>", "on_episode_end": "<function on_episode_end at 0x7f59846e1a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 766.5461859703064, "timesteps_since_restore": 264478, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 78.07291666666667, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32366471666326363, "episode_reward_min": -2.9986092407476406, "episode_reward_mean": -1.2629883039496548, "episode_len_mean": 374.97, "episodes_this_iter": 29, "policy_reward_min": {"av": -2.9986092407476406}, "policy_reward_max": {"av": 0.32366471666326363}, "policy_reward_mean": {"av": -1.2629883039496548}, "custom_metrics": {"num_ped_collisions_mean": 0.47, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2116820409336047, "avg_speed_min": 1.3875788545712395, "avg_speed_max": 4.774558308089288, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.354010030764467, "mean_processing_ms": 4.007683669937024, "mean_inference_ms": 0.4439502028463073}, "off_policy_estimator": {}, "info": {"num_steps_trained": 275905, "num_steps_sampled": 275905, "sample_time_ms": 29830.69, "grad_time_ms": 2320.806, "update_time_ms": 6.011, "opt_peak_throughput": 4703.624, "sample_peak_throughput": 365.939, "opt_samples": 10916.2, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05260143429040909, "policy_loss": -0.003933652304112911, "vf_loss": 0.056530099362134933, "vf_explained_var": 0.9721646904945374, "kl": 0.008510700426995754, "entropy": 1.8732850551605225, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11427, "done": false, "timesteps_total": 275905, "episodes_total": 811, "training_iteration": 25, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-54-47", "timestamp": 1588784087, "time_this_iter_s": 35.663941860198975, "time_total_s": 802.2101278305054, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984676158>", "on_episode_end": "<function on_episode_end at 0x7f5984676048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 802.2101278305054, "timesteps_since_restore": 275905, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 71.60196078431373, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32364546622853646, "episode_reward_min": -2.998582417722958, "episode_reward_mean": -1.353107605977775, "episode_len_mean": 383.82, "episodes_this_iter": 31, "policy_reward_min": {"av": -2.998582417722958}, "policy_reward_max": {"av": 0.32364546622853646}, "policy_reward_mean": {"av": -1.353107605977775}, "custom_metrics": {"num_ped_collisions_mean": 0.5, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9533048196050915, "avg_speed_min": 1.2303216888575255, "avg_speed_max": 4.645770102519813, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.428020589759562, "mean_processing_ms": 3.9828305743829424, "mean_inference_ms": 0.44547564680282714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 287575, "num_steps_sampled": 287575, "sample_time_ms": 30083.932, "grad_time_ms": 2310.489, "update_time_ms": 6.001, "opt_peak_throughput": 4766.438, "sample_peak_throughput": 366.069, "opt_samples": 11012.8, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.3122459053993225, "policy_loss": -0.00469175772741437, "vf_loss": 0.3169340193271637, "vf_explained_var": 0.8507295250892639, "kl": 0.006251684855669737, "entropy": 2.044475555419922, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11670, "done": false, "timesteps_total": 287575, "episodes_total": 842, "training_iteration": 26, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-55-26", "timestamp": 1588784126, "time_this_iter_s": 38.79380702972412, "time_total_s": 841.0039348602295, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714730>", "on_episode_step": "<function on_episode_step at 0x7f59846e1950>", "on_episode_end": "<function on_episode_end at 0x7f59846766a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846767b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 841.0039348602295, "timesteps_since_restore": 287575, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 72.38928571428572, "ram_util_percent": 33.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32364814028209266, "episode_reward_min": -2.9986208680850384, "episode_reward_mean": -1.269451788872957, "episode_len_mean": 396.02, "episodes_this_iter": 25, "policy_reward_min": {"av": -2.9986208680850384}, "policy_reward_max": {"av": 0.32364814028209266}, "policy_reward_mean": {"av": -1.269451788872957}, "custom_metrics": {"num_ped_collisions_mean": 0.47, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0019261912126667, "avg_speed_min": 1.09710564739737, "avg_speed_max": 4.971453440986572, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.623467896250645, "mean_processing_ms": 3.952295574231613, "mean_inference_ms": 0.45014792267136144}, "off_policy_estimator": {}, "info": {"num_steps_trained": 298441, "num_steps_sampled": 298441, "sample_time_ms": 30389.637, "grad_time_ms": 2336.956, "update_time_ms": 6.056, "opt_peak_throughput": 4700.646, "sample_peak_throughput": 361.478, "opt_samples": 10985.2, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.23894858360290527, "policy_loss": -0.005144912749528885, "vf_loss": 0.244087815284729, "vf_explained_var": 0.8749849200248718, "kl": 0.00967041589319706, "entropy": 1.9301903247833252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10866, "done": false, "timesteps_total": 298441, "episodes_total": 867, "training_iteration": 27, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-56-02", "timestamp": 1588784162, "time_this_iter_s": 36.040186643600464, "time_total_s": 877.04412150383, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984676158>", "on_episode_end": "<function on_episode_end at 0x7f5984676048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 877.04412150383, "timesteps_since_restore": 298441, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 78.11568627450981, "ram_util_percent": 33.5078431372549}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32364814028209266, "episode_reward_min": -2.9986208680850384, "episode_reward_mean": -1.1431990730169803, "episode_len_mean": 415.67, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.9986208680850384}, "policy_reward_max": {"av": 0.32364814028209266}, "policy_reward_mean": {"av": -1.1431990730169803}, "custom_metrics": {"num_ped_collisions_mean": 0.43, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.830210797589793, "avg_speed_min": 1.068932829517063, "avg_speed_max": 4.971453440986572, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.71256673769665, "mean_processing_ms": 3.948610295830717, "mean_inference_ms": 0.45157460537542266}, "off_policy_estimator": {}, "info": {"num_steps_trained": 309244, "num_steps_sampled": 309244, "sample_time_ms": 31039.208, "grad_time_ms": 2435.491, "update_time_ms": 6.055, "opt_peak_throughput": 4486.406, "sample_peak_throughput": 352.026, "opt_samples": 10926.6, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.6402437686920166, "policy_loss": -0.003360843053087592, "vf_loss": 0.6436014175415039, "vf_explained_var": 0.5399706363677979, "kl": 0.005341216456145048, "entropy": 1.9806780815124512, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10803, "done": false, "timesteps_total": 309244, "episodes_total": 890, "training_iteration": 28, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-56-39", "timestamp": 1588784199, "time_this_iter_s": 36.8317813873291, "time_total_s": 913.8759028911591, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f59846e1950>", "on_episode_end": "<function on_episode_end at 0x7f5984675730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 913.8759028911591, "timesteps_since_restore": 309244, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 77.90188679245286, "ram_util_percent": 33.533962264150944}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32364814028209266, "episode_reward_min": -2.9986208680850384, "episode_reward_mean": -1.0124984968044068, "episode_len_mean": 430.63, "episodes_this_iter": 25, "policy_reward_min": {"av": -2.9986208680850384}, "policy_reward_max": {"av": 0.32364814028209266}, "policy_reward_mean": {"av": -1.0124984968044068}, "custom_metrics": {"num_ped_collisions_mean": 0.38, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.62410879538601, "avg_speed_min": 1.0662322485805333, "avg_speed_max": 4.971453440986572, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.92163807529208, "mean_processing_ms": 3.937401173501302, "mean_inference_ms": 0.45535818128970157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 320432, "num_steps_sampled": 320432, "sample_time_ms": 32131.073, "grad_time_ms": 2551.981, "update_time_ms": 5.966, "opt_peak_throughput": 4304.891, "sample_peak_throughput": 341.912, "opt_samples": 10986.0, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.47398287057876587, "policy_loss": -0.007293441332876682, "vf_loss": 0.48126712441444397, "vf_explained_var": 0.5198590755462646, "kl": 0.01562846079468727, "entropy": 2.015991449356079, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11188, "done": false, "timesteps_total": 320432, "episodes_total": 915, "training_iteration": 29, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-57-21", "timestamp": 1588784241, "time_this_iter_s": 42.732149600982666, "time_total_s": 956.6080524921417, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675e18>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 956.6080524921417, "timesteps_since_restore": 320432, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 80.90491803278687, "ram_util_percent": 33.57213114754097}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32364814028209266, "episode_reward_min": -2.9986208680850384, "episode_reward_mean": -0.6671877507619746, "episode_len_mean": 447.47, "episodes_this_iter": 24, "policy_reward_min": {"av": -2.9986208680850384}, "policy_reward_max": {"av": 0.32364814028209266}, "policy_reward_mean": {"av": -0.6671877507619746}, "custom_metrics": {"num_ped_collisions_mean": 0.25, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5841956101353047, "avg_speed_min": 1.0462922757571183, "avg_speed_max": 4.971453440986572, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.240552758939497, "mean_processing_ms": 3.9043600395286813, "mean_inference_ms": 0.4616863683564152}, "off_policy_estimator": {}, "info": {"num_steps_trained": 331631, "num_steps_sampled": 331631, "sample_time_ms": 32852.191, "grad_time_ms": 2652.724, "update_time_ms": 5.929, "opt_peak_throughput": 4152.411, "sample_peak_throughput": 335.296, "opt_samples": 11015.2, "learner": {"av": {"cur_kl_coeff": 0.0005859375232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 0.13941003382205963, "policy_loss": -0.013441474176943302, "vf_loss": 0.15282957255840302, "vf_explained_var": 0.35081496834754944, "kl": 0.03742152452468872, "entropy": 2.104308843612671, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11199, "done": false, "timesteps_total": 331631, "episodes_total": 939, "training_iteration": 30, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-58-01", "timestamp": 1588784281, "time_this_iter_s": 39.86259078979492, "time_total_s": 996.4706432819366, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675730>", "on_episode_step": "<function on_episode_step at 0x7f59846e1a60>", "on_episode_end": "<function on_episode_end at 0x7f59846e1950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846769d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 996.4706432819366, "timesteps_since_restore": 331631, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 81.61754385964913, "ram_util_percent": 33.57894736842105}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32361115065109286, "episode_reward_min": -2.998700214705813, "episode_reward_mean": -0.6131906932706974, "episode_len_mean": 461.26, "episodes_this_iter": 23, "policy_reward_min": {"av": -2.998700214705813}, "policy_reward_max": {"av": 0.32361115065109286}, "policy_reward_mean": {"av": -0.6131906932706974}, "custom_metrics": {"num_ped_collisions_mean": 0.23, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3217315440192787, "avg_speed_min": 1.0462922757571183, "avg_speed_max": 4.971453440986572, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.52010976618986, "mean_processing_ms": 3.8862244834799977, "mean_inference_ms": 0.4668332655646617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 342658, "num_steps_sampled": 342658, "sample_time_ms": 34035.917, "grad_time_ms": 2806.367, "update_time_ms": 5.986, "opt_peak_throughput": 3937.261, "sample_peak_throughput": 324.639, "opt_samples": 11049.4, "learner": {"av": {"cur_kl_coeff": 0.0008789062267169356, "cur_lr": 9.999999747378752e-06, "total_loss": 0.533542811870575, "policy_loss": 0.0008631719974800944, "vf_loss": 0.5326761603355408, "vf_explained_var": 0.30693677067756653, "kl": 0.004011606797575951, "entropy": 2.090672254562378, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11027, "done": false, "timesteps_total": 342658, "episodes_total": 962, "training_iteration": 31, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-58-45", "timestamp": 1588784325, "time_this_iter_s": 43.14639139175415, "time_total_s": 1039.6170346736908, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675950>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f5984675268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846751e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1039.6170346736908, "timesteps_since_restore": 342658, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 85.15409836065575, "ram_util_percent": 33.58524590163933}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32348884149772816, "episode_reward_min": -3.0003688540470064, "episode_reward_mean": -0.5560627487871267, "episode_len_mean": 470.18, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0003688540470064}, "policy_reward_max": {"av": 0.32348884149772816}, "policy_reward_mean": {"av": -0.5560627487871267}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.0163355041042332, "avg_speed_min": 1.0423944986476674, "avg_speed_max": 4.814973924163683, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.978321753864194, "mean_processing_ms": 3.8559476142388847, "mean_inference_ms": 0.47639110065315693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 353708, "num_steps_sampled": 353708, "sample_time_ms": 35470.836, "grad_time_ms": 3020.179, "update_time_ms": 5.878, "opt_peak_throughput": 3663.028, "sample_peak_throughput": 311.89, "opt_samples": 11063.0, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.23157131671905518, "policy_loss": -0.0034688301384449005, "vf_loss": 0.2350362092256546, "vf_explained_var": 0.536944568157196, "kl": 0.008981890976428986, "entropy": 2.0684401988983154, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11050, "done": false, "timesteps_total": 353708, "episodes_total": 984, "training_iteration": 32, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_16-59-31", "timestamp": 1588784371, "time_this_iter_s": 46.69319176673889, "time_total_s": 1086.3102264404297, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f59846e1a60>", "on_episode_end": "<function on_episode_end at 0x7f5984675730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1086.3102264404297, "timesteps_since_restore": 353708, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 87.66119402985073, "ram_util_percent": 33.59402985074627}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3234849159806546, "episode_reward_min": -3.00061, "episode_reward_mean": -0.46148857811035954, "episode_len_mean": 477.48, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00061}, "policy_reward_max": {"av": 0.3234849159806546}, "policy_reward_mean": {"av": -0.46148857811035954}, "custom_metrics": {"num_ped_collisions_mean": 0.17, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.0422364223147356, "avg_speed_min": 1.0423944986476674, "avg_speed_max": 4.814973924163683, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.37013514191951, "mean_processing_ms": 3.8374658159951185, "mean_inference_ms": 0.483390055683705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 364941, "num_steps_sampled": 364941, "sample_time_ms": 36270.639, "grad_time_ms": 3120.391, "update_time_ms": 5.741, "opt_peak_throughput": 3567.341, "sample_peak_throughput": 306.901, "opt_samples": 11131.5, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.12418355792760849, "policy_loss": -0.006179542746394873, "vf_loss": 0.1303596943616867, "vf_explained_var": 0.49656128883361816, "kl": 0.007768918294459581, "entropy": 1.9613120555877686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11233, "done": false, "timesteps_total": 364941, "episodes_total": 1007, "training_iteration": 33, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-00-12", "timestamp": 1588784412, "time_this_iter_s": 40.413301944732666, "time_total_s": 1126.7235283851624, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f59846760d0>", "on_episode_end": "<function on_episode_end at 0x7f5984676d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1126.7235283851624, "timesteps_since_restore": 364941, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 81.80344827586208, "ram_util_percent": 33.596551724137925}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.32324283648554336, "episode_reward_min": -3.00061, "episode_reward_mean": -0.47161600014111876, "episode_len_mean": 470.12, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00061}, "policy_reward_max": {"av": 0.32324283648554336}, "policy_reward_mean": {"av": -0.47161600014111876}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1185004920178034, "avg_speed_min": 1.0423944986476674, "avg_speed_max": 4.932450024278346, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.84387283662691, "mean_processing_ms": 3.812689259077412, "mean_inference_ms": 0.49223819048717166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376116, "num_steps_sampled": 376116, "sample_time_ms": 36765.94, "grad_time_ms": 3174.906, "update_time_ms": 5.624, "opt_peak_throughput": 3516.261, "sample_peak_throughput": 303.645, "opt_samples": 11163.8, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.30201902985572815, "policy_loss": -0.0029536860529333353, "vf_loss": 0.3049658536911011, "vf_explained_var": 0.37587571144104004, "kl": 0.015567596070468426, "entropy": 2.0834436416625977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11175, "done": false, "timesteps_total": 376116, "episodes_total": 1034, "training_iteration": 34, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-00-51", "timestamp": 1588784451, "time_this_iter_s": 39.400469064712524, "time_total_s": 1166.1239974498749, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984714730>", "on_episode_end": "<function on_episode_end at 0x7f5984676e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1166.1239974498749, "timesteps_since_restore": 376116, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 79.79642857142858, "ram_util_percent": 33.59464285714285}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.3231792353283741, "episode_reward_min": -3.00061, "episode_reward_mean": -0.3348169551378761, "episode_len_mean": 476.49, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00061}, "policy_reward_max": {"av": 0.3231792353283741}, "policy_reward_mean": {"av": -0.3348169551378761}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.197696275351555, "avg_speed_min": 1.0423944986476674, "avg_speed_max": 4.932450024278346, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.10474751858708, "mean_processing_ms": 3.7915854307899988, "mean_inference_ms": 0.4970980029283816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 387045, "num_steps_sampled": 387045, "sample_time_ms": 37156.577, "grad_time_ms": 3268.358, "update_time_ms": 5.603, "opt_peak_throughput": 3400.485, "sample_peak_throughput": 299.113, "opt_samples": 11114.0, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.04533301666378975, "policy_loss": -0.0033647865056991577, "vf_loss": 0.0486929714679718, "vf_explained_var": 0.21730422973632812, "kl": 0.011013480834662914, "entropy": 1.9575247764587402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10929, "done": false, "timesteps_total": 387045, "episodes_total": 1054, "training_iteration": 35, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-01-32", "timestamp": 1588784492, "time_this_iter_s": 40.50489616394043, "time_total_s": 1206.6288936138153, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f5984676d90>", "on_episode_end": "<function on_episode_end at 0x7f59846760d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1206.6288936138153, "timesteps_since_restore": 387045, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 82.49137931034484, "ram_util_percent": 33.603448275862064}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.00061, "episode_reward_mean": -0.18264235474593918, "episode_len_mean": 467.77, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00061}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": -0.18264235474593918}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.482341515239647, "avg_speed_min": 1.0391203296075446, "avg_speed_max": 4.932450024278346, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.42411172702366, "mean_processing_ms": 3.7728704991537865, "mean_inference_ms": 0.5027801593559204}, "off_policy_estimator": {}, "info": {"num_steps_trained": 398494, "num_steps_sampled": 398494, "sample_time_ms": 37045.209, "grad_time_ms": 3280.65, "update_time_ms": 5.756, "opt_peak_throughput": 3381.007, "sample_peak_throughput": 299.415, "opt_samples": 11091.9, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09312012046575546, "policy_loss": -0.006962914485484362, "vf_loss": 0.1000802293419838, "vf_explained_var": 0.3874771296977997, "kl": 0.006394622847437859, "entropy": 1.9871735572814941, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11449, "done": false, "timesteps_total": 398494, "episodes_total": 1082, "training_iteration": 36, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-02-10", "timestamp": 1588784530, "time_this_iter_s": 37.80416917800903, "time_total_s": 1244.4330627918243, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984714730>", "on_episode_end": "<function on_episode_end at 0x7f5984675488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1244.4330627918243, "timesteps_since_restore": 398494, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 79.24814814814816, "ram_util_percent": 33.598148148148134}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.00055, "episode_reward_mean": -0.22763029999999998, "episode_len_mean": 467.06, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": -0.22763029999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3325676690938275, "avg_speed_min": 1.0391203296075446, "avg_speed_max": 4.932450024278346, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.577765211845445, "mean_processing_ms": 3.7552189781050584, "mean_inference_ms": 0.5060189621781169}, "off_policy_estimator": {}, "info": {"num_steps_trained": 409201, "num_steps_sampled": 409201, "sample_time_ms": 37863.63, "grad_time_ms": 3414.981, "update_time_ms": 5.714, "opt_peak_throughput": 3243.356, "sample_peak_throughput": 292.523, "opt_samples": 11076.0, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0917733907699585, "policy_loss": -0.002119226148352027, "vf_loss": 0.09388982504606247, "vf_explained_var": 0.7559319734573364, "kl": 0.006385317537933588, "entropy": 2.0272974967956543, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10707, "done": false, "timesteps_total": 409201, "episodes_total": 1100, "training_iteration": 37, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-02-56", "timestamp": 1588784576, "time_this_iter_s": 45.56759285926819, "time_total_s": 1290.0006556510925, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f59846759d8>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1290.0006556510925, "timesteps_since_restore": 409201, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 87.08307692307693, "ram_util_percent": 33.596923076923076}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00055, "episode_reward_mean": -0.1251304, "episode_len_mean": 478.15, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.1251304}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3507426300340923, "avg_speed_min": 1.0391203296075446, "avg_speed_max": 4.932450024278346, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.889305599431225, "mean_processing_ms": 3.730876028090699, "mean_inference_ms": 0.5122691482238753}, "off_policy_estimator": {}, "info": {"num_steps_trained": 420755, "num_steps_sampled": 420755, "sample_time_ms": 38012.222, "grad_time_ms": 3408.978, "update_time_ms": 5.72, "opt_peak_throughput": 3271.097, "sample_peak_throughput": 293.356, "opt_samples": 11151.1, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05124964937567711, "policy_loss": -0.004194908309727907, "vf_loss": 0.0554407462477684, "vf_explained_var": 0.003964300733059645, "kl": 0.008670213632285595, "entropy": 1.9600871801376343, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11554, "done": false, "timesteps_total": 420755, "episodes_total": 1127, "training_iteration": 38, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-03-34", "timestamp": 1588784614, "time_this_iter_s": 38.25784754753113, "time_total_s": 1328.2585031986237, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984675b70>", "on_episode_end": "<function on_episode_end at 0x7f5984675488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846768c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1328.2585031986237, "timesteps_since_restore": 420755, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 78.82545454545456, "ram_util_percent": 33.59999999999999}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00055, "episode_reward_mean": -0.11011860000000001, "episode_len_mean": 482.0, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00055}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.11011860000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.409725995495732, "avg_speed_min": 1.0391203296075446, "avg_speed_max": 4.95631372895633, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.05262785751469, "mean_processing_ms": 3.7113774471214653, "mean_inference_ms": 0.5149014567288436}, "off_policy_estimator": {}, "info": {"num_steps_trained": 431708, "num_steps_sampled": 431708, "sample_time_ms": 37646.838, "grad_time_ms": 3376.748, "update_time_ms": 5.703, "opt_peak_throughput": 3295.36, "sample_peak_throughput": 295.579, "opt_samples": 11127.6, "learner": {"av": {"cur_kl_coeff": 0.0004394531133584678, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03005676157772541, "policy_loss": -0.01742727681994438, "vf_loss": 0.04747113212943077, "vf_explained_var": 0.5821622610092163, "kl": 0.02935468591749668, "entropy": 2.0740532875061035, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10953, "done": false, "timesteps_total": 431708, "episodes_total": 1147, "training_iteration": 39, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-04-13", "timestamp": 1588784653, "time_this_iter_s": 38.75562357902527, "time_total_s": 1367.014126777649, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f5984675a60>", "on_episode_end": "<function on_episode_end at 0x7f5984675400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1367.014126777649, "timesteps_since_restore": 431708, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 82.23636363636362, "ram_util_percent": 33.59999999999999}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.0006199999999996, "episode_reward_mean": -0.11263600000000001, "episode_len_mean": 486.06, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0006199999999996}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.11263600000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.420619387070577, "avg_speed_min": 1.0400220991474638, "avg_speed_max": 4.95631372895633, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.25272657066617, "mean_processing_ms": 3.6958937402124037, "mean_inference_ms": 0.5189342387623439}, "off_policy_estimator": {}, "info": {"num_steps_trained": 443191, "num_steps_sampled": 443191, "sample_time_ms": 37513.298, "grad_time_ms": 3354.855, "update_time_ms": 5.788, "opt_peak_throughput": 3325.33, "sample_peak_throughput": 297.388, "opt_samples": 11156.0, "learner": {"av": {"cur_kl_coeff": 0.0006591796991415322, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09253324568271637, "policy_loss": -0.004864935297518969, "vf_loss": 0.09739219397306442, "vf_explained_var": 0.6016677618026733, "kl": 0.009087176993489265, "entropy": 2.084122657775879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11483, "done": false, "timesteps_total": 443191, "episodes_total": 1172, "training_iteration": 40, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-04-51", "timestamp": 1588784691, "time_this_iter_s": 38.30992650985718, "time_total_s": 1405.324053287506, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675b70>", "on_episode_end": "<function on_episode_end at 0x7f59846dc840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1405.324053287506, "timesteps_since_restore": 443191, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 79.68363636363637, "ram_util_percent": 33.59999999999999}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.0006199999999996, "episode_reward_mean": 0.007374800000000002, "episode_len_mean": 486.4, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0006199999999996}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.007374800000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6037507516944145, "avg_speed_min": 1.0400220991474638, "avg_speed_max": 4.974533419233257, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.42499806703886, "mean_processing_ms": 3.6719352256730655, "mean_inference_ms": 0.522281706298497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 454334, "num_steps_sampled": 454334, "sample_time_ms": 37185.902, "grad_time_ms": 3305.741, "update_time_ms": 5.849, "opt_peak_throughput": 3378.244, "sample_peak_throughput": 300.318, "opt_samples": 11167.6, "learner": {"av": {"cur_kl_coeff": 0.0006591796991415322, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05107024312019348, "policy_loss": -0.010391508229076862, "vf_loss": 0.061454176902770996, "vf_explained_var": 0.0749938115477562, "kl": 0.011500387452542782, "entropy": 2.013953924179077, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11143, "done": false, "timesteps_total": 454334, "episodes_total": 1195, "training_iteration": 41, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-05-31", "timestamp": 1588784731, "time_this_iter_s": 39.380709409713745, "time_total_s": 1444.7047626972198, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846761e0>", "on_episode_step": "<function on_episode_step at 0x7f5984676400>", "on_episode_end": "<function on_episode_end at 0x7f59846769d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846766a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1444.7047626972198, "timesteps_since_restore": 454334, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 80.72321428571429, "ram_util_percent": 33.6}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.0006199999999996, "episode_reward_mean": 0.03737139999999999, "episode_len_mean": 491.4, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0006199999999996}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.03737139999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6754053829745534, "avg_speed_min": 1.0400220991474638, "avg_speed_max": 4.974533419233257, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.504838041957036, "mean_processing_ms": 3.6583001202298546, "mean_inference_ms": 0.5238880176732171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 465466, "num_steps_sampled": 465466, "sample_time_ms": 36498.602, "grad_time_ms": 3218.537, "update_time_ms": 5.818, "opt_peak_throughput": 3472.323, "sample_peak_throughput": 306.198, "opt_samples": 11175.8, "learner": {"av": {"cur_kl_coeff": 0.0006591796991415322, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0024566135834902525, "policy_loss": -0.0048881215043365955, "vf_loss": 0.007343003526329994, "vf_explained_var": 0.4838084876537323, "kl": 0.0026286346837878227, "entropy": 2.0443079471588135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11132, "done": false, "timesteps_total": 465466, "episodes_total": 1217, "training_iteration": 42, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-06-10", "timestamp": 1588784770, "time_this_iter_s": 38.9474892616272, "time_total_s": 1483.652251958847, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f59845d6bf8>", "on_episode_end": "<function on_episode_end at 0x7f5984714730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1483.652251958847, "timesteps_since_restore": 465466, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 79.93571428571428, "ram_util_percent": 33.6}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00071, "episode_reward_mean": -0.027629500000000005, "episode_len_mean": 483.96, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00071}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.027629500000000005}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.756543055976178, "avg_speed_min": 1.0403053090945527, "avg_speed_max": 5.143967842571388, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.617399899123136, "mean_processing_ms": 3.6444550113286183, "mean_inference_ms": 0.525670096868112}, "off_policy_estimator": {}, "info": {"num_steps_trained": 476904, "num_steps_sampled": 476904, "sample_time_ms": 36230.237, "grad_time_ms": 3165.706, "update_time_ms": 5.901, "opt_peak_throughput": 3536.747, "sample_peak_throughput": 309.032, "opt_samples": 11196.3, "learner": {"av": {"cur_kl_coeff": 0.0003295898495707661, "cur_lr": 9.999999747378752e-06, "total_loss": 0.06523469090461731, "policy_loss": -0.002070351969450712, "vf_loss": 0.06729847937822342, "vf_explained_var": 0.7785668969154358, "kl": 0.019919252023100853, "entropy": 1.9530748128890991, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11438, "done": false, "timesteps_total": 476904, "episodes_total": 1243, "training_iteration": 43, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-06-47", "timestamp": 1588784807, "time_this_iter_s": 37.20203232765198, "time_total_s": 1520.854284286499, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984676400>", "on_episode_end": "<function on_episode_end at 0x7f59846761e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846766a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1520.854284286499, "timesteps_since_restore": 476904, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 78.14339622641508, "ram_util_percent": 33.60377358490565}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00071, "episode_reward_mean": -0.07761040000000002, "episode_len_mean": 476.51, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00071}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.07761040000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6325728258681016, "avg_speed_min": 1.039643649104428, "avg_speed_max": 5.143967842571388, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.719721836268874, "mean_processing_ms": 3.629388918348261, "mean_inference_ms": 0.5278878403955719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 487883, "num_steps_sampled": 487883, "sample_time_ms": 36424.578, "grad_time_ms": 3204.189, "update_time_ms": 6.022, "opt_peak_throughput": 3488.152, "sample_peak_throughput": 306.845, "opt_samples": 11176.7, "learner": {"av": {"cur_kl_coeff": 0.0003295898495707661, "cur_lr": 9.999999747378752e-06, "total_loss": 0.04003966972231865, "policy_loss": -0.008166166953742504, "vf_loss": 0.048203691840171814, "vf_explained_var": -0.021957874298095703, "kl": 0.00650552473962307, "entropy": 1.9649004936218262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10979, "done": false, "timesteps_total": 487883, "episodes_total": 1264, "training_iteration": 44, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-07-29", "timestamp": 1588784849, "time_this_iter_s": 41.72961235046387, "time_total_s": 1562.583896636963, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f5984714730>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846758c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1562.583896636963, "timesteps_since_restore": 487883, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 81.965, "ram_util_percent": 33.599999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00071, "episode_reward_mean": -0.08509150000000001, "episode_len_mean": 470.11, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00071}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.08509150000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6775287067396953, "avg_speed_min": 1.039360444606603, "avg_speed_max": 5.143967842571388, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.85645100937864, "mean_processing_ms": 3.6184232842539696, "mean_inference_ms": 0.5306349348883742}, "off_policy_estimator": {}, "info": {"num_steps_trained": 499320, "num_steps_sampled": 499320, "sample_time_ms": 36253.205, "grad_time_ms": 3183.572, "update_time_ms": 5.972, "opt_peak_throughput": 3526.699, "sample_peak_throughput": 309.697, "opt_samples": 11227.5, "learner": {"av": {"cur_kl_coeff": 0.0003295898495707661, "cur_lr": 9.999999747378752e-06, "total_loss": 0.06869383901357651, "policy_loss": 0.0003918828151654452, "vf_loss": 0.06830068677663803, "vf_explained_var": 0.23849940299987793, "kl": 0.0038812048733234406, "entropy": 1.9256457090377808, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11437, "done": false, "timesteps_total": 499320, "episodes_total": 1291, "training_iteration": 45, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-08-08", "timestamp": 1588784888, "time_this_iter_s": 38.58504629135132, "time_total_s": 1601.1689429283142, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f5984675ae8>", "on_episode_end": "<function on_episode_end at 0x7f5984675378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1601.1689429283142, "timesteps_since_restore": 499320, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 80.16545454545454, "ram_util_percent": 33.59999999999999}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00071, "episode_reward_mean": -0.08259330000000001, "episode_len_mean": 470.22, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00071}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.08259330000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.707827480562525, "avg_speed_min": 1.039360444606603, "avg_speed_max": 5.143967842571388, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 33.925456706331005, "mean_processing_ms": 3.602987046559463, "mean_inference_ms": 0.5322635307229098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 510563, "num_steps_sampled": 510563, "sample_time_ms": 36273.557, "grad_time_ms": 3190.975, "update_time_ms": 5.875, "opt_peak_throughput": 3512.062, "sample_peak_throughput": 308.955, "opt_samples": 11206.9, "learner": {"av": {"cur_kl_coeff": 0.00016479492478538305, "cur_lr": 9.999999747378752e-06, "total_loss": 0.023955654352903366, "policy_loss": -0.008156855590641499, "vf_loss": 0.03211192786693573, "vf_explained_var": 0.12386763095855713, "kl": 0.0035010711289942265, "entropy": 1.867957353591919, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11243, "done": false, "timesteps_total": 510563, "episodes_total": 1313, "training_iteration": 46, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-08-46", "timestamp": 1588784926, "time_this_iter_s": 38.08080196380615, "time_total_s": 1639.2497448921204, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f59846758c8>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1639.2497448921204, "timesteps_since_restore": 510563, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 78.28181818181818, "ram_util_percent": 33.61090909090908}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -1.00018, "episode_reward_mean": -0.015097400000000004, "episode_len_mean": 471.27, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.00018}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.015097400000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7767422572689027, "avg_speed_min": 1.039360444606603, "avg_speed_max": 5.1382137628303175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.01409715230436, "mean_processing_ms": 3.5917869112390934, "mean_inference_ms": 0.534380597877436}, "off_policy_estimator": {}, "info": {"num_steps_trained": 521844, "num_steps_sampled": 521844, "sample_time_ms": 35508.497, "grad_time_ms": 3082.575, "update_time_ms": 5.871, "opt_peak_throughput": 3654.185, "sample_peak_throughput": 317.228, "opt_samples": 11264.3, "learner": {"av": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03410390019416809, "policy_loss": -0.0022629383020102978, "vf_loss": 0.03636633977293968, "vf_explained_var": 0.29467537999153137, "kl": 0.006014882121235132, "entropy": 1.8670964241027832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11281, "done": false, "timesteps_total": 521844, "episodes_total": 1337, "training_iteration": 47, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-09-23", "timestamp": 1588784963, "time_this_iter_s": 36.83367729187012, "time_total_s": 1676.0834221839905, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f5984675ea0>", "on_episode_end": "<function on_episode_end at 0x7f5984675950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1676.0834221839905, "timesteps_since_restore": 521844, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 79.40961538461536, "ram_util_percent": 33.62115384615384}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -1.00017, "episode_reward_mean": 0.01737669999999999, "episode_len_mean": 476.19, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00017}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.01737669999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.817437133973794, "avg_speed_min": 1.039360444606603, "avg_speed_max": 5.1382137628303175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.07887082451307, "mean_processing_ms": 3.5801598032684425, "mean_inference_ms": 0.535660342422419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 533136, "num_steps_sampled": 533136, "sample_time_ms": 35455.137, "grad_time_ms": 3096.401, "update_time_ms": 5.839, "opt_peak_throughput": 3629.407, "sample_peak_throughput": 316.967, "opt_samples": 11238.1, "learner": {"av": {"cur_kl_coeff": 8.239746239269152e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.006460499484091997, "policy_loss": 0.0020667945500463247, "vf_loss": 0.004393334034830332, "vf_explained_var": 0.6542495489120483, "kl": 0.004498451016843319, "entropy": 1.8406893014907837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11292, "done": false, "timesteps_total": 533136, "episodes_total": 1359, "training_iteration": 48, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-10-01", "timestamp": 1588785001, "time_this_iter_s": 37.8619966506958, "time_total_s": 1713.9454188346863, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1a60>", "on_episode_step": "<function on_episode_step at 0x7f59846758c8>", "on_episode_end": "<function on_episode_end at 0x7f59845d6bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1713.9454188346863, "timesteps_since_restore": 533136, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 79.93888888888888, "ram_util_percent": 33.65185185185185}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.0002, "episode_reward_mean": 0.09735209999999998, "episode_len_mean": 488.77, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0002}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.09735209999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9956499182980623, "avg_speed_min": 1.040372457198902, "avg_speed_max": 5.128992166077893, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.080951704597375, "mean_processing_ms": 3.5621978321121945, "mean_inference_ms": 0.5357786422542712}, "off_policy_estimator": {}, "info": {"num_steps_trained": 544514, "num_steps_sampled": 544514, "sample_time_ms": 35130.978, "grad_time_ms": 3049.229, "update_time_ms": 5.9, "opt_peak_throughput": 3699.493, "sample_peak_throughput": 321.101, "opt_samples": 11280.6, "learner": {"av": {"cur_kl_coeff": 4.119873119634576e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.02805561199784279, "policy_loss": -0.004488655366003513, "vf_loss": 0.0325440876185894, "vf_explained_var": 0.2688339352607727, "kl": 0.004343688953667879, "entropy": 1.7775074243545532, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11378, "done": false, "timesteps_total": 544514, "episodes_total": 1383, "training_iteration": 49, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-10-36", "timestamp": 1588785036, "time_this_iter_s": 35.042868852615356, "time_total_s": 1748.9882876873016, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676f28>", "on_episode_step": "<function on_episode_step at 0x7f59846768c8>", "on_episode_end": "<function on_episode_end at 0x7f5984676840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1748.9882876873016, "timesteps_since_restore": 544514, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 77.102, "ram_util_percent": 33.664}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.0002, "episode_reward_mean": 0.09235719999999999, "episode_len_mean": 489.01, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0002}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.09235719999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9300248161323337, "avg_speed_min": 1.040372457198902, "avg_speed_max": 5.148566602594072, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.118280338299165, "mean_processing_ms": 3.5522621973617614, "mean_inference_ms": 0.5366360179691689}, "off_policy_estimator": {}, "info": {"num_steps_trained": 555698, "num_steps_sampled": 555698, "sample_time_ms": 35174.78, "grad_time_ms": 3057.272, "update_time_ms": 5.866, "opt_peak_throughput": 3679.98, "sample_peak_throughput": 319.851, "opt_samples": 11250.7, "learner": {"av": {"cur_kl_coeff": 2.059936559817288e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.02294369973242283, "policy_loss": -0.002111984184011817, "vf_loss": 0.02505560964345932, "vf_explained_var": 0.307858407497406, "kl": 0.003909080754965544, "entropy": 1.776554822921753, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11184, "done": false, "timesteps_total": 555698, "episodes_total": 1405, "training_iteration": 50, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-11-15", "timestamp": 1588785075, "time_this_iter_s": 38.82763361930847, "time_total_s": 1787.81592130661, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc840>", "on_episode_step": "<function on_episode_step at 0x7f59846e1a60>", "on_episode_end": "<function on_episode_end at 0x7f5984714730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1787.81592130661, "timesteps_since_restore": 555698, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 79.29107142857143, "ram_util_percent": 33.68035714285714}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24998, "episode_reward_min": -1.0002, "episode_reward_mean": 0.0798794, "episode_len_mean": 488.72, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0002}, "policy_reward_max": {"av": 0.24998}, "policy_reward_mean": {"av": 0.0798794}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8017904020528466, "avg_speed_min": 1.0407366320080862, "avg_speed_max": 5.179895942711382, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.1509847189366, "mean_processing_ms": 3.5403612957872004, "mean_inference_ms": 0.5371784455090719}, "off_policy_estimator": {}, "info": {"num_steps_trained": 567066, "num_steps_sampled": 567066, "sample_time_ms": 35155.304, "grad_time_ms": 3059.326, "update_time_ms": 5.938, "opt_peak_throughput": 3684.864, "sample_peak_throughput": 320.669, "opt_samples": 11273.2, "learner": {"av": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.024330472573637962, "policy_loss": -0.006827700417488813, "vf_loss": 0.031158067286014557, "vf_explained_var": 0.31798622012138367, "kl": 0.010249760933220387, "entropy": 1.758135199546814, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11368, "done": false, "timesteps_total": 567066, "episodes_total": 1430, "training_iteration": 51, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-11-54", "timestamp": 1588785114, "time_this_iter_s": 39.207709550857544, "time_total_s": 1827.0236308574677, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f59846768c8>", "on_episode_end": "<function on_episode_end at 0x7f5984676f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845dab70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1827.0236308574677, "timesteps_since_restore": 567066, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 80.42857142857143, "ram_util_percent": 33.683928571428574}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24998, "episode_reward_min": -1.0002, "episode_reward_mean": 0.09239119999999999, "episode_len_mean": 491.16, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.0002}, "policy_reward_max": {"av": 0.24998}, "policy_reward_mean": {"av": 0.09239119999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7813437836976815, "avg_speed_min": 1.039982393541349, "avg_speed_max": 5.179895942711382, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.20526229034644, "mean_processing_ms": 3.5247577293101617, "mean_inference_ms": 0.5386889749839521}, "off_policy_estimator": {}, "info": {"num_steps_trained": 578097, "num_steps_sampled": 578097, "sample_time_ms": 35263.233, "grad_time_ms": 3073.353, "update_time_ms": 5.929, "opt_peak_throughput": 3664.759, "sample_peak_throughput": 319.401, "opt_samples": 11263.1, "learner": {"av": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.007141262758523226, "policy_loss": -0.009263819083571434, "vf_loss": 0.0021224822849035263, "vf_explained_var": 0.8464023470878601, "kl": 0.007161210756748915, "entropy": 1.7164283990859985, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11031, "done": false, "timesteps_total": 578097, "episodes_total": 1450, "training_iteration": 52, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-12-34", "timestamp": 1588785154, "time_this_iter_s": 40.16658568382263, "time_total_s": 1867.1902165412903, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675488>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846767b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1867.1902165412903, "timesteps_since_restore": 578097, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 82.3, "ram_util_percent": 33.69298245614035}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24998, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.0973968, "episode_len_mean": 493.13, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24998}, "policy_reward_mean": {"av": 0.0973968}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.64700529787891, "avg_speed_min": 1.039982393541349, "avg_speed_max": 5.179895942711382, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.27027924145352, "mean_processing_ms": 3.5181328274390644, "mean_inference_ms": 0.5397212938237866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 589577, "num_steps_sampled": 589577, "sample_time_ms": 35335.932, "grad_time_ms": 3094.946, "update_time_ms": 5.943, "opt_peak_throughput": 3640.549, "sample_peak_throughput": 318.862, "opt_samples": 11267.3, "learner": {"av": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004897897131741047, "policy_loss": -0.005254378076642752, "vf_loss": 0.00035638545523397624, "vf_explained_var": 0.9725112318992615, "kl": 0.009346270002424717, "entropy": 1.751183271408081, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11480, "done": false, "timesteps_total": 589577, "episodes_total": 1475, "training_iteration": 53, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-13-13", "timestamp": 1588785193, "time_this_iter_s": 38.14478659629822, "time_total_s": 1905.3350031375885, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675378>", "on_episode_step": "<function on_episode_step at 0x7f59846766a8>", "on_episode_end": "<function on_episode_end at 0x7f5984676048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460dc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1905.3350031375885, "timesteps_since_restore": 589577, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 79.35454545454546, "ram_util_percent": 33.690909090909095}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24998, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.09989740000000001, "episode_len_mean": 495.23, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24998}, "policy_reward_mean": {"av": 0.09989740000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.462809121631515, "avg_speed_min": 1.039982393541349, "avg_speed_max": 5.179895942711382, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.3639431842224, "mean_processing_ms": 3.5032539255540924, "mean_inference_ms": 0.5417757054328513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 600581, "num_steps_sampled": 600581, "sample_time_ms": 35416.563, "grad_time_ms": 3113.733, "update_time_ms": 5.792, "opt_peak_throughput": 3619.386, "sample_peak_throughput": 318.207, "opt_samples": 11269.8, "learner": {"av": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.006978986319154501, "policy_loss": -0.007655357010662556, "vf_loss": 0.0006761775002814829, "vf_explained_var": 0.9487194418907166, "kl": 0.018347736448049545, "entropy": 1.6718868017196655, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11004, "done": false, "timesteps_total": 600581, "episodes_total": 1495, "training_iteration": 54, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-13-55", "timestamp": 1588785235, "time_this_iter_s": 42.722830057144165, "time_total_s": 1948.0578331947327, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f5984675488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846767b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1948.0578331947327, "timesteps_since_restore": 600581, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 84.46393442622951, "ram_util_percent": 33.6983606557377}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.11489389999999998, "episode_len_mean": 497.56, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.11489389999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.44561146079046, "avg_speed_min": 1.039982393541349, "avg_speed_max": 4.48299795161557, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.478684686631816, "mean_processing_ms": 3.492804268563485, "mean_inference_ms": 0.5439742858055551}, "off_policy_estimator": {}, "info": {"num_steps_trained": 612072, "num_steps_sampled": 612072, "sample_time_ms": 35445.362, "grad_time_ms": 3114.868, "update_time_ms": 5.916, "opt_peak_throughput": 3619.801, "sample_peak_throughput": 318.101, "opt_samples": 11275.2, "learner": {"av": {"cur_kl_coeff": 1.029968279908644e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.01279113907366991, "policy_loss": -0.013632111251354218, "vf_loss": 0.000840692431665957, "vf_explained_var": 0.930329442024231, "kl": 0.027330700308084488, "entropy": 1.6691616773605347, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11491, "done": false, "timesteps_total": 612072, "episodes_total": 1520, "training_iteration": 55, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-14-34", "timestamp": 1588785274, "time_this_iter_s": 38.885411739349365, "time_total_s": 1986.943244934082, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675bf8>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f5984675598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846759d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1986.943244934082, "timesteps_since_restore": 612072, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 79.58035714285714, "ram_util_percent": 33.698214285714286}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.00011, "episode_reward_mean": 0.0699093, "episode_len_mean": 490.61, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.00011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.0699093}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3843615399152682, "avg_speed_min": 1.0384783146374157, "avg_speed_max": 4.988985587612963, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 34.59871903029988, "mean_processing_ms": 3.4842376377064284, "mean_inference_ms": 0.5464919451288184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 623233, "num_steps_sampled": 623233, "sample_time_ms": 35714.158, "grad_time_ms": 3159.846, "update_time_ms": 5.823, "opt_peak_throughput": 3565.68, "sample_peak_throughput": 315.477, "opt_samples": 11267.0, "learner": {"av": {"cur_kl_coeff": 1.544952465337701e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03933810815215111, "policy_loss": -0.015567062422633171, "vf_loss": 0.05490458011627197, "vf_explained_var": 0.18655061721801758, "kl": 0.03827809914946556, "entropy": 1.5834330320358276, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11161, "done": false, "timesteps_total": 623233, "episodes_total": 1543, "training_iteration": 56, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-15-16", "timestamp": 1588785316, "time_this_iter_s": 41.21748733520508, "time_total_s": 2028.160732269287, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f5984675c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2028.160732269287, "timesteps_since_restore": 623233, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 83.04827586206896, "ram_util_percent": 33.69827586206897}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00038, "episode_reward_mean": 0.027403899999999995, "episode_len_mean": 489.86, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00038}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.027403899999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.255043485841617, "avg_speed_min": 1.0380861819964424, "avg_speed_max": 4.988985587612963, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 34.700091924726145, "mean_processing_ms": 3.475219965605956, "mean_inference_ms": 0.5483285238689108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 634445, "num_steps_sampled": 634445, "sample_time_ms": 36320.26, "grad_time_ms": 3239.475, "update_time_ms": 5.938, "opt_peak_throughput": 3475.903, "sample_peak_throughput": 310.023, "opt_samples": 11260.1, "learner": {"av": {"cur_kl_coeff": 2.3174285161076114e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.04453527182340622, "policy_loss": -0.0028025112114846706, "vf_loss": 0.04733741283416748, "vf_explained_var": 0.10301414877176285, "kl": 0.016058938577771187, "entropy": 1.6097257137298584, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11212, "done": false, "timesteps_total": 634445, "episodes_total": 1566, "training_iteration": 57, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-16-00", "timestamp": 1588785360, "time_this_iter_s": 43.69144892692566, "time_total_s": 2071.8521811962128, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675488>", "on_episode_step": "<function on_episode_step at 0x7f5984675598>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846759d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2071.8521811962128, "timesteps_since_restore": 634445, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 84.5984126984127, "ram_util_percent": 33.69841269841269}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00049, "episode_reward_mean": -0.002617800000000007, "episode_len_mean": 489.7, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00049}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.002617800000000007}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.243165956468534, "avg_speed_min": 1.0380649681315692, "avg_speed_max": 4.988985587612963, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 34.863376571063995, "mean_processing_ms": 3.467777032387046, "mean_inference_ms": 0.5517486661788885}, "off_policy_estimator": {}, "info": {"num_steps_trained": 645703, "num_steps_sampled": 645703, "sample_time_ms": 36799.987, "grad_time_ms": 3298.273, "update_time_ms": 6.097, "opt_peak_throughput": 3412.907, "sample_peak_throughput": 305.889, "opt_samples": 11256.7, "learner": {"av": {"cur_kl_coeff": 2.3174285161076114e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03761696815490723, "policy_loss": -0.003925101365894079, "vf_loss": 0.041541557759046555, "vf_explained_var": 0.7340962290763855, "kl": 0.021948128938674927, "entropy": 1.54778254032135, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11258, "done": false, "timesteps_total": 645703, "episodes_total": 1588, "training_iteration": 58, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-16-43", "timestamp": 1588785403, "time_this_iter_s": 43.249300479888916, "time_total_s": 2115.1014816761017, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675ae8>", "on_episode_step": "<function on_episode_step at 0x7f5984675c80>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2115.1014816761017, "timesteps_since_restore": 645703, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 84.82741935483871, "ram_util_percent": 33.699999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00049, "episode_reward_mean": -0.007618600000000007, "episode_len_mean": 489.7, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00049}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.007618600000000007}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.219150376542242, "avg_speed_min": 1.0380649681315692, "avg_speed_max": 4.988985587612963, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 34.98254710413753, "mean_processing_ms": 3.4597612197252388, "mean_inference_ms": 0.5538058837478288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 656915, "num_steps_sampled": 656915, "sample_time_ms": 37458.132, "grad_time_ms": 3390.966, "update_time_ms": 6.102, "opt_peak_throughput": 3314.719, "sample_peak_throughput": 300.071, "opt_samples": 11240.1, "learner": {"av": {"cur_kl_coeff": 3.4761429560603574e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003964253235608339, "policy_loss": -0.005592857953161001, "vf_loss": 0.001628217869438231, "vf_explained_var": 0.8580992817878723, "kl": 0.01131391990929842, "entropy": 1.5220192670822144, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11212, "done": false, "timesteps_total": 656915, "episodes_total": 1611, "training_iteration": 59, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-17-26", "timestamp": 1588785446, "time_this_iter_s": 42.552244901657104, "time_total_s": 2157.653726577759, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f598460d0d0>", "on_episode_end": "<function on_episode_end at 0x7f598460d158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846769d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2157.653726577759, "timesteps_since_restore": 656915, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 84.06229508196724, "ram_util_percent": 33.70327868852459}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00049, "episode_reward_mean": 0.0248861, "episode_len_mean": 499.09, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00049}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.0248861}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.0295901594466104, "avg_speed_min": 1.0380649681315692, "avg_speed_max": 4.596482102315479, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.15472193477564, "mean_processing_ms": 3.4478848335359333, "mean_inference_ms": 0.5574636811848531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 668119, "num_steps_sampled": 668119, "sample_time_ms": 37761.7, "grad_time_ms": 3437.009, "update_time_ms": 6.052, "opt_peak_throughput": 3270.896, "sample_peak_throughput": 297.712, "opt_samples": 11242.1, "learner": {"av": {"cur_kl_coeff": 3.4761429560603574e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005637235473841429, "policy_loss": -0.006063839420676231, "vf_loss": 0.00042620222666300833, "vf_explained_var": 0.9621509313583374, "kl": 0.011617826297879219, "entropy": 1.576126217842102, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11204, "done": false, "timesteps_total": 668119, "episodes_total": 1633, "training_iteration": 60, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-18-08", "timestamp": 1588785488, "time_this_iter_s": 42.32387709617615, "time_total_s": 2199.977603673935, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d9d8>", "on_episode_step": "<function on_episode_step at 0x7f5984676400>", "on_episode_end": "<function on_episode_end at 0x7f59846767b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2199.977603673935, "timesteps_since_restore": 668119, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 84.32166666666664, "ram_util_percent": 33.7}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00049, "episode_reward_mean": -0.002636700000000003, "episode_len_mean": 498.5, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00049}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.002636700000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.08120404569444, "avg_speed_min": 1.0377727020975387, "avg_speed_max": 4.627406158272386, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.31812360669836, "mean_processing_ms": 3.4437404615899316, "mean_inference_ms": 0.5604308099878756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 679373, "num_steps_sampled": 679373, "sample_time_ms": 38088.499, "grad_time_ms": 3486.039, "update_time_ms": 5.889, "opt_peak_throughput": 3221.622, "sample_peak_throughput": 294.858, "opt_samples": 11230.7, "learner": {"av": {"cur_kl_coeff": 3.4761429560603574e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.1111120730638504, "policy_loss": -0.0030501901637762785, "vf_loss": 0.11416197568178177, "vf_explained_var": 0.5529771447181702, "kl": 0.008897676132619381, "entropy": 1.6380032300949097, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11254, "done": false, "timesteps_total": 679373, "episodes_total": 1656, "training_iteration": 61, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-18-51", "timestamp": 1588785531, "time_this_iter_s": 42.96525311470032, "time_total_s": 2242.9428567886353, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d158>", "on_episode_step": "<function on_episode_step at 0x7f598460d0d0>", "on_episode_end": "<function on_episode_end at 0x7f5984676e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846769d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2242.9428567886353, "timesteps_since_restore": 679373, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 84.95737704918034, "ram_util_percent": 33.699999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00041, "episode_reward_mean": 0.0598536, "episode_len_mean": 499.41, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00041}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.0598536}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.126065001784892, "avg_speed_min": 1.0377727020975387, "avg_speed_max": 4.627406158272386, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.470633094374605, "mean_processing_ms": 3.4327194918006425, "mean_inference_ms": 0.5635143742432398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 690651, "num_steps_sampled": 690651, "sample_time_ms": 38459.641, "grad_time_ms": 3532.835, "update_time_ms": 5.95, "opt_peak_throughput": 3185.94, "sample_peak_throughput": 292.655, "opt_samples": 11255.4, "learner": {"av": {"cur_kl_coeff": 3.4761429560603574e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0035098358057439327, "policy_loss": -0.0047449530102312565, "vf_loss": 0.00825427658855915, "vf_explained_var": 0.3658891022205353, "kl": 0.014778503216803074, "entropy": 1.6353559494018555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11278, "done": false, "timesteps_total": 690651, "episodes_total": 1678, "training_iteration": 62, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-19-35", "timestamp": 1588785575, "time_this_iter_s": 44.34767246246338, "time_total_s": 2287.2905292510986, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845dab70>", "on_episode_step": "<function on_episode_step at 0x7f59845da0d0>", "on_episode_end": "<function on_episode_end at 0x7f59845da400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845da6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2287.2905292510986, "timesteps_since_restore": 690651, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 85.0875, "ram_util_percent": 33.699999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00041, "episode_reward_mean": 0.054859099999999994, "episode_len_mean": 499.41, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00041}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.054859099999999994}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.0869118634879897, "avg_speed_min": 1.0375116630231664, "avg_speed_max": 4.627406158272386, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.62133138554625, "mean_processing_ms": 3.4288677061289046, "mean_inference_ms": 0.5661750470259803}, "off_policy_estimator": {}, "info": {"num_steps_trained": 701899, "num_steps_sampled": 701899, "sample_time_ms": 38798.991, "grad_time_ms": 3584.632, "update_time_ms": 5.981, "opt_peak_throughput": 3133.432, "sample_peak_throughput": 289.497, "opt_samples": 11232.2, "learner": {"av": {"cur_kl_coeff": 3.4761429560603574e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0006556003354489803, "policy_loss": -0.0021688889246433973, "vf_loss": 0.0015131629770621657, "vf_explained_var": 0.8451517820358276, "kl": 0.0036939785350114107, "entropy": 1.509856939315796, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11248, "done": false, "timesteps_total": 701899, "episodes_total": 1701, "training_iteration": 63, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-20-18", "timestamp": 1588785618, "time_this_iter_s": 42.0575385093689, "time_total_s": 2329.3480677604675, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f598460d0d0>", "on_episode_end": "<function on_episode_end at 0x7f59846769d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2329.3480677604675, "timesteps_since_restore": 701899, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 83.915, "ram_util_percent": 33.7}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00041, "episode_reward_mean": 0.0348662, "episode_len_mean": 494.62, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00041}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.0348662}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1355366257518096, "avg_speed_min": 1.0375116630231664, "avg_speed_max": 4.627406158272386, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.74623775619938, "mean_processing_ms": 3.419726269952244, "mean_inference_ms": 0.5688763914533472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 713088, "num_steps_sampled": 713088, "sample_time_ms": 38494.337, "grad_time_ms": 3533.081, "update_time_ms": 6.044, "opt_peak_throughput": 3184.388, "sample_peak_throughput": 292.269, "opt_samples": 11250.7, "learner": {"av": {"cur_kl_coeff": 1.7380714780301787e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.030597219243645668, "policy_loss": -0.006734421942383051, "vf_loss": 0.03733105584979057, "vf_explained_var": 0.2236783355474472, "kl": 0.033893365412950516, "entropy": 1.5201867818832397, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11189, "done": false, "timesteps_total": 713088, "episodes_total": 1724, "training_iteration": 64, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-20-57", "timestamp": 1588785657, "time_this_iter_s": 39.161033153533936, "time_total_s": 2368.5091009140015, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f59845da400>", "on_episode_end": "<function on_episode_end at 0x7f59845da0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2368.5091009140015, "timesteps_since_restore": 713088, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 80.69821428571429, "ram_util_percent": 33.699999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003899999999994, "episode_reward_mean": 0.004833199999999993, "episode_len_mean": 491.38, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0003899999999994}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.004833199999999993}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2677361785430548, "avg_speed_min": 1.0375116630231664, "avg_speed_max": 4.514826490680898, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.857456512834176, "mean_processing_ms": 3.414832725097165, "mean_inference_ms": 0.5707998028611696}, "off_policy_estimator": {}, "info": {"num_steps_trained": 724269, "num_steps_sampled": 724269, "sample_time_ms": 38699.406, "grad_time_ms": 3566.246, "update_time_ms": 5.993, "opt_peak_throughput": 3146.081, "sample_peak_throughput": 289.919, "opt_samples": 11219.7, "learner": {"av": {"cur_kl_coeff": 2.607107126095798e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09003347903490067, "policy_loss": -0.0014625538606196642, "vf_loss": 0.09149590134620667, "vf_explained_var": 0.3076598644256592, "kl": 0.004760636482387781, "entropy": 1.6393274068832397, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11181, "done": false, "timesteps_total": 724269, "episodes_total": 1747, "training_iteration": 65, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-21-38", "timestamp": 1588785698, "time_this_iter_s": 41.26705574989319, "time_total_s": 2409.7761566638947, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845da6a8>", "on_episode_step": "<function on_episode_step at 0x7f598460d158>", "on_episode_end": "<function on_episode_end at 0x7f598460d0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461ad90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2409.7761566638947, "timesteps_since_restore": 724269, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 82.40677966101696, "ram_util_percent": 33.699999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003899999999994, "episode_reward_mean": 0.017342300000000005, "episode_len_mean": 491.38, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0003899999999994}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.017342300000000005}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3340554442904655, "avg_speed_min": 1.0375116630231664, "avg_speed_max": 4.514826490680898, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 35.96247572626872, "mean_processing_ms": 3.405852255173911, "mean_inference_ms": 0.5732445570000215}, "off_policy_estimator": {}, "info": {"num_steps_trained": 735540, "num_steps_sampled": 735540, "sample_time_ms": 38758.125, "grad_time_ms": 3573.881, "update_time_ms": 6.048, "opt_peak_throughput": 3142.438, "sample_peak_throughput": 289.764, "opt_samples": 11230.7, "learner": {"av": {"cur_kl_coeff": 1.303553563047899e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.001854527392424643, "policy_loss": 0.0009143237257376313, "vf_loss": 0.0009400888811796904, "vf_explained_var": 0.9149680137634277, "kl": 0.008934163488447666, "entropy": 1.5231866836547852, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11271, "done": false, "timesteps_total": 735540, "episodes_total": 1770, "training_iteration": 66, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-22-20", "timestamp": 1588785740, "time_this_iter_s": 41.88137221336365, "time_total_s": 2451.6575288772583, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675598>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2451.6575288772583, "timesteps_since_restore": 735540, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 83.57000000000001, "ram_util_percent": 33.7}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003899999999994, "episode_reward_mean": 0.03484740000000001, "episode_len_mean": 491.38, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0003899999999994}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.03484740000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.522417104434753, "avg_speed_min": 1.0375116630231664, "avg_speed_max": 4.644537729473229, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.0211431238551, "mean_processing_ms": 3.4025823450984944, "mean_inference_ms": 0.5741327661680568}, "off_policy_estimator": {}, "info": {"num_steps_trained": 746734, "num_steps_sampled": 746734, "sample_time_ms": 38354.058, "grad_time_ms": 3522.404, "update_time_ms": 5.993, "opt_peak_throughput": 3187.851, "sample_peak_throughput": 292.77, "opt_samples": 11228.9, "learner": {"av": {"cur_kl_coeff": 1.303553563047899e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.001681051799096167, "policy_loss": -0.002034669741988182, "vf_loss": 0.0003535928262863308, "vf_explained_var": 0.9724329113960266, "kl": 0.002396601950749755, "entropy": 1.4839566946029663, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11194, "done": false, "timesteps_total": 746734, "episodes_total": 1792, "training_iteration": 67, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-22-59", "timestamp": 1588785779, "time_this_iter_s": 39.13532733917236, "time_total_s": 2490.7928562164307, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1950>", "on_episode_step": "<function on_episode_step at 0x7f5984675378>", "on_episode_end": "<function on_episode_end at 0x7f5984675400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2490.7928562164307, "timesteps_since_restore": 746734, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 80.97857142857143, "ram_util_percent": 33.7125}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -3.0003899999999994, "episode_reward_mean": 0.02486240000000001, "episode_len_mean": 491.38, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0003899999999994}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.02486240000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4486331268275108, "avg_speed_min": 1.038226317332727, "avg_speed_max": 4.644537729473229, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.10235923885414, "mean_processing_ms": 3.3938848556702412, "mean_inference_ms": 0.576097429495437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 758039, "num_steps_sampled": 758039, "sample_time_ms": 38183.748, "grad_time_ms": 3502.18, "update_time_ms": 5.806, "opt_peak_throughput": 3207.602, "sample_peak_throughput": 294.198, "opt_samples": 11233.6, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.010335525497794151, "policy_loss": -0.010420809499919415, "vf_loss": 8.519425318809226e-05, "vf_explained_var": 0.9900521636009216, "kl": 0.014284775592386723, "entropy": 1.3940980434417725, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11305, "done": false, "timesteps_total": 758039, "episodes_total": 1815, "training_iteration": 68, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-23-41", "timestamp": 1588785821, "time_this_iter_s": 41.34177279472351, "time_total_s": 2532.134629011154, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f59846756a8>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2532.134629011154, "timesteps_since_restore": 758039, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 82.13050847457629, "ram_util_percent": 33.70169491525424}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00025, "episode_reward_mean": 0.0448863, "episode_len_mean": 489.25, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0448863}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.486451529009805, "avg_speed_min": 1.038226317332727, "avg_speed_max": 5.019696644669732, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.164870750501294, "mean_processing_ms": 3.389193894621702, "mean_inference_ms": 0.5769986740079823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 769067, "num_steps_sampled": 769067, "sample_time_ms": 37910.166, "grad_time_ms": 3460.291, "update_time_ms": 5.811, "opt_peak_throughput": 3241.114, "sample_peak_throughput": 295.836, "opt_samples": 11215.2, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.034199196845293045, "policy_loss": -0.007975342683494091, "vf_loss": 0.04217447713017464, "vf_explained_var": 0.2872774302959442, "kl": 0.00985165685415268, "entropy": 1.4766799211502075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11028, "done": false, "timesteps_total": 769067, "episodes_total": 1837, "training_iteration": 69, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-24-20", "timestamp": 1588785860, "time_this_iter_s": 39.39763569831848, "time_total_s": 2571.5322647094727, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460dd08>", "on_episode_step": "<function on_episode_step at 0x7f598460d268>", "on_episode_end": "<function on_episode_end at 0x7f598460d950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2571.5322647094727, "timesteps_since_restore": 769067, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 80.8, "ram_util_percent": 33.73214285714286}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.00015, "episode_reward_mean": 0.0649056, "episode_len_mean": 488.39, "episodes_this_iter": 27, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0649056}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6546526440545004, "avg_speed_min": 1.038226317332727, "avg_speed_max": 5.058312835357378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.21707947448453, "mean_processing_ms": 3.380479676077986, "mean_inference_ms": 0.5779866173046578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 780779, "num_steps_sampled": 780779, "sample_time_ms": 37522.974, "grad_time_ms": 3392.423, "update_time_ms": 5.802, "opt_peak_throughput": 3320.931, "sample_peak_throughput": 300.243, "opt_samples": 11266.0, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0318135991692543, "policy_loss": -0.003504880703985691, "vf_loss": 0.035318437963724136, "vf_explained_var": 0.39594510197639465, "kl": 0.005776727106422186, "entropy": 1.4677398204803467, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11712, "done": false, "timesteps_total": 780779, "episodes_total": 1864, "training_iteration": 70, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-24-58", "timestamp": 1588785898, "time_this_iter_s": 37.77261447906494, "time_total_s": 2609.3048791885376, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460dd90>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2609.3048791885376, "timesteps_since_restore": 780779, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 79.22222222222223, "ram_util_percent": 33.76666666666666}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.00015, "episode_reward_mean": 0.064894, "episode_len_mean": 488.39, "episodes_this_iter": 19, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.064894}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6448593474999784, "avg_speed_min": 1.0394193645918397, "avg_speed_max": 5.058312835357378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.2648993760909, "mean_processing_ms": 3.379278152099534, "mean_inference_ms": 0.5790215076879744}, "off_policy_estimator": {}, "info": {"num_steps_trained": 791614, "num_steps_sampled": 791614, "sample_time_ms": 37617.534, "grad_time_ms": 3402.232, "update_time_ms": 5.814, "opt_peak_throughput": 3299.04, "sample_peak_throughput": 298.374, "opt_samples": 11224.1, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0011321267811581492, "policy_loss": -0.0032460021320730448, "vf_loss": 0.0021138438023626804, "vf_explained_var": 0.7957727313041687, "kl": 0.0051633031107485294, "entropy": 1.538825273513794, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10835, "done": false, "timesteps_total": 791614, "episodes_total": 1883, "training_iteration": 71, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-25-42", "timestamp": 1588785942, "time_this_iter_s": 44.00880742073059, "time_total_s": 2653.313686609268, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f598460d950>", "on_episode_end": "<function on_episode_end at 0x7f598460d268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2653.313686609268, "timesteps_since_restore": 791614, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 85.4984126984127, "ram_util_percent": 33.78571428571429}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.00015, "episode_reward_mean": 0.0623703, "episode_len_mean": 488.39, "episodes_this_iter": 26, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0623703}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6056130979182783, "avg_speed_min": 1.0394193645918397, "avg_speed_max": 5.058312835357378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.35160947212328, "mean_processing_ms": 3.369820620002576, "mean_inference_ms": 0.5804943375279745}, "off_policy_estimator": {}, "info": {"num_steps_trained": 803258, "num_steps_sampled": 803258, "sample_time_ms": 37501.145, "grad_time_ms": 3379.866, "update_time_ms": 5.776, "opt_peak_throughput": 3331.7, "sample_peak_throughput": 300.276, "opt_samples": 11260.7, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010509933345019817, "policy_loss": -0.0030490513890981674, "vf_loss": 0.0019980119541287422, "vf_explained_var": 0.805986762046814, "kl": 0.0076812137849628925, "entropy": 1.4829819202423096, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11644, "done": false, "timesteps_total": 803258, "episodes_total": 1909, "training_iteration": 72, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-26-25", "timestamp": 1588785985, "time_this_iter_s": 42.959468126297, "time_total_s": 2696.273154735565, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d048>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f5984675048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984676158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2696.273154735565, "timesteps_since_restore": 803258, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 84.03770491803279, "ram_util_percent": 33.78688524590164}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -1.00015, "episode_reward_mean": 0.08735949999999999, "episode_len_mean": 493.38, "episodes_this_iter": 19, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.08735949999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5703322582768307, "avg_speed_min": 1.0394193645918397, "avg_speed_max": 5.058312835357378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.41601202182223, "mean_processing_ms": 3.3688044804793584, "mean_inference_ms": 0.5818433085467012}, "off_policy_estimator": {}, "info": {"num_steps_trained": 814153, "num_steps_sampled": 814153, "sample_time_ms": 37559.338, "grad_time_ms": 3389.356, "update_time_ms": 5.751, "opt_peak_throughput": 3311.957, "sample_peak_throughput": 298.871, "opt_samples": 11225.4, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.008272512815892696, "policy_loss": -0.009118928574025631, "vf_loss": 0.0008463272242806852, "vf_explained_var": 0.9200973510742188, "kl": 0.014364572241902351, "entropy": 1.5481843948364258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10895, "done": false, "timesteps_total": 814153, "episodes_total": 1928, "training_iteration": 73, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-27-08", "timestamp": 1588786028, "time_this_iter_s": 42.733688831329346, "time_total_s": 2739.0068435668945, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d158>", "on_episode_step": "<function on_episode_step at 0x7f598460dd90>", "on_episode_end": "<function on_episode_end at 0x7f59845d6bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2739.0068435668945, "timesteps_since_restore": 814153, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 84.87049180327867, "ram_util_percent": 33.79672131147541}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -1.00015, "episode_reward_mean": 0.09985359999999999, "episode_len_mean": 495.63, "episodes_this_iter": 27, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.09985359999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5434082679215546, "avg_speed_min": 1.0394193645918397, "avg_speed_max": 4.873442437420747, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.526865986337015, "mean_processing_ms": 3.3616097352283116, "mean_inference_ms": 0.5841855579914873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 825872, "num_steps_sampled": 825872, "sample_time_ms": 37625.956, "grad_time_ms": 3382.897, "update_time_ms": 5.712, "opt_peak_throughput": 3333.947, "sample_peak_throughput": 299.751, "opt_samples": 11278.4, "learner": {"av": {"cur_kl_coeff": 6.517767815239495e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.011475707404315472, "policy_loss": -0.00874751154333353, "vf_loss": 0.020222993567585945, "vf_explained_var": 0.4362996220588684, "kl": 0.03483560308814049, "entropy": 1.2799068689346313, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11719, "done": false, "timesteps_total": 825872, "episodes_total": 1955, "training_iteration": 74, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-27-48", "timestamp": 1588786068, "time_this_iter_s": 39.762349367141724, "time_total_s": 2778.7691929340363, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846751e0>", "on_episode_step": "<function on_episode_step at 0x7f598460d950>", "on_episode_end": "<function on_episode_end at 0x7f598460d268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2778.7691929340363, "timesteps_since_restore": 825872, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 80.38947368421053, "ram_util_percent": 33.79122807017544}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -1.00015, "episode_reward_mean": 0.10484760000000001, "episode_len_mean": 497.75, "episodes_this_iter": 18, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.10484760000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.473771306889866, "avg_speed_min": 1.0394193645918397, "avg_speed_max": 4.873442437420747, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.61290572510688, "mean_processing_ms": 3.3579276076185915, "mean_inference_ms": 0.5855073126252713}, "off_policy_estimator": {}, "info": {"num_steps_trained": 836645, "num_steps_sampled": 836645, "sample_time_ms": 38001.852, "grad_time_ms": 3440.709, "update_time_ms": 5.687, "opt_peak_throughput": 3266.071, "sample_peak_throughput": 295.712, "opt_samples": 11237.6, "learner": {"av": {"cur_kl_coeff": 9.776651495485567e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.005855807103216648, "policy_loss": -0.008106881752610207, "vf_loss": 0.013962292112410069, "vf_explained_var": 0.4285394847393036, "kl": 0.03994254767894745, "entropy": 1.3676974773406982, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10773, "done": false, "timesteps_total": 836645, "episodes_total": 1973, "training_iteration": 75, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-28-34", "timestamp": 1588786114, "time_this_iter_s": 45.60470652580261, "time_total_s": 2824.373899459839, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460dd90>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2824.373899459839, "timesteps_since_restore": 836645, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 87.44923076923078, "ram_util_percent": 33.798461538461545}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -1.00015, "episode_reward_mean": 0.11235800000000001, "episode_len_mean": 497.75, "episodes_this_iter": 27, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.11235800000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5989660588316337, "avg_speed_min": 1.1448756244777343, "avg_speed_max": 4.873442437420747, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.699996078104455, "mean_processing_ms": 3.3505734836645518, "mean_inference_ms": 0.5870796892490769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 848298, "num_steps_sampled": 848298, "sample_time_ms": 37622.631, "grad_time_ms": 3379.716, "update_time_ms": 5.752, "opt_peak_throughput": 3336.316, "sample_peak_throughput": 299.708, "opt_samples": 11275.8, "learner": {"av": {"cur_kl_coeff": 1.4664978152723052e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0004007673996966332, "policy_loss": -0.0006652813171967864, "vf_loss": 0.00026445274124853313, "vf_explained_var": 0.9795359969139099, "kl": 0.004240982234477997, "entropy": 1.2536954879760742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11653, "done": false, "timesteps_total": 848298, "episodes_total": 2000, "training_iteration": 76, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-29-11", "timestamp": 1588786151, "time_this_iter_s": 37.48054265975952, "time_total_s": 2861.8544421195984, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a488>", "on_episode_step": "<function on_episode_step at 0x7f598461ad08>", "on_episode_end": "<function on_episode_end at 0x7f598461aea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845da0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846758c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2861.8544421195984, "timesteps_since_restore": 848298, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 80.55185185185185, "ram_util_percent": 33.79074074074074}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -1.00015, "episode_reward_mean": 0.10236629999999998, "episode_len_mean": 495.25, "episodes_this_iter": 19, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.10236629999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6617406261559955, "avg_speed_min": 1.1448756244777343, "avg_speed_max": 4.873442437420747, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.75631125898999, "mean_processing_ms": 3.3476640925577716, "mean_inference_ms": 0.5880205299980062}, "off_policy_estimator": {}, "info": {"num_steps_trained": 859202, "num_steps_sampled": 859202, "sample_time_ms": 37814.41, "grad_time_ms": 3405.214, "update_time_ms": 5.71, "opt_peak_throughput": 3302.817, "sample_peak_throughput": 297.421, "opt_samples": 11246.8, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.013620604760944843, "policy_loss": -0.002216460881754756, "vf_loss": 0.015836967155337334, "vf_explained_var": 0.4419206976890564, "kl": 0.014128876850008965, "entropy": 1.1678293943405151, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10904, "done": false, "timesteps_total": 859202, "episodes_total": 2019, "training_iteration": 77, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-29-53", "timestamp": 1588786193, "time_this_iter_s": 41.308104515075684, "time_total_s": 2903.162546634674, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845d6bf8>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f5984675730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2903.162546634674, "timesteps_since_restore": 859202, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 82.64915254237287, "ram_util_percent": 33.79830508474576}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00015, "episode_reward_mean": 0.10737219999999999, "episode_len_mean": 495.25, "episodes_this_iter": 26, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.10737219999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.778764472624413, "avg_speed_min": 1.1448756244777343, "avg_speed_max": 4.762239421493282, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.81348737178634, "mean_processing_ms": 3.3401881850948514, "mean_inference_ms": 0.5891669376828864}, "off_policy_estimator": {}, "info": {"num_steps_trained": 870785, "num_steps_sampled": 870785, "sample_time_ms": 37327.229, "grad_time_ms": 3330.857, "update_time_ms": 5.726, "opt_peak_throughput": 3384.894, "sample_peak_throughput": 302.048, "opt_samples": 11274.6, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005655533168464899, "policy_loss": -0.005841420032083988, "vf_loss": 0.00018585353973321617, "vf_explained_var": 0.9844495058059692, "kl": 0.005115296225994825, "entropy": 1.2106342315673828, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11583, "done": false, "timesteps_total": 870785, "episodes_total": 2045, "training_iteration": 78, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-30-29", "timestamp": 1588786229, "time_this_iter_s": 35.726083755493164, "time_total_s": 2938.8886303901672, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461aea0>", "on_episode_step": "<function on_episode_step at 0x7f598461ad08>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846758c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984676730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2938.8886303901672, "timesteps_since_restore": 870785, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 77.70980392156862, "ram_util_percent": 33.794117647058826}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00013, "episode_reward_mean": 0.11986820000000004, "episode_len_mean": 497.5, "episodes_this_iter": 19, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.11986820000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7530719166407516, "avg_speed_min": 1.1448756244777343, "avg_speed_max": 4.762239421493282, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.85901875638981, "mean_processing_ms": 3.3363644568488926, "mean_inference_ms": 0.5899147850787788}, "off_policy_estimator": {}, "info": {"num_steps_trained": 881664, "num_steps_sampled": 881664, "sample_time_ms": 37711.458, "grad_time_ms": 3393.464, "update_time_ms": 5.707, "opt_peak_throughput": 3318.055, "sample_peak_throughput": 298.575, "opt_samples": 11259.7, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004134937189519405, "policy_loss": -0.0045341490767896175, "vf_loss": 0.00039911249768920243, "vf_explained_var": 0.9658922553062439, "kl": 0.01424938440322876, "entropy": 1.2500313520431519, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10879, "done": false, "timesteps_total": 881664, "episodes_total": 2064, "training_iteration": 79, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-31-13", "timestamp": 1588786273, "time_this_iter_s": 43.86518430709839, "time_total_s": 2982.7538146972656, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676048>", "on_episode_step": "<function on_episode_step at 0x7f598461ad90>", "on_episode_end": "<function on_episode_end at 0x7f598461a488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845da0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2982.7538146972656, "timesteps_since_restore": 881664, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 86.11587301587304, "ram_util_percent": 33.80000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00013, "episode_reward_mean": 0.1323644, "episode_len_mean": 497.5, "episodes_this_iter": 26, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.1323644}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8914987326087607, "avg_speed_min": 1.5372956958110213, "avg_speed_max": 4.762239421493282, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.89378552756993, "mean_processing_ms": 3.3297858877556377, "mean_inference_ms": 0.5905957960739406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 893296, "num_steps_sampled": 893296, "sample_time_ms": 37706.778, "grad_time_ms": 3386.359, "update_time_ms": 5.768, "opt_peak_throughput": 3322.654, "sample_peak_throughput": 298.4, "opt_samples": 11251.7, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0021250671707093716, "policy_loss": -0.004619387909770012, "vf_loss": 0.002494251821190119, "vf_explained_var": 0.854921281337738, "kl": 0.009502522647380829, "entropy": 1.337450385093689, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11632, "done": false, "timesteps_total": 893296, "episodes_total": 2090, "training_iteration": 80, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-31-50", "timestamp": 1588786310, "time_this_iter_s": 37.655601024627686, "time_total_s": 3020.4094157218933, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676400>", "on_episode_step": "<function on_episode_step at 0x7f59846768c8>", "on_episode_end": "<function on_episode_end at 0x7f5984676730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846758c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3020.4094157218933, "timesteps_since_restore": 893296, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 78.94814814814815, "ram_util_percent": 33.8}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003, "episode_reward_mean": 0.0773689, "episode_len_mean": 493.51, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.0773689}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9200329873562345, "avg_speed_min": 1.2935569247559036, "avg_speed_max": 4.762239421493282, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.91073792652175, "mean_processing_ms": 3.326657507105285, "mean_inference_ms": 0.5907458310337784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 904313, "num_steps_sampled": 904313, "sample_time_ms": 37387.632, "grad_time_ms": 3332.743, "update_time_ms": 5.774, "opt_peak_throughput": 3381.569, "sample_peak_throughput": 301.434, "opt_samples": 11269.9, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.052031248807907104, "policy_loss": -0.006212002597749233, "vf_loss": 0.05824318155646324, "vf_explained_var": 0.5950008630752563, "kl": 0.008821810595691204, "entropy": 1.415452241897583, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11017, "done": false, "timesteps_total": 904313, "episodes_total": 2110, "training_iteration": 81, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-32-31", "timestamp": 1588786351, "time_this_iter_s": 40.281861543655396, "time_total_s": 3060.6912772655487, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461aea0>", "on_episode_step": "<function on_episode_step at 0x7f598461a488>", "on_episode_end": "<function on_episode_end at 0x7f598461ad90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3060.6912772655487, "timesteps_since_restore": 904313, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 81.34035087719298, "ram_util_percent": 33.79824561403509}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003, "episode_reward_mean": 0.0923653, "episode_len_mean": 496.01, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.0923653}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.937346566014061, "avg_speed_min": 1.2935569247559036, "avg_speed_max": 4.730809356972151, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.9473314762081, "mean_processing_ms": 3.3197141020787684, "mean_inference_ms": 0.5914394315069961}, "off_policy_estimator": {}, "info": {"num_steps_trained": 915896, "num_steps_sampled": 915896, "sample_time_ms": 36861.561, "grad_time_ms": 3254.691, "update_time_ms": 5.792, "opt_peak_throughput": 3460.789, "sample_peak_throughput": 305.57, "opt_samples": 11263.8, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005680900067090988, "policy_loss": -0.00658048689365387, "vf_loss": 0.0008995163952931762, "vf_explained_var": 0.9307039380073547, "kl": 0.01005318108946085, "entropy": 1.0993655920028687, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11583, "done": false, "timesteps_total": 915896, "episodes_total": 2136, "training_iteration": 82, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-33-08", "timestamp": 1588786388, "time_this_iter_s": 36.91818594932556, "time_total_s": 3097.6094632148743, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845da0d0>", "on_episode_step": "<function on_episode_step at 0x7f5984676730>", "on_episode_end": "<function on_episode_end at 0x7f59846768c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845461e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3097.6094632148743, "timesteps_since_restore": 915896, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 77.70754716981132, "ram_util_percent": 33.79811320754717}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.0003, "episode_reward_mean": 0.07987509999999999, "episode_len_mean": 493.65, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.07987509999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9984137144101664, "avg_speed_min": 1.2935569247559036, "avg_speed_max": 5.037284824661695, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.940686168648284, "mean_processing_ms": 3.316491058265066, "mean_inference_ms": 0.591100330971955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 926879, "num_steps_sampled": 926879, "sample_time_ms": 36475.648, "grad_time_ms": 3191.108, "update_time_ms": 5.818, "opt_peak_throughput": 3532.503, "sample_peak_throughput": 309.045, "opt_samples": 11272.6, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.014805492013692856, "policy_loss": -0.0039977505803108215, "vf_loss": 0.018803197890520096, "vf_explained_var": 0.48494774103164673, "kl": 0.006493433378636837, "entropy": 1.3372236490249634, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10983, "done": false, "timesteps_total": 926879, "episodes_total": 2156, "training_iteration": 83, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-33-46", "timestamp": 1588786426, "time_this_iter_s": 38.23829627037048, "time_total_s": 3135.8477594852448, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461ad08>", "on_episode_step": "<function on_episode_step at 0x7f59845e3378>", "on_episode_end": "<function on_episode_end at 0x7f59845e32f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3135.8477594852448, "timesteps_since_restore": 926879, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 79.32909090909092, "ram_util_percent": 33.80363636363636}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.0003, "episode_reward_mean": 0.0649033, "episode_len_mean": 491.49, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.0649033}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1173334424521526, "avg_speed_min": 1.2935569247559036, "avg_speed_max": 5.1680913156156905, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 36.94645301837486, "mean_processing_ms": 3.3099721802993223, "mean_inference_ms": 0.5912992943220852}, "off_policy_estimator": {}, "info": {"num_steps_trained": 938349, "num_steps_sampled": 938349, "sample_time_ms": 35978.109, "grad_time_ms": 3132.056, "update_time_ms": 5.848, "opt_peak_throughput": 3591.156, "sample_peak_throughput": 312.626, "opt_samples": 11247.7, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.022062594071030617, "policy_loss": -0.006062131375074387, "vf_loss": 0.028124621137976646, "vf_explained_var": 0.33120906352996826, "kl": 0.013814054429531097, "entropy": 1.2330294847488403, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11470, "done": false, "timesteps_total": 938349, "episodes_total": 2181, "training_iteration": 84, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-34-20", "timestamp": 1588786460, "time_this_iter_s": 34.19700598716736, "time_total_s": 3170.044765472412, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461ad90>", "on_episode_step": "<function on_episode_step at 0x7f598460d268>", "on_episode_end": "<function on_episode_end at 0x7f598460dd08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3170.044765472412, "timesteps_since_restore": 938349, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 77.64285714285714, "ram_util_percent": 33.800000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.00024, "episode_reward_mean": 0.0799027, "episode_len_mean": 487.67, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.00024}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.0799027}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2424163849624765, "avg_speed_min": 1.3888158253184353, "avg_speed_max": 5.1680913156156905, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.922792348805494, "mean_processing_ms": 3.3068875479813533, "mean_inference_ms": 0.5905899239953097}, "off_policy_estimator": {}, "info": {"num_steps_trained": 949667, "num_steps_sampled": 949667, "sample_time_ms": 35329.584, "grad_time_ms": 3031.95, "update_time_ms": 5.791, "opt_peak_throughput": 3727.7, "sample_peak_throughput": 319.908, "opt_samples": 11302.2, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.023619890213012695, "policy_loss": -0.008946910500526428, "vf_loss": 0.03256675973534584, "vf_explained_var": 0.4177634119987488, "kl": 0.006186815910041332, "entropy": 1.2445378303527832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11318, "done": false, "timesteps_total": 949667, "episodes_total": 2204, "training_iteration": 85, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-34-59", "timestamp": 1588786499, "time_this_iter_s": 38.11712312698364, "time_total_s": 3208.1618885993958, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d048>", "on_episode_step": "<function on_episode_step at 0x7f59845e32f0>", "on_episode_end": "<function on_episode_end at 0x7f59845e3378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845da400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3208.1618885993958, "timesteps_since_restore": 949667, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 79.37592592592591, "ram_util_percent": 33.8}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.00018, "episode_reward_mean": 0.10239959999999998, "episode_len_mean": 491.23, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00018}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.10239959999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1701512815319033, "avg_speed_min": 1.3888158253184353, "avg_speed_max": 5.1680913156156905, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.917358224908675, "mean_processing_ms": 3.300737105594453, "mean_inference_ms": 0.5907048198634366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 960826, "num_steps_sampled": 960826, "sample_time_ms": 35428.799, "grad_time_ms": 3054.335, "update_time_ms": 5.758, "opt_peak_throughput": 3684.206, "sample_peak_throughput": 317.617, "opt_samples": 11252.8, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.00022441227338276803, "policy_loss": -0.0018466131296008825, "vf_loss": 0.002070904476568103, "vf_explained_var": 0.8327034711837769, "kl": 0.017042597755789757, "entropy": 1.3090676069259644, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11159, "done": false, "timesteps_total": 960826, "episodes_total": 2226, "training_iteration": 86, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-35-37", "timestamp": 1588786537, "time_this_iter_s": 38.695905447006226, "time_total_s": 3246.857794046402, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984676400>", "on_episode_step": "<function on_episode_step at 0x7f5984676730>", "on_episode_end": "<function on_episode_end at 0x7f5984676048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846768c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3246.857794046402, "timesteps_since_restore": 960826, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 80.92363636363636, "ram_util_percent": 33.8}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.00018, "episode_reward_mean": 0.1198876, "episode_len_mean": 493.59, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.00018}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1198876}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1551582024572737, "avg_speed_min": 1.151597157859321, "avg_speed_max": 5.1680913156156905, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.90323424028304, "mean_processing_ms": 3.2985664899013507, "mean_inference_ms": 0.5905130488043686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 972086, "num_steps_sampled": 972086, "sample_time_ms": 35182.091, "grad_time_ms": 3022.49, "update_time_ms": 5.706, "opt_peak_throughput": 3734.802, "sample_peak_throughput": 320.856, "opt_samples": 11288.4, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003547997446730733, "policy_loss": -0.0040787216275930405, "vf_loss": 0.0005306763923726976, "vf_explained_var": 0.9610095024108887, "kl": 0.00732801016420126, "entropy": 1.3265231847763062, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11260, "done": false, "timesteps_total": 972086, "episodes_total": 2249, "training_iteration": 87, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-36-16", "timestamp": 1588786576, "time_this_iter_s": 38.52173733711243, "time_total_s": 3285.3795313835144, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a488>", "on_episode_step": "<function on_episode_step at 0x7f59845da0d0>", "on_episode_end": "<function on_episode_end at 0x7f59845da400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460dd08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3285.3795313835144, "timesteps_since_restore": 972086, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 79.91272727272727, "ram_util_percent": 33.8}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.00018, "episode_reward_mean": 0.1273705, "episode_len_mean": 495.75, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00018}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1273705}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9841218772079428, "avg_speed_min": 1.151597157859321, "avg_speed_max": 4.938756189123093, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.913207406981485, "mean_processing_ms": 3.2924283737021263, "mean_inference_ms": 0.5907577535801978}, "off_policy_estimator": {}, "info": {"num_steps_trained": 983325, "num_steps_sampled": 983325, "sample_time_ms": 35629.498, "grad_time_ms": 3090.339, "update_time_ms": 5.824, "opt_peak_throughput": 3641.671, "sample_peak_throughput": 315.862, "opt_samples": 11254.0, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004222240298986435, "policy_loss": -0.004462364129722118, "vf_loss": 0.00024008078617043793, "vf_explained_var": 0.9814366102218628, "kl": 0.006535759195685387, "entropy": 1.261793851852417, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11239, "done": false, "timesteps_total": 983325, "episodes_total": 2271, "training_iteration": 88, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-36-57", "timestamp": 1588786617, "time_this_iter_s": 40.88057351112366, "time_total_s": 3326.260104894638, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461ad08>", "on_episode_step": "<function on_episode_step at 0x7f5984676048>", "on_episode_end": "<function on_episode_end at 0x7f5984676730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846758c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3326.260104894638, "timesteps_since_restore": 983325, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 82.07457627118643, "ram_util_percent": 33.800000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -0.0005500000000000008, "episode_reward_mean": 0.1473571, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0005500000000000008}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1473571}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8321277225893953, "avg_speed_min": 1.0372412662941846, "avg_speed_max": 4.938756189123093, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.93323704148441, "mean_processing_ms": 3.2892155463223998, "mean_inference_ms": 0.5913202193286369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 994588, "num_steps_sampled": 994588, "sample_time_ms": 35357.914, "grad_time_ms": 3041.106, "update_time_ms": 5.821, "opt_peak_throughput": 3713.254, "sample_peak_throughput": 319.374, "opt_samples": 11292.4, "learner": {"av": {"cur_kl_coeff": 7.332489076361526e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0739259198307991, "policy_loss": -0.0023681980092078447, "vf_loss": 0.07629408687353134, "vf_explained_var": 0.3950190842151642, "kl": 0.004937012679874897, "entropy": 1.3400063514709473, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11263, "done": false, "timesteps_total": 994588, "episodes_total": 2294, "training_iteration": 89, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-37-38", "timestamp": 1588786658, "time_this_iter_s": 40.65788507461548, "time_total_s": 3366.9179899692535, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846768c8>", "on_episode_step": "<function on_episode_step at 0x7f59845da400>", "on_episode_end": "<function on_episode_end at 0x7f59845da0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460dd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3366.9179899692535, "timesteps_since_restore": 994588, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 82.37068965517241, "ram_util_percent": 33.82241379310345}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -0.0005500000000000008, "episode_reward_mean": 0.1373594, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0005500000000000008}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1373594}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6645401638166404, "avg_speed_min": 1.0372412662941846, "avg_speed_max": 4.453832478918717, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 36.97225004875968, "mean_processing_ms": 3.284578234146711, "mean_inference_ms": 0.5920687598090009}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1005885, "num_steps_sampled": 1005885, "sample_time_ms": 35703.591, "grad_time_ms": 3101.493, "update_time_ms": 5.874, "opt_peak_throughput": 3630.155, "sample_peak_throughput": 315.344, "opt_samples": 11258.9, "learner": {"av": {"cur_kl_coeff": 3.666244538180763e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028282541316002607, "policy_loss": -0.003386212745681405, "vf_loss": 0.000557919789571315, "vf_explained_var": 0.9537163972854614, "kl": 0.0127406632527709, "entropy": 1.158652663230896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11297, "done": false, "timesteps_total": 1005885, "episodes_total": 2316, "training_iteration": 90, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-38-20", "timestamp": 1588786700, "time_this_iter_s": 41.71700310707092, "time_total_s": 3408.6349930763245, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846758c8>", "on_episode_step": "<function on_episode_step at 0x7f5984675378>", "on_episode_end": "<function on_episode_end at 0x7f5984675268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846756a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3408.6349930763245, "timesteps_since_restore": 1005885, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 81.79166666666667, "ram_util_percent": 33.81666666666668}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.0000600000000002, "episode_reward_mean": 0.1123787, "episode_len_mean": 497.92, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0000600000000002}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.1123787}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.56490740981494, "avg_speed_min": 1.0372412662941846, "avg_speed_max": 4.577514436190658, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.02015242632228, "mean_processing_ms": 3.28128284496406, "mean_inference_ms": 0.5930721448737936}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1017207, "num_steps_sampled": 1017207, "sample_time_ms": 35802.626, "grad_time_ms": 3122.303, "update_time_ms": 5.922, "opt_peak_throughput": 3615.728, "sample_peak_throughput": 315.323, "opt_samples": 11289.4, "learner": {"av": {"cur_kl_coeff": 3.666244538180763e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0035227988846600056, "policy_loss": -0.014646106399595737, "vf_loss": 0.018168780952692032, "vf_explained_var": 0.3768993616104126, "kl": 0.03482867777347565, "entropy": 1.042898416519165, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11322, "done": false, "timesteps_total": 1017207, "episodes_total": 2340, "training_iteration": 91, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-39-01", "timestamp": 1588786741, "time_this_iter_s": 41.47945833206177, "time_total_s": 3450.1144514083862, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a488>", "on_episode_step": "<function on_episode_step at 0x7f59845dab70>", "on_episode_end": "<function on_episode_end at 0x7f59845da400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845da0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3450.1144514083862, "timesteps_since_restore": 1017207, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 82.8677966101695, "ram_util_percent": 33.83898305084747}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.0000600000000002, "episode_reward_mean": 0.09239789999999999, "episode_len_mean": 497.92, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0000600000000002}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.09239789999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.40900570551117, "avg_speed_min": 1.0372412662941846, "avg_speed_max": 4.862907650650847, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.08374536904038, "mean_processing_ms": 3.2779559357451276, "mean_inference_ms": 0.5943028573246744}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1028258, "num_steps_sampled": 1028258, "sample_time_ms": 36541.679, "grad_time_ms": 3240.271, "update_time_ms": 6.025, "opt_peak_throughput": 3467.673, "sample_peak_throughput": 307.49, "opt_samples": 11236.2, "learner": {"av": {"cur_kl_coeff": 5.499366579897469e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004492493346333504, "policy_loss": -0.004676667973399162, "vf_loss": 0.000184124888619408, "vf_explained_var": 0.9740995764732361, "kl": 0.009880811907351017, "entropy": 0.9579464793205261, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11051, "done": false, "timesteps_total": 1028258, "episodes_total": 2361, "training_iteration": 92, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-39-47", "timestamp": 1588786787, "time_this_iter_s": 45.489786863327026, "time_total_s": 3495.6042382717133, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675598>", "on_episode_step": "<function on_episode_step at 0x7f5984675268>", "on_episode_end": "<function on_episode_end at 0x7f5984675378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e30d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3495.6042382717133, "timesteps_since_restore": 1028258, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 87.29076923076924, "ram_util_percent": 33.88307692307693}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.0000600000000002, "episode_reward_mean": 0.0798989, "episode_len_mean": 497.92, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0000600000000002}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0798989}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.340639500239142, "avg_speed_min": 1.0895678554828214, "avg_speed_max": 4.862907650650847, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.1650420926911, "mean_processing_ms": 3.2751291875890667, "mean_inference_ms": 0.5957772911572347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1039674, "num_steps_sampled": 1039674, "sample_time_ms": 37026.819, "grad_time_ms": 3313.523, "update_time_ms": 6.062, "opt_peak_throughput": 3404.081, "sample_peak_throughput": 304.631, "opt_samples": 11279.5, "learner": {"av": {"cur_kl_coeff": 5.499366579897469e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.003387440461665392, "policy_loss": 0.0013032853603363037, "vf_loss": 0.002084118779748678, "vf_explained_var": 0.782036304473877, "kl": 0.007305835373699665, "entropy": 1.0855709314346313, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11416, "done": false, "timesteps_total": 1039674, "episodes_total": 2385, "training_iteration": 93, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-40-31", "timestamp": 1588786831, "time_this_iter_s": 43.82296371459961, "time_total_s": 3539.427201986313, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e38c8>", "on_episode_step": "<function on_episode_step at 0x7f59845e3048>", "on_episode_end": "<function on_episode_end at 0x7f59845e3f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3539.427201986313, "timesteps_since_restore": 1039674, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 85.12539682539683, "ram_util_percent": 33.87301587301588}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.0000600000000002, "episode_reward_mean": 0.0723945, "episode_len_mean": 497.92, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0000600000000002}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0723945}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.286544168356019, "avg_speed_min": 1.0895678554828214, "avg_speed_max": 4.862907650650847, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.252649742638226, "mean_processing_ms": 3.2722078376182164, "mean_inference_ms": 0.5974205845511986}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1050809, "num_steps_sampled": 1050809, "sample_time_ms": 37970.306, "grad_time_ms": 3444.759, "update_time_ms": 6.046, "opt_peak_throughput": 3264.669, "sample_peak_throughput": 296.179, "opt_samples": 11246.0, "learner": {"av": {"cur_kl_coeff": 5.499366579897469e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05242493003606796, "policy_loss": -0.0024753028992563486, "vf_loss": 0.05490019917488098, "vf_explained_var": 0.556144118309021, "kl": 0.0053764148615300655, "entropy": 1.2122831344604492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11135, "done": false, "timesteps_total": 1050809, "episodes_total": 2406, "training_iteration": 94, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-41-16", "timestamp": 1588786876, "time_this_iter_s": 44.94412183761597, "time_total_s": 3584.371323823929, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675378>", "on_episode_step": "<function on_episode_step at 0x7f59845e36a8>", "on_episode_end": "<function on_episode_end at 0x7f59845e3620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e30d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3584.371323823929, "timesteps_since_restore": 1050809, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 86.66093749999999, "ram_util_percent": 33.884375}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00045, "episode_reward_mean": 0.009863899999999998, "episode_len_mean": 497.09, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.009863899999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2252785847719587, "avg_speed_min": 1.0895678554828214, "avg_speed_max": 4.862907650650847, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.355164820714414, "mean_processing_ms": 3.269831700138218, "mean_inference_ms": 0.599208506298859}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1062114, "num_steps_sampled": 1062114, "sample_time_ms": 38398.036, "grad_time_ms": 3500.602, "update_time_ms": 6.108, "opt_peak_throughput": 3212.219, "sample_peak_throughput": 292.846, "opt_samples": 11244.7, "learner": {"av": {"cur_kl_coeff": 5.499366579897469e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.06972914189100266, "policy_loss": -0.001656023203395307, "vf_loss": 0.07138505578041077, "vf_explained_var": 0.6317844390869141, "kl": 0.019805893301963806, "entropy": 1.2747793197631836, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11305, "done": false, "timesteps_total": 1062114, "episodes_total": 2430, "training_iteration": 95, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-41-59", "timestamp": 1588786919, "time_this_iter_s": 42.95371055603027, "time_total_s": 3627.325034379959, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3f28>", "on_episode_step": "<function on_episode_step at 0x7f5984675268>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3627.325034379959, "timesteps_since_restore": 1062114, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 84.56885245901637, "ram_util_percent": 33.886885245901645}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00045, "episode_reward_mean": 0.0398389, "episode_len_mean": 499.17, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.0398389}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.341869642837756, "avg_speed_min": 1.1093328902347086, "avg_speed_max": 4.862907650650847, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.44259233806681, "mean_processing_ms": 3.2669030155464083, "mean_inference_ms": 0.6008070548656126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1073235, "num_steps_sampled": 1073235, "sample_time_ms": 38744.182, "grad_time_ms": 3543.097, "update_time_ms": 6.119, "opt_peak_throughput": 3172.62, "sample_peak_throughput": 290.131, "opt_samples": 11240.9, "learner": {"av": {"cur_kl_coeff": 5.499366579897469e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.00016346760094165802, "policy_loss": -0.0010188014712184668, "vf_loss": 0.0011822598753497005, "vf_explained_var": 0.8944652676582336, "kl": 0.002681054174900055, "entropy": 1.240622878074646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11121, "done": false, "timesteps_total": 1073235, "episodes_total": 2451, "training_iteration": 96, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-42-42", "timestamp": 1588786962, "time_this_iter_s": 42.58438420295715, "time_total_s": 3669.9094185829163, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d158>", "on_episode_step": "<function on_episode_step at 0x7f598460d950>", "on_episode_end": "<function on_episode_end at 0x7f598460dd08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460dd90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3669.9094185829163, "timesteps_since_restore": 1073235, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 83.87213114754097, "ram_util_percent": 33.89672131147542}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -3.0005, "episode_reward_mean": 0.022313200000000002, "episode_len_mean": 498.88, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.022313200000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3783800395064723, "avg_speed_min": 1.156274737219801, "avg_speed_max": 4.7117953088999895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.52843531855343, "mean_processing_ms": 3.2644725318686625, "mean_inference_ms": 0.6023466268367853}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1084590, "num_steps_sampled": 1084590, "sample_time_ms": 39077.196, "grad_time_ms": 3582.198, "update_time_ms": 6.223, "opt_peak_throughput": 3140.642, "sample_peak_throughput": 287.902, "opt_samples": 11250.4, "learner": {"av": {"cur_kl_coeff": 2.7496832899487345e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05451728776097298, "policy_loss": -0.003469715593382716, "vf_loss": 0.05798697844147682, "vf_explained_var": 0.7342462539672852, "kl": 0.010385963134467602, "entropy": 1.3047645092010498, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11355, "done": false, "timesteps_total": 1084590, "episodes_total": 2475, "training_iteration": 97, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-43-24", "timestamp": 1588787004, "time_this_iter_s": 42.24455285072327, "time_total_s": 3712.1539714336395, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d0d0>", "on_episode_step": "<function on_episode_step at 0x7f5984675ae8>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3712.1539714336395, "timesteps_since_restore": 1084590, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 84.79333333333334, "ram_util_percent": 33.89500000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -3.0005, "episode_reward_mean": 0.014829799999999997, "episode_len_mean": 496.22, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.014829799999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.443780159669685, "avg_speed_min": 1.1062372761969934, "avg_speed_max": 4.7117953088999895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.593700934936315, "mean_processing_ms": 3.261594000045211, "mean_inference_ms": 0.6036347391335776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1095598, "num_steps_sampled": 1095598, "sample_time_ms": 39111.228, "grad_time_ms": 3593.878, "update_time_ms": 6.132, "opt_peak_throughput": 3124.007, "sample_peak_throughput": 287.061, "opt_samples": 11227.3, "learner": {"av": {"cur_kl_coeff": 2.7496832899487345e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.009501139633357525, "policy_loss": -0.005401941481977701, "vf_loss": 0.014903035014867783, "vf_explained_var": 0.4207480549812317, "kl": 0.01596871390938759, "entropy": 1.092148780822754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11008, "done": false, "timesteps_total": 1095598, "episodes_total": 2496, "training_iteration": 98, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-44-05", "timestamp": 1588787045, "time_this_iter_s": 41.33643555641174, "time_total_s": 3753.4904069900513, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d268>", "on_episode_step": "<function on_episode_step at 0x7f598460dd08>", "on_episode_end": "<function on_episode_end at 0x7f598460d950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845760d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3753.4904069900513, "timesteps_since_restore": 1095598, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 81.96333333333334, "ram_util_percent": 33.90166666666667}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.0005, "episode_reward_mean": 0.0873162, "episode_len_mean": 497.05, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.0873162}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.549319904644037, "avg_speed_min": 1.1062372761969934, "avg_speed_max": 4.794720187153167, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.6559439850333, "mean_processing_ms": 3.259297620925981, "mean_inference_ms": 0.6049233967749417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1107151, "num_steps_sampled": 1107151, "sample_time_ms": 39241.722, "grad_time_ms": 3615.013, "update_time_ms": 6.097, "opt_peak_throughput": 3113.765, "sample_peak_throughput": 286.845, "opt_samples": 11256.3, "learner": {"av": {"cur_kl_coeff": 2.7496832899487345e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.008880848996341228, "policy_loss": -0.011029775254428387, "vf_loss": 0.0021488643251359463, "vf_explained_var": 0.8244123458862305, "kl": 0.023281410336494446, "entropy": 1.40462064743042, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11553, "done": false, "timesteps_total": 1107151, "episodes_total": 2521, "training_iteration": 99, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-44-48", "timestamp": 1588787088, "time_this_iter_s": 42.17372369766235, "time_total_s": 3795.6641306877136, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546e18>", "on_episode_step": "<function on_episode_step at 0x7f59846756a8>", "on_episode_end": "<function on_episode_end at 0x7f5984675ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845768c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3795.6641306877136, "timesteps_since_restore": 1107151, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 83.73166666666667, "ram_util_percent": 33.89833333333334}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.0005, "episode_reward_mean": 0.0498239, "episode_len_mean": 496.56, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0005}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.0498239}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5278047039805305, "avg_speed_min": 1.1062372761969934, "avg_speed_max": 4.794720187153167, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.70871911550365, "mean_processing_ms": 3.2562694164917763, "mean_inference_ms": 0.6058634040836605}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1118042, "num_steps_sampled": 1118042, "sample_time_ms": 39374.049, "grad_time_ms": 3644.163, "update_time_ms": 6.005, "opt_peak_throughput": 3077.716, "sample_peak_throughput": 284.85, "opt_samples": 11215.7, "learner": {"av": {"cur_kl_coeff": 4.124524821236264e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.05938402935862541, "policy_loss": -0.007875537499785423, "vf_loss": 0.06725945323705673, "vf_explained_var": 0.7188319563865662, "kl": 0.02689662203192711, "entropy": 1.2032099962234497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10891, "done": false, "timesteps_total": 1118042, "episodes_total": 2541, "training_iteration": 100, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-45-31", "timestamp": 1588787131, "time_this_iter_s": 43.33070778846741, "time_total_s": 3838.994838476181, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e37b8>", "on_episode_step": "<function on_episode_step at 0x7f59845e30d0>", "on_episode_end": "<function on_episode_end at 0x7f59845e3620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e36a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3838.994838476181, "timesteps_since_restore": 1118042, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 84.6774193548387, "ram_util_percent": 33.89838709677421}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.00045, "episode_reward_mean": 0.042351200000000006, "episode_len_mean": 488.85, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.042351200000000006}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6605226514355174, "avg_speed_min": 1.1062372761969934, "avg_speed_max": 4.919925192432267, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.74577694014997, "mean_processing_ms": 3.2546580243095615, "mean_inference_ms": 0.606652637830043}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1129483, "num_steps_sampled": 1129483, "sample_time_ms": 38985.54, "grad_time_ms": 3577.157, "update_time_ms": 6.07, "opt_peak_throughput": 3138.694, "sample_peak_throughput": 287.994, "opt_samples": 11227.6, "learner": {"av": {"cur_kl_coeff": 6.186787686601747e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.035587508231401443, "policy_loss": -0.004838024731725454, "vf_loss": 0.04042547941207886, "vf_explained_var": 0.3601537048816681, "kl": 0.009404913522303104, "entropy": 1.313387155532837, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11441, "done": false, "timesteps_total": 1129483, "episodes_total": 2567, "training_iteration": 101, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-46-08", "timestamp": 1588787168, "time_this_iter_s": 36.92591428756714, "time_total_s": 3875.920752763748, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a488>", "on_episode_step": "<function on_episode_step at 0x7f59845e32f0>", "on_episode_end": "<function on_episode_end at 0x7f59845e31e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846756a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3875.920752763748, "timesteps_since_restore": 1129483, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 78.32075471698113, "ram_util_percent": 33.89622641509435}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.00045, "episode_reward_mean": 0.03235299999999999, "episode_len_mean": 485.91, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.03235299999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7228586567123, "avg_speed_min": 1.1062372761969934, "avg_speed_max": 4.919925192432267, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.77930301914601, "mean_processing_ms": 3.249870931662416, "mean_inference_ms": 0.6071873300368293}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1140526, "num_steps_sampled": 1140526, "sample_time_ms": 38468.018, "grad_time_ms": 3506.608, "update_time_ms": 5.94, "opt_peak_throughput": 3201.612, "sample_peak_throughput": 291.848, "opt_samples": 11226.8, "learner": {"av": {"cur_kl_coeff": 6.186787686601747e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.008156346157193184, "policy_loss": -0.003053770400583744, "vf_loss": 0.011209957301616669, "vf_explained_var": 0.5188233852386475, "kl": 0.026514142751693726, "entropy": 1.1318528652191162, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11043, "done": false, "timesteps_total": 1140526, "episodes_total": 2588, "training_iteration": 102, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-46-48", "timestamp": 1588787208, "time_this_iter_s": 39.607837200164795, "time_total_s": 3915.528589963913, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3840>", "on_episode_step": "<function on_episode_step at 0x7f59845e3048>", "on_episode_end": "<function on_episode_end at 0x7f59845e3f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e39d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3915.528589963913, "timesteps_since_restore": 1140526, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 81.47321428571429, "ram_util_percent": 33.9}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.00045, "episode_reward_mean": 0.04736100000000001, "episode_len_mean": 488.57, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.04736100000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.801767085818931, "avg_speed_min": 1.09810069566443, "avg_speed_max": 4.919925192432267, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.79361384348281, "mean_processing_ms": 3.2501527734124203, "mean_inference_ms": 0.6076913573134137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1151973, "num_steps_sampled": 1151973, "sample_time_ms": 38025.572, "grad_time_ms": 3439.227, "update_time_ms": 6.035, "opt_peak_throughput": 3265.239, "sample_peak_throughput": 295.325, "opt_samples": 11229.9, "learner": {"av": {"cur_kl_coeff": 9.28018107515527e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0005132166552357376, "policy_loss": -0.0011293241987004876, "vf_loss": 0.0006160158663988113, "vf_explained_var": 0.9501329660415649, "kl": 0.010323263704776764, "entropy": 1.1420520544052124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11447, "done": false, "timesteps_total": 1151973, "episodes_total": 2613, "training_iteration": 103, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-47-27", "timestamp": 1588787247, "time_this_iter_s": 38.725791215896606, "time_total_s": 3954.2543811798096, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3950>", "on_episode_step": "<function on_episode_step at 0x7f59845e3c80>", "on_episode_end": "<function on_episode_end at 0x7f59845e3ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3954.2543811798096, "timesteps_since_restore": 1151973, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 80.13636363636364, "ram_util_percent": 33.90000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00045, "episode_reward_mean": 0.05737409999999999, "episode_len_mean": 488.57, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00045}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.05737409999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9121594076613984, "avg_speed_min": 1.09810069566443, "avg_speed_max": 5.019324785065895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 37.7935777713324, "mean_processing_ms": 3.2450961653177863, "mean_inference_ms": 0.6073109793952035}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1162964, "num_steps_sampled": 1162964, "sample_time_ms": 37506.687, "grad_time_ms": 3374.127, "update_time_ms": 6.11, "opt_peak_throughput": 3323.971, "sample_peak_throughput": 299.027, "opt_samples": 11215.5, "learner": {"av": {"cur_kl_coeff": 9.28018107515527e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0008835165644995868, "policy_loss": 0.0003810245543718338, "vf_loss": 0.0005024692509323359, "vf_explained_var": 0.9617454409599304, "kl": 0.0028550063725560904, "entropy": 1.2396745681762695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10991, "done": false, "timesteps_total": 1162964, "episodes_total": 2633, "training_iteration": 104, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-48-06", "timestamp": 1588787286, "time_this_iter_s": 39.10469436645508, "time_total_s": 3993.3590755462646, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546b70>", "on_episode_step": "<function on_episode_step at 0x7f5984546d90>", "on_episode_end": "<function on_episode_end at 0x7f5984546840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845469d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 3993.3590755462646, "timesteps_since_restore": 1162964, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 79.58771929824562, "ram_util_percent": 33.900000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00013, "episode_reward_mean": 0.1173832, "episode_len_mean": 497.06, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.1173832}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8082911551500143, "avg_speed_min": 1.09810069566443, "avg_speed_max": 5.019324785065895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.806295804455374, "mean_processing_ms": 3.2447006985141122, "mean_inference_ms": 0.6080282013101999}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1174511, "num_steps_sampled": 1174511, "sample_time_ms": 37284.453, "grad_time_ms": 3345.377, "update_time_ms": 6.13, "opt_peak_throughput": 3359.771, "sample_peak_throughput": 301.458, "opt_samples": 11239.7, "learner": {"av": {"cur_kl_coeff": 4.640090537577635e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.003073454136028886, "policy_loss": 0.0027954766992479563, "vf_loss": 0.0002779015339910984, "vf_explained_var": 0.9772774577140808, "kl": 0.01730247773230076, "entropy": 1.150079369544983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11547, "done": false, "timesteps_total": 1174511, "episodes_total": 2658, "training_iteration": 105, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-48-46", "timestamp": 1588787326, "time_this_iter_s": 40.443846225738525, "time_total_s": 4033.802921772003, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845468c8>", "on_episode_step": "<function on_episode_step at 0x7f5984546158>", "on_episode_end": "<function on_episode_end at 0x7f59845461e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4033.802921772003, "timesteps_since_restore": 1174511, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 82.32280701754387, "ram_util_percent": 33.900000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00013, "episode_reward_mean": 0.11738379999999998, "episode_len_mean": 497.06, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.11738379999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8006238235164647, "avg_speed_min": 1.09810069566443, "avg_speed_max": 5.019324785065895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.830690085375444, "mean_processing_ms": 3.239638916823513, "mean_inference_ms": 0.6083515278117138}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1185476, "num_steps_sampled": 1185476, "sample_time_ms": 37279.446, "grad_time_ms": 3354.191, "update_time_ms": 6.052, "opt_peak_throughput": 3346.291, "sample_peak_throughput": 301.08, "opt_samples": 11224.1, "learner": {"av": {"cur_kl_coeff": 4.640090537577635e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002323381369933486, "policy_loss": -0.0023949379101395607, "vf_loss": 7.154689956223592e-05, "vf_explained_var": 0.9931269288063049, "kl": 0.0024982932955026627, "entropy": 1.0097432136535645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10965, "done": false, "timesteps_total": 1185476, "episodes_total": 2678, "training_iteration": 106, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-49-29", "timestamp": 1588787369, "time_this_iter_s": 42.61936640739441, "time_total_s": 4076.4222881793976, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845460d0>", "on_episode_step": "<function on_episode_step at 0x7f5984546ea0>", "on_episode_end": "<function on_episode_end at 0x7f5984546950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4076.4222881793976, "timesteps_since_restore": 1185476, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 83.69180327868852, "ram_util_percent": 33.903278688524594}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -0.0001, "episode_reward_mean": 0.12488260000000001, "episode_len_mean": 500.0, "episodes_this_iter": 25, "policy_reward_min": {"av": -0.0001}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.12488260000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.734358623166131, "avg_speed_min": 1.115400822540897, "avg_speed_max": 5.019324785065895, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.842659373378936, "mean_processing_ms": 3.239073933674047, "mean_inference_ms": 0.6087901225800634}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1196981, "num_steps_sampled": 1196981, "sample_time_ms": 37008.289, "grad_time_ms": 3319.303, "update_time_ms": 6.105, "opt_peak_throughput": 3385.982, "sample_peak_throughput": 303.691, "opt_samples": 11239.1, "learner": {"av": {"cur_kl_coeff": 2.3200452687888173e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.013853165321052074, "policy_loss": -0.014147055335342884, "vf_loss": 0.0002938589022960514, "vf_explained_var": 0.973085343837738, "kl": 0.0155830392614007, "entropy": 1.0374208688735962, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11505, "done": false, "timesteps_total": 1196981, "episodes_total": 2703, "training_iteration": 107, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-50-08", "timestamp": 1588787408, "time_this_iter_s": 39.18425893783569, "time_total_s": 4115.606547117233, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546a60>", "on_episode_step": "<function on_episode_step at 0x7f5984546158>", "on_episode_end": "<function on_episode_end at 0x7f59845468c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e31e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4115.606547117233, "timesteps_since_restore": 1196981, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 80.4375, "ram_util_percent": 33.9}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.11986400000000001, "episode_len_mean": 500.0, "episodes_this_iter": 20, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.11986400000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.603589445038885, "avg_speed_min": 1.115400822540897, "avg_speed_max": 4.933231050610643, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.89236099646946, "mean_processing_ms": 3.234090039633984, "mean_inference_ms": 0.6096536220454819}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1207980, "num_steps_sampled": 1207980, "sample_time_ms": 37200.707, "grad_time_ms": 3341.876, "update_time_ms": 6.28, "opt_peak_throughput": 3362.842, "sample_peak_throughput": 302.096, "opt_samples": 11238.2, "learner": {"av": {"cur_kl_coeff": 2.3200452687888173e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004633824806660414, "policy_loss": -0.005911529995501041, "vf_loss": 0.001277602044865489, "vf_explained_var": 0.8938307166099548, "kl": 0.044941436499357224, "entropy": 1.1613023281097412, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10999, "done": false, "timesteps_total": 1207980, "episodes_total": 2723, "training_iteration": 108, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-50-52", "timestamp": 1588787452, "time_this_iter_s": 43.4874849319458, "time_total_s": 4159.094032049179, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546400>", "on_episode_step": "<function on_episode_step at 0x7f5984546950>", "on_episode_end": "<function on_episode_end at 0x7f5984546ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4159.094032049179, "timesteps_since_restore": 1207980, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 84.65161290322578, "ram_util_percent": 33.90000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.1273642, "episode_len_mean": 500.0, "episodes_this_iter": 25, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.1273642}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.746076493989014, "avg_speed_min": 1.3245133641043414, "avg_speed_max": 4.97291554138271, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.900302377548, "mean_processing_ms": 3.2335524177819766, "mean_inference_ms": 0.6099990439564008}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1219553, "num_steps_sampled": 1219553, "sample_time_ms": 36743.758, "grad_time_ms": 3272.38, "update_time_ms": 6.262, "opt_peak_throughput": 3434.87, "sample_peak_throughput": 305.908, "opt_samples": 11240.2, "learner": {"av": {"cur_kl_coeff": 3.4800680168700637e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002174305496737361, "policy_loss": -0.0022837643045932055, "vf_loss": 0.00010942913650069386, "vf_explained_var": 0.9904946088790894, "kl": 0.00916177500039339, "entropy": 0.8465018272399902, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11573, "done": false, "timesteps_total": 1219553, "episodes_total": 2748, "training_iteration": 109, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-51-29", "timestamp": 1588787489, "time_this_iter_s": 36.91038632392883, "time_total_s": 4196.004418373108, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f5984546e18>", "on_episode_end": "<function on_episode_end at 0x7f5984546d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845460d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4196.004418373108, "timesteps_since_restore": 1219553, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 77.89245283018869, "ram_util_percent": 33.90000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.12487450000000001, "episode_len_mean": 500.0, "episodes_this_iter": 20, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.12487450000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7598989709119093, "avg_speed_min": 1.3245133641043414, "avg_speed_max": 5.25944845910231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.93765854878609, "mean_processing_ms": 3.2285241827263134, "mean_inference_ms": 0.6106569767215715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1230477, "num_steps_sampled": 1230477, "sample_time_ms": 36396.214, "grad_time_ms": 3221.98, "update_time_ms": 6.294, "opt_peak_throughput": 3489.625, "sample_peak_throughput": 308.919, "opt_samples": 11243.5, "learner": {"av": {"cur_kl_coeff": 3.4800680168700637e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005898905452340841, "policy_loss": -0.005945118144154549, "vf_loss": 4.614526915247552e-05, "vf_explained_var": 0.9959511756896973, "kl": 0.020094800740480423, "entropy": 0.7670916318893433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10924, "done": false, "timesteps_total": 1230477, "episodes_total": 2768, "training_iteration": 110, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-52-09", "timestamp": 1588787529, "time_this_iter_s": 39.35181188583374, "time_total_s": 4235.356230258942, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845461e0>", "on_episode_step": "<function on_episode_step at 0x7f5984546950>", "on_episode_end": "<function on_episode_end at 0x7f5984546400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4235.356230258942, "timesteps_since_restore": 1230477, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 81.85000000000001, "ram_util_percent": 33.9}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1248774, "episode_len_mean": 498.04, "episodes_this_iter": 26, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1248774}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.918363480724386, "avg_speed_min": 1.3245133641043414, "avg_speed_max": 5.25944845910231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.92960910592379, "mean_processing_ms": 3.226972432396019, "mean_inference_ms": 0.6106744316498164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1242087, "num_steps_sampled": 1242087, "sample_time_ms": 36482.84, "grad_time_ms": 3235.397, "update_time_ms": 6.221, "opt_peak_throughput": 3480.376, "sample_peak_throughput": 308.649, "opt_samples": 11260.4, "learner": {"av": {"cur_kl_coeff": 5.220102138991933e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.02690400928258896, "policy_loss": -0.003374651074409485, "vf_loss": 0.030278557911515236, "vf_explained_var": 0.25348660349845886, "kl": 0.019685791805386543, "entropy": 0.7515810132026672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11610, "done": false, "timesteps_total": 1242087, "episodes_total": 2794, "training_iteration": 111, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-52-47", "timestamp": 1588787567, "time_this_iter_s": 37.92449879646301, "time_total_s": 4273.280729055405, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546048>", "on_episode_step": "<function on_episode_step at 0x7f5984546d90>", "on_episode_end": "<function on_episode_end at 0x7f5984546e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461ae18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4273.280729055405, "timesteps_since_restore": 1242087, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 77.78545454545456, "ram_util_percent": 33.918181818181836}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1049052, "episode_len_mean": 495.74, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1049052}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9208872498749527, "avg_speed_min": 1.3245133641043414, "avg_speed_max": 5.25944845910231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.940766438997215, "mean_processing_ms": 3.222964632711335, "mean_inference_ms": 0.6107329707516913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1253022, "num_steps_sampled": 1253022, "sample_time_ms": 36595.119, "grad_time_ms": 3249.01, "update_time_ms": 6.219, "opt_peak_throughput": 3462.47, "sample_peak_throughput": 307.407, "opt_samples": 11249.6, "learner": {"av": {"cur_kl_coeff": 5.220102138991933e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.013761315494775772, "policy_loss": -0.004080009646713734, "vf_loss": 0.017841266468167305, "vf_explained_var": 0.45977649092674255, "kl": 0.011151477694511414, "entropy": 0.8270959854125977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10935, "done": false, "timesteps_total": 1253022, "episodes_total": 2814, "training_iteration": 112, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-53-28", "timestamp": 1588787608, "time_this_iter_s": 40.866578578948975, "time_total_s": 4314.147307634354, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845460d0>", "on_episode_step": "<function on_episode_step at 0x7f5984546488>", "on_episode_end": "<function on_episode_end at 0x7f5984546840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4314.147307634354, "timesteps_since_restore": 1253022, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 83.07413793103447, "ram_util_percent": 33.939655172413794}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.10241339999999999, "episode_len_mean": 495.74, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.10241339999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9215559418553663, "avg_speed_min": 1.6093938262881216, "avg_speed_max": 5.25944845910231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.93803118446947, "mean_processing_ms": 3.2216235287429513, "mean_inference_ms": 0.6109078240364555}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1264582, "num_steps_sampled": 1264582, "sample_time_ms": 36627.361, "grad_time_ms": 3255.137, "update_time_ms": 6.082, "opt_peak_throughput": 3459.424, "sample_peak_throughput": 307.445, "opt_samples": 11260.9, "learner": {"av": {"cur_kl_coeff": 5.220102138991933e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005578379146754742, "policy_loss": -0.005800718441605568, "vf_loss": 0.00022201132378540933, "vf_explained_var": 0.9805764555931091, "kl": 0.06327462941408157, "entropy": 1.0565639734268188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11560, "done": false, "timesteps_total": 1264582, "episodes_total": 2839, "training_iteration": 113, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-54-07", "timestamp": 1588787647, "time_this_iter_s": 39.10810136795044, "time_total_s": 4353.255409002304, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f5984546d90>", "on_episode_end": "<function on_episode_end at 0x7f5984546048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e31e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4353.255409002304, "timesteps_since_restore": 1264582, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 79.43214285714285, "ram_util_percent": 33.94642857142858}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.09990709999999998, "episode_len_mean": 495.74, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.09990709999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8078783194089563, "avg_speed_min": 1.0893022277418127, "avg_speed_max": 5.017220743379082, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.958348805190354, "mean_processing_ms": 3.217890621063978, "mean_inference_ms": 0.6111397563173939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1275563, "num_steps_sampled": 1275563, "sample_time_ms": 36976.269, "grad_time_ms": 3300.789, "update_time_ms": 6.049, "opt_peak_throughput": 3411.275, "sample_peak_throughput": 304.517, "opt_samples": 11259.9, "learner": {"av": {"cur_kl_coeff": 7.830152753740549e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002268383279442787, "policy_loss": -0.0025091718416661024, "vf_loss": 0.0002406543935649097, "vf_explained_var": 0.9798395037651062, "kl": 0.017030488699674606, "entropy": 1.059464931488037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10981, "done": false, "timesteps_total": 1275563, "episodes_total": 2859, "training_iteration": 114, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-54-50", "timestamp": 1588787690, "time_this_iter_s": 43.04993510246277, "time_total_s": 4396.305344104767, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546158>", "on_episode_step": "<function on_episode_step at 0x7f5984546488>", "on_episode_end": "<function on_episode_end at 0x7f59845460d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461aae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4396.305344104767, "timesteps_since_restore": 1275563, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 84.09677419354838, "ram_util_percent": 33.975806451612904}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.09988810000000001, "episode_len_mean": 495.74, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.09988810000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.68499389798379, "avg_speed_min": 1.0893022277418127, "avg_speed_max": 5.017220743379082, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 37.980527646412426, "mean_processing_ms": 3.2169948896510534, "mean_inference_ms": 0.611737097721393}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1287034, "num_steps_sampled": 1287034, "sample_time_ms": 36994.951, "grad_time_ms": 3300.02, "update_time_ms": 5.982, "opt_peak_throughput": 3409.767, "sample_peak_throughput": 304.158, "opt_samples": 11252.3, "learner": {"av": {"cur_kl_coeff": 7.830152753740549e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.006872143596410751, "policy_loss": -0.007743637543171644, "vf_loss": 0.0008713390561752021, "vf_explained_var": 0.9319725632667542, "kl": 0.020467417314648628, "entropy": 1.1754441261291504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11471, "done": false, "timesteps_total": 1287034, "episodes_total": 2884, "training_iteration": 115, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-55-31", "timestamp": 1588787731, "time_this_iter_s": 40.621718406677246, "time_total_s": 4436.927062511444, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546e18>", "on_episode_step": "<function on_episode_step at 0x7f5984546bf8>", "on_episode_end": "<function on_episode_end at 0x7f5984546048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4436.927062511444, "timesteps_since_restore": 1287034, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 83.14827586206897, "ram_util_percent": 33.97931034482759}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.00015, "episode_reward_mean": 0.11987229999999999, "episode_len_mean": 497.7, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.11987229999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6859984915052975, "avg_speed_min": 1.0893022277418127, "avg_speed_max": 5.017220743379082, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.02304735822402, "mean_processing_ms": 3.2145819427445095, "mean_inference_ms": 0.612492992575023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1298053, "num_steps_sampled": 1298053, "sample_time_ms": 36847.896, "grad_time_ms": 3272.966, "update_time_ms": 6.132, "opt_peak_throughput": 3439.601, "sample_peak_throughput": 305.518, "opt_samples": 11257.7, "learner": {"av": {"cur_kl_coeff": 1.1745229130610824e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002270752564072609, "policy_loss": -0.0026535894721746445, "vf_loss": 0.0003826536703854799, "vf_explained_var": 0.9678990244865417, "kl": 0.015571242198348045, "entropy": 0.9540309309959412, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11019, "done": false, "timesteps_total": 1298053, "episodes_total": 2904, "training_iteration": 116, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-56-12", "timestamp": 1588787772, "time_this_iter_s": 40.8807806968689, "time_total_s": 4477.807843208313, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461af28>", "on_episode_step": "<function on_episode_step at 0x7f598461a268>", "on_episode_end": "<function on_episode_end at 0x7f598461aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4477.807843208313, "timesteps_since_restore": 1298053, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 83.8896551724138, "ram_util_percent": 33.9896551724138}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -0.00017, "episode_reward_mean": 0.12488200000000002, "episode_len_mean": 500.0, "episodes_this_iter": 25, "policy_reward_min": {"av": -0.00017}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.12488200000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.59413175045048, "avg_speed_min": 1.0893022277418127, "avg_speed_max": 4.996642081676933, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.038024273244055, "mean_processing_ms": 3.2121264304885773, "mean_inference_ms": 0.61271960077771}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1309568, "num_steps_sampled": 1309568, "sample_time_ms": 36918.678, "grad_time_ms": 3279.821, "update_time_ms": 6.138, "opt_peak_throughput": 3432.718, "sample_peak_throughput": 304.959, "opt_samples": 11258.7, "learner": {"av": {"cur_kl_coeff": 1.1745229130610824e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0003711541648954153, "policy_loss": -0.0004495832836255431, "vf_loss": 7.810143870301545e-05, "vf_explained_var": 0.9933556318283081, "kl": 0.0279544647783041, "entropy": 0.9601842164993286, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11515, "done": false, "timesteps_total": 1309568, "episodes_total": 2929, "training_iteration": 117, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-56-52", "timestamp": 1588787812, "time_this_iter_s": 39.96097421646118, "time_total_s": 4517.768817424774, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461abf8>", "on_episode_step": "<function on_episode_step at 0x7f5984546048>", "on_episode_end": "<function on_episode_end at 0x7f5984546bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4517.768817424774, "timesteps_since_restore": 1309568, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 80.72456140350876, "ram_util_percent": 33.99473684210526}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.00017, "episode_reward_mean": 0.1373807, "episode_len_mean": 500.0, "episodes_this_iter": 20, "policy_reward_min": {"av": -0.00017}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1373807}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.717678429738159, "avg_speed_min": 1.0764303431176825, "avg_speed_max": 5.046362283275236, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.07528275835208, "mean_processing_ms": 3.210066767787653, "mean_inference_ms": 0.6134617631157644}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1320545, "num_steps_sampled": 1320545, "sample_time_ms": 36497.702, "grad_time_ms": 3217.473, "update_time_ms": 6.008, "opt_peak_throughput": 3498.553, "sample_peak_throughput": 308.417, "opt_samples": 11256.5, "learner": {"av": {"cur_kl_coeff": 1.7617843695916235e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010168998269364238, "policy_loss": -0.0011061833938583732, "vf_loss": 8.919687388697639e-05, "vf_explained_var": 0.9932666420936584, "kl": 0.005094759166240692, "entropy": 1.102676510810852, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10977, "done": false, "timesteps_total": 1320545, "episodes_total": 2949, "training_iteration": 118, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-57-30", "timestamp": 1588787850, "time_this_iter_s": 38.65316724777222, "time_total_s": 4556.421984672546, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461aae8>", "on_episode_step": "<function on_episode_step at 0x7f598461af28>", "on_episode_end": "<function on_episode_end at 0x7f598461a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845468c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e38c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4556.421984672546, "timesteps_since_restore": 1320545, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 81.61090909090906, "ram_util_percent": 33.99636363636363}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.00017, "episode_reward_mean": 0.1298959, "episode_len_mean": 500.0, "episodes_this_iter": 25, "policy_reward_min": {"av": -0.00017}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1298959}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6831332768975993, "avg_speed_min": 1.0390392972768765, "avg_speed_max": 5.046362283275236, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.078556797071485, "mean_processing_ms": 3.207481089833399, "mean_inference_ms": 0.6134565699112456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1332063, "num_steps_sampled": 1332063, "sample_time_ms": 36859.065, "grad_time_ms": 3272.539, "update_time_ms": 6.032, "opt_peak_throughput": 3438.004, "sample_peak_throughput": 305.244, "opt_samples": 11251.0, "learner": {"av": {"cur_kl_coeff": 1.7617843695916235e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028407229110598564, "policy_loss": -0.002911058720201254, "vf_loss": 7.028954132692888e-05, "vf_explained_var": 0.9943958520889282, "kl": 0.0026226334739476442, "entropy": 1.0899533033370972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11518, "done": false, "timesteps_total": 1332063, "episodes_total": 2974, "training_iteration": 119, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-58-12", "timestamp": 1588787892, "time_this_iter_s": 41.07256531715393, "time_total_s": 4597.4945499897, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461aa60>", "on_episode_step": "<function on_episode_step at 0x7f598461a620>", "on_episode_end": "<function on_episode_end at 0x7f598461a1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461ae18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4597.4945499897, "timesteps_since_restore": 1332063, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 82.05932203389831, "ram_util_percent": 33.99322033898305}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -9e-05, "episode_reward_mean": 0.1423981, "episode_len_mean": 500.0, "episodes_this_iter": 20, "policy_reward_min": {"av": -9e-05}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1423981}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7946073616432017, "avg_speed_min": 1.0390392972768765, "avg_speed_max": 5.046362283275236, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.09969093264239, "mean_processing_ms": 3.2052401321641666, "mean_inference_ms": 0.6138792043380734}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1343062, "num_steps_sampled": 1343062, "sample_time_ms": 36647.096, "grad_time_ms": 3239.059, "update_time_ms": 5.973, "opt_peak_throughput": 3475.855, "sample_peak_throughput": 307.214, "opt_samples": 11258.5, "learner": {"av": {"cur_kl_coeff": 8.808921847958118e-06, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028172447346150875, "policy_loss": -0.003413240425288677, "vf_loss": 0.0005958435358479619, "vf_explained_var": 0.9547871947288513, "kl": 0.01760384812951088, "entropy": 1.2239452600479126, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10999, "done": false, "timesteps_total": 1343062, "episodes_total": 2994, "training_iteration": 120, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-58-49", "timestamp": 1588787929, "time_this_iter_s": 36.89685845375061, "time_total_s": 4634.391408443451, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a7b8>", "on_episode_step": "<function on_episode_step at 0x7f598461aae8>", "on_episode_end": "<function on_episode_end at 0x7f598461a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e38c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4634.391408443451, "timesteps_since_restore": 1343062, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 79.20188679245283, "ram_util_percent": 33.99433962264151}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.1349057, "episode_len_mean": 497.62, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1349057}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.853394211663477, "avg_speed_min": 1.0390392972768765, "avg_speed_max": 5.175384232883065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.080422445426976, "mean_processing_ms": 3.202483590451333, "mean_inference_ms": 0.6134315437858757}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1354535, "num_steps_sampled": 1354535, "sample_time_ms": 36520.884, "grad_time_ms": 3226.637, "update_time_ms": 5.951, "opt_peak_throughput": 3484.99, "sample_peak_throughput": 307.901, "opt_samples": 11244.8, "learner": {"av": {"cur_kl_coeff": 8.808921847958118e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 0.009916173294186592, "policy_loss": -0.011163610965013504, "vf_loss": 0.021079467609524727, "vf_explained_var": 0.42716002464294434, "kl": 0.03610111027956009, "entropy": 1.018586277961731, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11473, "done": false, "timesteps_total": 1354535, "episodes_total": 3019, "training_iteration": 121, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_17-59-25", "timestamp": 1588787965, "time_this_iter_s": 36.538734436035156, "time_total_s": 4670.930142879486, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461af28>", "on_episode_step": "<function on_episode_step at 0x7f598461a620>", "on_episode_end": "<function on_episode_end at 0x7f598461aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461ae18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4670.930142879486, "timesteps_since_restore": 1354535, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 78.70384615384616, "ram_util_percent": 33.996153846153845}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.1349015, "episode_len_mean": 497.62, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1349015}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.825313218175724, "avg_speed_min": 1.0379621471407343, "avg_speed_max": 5.175384232883065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.083684623287255, "mean_processing_ms": 3.1992751280702807, "mean_inference_ms": 0.6133959326947207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1365699, "num_steps_sampled": 1365699, "sample_time_ms": 36435.605, "grad_time_ms": 3213.207, "update_time_ms": 6.03, "opt_peak_throughput": 3506.684, "sample_peak_throughput": 309.25, "opt_samples": 11267.7, "learner": {"av": {"cur_kl_coeff": 1.3213382771937177e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.010552617721259594, "policy_loss": -0.0069230906665325165, "vf_loss": 0.0174753088504076, "vf_explained_var": 0.6036765575408936, "kl": 0.030598195269703865, "entropy": 1.0303906202316284, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11164, "done": false, "timesteps_total": 1365699, "episodes_total": 3040, "training_iteration": 122, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-00-05", "timestamp": 1588788005, "time_this_iter_s": 39.8803391456604, "time_total_s": 4710.8104820251465, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598461aae8>", "on_episode_end": "<function on_episode_end at 0x7f598461a7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e38c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846758c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4710.8104820251465, "timesteps_since_restore": 1365699, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 81.15964912280702, "ram_util_percent": 34.00350877192982}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.12239529999999998, "episode_len_mean": 497.62, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.12239529999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6872973950491486, "avg_speed_min": 1.0379621471407343, "avg_speed_max": 5.175384232883065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.07941219981549, "mean_processing_ms": 3.1978214104666716, "mean_inference_ms": 0.6134043381726023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1377035, "num_steps_sampled": 1377035, "sample_time_ms": 36576.293, "grad_time_ms": 3238.756, "update_time_ms": 5.98, "opt_peak_throughput": 3472.104, "sample_peak_throughput": 307.448, "opt_samples": 11245.3, "learner": {"av": {"cur_kl_coeff": 1.9820074157905765e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.011688299477100372, "policy_loss": -0.012727093882858753, "vf_loss": 0.0010383635526522994, "vf_explained_var": 0.9116376042366028, "kl": 0.021857598796486855, "entropy": 0.9435331225395203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11336, "done": false, "timesteps_total": 1377035, "episodes_total": 3064, "training_iteration": 123, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-00-46", "timestamp": 1588788046, "time_this_iter_s": 40.7706561088562, "time_total_s": 4751.581138134003, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a268>", "on_episode_step": "<function on_episode_step at 0x7f598461aa60>", "on_episode_end": "<function on_episode_end at 0x7f598461a620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4751.581138134003, "timesteps_since_restore": 1377035, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 82.64827586206897, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.11989970000000001, "episode_len_mean": 497.62, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.11989970000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6592472493610315, "avg_speed_min": 1.0379621471407343, "avg_speed_max": 5.175384232883065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.08713971964651, "mean_processing_ms": 3.1948019166482347, "mean_inference_ms": 0.6134778108195199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1388171, "num_steps_sampled": 1388171, "sample_time_ms": 36364.032, "grad_time_ms": 3211.874, "update_time_ms": 5.984, "opt_peak_throughput": 3505.991, "sample_peak_throughput": 309.669, "opt_samples": 11260.8, "learner": {"av": {"cur_kl_coeff": 2.973011214635335e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.008625930175185204, "policy_loss": -0.008739677257835865, "vf_loss": 0.00011312062997603789, "vf_explained_var": 0.9897423386573792, "kl": 0.021099312230944633, "entropy": 0.8245505690574646, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11136, "done": false, "timesteps_total": 1388171, "episodes_total": 3085, "training_iteration": 124, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-01-27", "timestamp": 1588788087, "time_this_iter_s": 40.6580650806427, "time_total_s": 4792.239203214645, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461ae18>", "on_episode_step": "<function on_episode_step at 0x7f598461a1e0>", "on_episode_end": "<function on_episode_end at 0x7f598461a7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4792.239203214645, "timesteps_since_restore": 1388171, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 81.21896551724137, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0000900000000001, "episode_reward_mean": 0.11739999999999999, "episode_len_mean": 497.62, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0000900000000001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.11739999999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.593142197988185, "avg_speed_min": 1.0379621471407343, "avg_speed_max": 5.175384232883065, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.09326240734402, "mean_processing_ms": 3.193499842911145, "mean_inference_ms": 0.613693601796071}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1399567, "num_steps_sampled": 1399567, "sample_time_ms": 36251.565, "grad_time_ms": 3199.891, "update_time_ms": 6.045, "opt_peak_throughput": 3516.776, "sample_peak_throughput": 310.422, "opt_samples": 11253.3, "learner": {"av": {"cur_kl_coeff": 4.459516640054062e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.010626186616718769, "policy_loss": -0.010764672420918941, "vf_loss": 0.000135369788040407, "vf_explained_var": 0.9879481792449951, "kl": 0.06984759122133255, "entropy": 0.9459206461906433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11396, "done": false, "timesteps_total": 1399567, "episodes_total": 3109, "training_iteration": 125, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-02-06", "timestamp": 1588788126, "time_this_iter_s": 39.37819051742554, "time_total_s": 4831.617393732071, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845469d8>", "on_episode_step": "<function on_episode_step at 0x7f5984546950>", "on_episode_end": "<function on_episode_end at 0x7f5984546e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4831.617393732071, "timesteps_since_restore": 1399567, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 80.14035087719299, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00005, "episode_reward_mean": 0.1149117, "episode_len_mean": 497.04, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00005}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1149117}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.577028171160488, "avg_speed_min": 1.0391928234440386, "avg_speed_max": 5.165272001301278, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.10538028821893, "mean_processing_ms": 3.1907527184890396, "mean_inference_ms": 0.6138810241697118}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1410651, "num_steps_sampled": 1410651, "sample_time_ms": 35991.126, "grad_time_ms": 3168.29, "update_time_ms": 5.936, "opt_peak_throughput": 3553.904, "sample_peak_throughput": 312.849, "opt_samples": 11259.8, "learner": {"av": {"cur_kl_coeff": 6.689275323878974e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.012691730633378029, "policy_loss": 0.0015887744957581162, "vf_loss": 0.011101894080638885, "vf_explained_var": 0.6197634339332581, "kl": 0.015830304473638535, "entropy": 1.0419974327087402, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11084, "done": false, "timesteps_total": 1410651, "episodes_total": 3131, "training_iteration": 126, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-02-44", "timestamp": 1588788164, "time_this_iter_s": 37.960500955581665, "time_total_s": 4869.577894687653, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3048>", "on_episode_step": "<function on_episode_step at 0x7f59845e38c8>", "on_episode_end": "<function on_episode_end at 0x7f59845e3c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4869.577894687653, "timesteps_since_restore": 1410651, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 79.82777777777777, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -1.00005, "episode_reward_mean": 0.11241419999999999, "episode_len_mean": 497.04, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.00005}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.11241419999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.504274565687282, "avg_speed_min": 1.0391928234440386, "avg_speed_max": 5.068693861528405, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.107666287278946, "mean_processing_ms": 3.1901449322287885, "mean_inference_ms": 0.6140146894002014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1421944, "num_steps_sampled": 1421944, "sample_time_ms": 36049.748, "grad_time_ms": 3176.717, "update_time_ms": 5.993, "opt_peak_throughput": 3537.489, "sample_peak_throughput": 311.725, "opt_samples": 11237.6, "learner": {"av": {"cur_kl_coeff": 6.689275323878974e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.00544715067371726, "policy_loss": -0.005544968415051699, "vf_loss": 9.611877612769604e-05, "vf_explained_var": 0.9922628998756409, "kl": 0.025380278006196022, "entropy": 1.0607165098190308, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11293, "done": false, "timesteps_total": 1421944, "episodes_total": 3154, "training_iteration": 127, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-03-25", "timestamp": 1588788205, "time_this_iter_s": 40.631367921829224, "time_total_s": 4910.209262609482, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3a60>", "on_episode_step": "<function on_episode_step at 0x7f598461a9d8>", "on_episode_end": "<function on_episode_end at 0x7f598461aae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4910.209262609482, "timesteps_since_restore": 1421944, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 82.3896551724138, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -1.00005, "episode_reward_mean": 0.11992190000000001, "episode_len_mean": 497.04, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00005}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.11992190000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.537676917274801, "avg_speed_min": 1.0392544359231033, "avg_speed_max": 5.068693861528405, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.12513830725586, "mean_processing_ms": 3.1868184732930005, "mean_inference_ms": 0.614326365125787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1433133, "num_steps_sampled": 1433133, "sample_time_ms": 36236.772, "grad_time_ms": 3204.821, "update_time_ms": 5.944, "opt_peak_throughput": 3513.083, "sample_peak_throughput": 310.701, "opt_samples": 11258.8, "learner": {"av": {"cur_kl_coeff": 0.0001003391298581846, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0017360963393002748, "policy_loss": -0.002059699036180973, "vf_loss": 0.00032195894164033234, "vf_explained_var": 0.9331627488136292, "kl": 0.016372380778193474, "entropy": 1.107056736946106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11189, "done": false, "timesteps_total": 1433133, "episodes_total": 3176, "training_iteration": 128, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-04-06", "timestamp": 1588788246, "time_this_iter_s": 40.804840326309204, "time_total_s": 4951.014102935791, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3bf8>", "on_episode_step": "<function on_episode_step at 0x7f59845e38c8>", "on_episode_end": "<function on_episode_end at 0x7f59845e3048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4951.014102935791, "timesteps_since_restore": 1433133, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 82.53448275862068, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00033, "episode_reward_mean": 0.06241300000000001, "episode_len_mean": 494.66, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00033}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": 0.06241300000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5241794275980864, "avg_speed_min": 1.0392544359231033, "avg_speed_max": 5.1294346662010675, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.12491819658541, "mean_processing_ms": 3.1860806307191663, "mean_inference_ms": 0.6143980338088819}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1444452, "num_steps_sampled": 1444452, "sample_time_ms": 36133.711, "grad_time_ms": 3185.523, "update_time_ms": 6.011, "opt_peak_throughput": 3528.118, "sample_peak_throughput": 311.036, "opt_samples": 11238.9, "learner": {"av": {"cur_kl_coeff": 0.0001003391298581846, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004920936655253172, "policy_loss": -0.018029579892754555, "vf_loss": 0.013106619007885456, "vf_explained_var": 0.9653124809265137, "kl": 0.02015388011932373, "entropy": 1.1793502569198608, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11319, "done": false, "timesteps_total": 1444452, "episodes_total": 3200, "training_iteration": 129, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-04-46", "timestamp": 1588788286, "time_this_iter_s": 39.85088515281677, "time_total_s": 4990.864988088608, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3c80>", "on_episode_step": "<function on_episode_step at 0x7f5984546950>", "on_episode_end": "<function on_episode_end at 0x7f5984546e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 4990.864988088608, "timesteps_since_restore": 1444452, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 80.63333333333334, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00033, "episode_reward_mean": -0.0350931, "episode_len_mean": 483.51, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.00033}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.0350931}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6609311093020165, "avg_speed_min": 1.0428662656870826, "avg_speed_max": 5.484927554606575, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.137562146019434, "mean_processing_ms": 3.1855561597598494, "mean_inference_ms": 0.6145116395607102}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1455394, "num_steps_sampled": 1455394, "sample_time_ms": 36088.911, "grad_time_ms": 3184.88, "update_time_ms": 6.077, "opt_peak_throughput": 3527.04, "sample_peak_throughput": 311.265, "opt_samples": 11233.2, "learner": {"av": {"cur_kl_coeff": 0.00015050869842525572, "cur_lr": 9.999999747378752e-06, "total_loss": 0.17673389613628387, "policy_loss": -0.011629786342382431, "vf_loss": 0.18835881352424622, "vf_explained_var": 0.6776058673858643, "kl": 0.03246765211224556, "entropy": 1.1627986431121826, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10942, "done": false, "timesteps_total": 1455394, "episodes_total": 3223, "training_iteration": 130, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-05-23", "timestamp": 1588788323, "time_this_iter_s": 36.44285440444946, "time_total_s": 5027.307842493057, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675488>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f5984675378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5027.307842493057, "timesteps_since_restore": 1455394, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 78.80384615384615, "ram_util_percent": 34.003846153846155}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00051, "episode_reward_mean": -0.2226051, "episode_len_mean": 471.56, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.2226051}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.690260590565394, "avg_speed_min": 1.0428662656870826, "avg_speed_max": 5.484927554606575, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.12807891290784, "mean_processing_ms": 3.1847050487070465, "mean_inference_ms": 0.6144062734756082}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1466743, "num_steps_sampled": 1466743, "sample_time_ms": 36102.095, "grad_time_ms": 3172.246, "update_time_ms": 6.101, "opt_peak_throughput": 3537.179, "sample_peak_throughput": 310.807, "opt_samples": 11220.8, "learner": {"av": {"cur_kl_coeff": 0.00022576304036192596, "cur_lr": 9.999999747378752e-06, "total_loss": 0.3003372550010681, "policy_loss": -0.0060529084876179695, "vf_loss": 0.3063803017139435, "vf_explained_var": 0.6584029197692871, "kl": 0.04370691254734993, "entropy": 1.3659292459487915, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11349, "done": false, "timesteps_total": 1466743, "episodes_total": 3251, "training_iteration": 131, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-05-59", "timestamp": 1588788359, "time_this_iter_s": 36.54418110847473, "time_total_s": 5063.852023601532, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675620>", "on_episode_step": "<function on_episode_step at 0x7f598461a400>", "on_episode_end": "<function on_episode_end at 0x7f598461aae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5063.852023601532, "timesteps_since_restore": 1466743, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 74.96792452830188, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00051, "episode_reward_mean": -0.26010059999999996, "episode_len_mean": 468.9, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.26010059999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.656523341590209, "avg_speed_min": 1.0428614392837559, "avg_speed_max": 5.484927554606575, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.13703824544605, "mean_processing_ms": 3.1831996895566204, "mean_inference_ms": 0.6145441531304815}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1477519, "num_steps_sampled": 1477519, "sample_time_ms": 36409.127, "grad_time_ms": 3211.474, "update_time_ms": 6.04, "opt_peak_throughput": 3481.891, "sample_peak_throughput": 307.121, "opt_samples": 11182.0, "learner": {"av": {"cur_kl_coeff": 0.0003386445459909737, "cur_lr": 9.999999747378752e-06, "total_loss": 0.010285790078341961, "policy_loss": -0.0028863579500466585, "vf_loss": 0.013167249970138073, "vf_explained_var": 0.8471192717552185, "kl": 0.014468755573034286, "entropy": 1.092942237854004, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10776, "done": false, "timesteps_total": 1477519, "episodes_total": 3269, "training_iteration": 132, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-06-43", "timestamp": 1588788403, "time_this_iter_s": 43.3423547744751, "time_total_s": 5107.194378376007, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846751e0>", "on_episode_step": "<function on_episode_step at 0x7f5984675378>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5107.194378376007, "timesteps_since_restore": 1477519, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 84.74838709677418, "ram_util_percent": 34.0}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24997, "episode_reward_min": -3.00051, "episode_reward_mean": -0.21008609999999997, "episode_len_mean": 471.28, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24997}, "policy_reward_mean": {"av": -0.21008609999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5787899019358465, "avg_speed_min": 1.0375878506049843, "avg_speed_max": 5.484927554606575, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.1468580465421, "mean_processing_ms": 3.184445148908205, "mean_inference_ms": 0.6148805817731171}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1489294, "num_steps_sampled": 1489294, "sample_time_ms": 36404.572, "grad_time_ms": 3188.689, "update_time_ms": 6.061, "opt_peak_throughput": 3520.538, "sample_peak_throughput": 308.365, "opt_samples": 11225.9, "learner": {"av": {"cur_kl_coeff": 0.0003386445459909737, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0004435997107066214, "policy_loss": -0.0013283600565046072, "vf_loss": 0.0017708605155348778, "vf_explained_var": 0.8151203989982605, "kl": 0.0032562771812081337, "entropy": 1.131156086921692, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11775, "done": false, "timesteps_total": 1489294, "episodes_total": 3297, "training_iteration": 133, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-07-23", "timestamp": 1588788443, "time_this_iter_s": 40.496992111206055, "time_total_s": 5147.691370487213, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e39d8>", "on_episode_step": "<function on_episode_step at 0x7f59845e3a60>", "on_episode_end": "<function on_episode_end at 0x7f59845e3bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e38c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5147.691370487213, "timesteps_since_restore": 1489294, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 80.43620689655172, "ram_util_percent": 34.00344827586206}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00051, "episode_reward_mean": -0.13008970000000003, "episode_len_mean": 482.5, "episodes_this_iter": 17, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": -0.13008970000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.464689949307043, "avg_speed_min": 1.0375878506049843, "avg_speed_max": 5.3073457050075765, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.15248763862044, "mean_processing_ms": 3.1791565557829413, "mean_inference_ms": 0.6146288585892623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1500041, "num_steps_sampled": 1500041, "sample_time_ms": 36618.023, "grad_time_ms": 3208.985, "update_time_ms": 6.012, "opt_peak_throughput": 3486.149, "sample_peak_throughput": 305.505, "opt_samples": 11187.0, "learner": {"av": {"cur_kl_coeff": 0.00016932227299548686, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0023933968041092157, "policy_loss": -0.003463543951511383, "vf_loss": 0.0010655588703230023, "vf_explained_var": 0.9026396870613098, "kl": 0.027103431522846222, "entropy": 1.0829052925109863, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10747, "done": false, "timesteps_total": 1500041, "episodes_total": 3314, "training_iteration": 134, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-08-06", "timestamp": 1588788486, "time_this_iter_s": 42.99534201622009, "time_total_s": 5190.686712503433, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3c80>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f5984675158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845460d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5190.686712503433, "timesteps_since_restore": 1500041, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 85.57049180327871, "ram_util_percent": 34.03442622950819}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00051, "episode_reward_mean": -0.007591099999999982, "episode_len_mean": 492.84, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.007591099999999982}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.358456488119166, "avg_speed_min": 1.0375878506049843, "avg_speed_max": 5.3073457050075765, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.184683004002466, "mean_processing_ms": 3.180355069801325, "mean_inference_ms": 0.6155212008606754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1511834, "num_steps_sampled": 1511834, "sample_time_ms": 36523.089, "grad_time_ms": 3177.305, "update_time_ms": 5.934, "opt_peak_throughput": 3533.403, "sample_peak_throughput": 307.386, "opt_samples": 11226.7, "learner": {"av": {"cur_kl_coeff": 0.0002539834240451455, "cur_lr": 9.999999747378752e-06, "total_loss": 0.001551673631183803, "policy_loss": 0.0013574932236224413, "vf_loss": 0.0001924687239807099, "vf_explained_var": 0.982623815536499, "kl": 0.006730054505169392, "entropy": 1.082222819328308, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11793, "done": false, "timesteps_total": 1511834, "episodes_total": 3342, "training_iteration": 135, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-08-45", "timestamp": 1588788525, "time_this_iter_s": 38.11127305030823, "time_total_s": 5228.7979855537415, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3ae8>", "on_episode_step": "<function on_episode_step at 0x7f59845e3a60>", "on_episode_end": "<function on_episode_end at 0x7f59845e3048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a2f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5228.7979855537415, "timesteps_since_restore": 1511834, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 80.02222222222224, "ram_util_percent": 34.04259259259259}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.1124222, "episode_len_mean": 500.0, "episodes_this_iter": 17, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.1124222}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.319826725684989, "avg_speed_min": 1.0375878506049843, "avg_speed_max": 4.970962533886151, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.21694475139413, "mean_processing_ms": 3.175921266988721, "mean_inference_ms": 0.6158259719733225}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1522605, "num_steps_sampled": 1522605, "sample_time_ms": 37058.098, "grad_time_ms": 3249.7, "update_time_ms": 6.035, "opt_peak_throughput": 3445.056, "sample_peak_throughput": 302.104, "opt_samples": 11195.4, "learner": {"av": {"cur_kl_coeff": 0.0002539834240451455, "cur_lr": 9.999999747378752e-06, "total_loss": -0.001995889935642481, "policy_loss": -0.00217501912266016, "vf_loss": 0.00017755466978996992, "vf_explained_var": 0.984118640422821, "kl": 0.0062067098915576935, "entropy": 0.9609013795852661, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10771, "done": false, "timesteps_total": 1522605, "episodes_total": 3359, "training_iteration": 136, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-09-29", "timestamp": 1588788569, "time_this_iter_s": 44.03403162956238, "time_total_s": 5272.832017183304, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a268>", "on_episode_step": "<function on_episode_step at 0x7f598461a048>", "on_episode_end": "<function on_episode_end at 0x7f598461a840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461ae18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5272.832017183304, "timesteps_since_restore": 1522605, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 85.26031746031745, "ram_util_percent": 34.082539682539675}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.1324118, "episode_len_mean": 500.0, "episodes_this_iter": 28, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1324118}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.5564180508370518, "avg_speed_min": 1.0396182690804583, "avg_speed_max": 5.078927994013739, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.229640330086376, "mean_processing_ms": 3.175415230958998, "mean_inference_ms": 0.616099624582366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1534334, "num_steps_sampled": 1534334, "sample_time_ms": 36640.694, "grad_time_ms": 3169.816, "update_time_ms": 5.911, "opt_peak_throughput": 3545.632, "sample_peak_throughput": 306.735, "opt_samples": 11239.0, "learner": {"av": {"cur_kl_coeff": 0.0002539834240451455, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0029029371216893196, "policy_loss": -0.00302769523113966, "vf_loss": 0.00012335568317212164, "vf_explained_var": 0.9905816912651062, "kl": 0.00552697479724884, "entropy": 1.1340558528900146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11729, "done": false, "timesteps_total": 1534334, "episodes_total": 3387, "training_iteration": 137, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-10-04", "timestamp": 1588788604, "time_this_iter_s": 35.65713691711426, "time_total_s": 5308.489154100418, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3a60>", "on_episode_step": "<function on_episode_step at 0x7f598461a400>", "on_episode_end": "<function on_episode_end at 0x7f598461aae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a2f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5308.489154100418, "timesteps_since_restore": 1534334, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 79.15686274509805, "ram_util_percent": 34.07450980392156}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.14240449999999996, "episode_len_mean": 500.0, "episodes_this_iter": 17, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.14240449999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.630573463722344, "avg_speed_min": 1.0396182690804583, "avg_speed_max": 5.078927994013739, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.25237740271672, "mean_processing_ms": 3.172016088983361, "mean_inference_ms": 0.6162031025158684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1545007, "num_steps_sampled": 1545007, "sample_time_ms": 36734.187, "grad_time_ms": 3176.914, "update_time_ms": 6.002, "opt_peak_throughput": 3521.467, "sample_peak_throughput": 304.55, "opt_samples": 11187.4, "learner": {"av": {"cur_kl_coeff": 0.0002539834240451455, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0016284638550132513, "policy_loss": -0.0016742474399507046, "vf_loss": 4.4723463361151516e-05, "vf_explained_var": 0.9964712858200073, "kl": 0.004169341176748276, "entropy": 1.0623053312301636, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10673, "done": false, "timesteps_total": 1545007, "episodes_total": 3404, "training_iteration": 138, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-10-46", "timestamp": 1588788646, "time_this_iter_s": 41.81174898147583, "time_total_s": 5350.300903081894, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3048>", "on_episode_step": "<function on_episode_step at 0x7f598461a048>", "on_episode_end": "<function on_episode_end at 0x7f598461a268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461ae18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460df28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5350.300903081894, "timesteps_since_restore": 1545007, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 84.09333333333333, "ram_util_percent": 34.09333333333333}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1e-05, "episode_reward_mean": 0.13491469999999997, "episode_len_mean": 500.0, "episodes_this_iter": 28, "policy_reward_min": {"av": -1e-05}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.13491469999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.522453171768424, "avg_speed_min": 1.0396182690804583, "avg_speed_max": 5.078927994013739, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.266811833056984, "mean_processing_ms": 3.1715379001987007, "mean_inference_ms": 0.6165453003271791}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1556867, "num_steps_sampled": 1556867, "sample_time_ms": 36708.682, "grad_time_ms": 3158.288, "update_time_ms": 5.932, "opt_peak_throughput": 3559.366, "sample_peak_throughput": 306.235, "opt_samples": 11241.5, "learner": {"av": {"cur_kl_coeff": 0.00012699171202257276, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010145200649276376, "policy_loss": -0.0010409889509901404, "vf_loss": 2.3508984668296762e-05, "vf_explained_var": 0.9981579184532166, "kl": 0.02329826168715954, "entropy": 1.0327860116958618, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11860, "done": false, "timesteps_total": 1556867, "episodes_total": 3432, "training_iteration": 139, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-11-26", "timestamp": 1588788686, "time_this_iter_s": 39.40858507156372, "time_total_s": 5389.709488153458, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3840>", "on_episode_step": "<function on_episode_step at 0x7f598461aae8>", "on_episode_end": "<function on_episode_end at 0x7f598461a400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5389.709488153458, "timesteps_since_restore": 1556867, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 81.29642857142858, "ram_util_percent": 34.089285714285715}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.0003, "episode_reward_mean": 0.09741059999999999, "episode_len_mean": 495.63, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.09741059999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.579025069568727, "avg_speed_min": 1.0403062688210813, "avg_speed_max": 5.078927994013739, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.28223932098521, "mean_processing_ms": 3.1684271730182547, "mean_inference_ms": 0.61655920998037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1567634, "num_steps_sampled": 1567634, "sample_time_ms": 37267.711, "grad_time_ms": 3219.941, "update_time_ms": 5.933, "opt_peak_throughput": 3485.778, "sample_peak_throughput": 301.172, "opt_samples": 11224.0, "learner": {"av": {"cur_kl_coeff": 0.00019048756803385913, "cur_lr": 9.999999747378752e-06, "total_loss": 0.007766456343233585, "policy_loss": -0.01455366238951683, "vf_loss": 0.022315744310617447, "vf_explained_var": 0.8826563954353333, "kl": 0.022962763905525208, "entropy": 0.9117919206619263, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10767, "done": false, "timesteps_total": 1567634, "episodes_total": 3451, "training_iteration": 140, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-12-09", "timestamp": 1588788729, "time_this_iter_s": 42.64988398551941, "time_total_s": 5432.359372138977, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d620>", "on_episode_step": "<function on_episode_step at 0x7f598460db70>", "on_episode_end": "<function on_episode_end at 0x7f598460d400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a2f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5432.359372138977, "timesteps_since_restore": 1567634, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 80.9655737704918, "ram_util_percent": 34.09508196721311}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.0003, "episode_reward_mean": 0.0899166, "episode_len_mean": 495.63, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.0899166}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5052190024157146, "avg_speed_min": 1.0403062688210813, "avg_speed_max": 5.143714754188825, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.298494831292416, "mean_processing_ms": 3.1682472554361665, "mean_inference_ms": 0.6169466139095825}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1579342, "num_steps_sampled": 1579342, "sample_time_ms": 37596.164, "grad_time_ms": 3279.783, "update_time_ms": 5.911, "opt_peak_throughput": 3433.124, "sample_peak_throughput": 299.496, "opt_samples": 11259.9, "learner": {"av": {"cur_kl_coeff": 0.00028573133749887347, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002709852298721671, "policy_loss": -0.0029343923088163137, "vf_loss": 0.00022233574418351054, "vf_explained_var": 0.9766672253608704, "kl": 0.0077101923525333405, "entropy": 0.786253809928894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11708, "done": false, "timesteps_total": 1579342, "episodes_total": 3477, "training_iteration": 141, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-12-49", "timestamp": 1588788769, "time_this_iter_s": 40.42685413360596, "time_total_s": 5472.786226272583, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d1e0>", "on_episode_step": "<function on_episode_step at 0x7f59846756a8>", "on_episode_end": "<function on_episode_end at 0x7f5984675a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5472.786226272583, "timesteps_since_restore": 1579342, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 81.51896551724137, "ram_util_percent": 34.08793103448275}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.0003, "episode_reward_mean": 0.07241859999999999, "episode_len_mean": 493.22, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.07241859999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.416696724725868, "avg_speed_min": 1.0402534712019893, "avg_speed_max": 5.143714754188825, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.30912124020922, "mean_processing_ms": 3.166439121009067, "mean_inference_ms": 0.6170111350147454}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1590228, "num_steps_sampled": 1590228, "sample_time_ms": 37379.607, "grad_time_ms": 3259.407, "update_time_ms": 5.96, "opt_peak_throughput": 3457.96, "sample_peak_throughput": 301.525, "opt_samples": 11270.9, "learner": {"av": {"cur_kl_coeff": 0.00028573133749887347, "cur_lr": 9.999999747378752e-06, "total_loss": 0.01650775410234928, "policy_loss": -0.0004721162258647382, "vf_loss": 0.016977930441498756, "vf_explained_var": 0.49395880103111267, "kl": 0.0067817773669958115, "entropy": 0.9720522165298462, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10886, "done": false, "timesteps_total": 1590228, "episodes_total": 3497, "training_iteration": 142, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-13-30", "timestamp": 1588788810, "time_this_iter_s": 40.973209857940674, "time_total_s": 5513.759436130524, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d598>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f598460db70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598461a2f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845e3c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5513.759436130524, "timesteps_since_restore": 1590228, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 82.52203389830508, "ram_util_percent": 34.09661016949152}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.0003, "episode_reward_mean": 0.07491949999999999, "episode_len_mean": 493.22, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.07491949999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4950017414831764, "avg_speed_min": 1.0402534712019893, "avg_speed_max": 5.143714754188825, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.32606759282537, "mean_processing_ms": 3.1654159085879248, "mean_inference_ms": 0.6173597877921502}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1601737, "num_steps_sampled": 1601737, "sample_time_ms": 37126.764, "grad_time_ms": 3239.794, "update_time_ms": 5.985, "opt_peak_throughput": 3470.684, "sample_peak_throughput": 302.862, "opt_samples": 11244.3, "learner": {"av": {"cur_kl_coeff": 0.00028573133749887347, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004781207535415888, "policy_loss": -0.005924304947257042, "vf_loss": 0.001140924054197967, "vf_explained_var": 0.8985069394111633, "kl": 0.007595640141516924, "entropy": 0.8375219106674194, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11509, "done": false, "timesteps_total": 1601737, "episodes_total": 3522, "training_iteration": 143, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-14-08", "timestamp": 1588788848, "time_this_iter_s": 37.772284269332886, "time_total_s": 5551.531720399857, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d488>", "on_episode_step": "<function on_episode_step at 0x7f598460d730>", "on_episode_end": "<function on_episode_end at 0x7f598460d6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460dc80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5551.531720399857, "timesteps_since_restore": 1601737, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 79.94814814814815, "ram_util_percent": 34.09629629629629}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.0003, "episode_reward_mean": 0.06242259999999999, "episode_len_mean": 491.52, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0003}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.06242259999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5603160020389413, "avg_speed_min": 1.0402534712019893, "avg_speed_max": 5.143714754188825, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.33473076146532, "mean_processing_ms": 3.1635794388805647, "mean_inference_ms": 0.6175838252862405}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1612945, "num_steps_sampled": 1612945, "sample_time_ms": 36891.422, "grad_time_ms": 3213.951, "update_time_ms": 6.094, "opt_peak_throughput": 3512.935, "sample_peak_throughput": 306.044, "opt_samples": 11290.4, "learner": {"av": {"cur_kl_coeff": 0.00028573133749887347, "cur_lr": 9.999999747378752e-06, "total_loss": 0.01242364663630724, "policy_loss": -0.0075447033159434795, "vf_loss": 0.019958961755037308, "vf_explained_var": 0.3864387571811676, "kl": 0.03286739066243172, "entropy": 0.7002050876617432, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11208, "done": false, "timesteps_total": 1612945, "episodes_total": 3543, "training_iteration": 144, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-14-49", "timestamp": 1588788889, "time_this_iter_s": 40.38460302352905, "time_total_s": 5591.916323423386, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d620>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f598460d598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59845e3c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5591.916323423386, "timesteps_since_restore": 1612945, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 82.27894736842104, "ram_util_percent": 34.098245614035086}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00015, "episode_reward_mean": 0.0999269, "episode_len_mean": 495.89, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.0999269}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.504960802469393, "avg_speed_min": 1.0402534712019893, "avg_speed_max": 5.134207238561306, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.341197384960836, "mean_processing_ms": 3.1617753614883264, "mean_inference_ms": 0.6173491442918249}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1624325, "num_steps_sampled": 1624325, "sample_time_ms": 37126.856, "grad_time_ms": 3264.016, "update_time_ms": 6.109, "opt_peak_throughput": 3446.398, "sample_peak_throughput": 302.991, "opt_samples": 11249.1, "learner": {"av": {"cur_kl_coeff": 0.0004285970062483102, "cur_lr": 9.999999747378752e-06, "total_loss": -0.001486750552430749, "policy_loss": -0.0018035018583759665, "vf_loss": 0.0003020852745976299, "vf_explained_var": 0.966154932975769, "kl": 0.034222397953271866, "entropy": 0.947074830532074, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11380, "done": false, "timesteps_total": 1624325, "episodes_total": 3567, "training_iteration": 145, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-15-30", "timestamp": 1588788930, "time_this_iter_s": 40.96667456626892, "time_total_s": 5632.8829979896545, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a840>", "on_episode_step": "<function on_episode_step at 0x7f5984546c80>", "on_episode_end": "<function on_episode_end at 0x7f5984546ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472aea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5632.8829979896545, "timesteps_since_restore": 1624325, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 81.70677966101697, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00015, "episode_reward_mean": 0.1024195, "episode_len_mean": 495.89, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.00015}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1024195}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5148952953595853, "avg_speed_min": 1.0401921826548592, "avg_speed_max": 5.134207238561306, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.35608469577425, "mean_processing_ms": 3.1608232092256983, "mean_inference_ms": 0.6180226005091369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1635338, "num_steps_sampled": 1635338, "sample_time_ms": 36915.689, "grad_time_ms": 3229.277, "update_time_ms": 6.032, "opt_peak_throughput": 3490.967, "sample_peak_throughput": 305.38, "opt_samples": 11273.3, "learner": {"av": {"cur_kl_coeff": 0.0006428955239243805, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003520593047142029, "policy_loss": -0.003645711811259389, "vf_loss": 0.0001194071228383109, "vf_explained_var": 0.9884456992149353, "kl": 0.008881407789885998, "entropy": 0.9579619765281677, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11013, "done": false, "timesteps_total": 1635338, "episodes_total": 3588, "training_iteration": 146, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-16-11", "timestamp": 1588788971, "time_this_iter_s": 41.57417321205139, "time_total_s": 5674.457171201706, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461ae18>", "on_episode_step": "<function on_episode_step at 0x7f598460d598>", "on_episode_end": "<function on_episode_end at 0x7f598460d400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5674.457171201706, "timesteps_since_restore": 1635338, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 83.76779661016948, "ram_util_percent": 34.10338983050847}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0001, "episode_reward_mean": 0.08742899999999999, "episode_len_mean": 496.19, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.08742899999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.365562463496543, "avg_speed_min": 1.0401921826548592, "avg_speed_max": 5.134207238561306, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.375667296381465, "mean_processing_ms": 3.1581406675217254, "mean_inference_ms": 0.6182250190347088}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1646867, "num_steps_sampled": 1646867, "sample_time_ms": 37370.584, "grad_time_ms": 3312.785, "update_time_ms": 6.023, "opt_peak_throughput": 3396.931, "sample_peak_throughput": 301.127, "opt_samples": 11253.3, "learner": {"av": {"cur_kl_coeff": 0.0006428955239243805, "cur_lr": 9.999999747378752e-06, "total_loss": 0.021913275122642517, "policy_loss": 0.0008923850837163627, "vf_loss": 0.021018419414758682, "vf_explained_var": 0.3597884774208069, "kl": 0.003846267005428672, "entropy": 0.917679488658905, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11529, "done": false, "timesteps_total": 1646867, "episodes_total": 3613, "training_iteration": 147, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-16-52", "timestamp": 1588789012, "time_this_iter_s": 41.04161715507507, "time_total_s": 5715.498788356781, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546c80>", "on_episode_step": "<function on_episode_step at 0x7f5984546488>", "on_episode_end": "<function on_episode_end at 0x7f5984546840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5715.498788356781, "timesteps_since_restore": 1646867, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 81.98305084745765, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.00008, "episode_reward_mean": 0.0899351, "episode_len_mean": 497.89, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.00008}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.0899351}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.211156130789073, "avg_speed_min": 1.0388248683906902, "avg_speed_max": 4.92105221573566, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.391040483263076, "mean_processing_ms": 3.1583056433024757, "mean_inference_ms": 0.6186589129697109}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1657850, "num_steps_sampled": 1657850, "sample_time_ms": 37488.929, "grad_time_ms": 3334.31, "update_time_ms": 6.035, "opt_peak_throughput": 3384.299, "sample_peak_throughput": 301.004, "opt_samples": 11284.3, "learner": {"av": {"cur_kl_coeff": 0.00032144776196219027, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003495276439934969, "policy_loss": -0.00422084191814065, "vf_loss": 0.0007217588718049228, "vf_explained_var": 0.914357602596283, "kl": 0.011853531002998352, "entropy": 0.8080664277076721, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10983, "done": false, "timesteps_total": 1657850, "episodes_total": 3633, "training_iteration": 148, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-17-36", "timestamp": 1588789056, "time_this_iter_s": 43.21007966995239, "time_total_s": 5758.708868026733, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59845e3c80>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f598460d598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5758.708868026733, "timesteps_since_restore": 1657850, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 84.87903225806451, "ram_util_percent": 34.09999999999999}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.00008, "episode_reward_mean": 0.08243289999999998, "episode_len_mean": 496.05, "episodes_this_iter": 26, "policy_reward_min": {"av": -1.00008}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.08243289999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.242200808794711, "avg_speed_min": 1.0388248683906902, "avg_speed_max": 5.074027785741889, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.42270068525885, "mean_processing_ms": 3.156702487518902, "mean_inference_ms": 0.619360314727725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1669477, "num_steps_sampled": 1669477, "sample_time_ms": 37493.839, "grad_time_ms": 3352.919, "update_time_ms": 5.985, "opt_peak_throughput": 3358.566, "sample_peak_throughput": 300.343, "opt_samples": 11261.0, "learner": {"av": {"cur_kl_coeff": 0.00032144776196219027, "cur_lr": 9.999999747378752e-06, "total_loss": 0.01357753574848175, "policy_loss": -0.009620576165616512, "vf_loss": 0.02319197915494442, "vf_explained_var": 0.37453553080558777, "kl": 0.019087182357907295, "entropy": 0.9911778569221497, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11627, "done": false, "timesteps_total": 1669477, "episodes_total": 3659, "training_iteration": 149, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-18-15", "timestamp": 1588789095, "time_this_iter_s": 39.64222002029419, "time_total_s": 5798.351088047028, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f598460d730>", "on_episode_end": "<function on_episode_end at 0x7f598460d6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5798.351088047028, "timesteps_since_restore": 1669477, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 80.37368421052632, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -3.00058, "episode_reward_mean": 0.052423800000000007, "episode_len_mean": 495.73, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.052423800000000007}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.243415331447485, "avg_speed_min": 1.0388248683906902, "avg_speed_max": 5.074027785741889, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.43921300676896, "mean_processing_ms": 3.155899706961309, "mean_inference_ms": 0.6196696506862035}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1680305, "num_steps_sampled": 1680305, "sample_time_ms": 37483.487, "grad_time_ms": 3365.512, "update_time_ms": 5.992, "opt_peak_throughput": 3347.812, "sample_peak_throughput": 300.588, "opt_samples": 11267.1, "learner": {"av": {"cur_kl_coeff": 0.00032144776196219027, "cur_lr": 9.999999747378752e-06, "total_loss": 0.08294183760881424, "policy_loss": -0.007897898554801941, "vf_loss": 0.09083504974842072, "vf_explained_var": 0.2703295350074768, "kl": 0.014592178165912628, "entropy": 0.9070309996604919, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10828, "done": false, "timesteps_total": 1680305, "episodes_total": 3678, "training_iteration": 150, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-18-58", "timestamp": 1588789138, "time_this_iter_s": 42.67190337181091, "time_total_s": 5841.0229914188385, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546840>", "on_episode_step": "<function on_episode_step at 0x7f598460d620>", "on_episode_end": "<function on_episode_end at 0x7f598460db70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461a6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5841.0229914188385, "timesteps_since_restore": 1680305, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 84.02950819672132, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -3.00058, "episode_reward_mean": 0.06991180000000002, "episode_len_mean": 497.84, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.06991180000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2586398400260608, "avg_speed_min": 1.0388248683906902, "avg_speed_max": 5.074027785741889, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.48242077348196, "mean_processing_ms": 3.1542712702741795, "mean_inference_ms": 0.6203773779007367}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1691881, "num_steps_sampled": 1691881, "sample_time_ms": 37735.398, "grad_time_ms": 3397.565, "update_time_ms": 6.056, "opt_peak_throughput": 3312.342, "sample_peak_throughput": 298.232, "opt_samples": 11253.9, "learner": {"av": {"cur_kl_coeff": 0.00032144776196219027, "cur_lr": 9.999999747378752e-06, "total_loss": 0.009818267077207565, "policy_loss": -0.010931580327451229, "vf_loss": 0.02074124850332737, "vf_explained_var": 0.5818735957145691, "kl": 0.026745852082967758, "entropy": 1.0280416011810303, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11576, "done": false, "timesteps_total": 1691881, "episodes_total": 3704, "training_iteration": 151, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-19-42", "timestamp": 1588789182, "time_this_iter_s": 43.26709818840027, "time_total_s": 5884.290089607239, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546c80>", "on_episode_step": "<function on_episode_step at 0x7f598460d6a8>", "on_episode_end": "<function on_episode_end at 0x7f598460d730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598461aae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5884.290089607239, "timesteps_since_restore": 1691881, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 85.58852459016391, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -3.00058, "episode_reward_mean": 0.0649075, "episode_len_mean": 497.84, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.0649075}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1948130974875357, "avg_speed_min": 1.0388248683906902, "avg_speed_max": 5.074027785741889, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.503773903152165, "mean_processing_ms": 3.1536012781719696, "mean_inference_ms": 0.6208834495604433}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1702843, "num_steps_sampled": 1702843, "sample_time_ms": 38064.077, "grad_time_ms": 3431.541, "update_time_ms": 6.11, "opt_peak_throughput": 3281.761, "sample_peak_throughput": 295.856, "opt_samples": 11261.5, "learner": {"av": {"cur_kl_coeff": 0.00048217165749520063, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0015427250182256103, "policy_loss": -0.0019922733772546053, "vf_loss": 0.0004408107197377831, "vf_explained_var": 0.9654678702354431, "kl": 0.018124578520655632, "entropy": 1.0264965295791626, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10962, "done": false, "timesteps_total": 1702843, "episodes_total": 3723, "training_iteration": 152, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-20-26", "timestamp": 1588789226, "time_this_iter_s": 44.60059714317322, "time_total_s": 5928.890686750412, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f598461a2f0>", "on_episode_end": "<function on_episode_end at 0x7f598472a8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598c0e1488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5928.890686750412, "timesteps_since_restore": 1702843, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 86.046875, "ram_util_percent": 34.1}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -3.00058, "episode_reward_mean": 0.0673953, "episode_len_mean": 497.84, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.0673953}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1584333033700265, "avg_speed_min": 1.0390273339148297, "avg_speed_max": 4.792657127173546, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.55719678170225, "mean_processing_ms": 3.15201793539862, "mean_inference_ms": 0.6217688047813227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1714470, "num_steps_sampled": 1714470, "sample_time_ms": 38413.649, "grad_time_ms": 3476.324, "update_time_ms": 6.033, "opt_peak_throughput": 3242.88, "sample_peak_throughput": 293.471, "opt_samples": 11273.3, "learner": {"av": {"cur_kl_coeff": 0.00048217165749520063, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0017946664011105895, "policy_loss": -0.009891671128571033, "vf_loss": 0.011682144366204739, "vf_explained_var": 0.7535799145698547, "kl": 0.008702496998012066, "entropy": 1.0872442722320557, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11627, "done": false, "timesteps_total": 1714470, "episodes_total": 3749, "training_iteration": 153, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-21-08", "timestamp": 1588789268, "time_this_iter_s": 41.7159149646759, "time_total_s": 5970.606601715088, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f598460d840>", "on_episode_end": "<function on_episode_end at 0x7f598460d730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59847987b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 5970.606601715088, "timesteps_since_restore": 1714470, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 82.58, "ram_util_percent": 34.099999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00058, "episode_reward_mean": 0.05238079999999999, "episode_len_mean": 499.18, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.05238079999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2099953322315002, "avg_speed_min": 1.0390273339148297, "avg_speed_max": 4.792657127173546, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.58293122204357, "mean_processing_ms": 3.1501937355168312, "mean_inference_ms": 0.6221982251399664}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1725273, "num_steps_sampled": 1725273, "sample_time_ms": 38514.041, "grad_time_ms": 3487.64, "update_time_ms": 5.993, "opt_peak_throughput": 3220.745, "sample_peak_throughput": 291.655, "opt_samples": 11232.8, "learner": {"av": {"cur_kl_coeff": 0.00048217165749520063, "cur_lr": 9.999999747378752e-06, "total_loss": 0.06927358359098434, "policy_loss": -0.004423059057444334, "vf_loss": 0.07368599623441696, "vf_explained_var": 0.5725516676902771, "kl": 0.02207866683602333, "entropy": 1.2554142475128174, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10803, "done": false, "timesteps_total": 1725273, "episodes_total": 3768, "training_iteration": 154, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-21-50", "timestamp": 1588789310, "time_this_iter_s": 41.50188064575195, "time_total_s": 6012.10848236084, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1048>", "on_episode_step": "<function on_episode_step at 0x7f598c0e1488>", "on_episode_end": "<function on_episode_end at 0x7f5984546c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6012.10848236084, "timesteps_since_restore": 1725273, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 83.29322033898303, "ram_util_percent": 34.106779661016944}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00058, "episode_reward_mean": 0.077374, "episode_len_mean": 496.9, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.077374}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.35818613879758, "avg_speed_min": 1.0390273339148297, "avg_speed_max": 4.5543884444190255, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.617124133047156, "mean_processing_ms": 3.1501630913720327, "mean_inference_ms": 0.6228527344875672}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1736903, "num_steps_sampled": 1736903, "sample_time_ms": 38400.684, "grad_time_ms": 3457.747, "update_time_ms": 6.076, "opt_peak_throughput": 3255.82, "sample_peak_throughput": 293.167, "opt_samples": 11257.8, "learner": {"av": {"cur_kl_coeff": 0.000723257486242801, "cur_lr": 9.999999747378752e-06, "total_loss": 0.040483828634023666, "policy_loss": -0.003410518169403076, "vf_loss": 0.04388991743326187, "vf_explained_var": 0.4036179482936859, "kl": 0.006132300011813641, "entropy": 1.030572533607483, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11630, "done": false, "timesteps_total": 1736903, "episodes_total": 3795, "training_iteration": 155, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-22-29", "timestamp": 1588789349, "time_this_iter_s": 39.53513050079346, "time_total_s": 6051.643612861633, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1400>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f5984675488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6051.643612861633, "timesteps_since_restore": 1736903, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 80.60526315789474, "ram_util_percent": 34.108771929824556}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00058, "episode_reward_mean": 0.08486440000000002, "episode_len_mean": 496.9, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.08486440000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.441748947929301, "avg_speed_min": 1.0390273339148297, "avg_speed_max": 4.791353978230974, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.638474919473886, "mean_processing_ms": 3.1479217224879945, "mean_inference_ms": 0.623173600007472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1747672, "num_steps_sampled": 1747672, "sample_time_ms": 38468.702, "grad_time_ms": 3468.876, "update_time_ms": 6.113, "opt_peak_throughput": 3238.34, "sample_peak_throughput": 292.014, "opt_samples": 11233.4, "learner": {"av": {"cur_kl_coeff": 0.000723257486242801, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004830362740904093, "policy_loss": -0.005876386072486639, "vf_loss": 0.001034984365105629, "vf_explained_var": 0.8885998129844666, "kl": 0.015262811444699764, "entropy": 1.1762583255767822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10769, "done": false, "timesteps_total": 1747672, "episodes_total": 3813, "training_iteration": 156, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-23-12", "timestamp": 1588789392, "time_this_iter_s": 42.365970849990845, "time_total_s": 6094.009583711624, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f598c0e1488>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6094.009583711624, "timesteps_since_restore": 1747672, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 84.60166666666667, "ram_util_percent": 34.11333333333332}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00058, "episode_reward_mean": 0.10485620000000002, "episode_len_mean": 496.9, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.10485620000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.724825687192114, "avg_speed_min": 1.039809716124811, "avg_speed_max": 4.794544009907207, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.65177865066191, "mean_processing_ms": 3.147689984665261, "mean_inference_ms": 0.6234062744393261}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1759416, "num_steps_sampled": 1759416, "sample_time_ms": 38200.491, "grad_time_ms": 3412.133, "update_time_ms": 6.129, "opt_peak_throughput": 3298.494, "sample_peak_throughput": 294.627, "opt_samples": 11254.9, "learner": {"av": {"cur_kl_coeff": 0.000723257486242801, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004824530333280563, "policy_loss": -0.0050438167527318, "vf_loss": 0.00019468141545075923, "vf_explained_var": 0.9841176271438599, "kl": 0.03401706740260124, "entropy": 1.0639451742172241, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11744, "done": false, "timesteps_total": 1759416, "episodes_total": 3840, "training_iteration": 157, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-23-50", "timestamp": 1588789430, "time_this_iter_s": 37.79130029678345, "time_total_s": 6131.800884008408, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a048>", "on_episode_step": "<function on_episode_step at 0x7f598472a8c8>", "on_episode_end": "<function on_episode_end at 0x7f598472a268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598c0e1598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6131.800884008408, "timesteps_since_restore": 1759416, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 78.72407407407405, "ram_util_percent": 34.16296296296295}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -1.00011, "episode_reward_mean": 0.12237730000000001, "episode_len_mean": 497.4, "episodes_this_iter": 18, "policy_reward_min": {"av": -1.00011}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.12237730000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6402188428166564, "avg_speed_min": 1.039809716124811, "avg_speed_max": 4.794544009907207, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.66799458947593, "mean_processing_ms": 3.1454136401940747, "mean_inference_ms": 0.6236503254555409}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1770266, "num_steps_sampled": 1770266, "sample_time_ms": 38283.099, "grad_time_ms": 3423.509, "update_time_ms": 6.0, "opt_peak_throughput": 3283.648, "sample_peak_throughput": 293.644, "opt_samples": 11241.6, "learner": {"av": {"cur_kl_coeff": 0.00108488614205271, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0035420414060354233, "policy_loss": -0.003716390812769532, "vf_loss": 0.00016935345774982125, "vf_explained_var": 0.979344367980957, "kl": 0.004606254864484072, "entropy": 0.7104629278182983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10850, "done": false, "timesteps_total": 1770266, "episodes_total": 3858, "training_iteration": 158, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-24-34", "timestamp": 1588789474, "time_this_iter_s": 44.148505449295044, "time_total_s": 6175.949389457703, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598472ae18>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6175.949389457703, "timesteps_since_restore": 1770266, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 85.19523809523811, "ram_util_percent": 34.17936507936507}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.11740529999999999, "episode_len_mean": 500.0, "episodes_this_iter": 27, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.11740529999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.465313240946772, "avg_speed_min": 1.0394789048124922, "avg_speed_max": 4.91544839455979, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.69858683777051, "mean_processing_ms": 3.1446576389977268, "mean_inference_ms": 0.6241556833157633}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1781912, "num_steps_sampled": 1781912, "sample_time_ms": 38544.424, "grad_time_ms": 3457.462, "update_time_ms": 6.054, "opt_peak_throughput": 3251.952, "sample_peak_throughput": 291.702, "opt_samples": 11243.5, "learner": {"av": {"cur_kl_coeff": 0.000542443071026355, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0032284120097756386, "policy_loss": -0.005494328681379557, "vf_loss": 0.0022630172315984964, "vf_explained_var": 0.8396437168121338, "kl": 0.005348291713744402, "entropy": 0.784825325012207, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11646, "done": false, "timesteps_total": 1781912, "episodes_total": 3885, "training_iteration": 159, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-25-17", "timestamp": 1588789517, "time_this_iter_s": 42.59615135192871, "time_total_s": 6218.545540809631, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1488>", "on_episode_step": "<function on_episode_step at 0x7f598c0e10d0>", "on_episode_end": "<function on_episode_end at 0x7f598c0e1048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6218.545540809631, "timesteps_since_restore": 1781912, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 83.0606557377049, "ram_util_percent": 34.18032786885246}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.10991970000000001, "episode_len_mean": 500.0, "episodes_this_iter": 18, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.10991970000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.338036362960532, "avg_speed_min": 1.0394789048124922, "avg_speed_max": 4.91544839455979, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.714382029072574, "mean_processing_ms": 3.1428937802112284, "mean_inference_ms": 0.6244911783369892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1792756, "num_steps_sampled": 1792756, "sample_time_ms": 38577.352, "grad_time_ms": 3467.597, "update_time_ms": 6.012, "opt_peak_throughput": 3242.908, "sample_peak_throughput": 291.495, "opt_samples": 11245.1, "learner": {"av": {"cur_kl_coeff": 0.000542443071026355, "cur_lr": 9.999999747378752e-06, "total_loss": -0.006466811057180166, "policy_loss": -0.006861432455480099, "vf_loss": 0.0003905783232767135, "vf_explained_var": 0.9628207087516785, "kl": 0.007450325880199671, "entropy": 0.9477764964103699, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10844, "done": false, "timesteps_total": 1792756, "episodes_total": 3903, "training_iteration": 160, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-26-00", "timestamp": 1588789560, "time_this_iter_s": 43.10195231437683, "time_total_s": 6261.647493124008, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675488>", "on_episode_step": "<function on_episode_step at 0x7f59846751e0>", "on_episode_end": "<function on_episode_end at 0x7f59846756a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598c0e1378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6261.647493124008, "timesteps_since_restore": 1792756, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 84.75322580645162, "ram_util_percent": 34.196774193548386}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.0949405, "episode_len_mean": 500.0, "episodes_this_iter": 27, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0949405}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.1522619112125954, "avg_speed_min": 1.0394789048124922, "avg_speed_max": 4.91544839455979, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.75252400016699, "mean_processing_ms": 3.142200017077224, "mean_inference_ms": 0.6252047030215067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1804461, "num_steps_sampled": 1804461, "sample_time_ms": 38292.588, "grad_time_ms": 3428.066, "update_time_ms": 6.054, "opt_peak_throughput": 3284.067, "sample_peak_throughput": 293.999, "opt_samples": 11258.0, "learner": {"av": {"cur_kl_coeff": 0.000542443071026355, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0037044454365968704, "policy_loss": -0.00399732356891036, "vf_loss": 0.00029151441412977874, "vf_explained_var": 0.9732258915901184, "kl": 0.002517454558983445, "entropy": 0.9337531924247742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11705, "done": false, "timesteps_total": 1804461, "episodes_total": 3930, "training_iteration": 161, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-26-40", "timestamp": 1588789600, "time_this_iter_s": 40.025062561035156, "time_total_s": 6301.672555685043, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675158>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f5984675950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6301.672555685043, "timesteps_since_restore": 1804461, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 81.02105263157895, "ram_util_percent": 34.19298245614035}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -0.0005700000000000008, "episode_reward_mean": 0.0974391, "episode_len_mean": 500.0, "episodes_this_iter": 18, "policy_reward_min": {"av": -0.0005700000000000008}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0974391}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.120883137511891, "avg_speed_min": 1.0394789048124922, "avg_speed_max": 4.91544839455979, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.769600019937435, "mean_processing_ms": 3.140609336766293, "mean_inference_ms": 0.6256002365294643}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1815239, "num_steps_sampled": 1815239, "sample_time_ms": 38107.85, "grad_time_ms": 3413.778, "update_time_ms": 6.057, "opt_peak_throughput": 3292.423, "sample_peak_throughput": 294.942, "opt_samples": 11239.6, "learner": {"av": {"cur_kl_coeff": 0.0002712215355131775, "cur_lr": 9.999999747378752e-06, "total_loss": 0.008932271040976048, "policy_loss": 0.00870029628276825, "vf_loss": 0.00023069727467373013, "vf_explained_var": 0.9443891644477844, "kl": 0.004706677980720997, "entropy": 0.9769719839096069, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10778, "done": false, "timesteps_total": 1815239, "episodes_total": 3948, "training_iteration": 162, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-27-23", "timestamp": 1588789643, "time_this_iter_s": 42.610432624816895, "time_total_s": 6344.28298830986, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846756a8>", "on_episode_step": "<function on_episode_step at 0x7f598c0e10d0>", "on_episode_end": "<function on_episode_end at 0x7f598c0e1048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598c0e1378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6344.28298830986, "timesteps_since_restore": 1815239, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 83.62131147540983, "ram_util_percent": 34.19672131147541}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.0000000000000004e-05, "episode_reward_mean": 0.11493820000000002, "episode_len_mean": 500.0, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.0000000000000004e-05}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.11493820000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2795692843308863, "avg_speed_min": 1.0402391086761928, "avg_speed_max": 4.982988349127307, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.79682867677172, "mean_processing_ms": 3.139865687399424, "mean_inference_ms": 0.6261069092342911}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1826941, "num_steps_sampled": 1826941, "sample_time_ms": 37769.099, "grad_time_ms": 3366.925, "update_time_ms": 6.061, "opt_peak_throughput": 3340.466, "sample_peak_throughput": 297.786, "opt_samples": 11247.1, "learner": {"av": {"cur_kl_coeff": 0.00013561076775658876, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004029768984764814, "policy_loss": -0.004076778423041105, "vf_loss": 4.616115620592609e-05, "vf_explained_var": 0.9962486028671265, "kl": 0.006271387450397015, "entropy": 1.0477374792099, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11702, "done": false, "timesteps_total": 1826941, "episodes_total": 3975, "training_iteration": 163, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-28-01", "timestamp": 1588789681, "time_this_iter_s": 37.85923218727112, "time_total_s": 6382.142220497131, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846751e0>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f5984546488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6382.142220497131, "timesteps_since_restore": 1826941, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 79.90555555555555, "ram_util_percent": 34.19444444444445}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.0000000000000004e-05, "episode_reward_mean": 0.12992789999999999, "episode_len_mean": 500.0, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.0000000000000004e-05}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.12992789999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4308100280766993, "avg_speed_min": 1.0402391086761928, "avg_speed_max": 4.982988349127307, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.80176701719806, "mean_processing_ms": 3.1382419249623212, "mean_inference_ms": 0.6262634640832649}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1837738, "num_steps_sampled": 1837738, "sample_time_ms": 37829.006, "grad_time_ms": 3383.127, "update_time_ms": 5.972, "opt_peak_throughput": 3324.292, "sample_peak_throughput": 297.298, "opt_samples": 11246.5, "learner": {"av": {"cur_kl_coeff": 0.00013561076775658876, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0007677940302528441, "policy_loss": -0.0008734165458008647, "vf_loss": 0.00010449779074406251, "vf_explained_var": 0.9910584688186646, "kl": 0.008314890787005424, "entropy": 0.9748314619064331, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10797, "done": false, "timesteps_total": 1837738, "episodes_total": 3993, "training_iteration": 164, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-28-43", "timestamp": 1588789723, "time_this_iter_s": 42.26189947128296, "time_total_s": 6424.404119968414, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798950>", "on_episode_step": "<function on_episode_step at 0x7f59847980d0>", "on_episode_end": "<function on_episode_end at 0x7f59847981e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6424.404119968414, "timesteps_since_restore": 1837738, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 85.28833333333334, "ram_util_percent": 34.19666666666667}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -2e-05, "episode_reward_mean": 0.1274237, "episode_len_mean": 500.0, "episodes_this_iter": 27, "policy_reward_min": {"av": -2e-05}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1274237}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4073642751686126, "avg_speed_min": 1.0399487213058805, "avg_speed_max": 4.982988349127307, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.825440330350226, "mean_processing_ms": 3.1375704468321084, "mean_inference_ms": 0.6266556558486102}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1849410, "num_steps_sampled": 1849410, "sample_time_ms": 37900.702, "grad_time_ms": 3397.289, "update_time_ms": 6.066, "opt_peak_throughput": 3311.67, "sample_peak_throughput": 296.847, "opt_samples": 11250.7, "learner": {"av": {"cur_kl_coeff": 0.00013561076775658876, "cur_lr": 9.999999747378752e-06, "total_loss": -0.007122768554836512, "policy_loss": -0.007207278627902269, "vf_loss": 8.35772734717466e-05, "vf_explained_var": 0.9926671981811523, "kl": 0.006901896093040705, "entropy": 1.0405499935150146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11672, "done": false, "timesteps_total": 1849410, "episodes_total": 4020, "training_iteration": 165, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-29-24", "timestamp": 1588789764, "time_this_iter_s": 40.394704818725586, "time_total_s": 6464.79882478714, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847982f0>", "on_episode_step": "<function on_episode_step at 0x7f5984546c80>", "on_episode_end": "<function on_episode_end at 0x7f5984546488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6464.79882478714, "timesteps_since_restore": 1849410, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 81.28793103448275, "ram_util_percent": 34.19655172413793}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -2e-05, "episode_reward_mean": 0.11992699999999999, "episode_len_mean": 500.0, "episodes_this_iter": 18, "policy_reward_min": {"av": -2e-05}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.11992699999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3456351653598615, "avg_speed_min": 1.0399487213058805, "avg_speed_max": 4.982988349127307, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.83309308042337, "mean_processing_ms": 3.1359862873371247, "mean_inference_ms": 0.626897768687131}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1860227, "num_steps_sampled": 1860227, "sample_time_ms": 37976.008, "grad_time_ms": 3407.163, "update_time_ms": 6.053, "opt_peak_throughput": 3303.482, "sample_peak_throughput": 296.384, "opt_samples": 11255.5, "learner": {"av": {"cur_kl_coeff": 0.00013561076775658876, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0006580206681974232, "policy_loss": -0.0008418432553298771, "vf_loss": 0.00018314673798158765, "vf_explained_var": 0.9844741225242615, "kl": 0.004981067031621933, "entropy": 0.9875375628471375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10817, "done": false, "timesteps_total": 1860227, "episodes_total": 4038, "training_iteration": 166, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-30-07", "timestamp": 1588789807, "time_this_iter_s": 43.21717119216919, "time_total_s": 6508.015995979309, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798c80>", "on_episode_step": "<function on_episode_step at 0x7f59847981e0>", "on_episode_end": "<function on_episode_end at 0x7f59847980d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598c0e1378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6508.015995979309, "timesteps_since_restore": 1860227, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 84.81612903225808, "ram_util_percent": 34.19838709677419}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": 0.0, "episode_reward_mean": 0.12491739999999998, "episode_len_mean": 500.0, "episodes_this_iter": 27, "policy_reward_min": {"av": 0.0}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.12491739999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3428433193033324, "avg_speed_min": 1.0399487213058805, "avg_speed_max": 4.8088929120577255, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.86336020943651, "mean_processing_ms": 3.1352186073713737, "mean_inference_ms": 0.6273802090176326}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1871924, "num_steps_sampled": 1871924, "sample_time_ms": 38153.729, "grad_time_ms": 3441.022, "update_time_ms": 6.105, "opt_peak_throughput": 3269.61, "sample_peak_throughput": 294.881, "opt_samples": 11250.8, "learner": {"av": {"cur_kl_coeff": 6.780538387829438e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028271665796637535, "policy_loss": -0.0028436786960810423, "vf_loss": 1.6109510397654958e-05, "vf_explained_var": 0.9984837174415588, "kl": 0.00599373085424304, "entropy": 1.0060431957244873, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11697, "done": false, "timesteps_total": 1871924, "episodes_total": 4065, "training_iteration": 167, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-30-47", "timestamp": 1588789847, "time_this_iter_s": 39.90921711921692, "time_total_s": 6547.925213098526, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460da60>", "on_episode_step": "<function on_episode_step at 0x7f5984798840>", "on_episode_end": "<function on_episode_end at 0x7f5984798268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6547.925213098526, "timesteps_since_restore": 1871924, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 81.48596491228069, "ram_util_percent": 34.19649122807018}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -6e-05, "episode_reward_mean": 0.1124245, "episode_len_mean": 500.0, "episodes_this_iter": 18, "policy_reward_min": {"av": -6e-05}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.1124245}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2179125126719312, "avg_speed_min": 1.0399487213058805, "avg_speed_max": 4.8088929120577255, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.87540142496661, "mean_processing_ms": 3.1336840920040046, "mean_inference_ms": 0.6276616500098076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1882748, "num_steps_sampled": 1882748, "sample_time_ms": 38181.893, "grad_time_ms": 3448.488, "update_time_ms": 6.186, "opt_peak_throughput": 3261.777, "sample_peak_throughput": 294.595, "opt_samples": 11248.2, "learner": {"av": {"cur_kl_coeff": 6.780538387829438e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.007098098751157522, "policy_loss": -0.007357900496572256, "vf_loss": 0.0002589671639725566, "vf_explained_var": 0.9771308898925781, "kl": 0.012261920608580112, "entropy": 0.9123157262802124, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10824, "done": false, "timesteps_total": 1882748, "episodes_total": 4083, "training_iteration": 168, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-31-31", "timestamp": 1588789891, "time_this_iter_s": 44.505895137786865, "time_total_s": 6592.431108236313, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847981e0>", "on_episode_step": "<function on_episode_step at 0x7f59847980d0>", "on_episode_end": "<function on_episode_end at 0x7f598460d598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6592.431108236313, "timesteps_since_restore": 1882748, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 86.87936507936507, "ram_util_percent": 34.19841269841269}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00059, "episode_reward_mean": 0.0849178, "episode_len_mean": 499.26, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00059}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0849178}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2735809749879152, "avg_speed_min": 1.0412285207406196, "avg_speed_max": 5.078050525280698, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.90716646323099, "mean_processing_ms": 3.132907748230541, "mean_inference_ms": 0.6281353236579406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1894316, "num_steps_sampled": 1894316, "sample_time_ms": 37758.984, "grad_time_ms": 3387.859, "update_time_ms": 6.333, "opt_peak_throughput": 3317.848, "sample_peak_throughput": 297.688, "opt_samples": 11240.4, "learner": {"av": {"cur_kl_coeff": 6.780538387829438e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.07820785790681839, "policy_loss": -0.0021324141416698694, "vf_loss": 0.08033957332372665, "vf_explained_var": 0.13738562166690826, "kl": 0.01018406730145216, "entropy": 0.9353536367416382, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11568, "done": false, "timesteps_total": 1894316, "episodes_total": 4110, "training_iteration": 169, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-32-09", "timestamp": 1588789929, "time_this_iter_s": 37.76173377037048, "time_total_s": 6630.192842006683, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546c80>", "on_episode_step": "<function on_episode_step at 0x7f5984546488>", "on_episode_end": "<function on_episode_end at 0x7f5984546ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6630.192842006683, "timesteps_since_restore": 1894316, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 78.62037037037035, "ram_util_percent": 34.2}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00059, "episode_reward_mean": 0.0824246, "episode_len_mean": 499.26, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00059}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.0824246}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2926428679141875, "avg_speed_min": 1.0412285207406196, "avg_speed_max": 5.216401612831642, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.91232155026357, "mean_processing_ms": 3.131343244559561, "mean_inference_ms": 0.6282901908031768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1905187, "num_steps_sampled": 1905187, "sample_time_ms": 37688.158, "grad_time_ms": 3371.375, "update_time_ms": 6.275, "opt_peak_throughput": 3334.87, "sample_peak_throughput": 298.319, "opt_samples": 11243.1, "learner": {"av": {"cur_kl_coeff": 6.780538387829438e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0011542541906237602, "policy_loss": 0.00105904636438936, "vf_loss": 9.294132905779406e-05, "vf_explained_var": 0.9916065335273743, "kl": 0.03344104066491127, "entropy": 1.0054835081100464, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10871, "done": false, "timesteps_total": 1905187, "episodes_total": 4128, "training_iteration": 170, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-32-52", "timestamp": 1588789972, "time_this_iter_s": 42.22859859466553, "time_total_s": 6672.421440601349, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f598460d598>", "on_episode_end": "<function on_episode_end at 0x7f59847980d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984714bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6672.421440601349, "timesteps_since_restore": 1905187, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 83.06721311475408, "ram_util_percent": 34.204918032786885}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00059, "episode_reward_mean": 0.08492490000000003, "episode_len_mean": 499.26, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00059}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.08492490000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.384722031073483, "avg_speed_min": 1.0412285207406196, "avg_speed_max": 5.216401612831642, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.93357808195095, "mean_processing_ms": 3.1304569784640908, "mean_inference_ms": 0.6285737436507366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1916853, "num_steps_sampled": 1916853, "sample_time_ms": 37455.972, "grad_time_ms": 3338.076, "update_time_ms": 6.195, "opt_peak_throughput": 3366.97, "sample_peak_throughput": 300.064, "opt_samples": 11239.2, "learner": {"av": {"cur_kl_coeff": 0.00010170807945542037, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0017815938917919993, "policy_loss": -0.0029556225053966045, "vf_loss": 0.0011726527009159327, "vf_explained_var": 0.89801025390625, "kl": 0.013504799455404282, "entropy": 1.0438729524612427, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11666, "done": false, "timesteps_total": 1916853, "episodes_total": 4155, "training_iteration": 171, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-33-29", "timestamp": 1588790009, "time_this_iter_s": 37.369624853134155, "time_total_s": 6709.791065454483, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f5984798268>", "on_episode_end": "<function on_episode_end at 0x7f5984798840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472aa60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6709.791065454483, "timesteps_since_restore": 1916853, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 79.39999999999998, "ram_util_percent": 34.2}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00059, "episode_reward_mean": 0.09242990000000002, "episode_len_mean": 499.26, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00059}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.09242990000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.525493540806454, "avg_speed_min": 1.0412285207406196, "avg_speed_max": 5.222115662047365, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.925490573410634, "mean_processing_ms": 3.128844711267109, "mean_inference_ms": 0.6285209486246562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1927636, "num_steps_sampled": 1927636, "sample_time_ms": 37157.51, "grad_time_ms": 3293.336, "update_time_ms": 6.105, "opt_peak_throughput": 3412.862, "sample_peak_throughput": 302.488, "opt_samples": 11239.7, "learner": {"av": {"cur_kl_coeff": 0.00010170807945542037, "cur_lr": 9.999999747378752e-06, "total_loss": -0.011499733664095402, "policy_loss": -0.011663076467812061, "vf_loss": 0.00016103930829558522, "vf_explained_var": 0.9870015978813171, "kl": 0.022652780637145042, "entropy": 1.0609865188598633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10783, "done": false, "timesteps_total": 1927636, "episodes_total": 4173, "training_iteration": 172, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-34-08", "timestamp": 1588790048, "time_this_iter_s": 39.177086353302, "time_total_s": 6748.968151807785, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472ae18>", "on_episode_step": "<function on_episode_step at 0x7f598472a6a8>", "on_episode_end": "<function on_episode_end at 0x7f5984798c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59847980d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6748.968151807785, "timesteps_since_restore": 1927636, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 81.06607142857145, "ram_util_percent": 34.199999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24999, "episode_reward_min": -3.00059, "episode_reward_mean": 0.0749359, "episode_len_mean": 495.12, "episodes_this_iter": 28, "policy_reward_min": {"av": -3.00059}, "policy_reward_max": {"av": 0.24999}, "policy_reward_mean": {"av": 0.0749359}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6466577132369364, "avg_speed_min": 1.0412285207406196, "avg_speed_max": 5.222115662047365, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.91531124212225, "mean_processing_ms": 3.1280981054134065, "mean_inference_ms": 0.6281926301582541}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1939421, "num_steps_sampled": 1939421, "sample_time_ms": 37139.341, "grad_time_ms": 3288.558, "update_time_ms": 6.115, "opt_peak_throughput": 3420.344, "sample_peak_throughput": 302.859, "opt_samples": 11248.0, "learner": {"av": {"cur_kl_coeff": 0.00015256211918313056, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03086664155125618, "policy_loss": -0.007224372588098049, "vf_loss": 0.03808949142694473, "vf_explained_var": 0.3383451998233795, "kl": 0.00996257085353136, "entropy": 1.0488096475601196, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11785, "done": false, "timesteps_total": 1939421, "episodes_total": 4201, "training_iteration": 173, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-34-46", "timestamp": 1588790086, "time_this_iter_s": 37.6296865940094, "time_total_s": 6786.597838401794, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a268>", "on_episode_step": "<function on_episode_step at 0x7f598472a048>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598c0e1378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6786.597838401794, "timesteps_since_restore": 1939421, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 78.10740740740741, "ram_util_percent": 34.2}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24999, "episode_reward_min": -3.00027, "episode_reward_mean": 0.074937, "episode_len_mean": 495.32, "episodes_this_iter": 18, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.24999}, "policy_reward_mean": {"av": 0.074937}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.609015777191477, "avg_speed_min": 1.041460653429465, "avg_speed_max": 5.222115662047365, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.91570607367304, "mean_processing_ms": 3.1266625300452864, "mean_inference_ms": 0.6284429406587004}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1950223, "num_steps_sampled": 1950223, "sample_time_ms": 37175.522, "grad_time_ms": 3289.4, "update_time_ms": 6.158, "opt_peak_throughput": 3419.621, "sample_peak_throughput": 302.578, "opt_samples": 11248.5, "learner": {"av": {"cur_kl_coeff": 0.00015256211918313056, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03582632169127464, "policy_loss": -0.018241802230477333, "vf_loss": 0.05404883995652199, "vf_explained_var": 0.2715601325035095, "kl": 0.12642128765583038, "entropy": 1.3887221813201904, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10802, "done": false, "timesteps_total": 1950223, "episodes_total": 4219, "training_iteration": 174, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-35-29", "timestamp": 1588790129, "time_this_iter_s": 42.63226127624512, "time_total_s": 6829.23009967804, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f5984675a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6829.23009967804, "timesteps_since_restore": 1950223, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 83.87049180327871, "ram_util_percent": 34.199999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24999, "episode_reward_min": -3.00027, "episode_reward_mean": 0.009911500000000016, "episode_len_mean": 493.8, "episodes_this_iter": 27, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.24999}, "policy_reward_mean": {"av": 0.009911500000000016}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.535895472066335, "avg_speed_min": 1.041460653429465, "avg_speed_max": 5.222115662047365, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.918037551002314, "mean_processing_ms": 3.1259793004203362, "mean_inference_ms": 0.6282431144627363}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1961734, "num_steps_sampled": 1961734, "sample_time_ms": 37133.898, "grad_time_ms": 3286.851, "update_time_ms": 5.944, "opt_peak_throughput": 3417.375, "sample_peak_throughput": 302.484, "opt_samples": 11232.4, "learner": {"av": {"cur_kl_coeff": 0.00022884318605065346, "cur_lr": 9.999999747378752e-06, "total_loss": 0.21230942010879517, "policy_loss": -0.007923292927443981, "vf_loss": 0.22021692991256714, "vf_explained_var": 0.08547840267419815, "kl": 0.0689951479434967, "entropy": 2.106257438659668, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11511, "done": false, "timesteps_total": 1961734, "episodes_total": 4246, "training_iteration": 175, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-36-09", "timestamp": 1588790169, "time_this_iter_s": 39.950729846954346, "time_total_s": 6869.180829524994, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f598472a048>", "on_episode_end": "<function on_episode_end at 0x7f598c0e1378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6869.180829524994, "timesteps_since_restore": 1961734, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 81.19298245614036, "ram_util_percent": 34.199999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24999, "episode_reward_min": -3.00027, "episode_reward_mean": -0.14511079999999998, "episode_len_mean": 486.8, "episodes_this_iter": 19, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.24999}, "policy_reward_mean": {"av": -0.14511079999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4997219955554093, "avg_speed_min": 1.041460653429465, "avg_speed_max": 5.0941323013327215, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.92772589703386, "mean_processing_ms": 3.125322424189954, "mean_inference_ms": 0.6288331674790323}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1972209, "num_steps_sampled": 1972209, "sample_time_ms": 36955.703, "grad_time_ms": 3254.087, "update_time_ms": 5.886, "opt_peak_throughput": 3441.272, "sample_peak_throughput": 303.017, "opt_samples": 11198.2, "learner": {"av": {"cur_kl_coeff": 0.0003432647790759802, "cur_lr": 9.999999747378752e-06, "total_loss": 0.2876192629337311, "policy_loss": -0.00538926525041461, "vf_loss": 0.29300591349601746, "vf_explained_var": 0.1969725638628006, "kl": 0.00763501413166523, "entropy": 1.7972732782363892, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10475, "done": false, "timesteps_total": 1972209, "episodes_total": 4265, "training_iteration": 176, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-36-50", "timestamp": 1588790210, "time_this_iter_s": 41.10802936553955, "time_total_s": 6910.288858890533, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675a60>", "on_episode_step": "<function on_episode_step at 0x7f5984675048>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984714158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6910.288858890533, "timesteps_since_restore": 1972209, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 81.03728813559322, "ram_util_percent": 34.199999999999996}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.00027, "episode_reward_mean": -0.29266889999999995, "episode_len_mean": 481.86, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00027}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.29266889999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.379923760516935, "avg_speed_min": 1.0446624894554446, "avg_speed_max": 5.0941323013327215, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.93682430827849, "mean_processing_ms": 3.1247708842486452, "mean_inference_ms": 0.6285486550132934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1983261, "num_steps_sampled": 1983261, "sample_time_ms": 36975.853, "grad_time_ms": 3258.394, "update_time_ms": 5.772, "opt_peak_throughput": 3416.929, "sample_peak_throughput": 301.107, "opt_samples": 11133.7, "learner": {"av": {"cur_kl_coeff": 0.0003432647790759802, "cur_lr": 9.999999747378752e-06, "total_loss": 0.27208444476127625, "policy_loss": -0.014375546015799046, "vf_loss": 0.28645384311676025, "vf_explained_var": 0.2561351954936981, "kl": 0.017979033291339874, "entropy": 2.1301839351654053, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11052, "done": false, "timesteps_total": 1983261, "episodes_total": 4291, "training_iteration": 177, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-37-30", "timestamp": 1588790250, "time_this_iter_s": 40.15118336677551, "time_total_s": 6950.440042257309, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675950>", "on_episode_step": "<function on_episode_step at 0x7f598472a048>", "on_episode_end": "<function on_episode_end at 0x7f598460d7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984714268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6950.440042257309, "timesteps_since_restore": 1983261, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 78.5859649122807, "ram_util_percent": 34.219298245614034}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.00025, "episode_reward_mean": -0.3126774, "episode_len_mean": 483.08, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.3126774}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.344593987681693, "avg_speed_min": 1.0446624894554446, "avg_speed_max": 4.997407844699918, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.94449206645001, "mean_processing_ms": 3.1246589101921542, "mean_inference_ms": 0.6288604595771009}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1994073, "num_steps_sampled": 1994073, "sample_time_ms": 36474.458, "grad_time_ms": 3191.411, "update_time_ms": 5.701, "opt_peak_throughput": 3488.269, "sample_peak_throughput": 305.214, "opt_samples": 11132.5, "learner": {"av": {"cur_kl_coeff": 0.0003432647790759802, "cur_lr": 9.999999747378752e-06, "total_loss": 0.20079205930233002, "policy_loss": -0.0016391469398513436, "vf_loss": 0.20243053138256073, "vf_explained_var": 0.3538249433040619, "kl": 0.001955505460500717, "entropy": 1.7402033805847168, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10812, "done": false, "timesteps_total": 1994073, "episodes_total": 4311, "training_iteration": 178, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-38-09", "timestamp": 1588790289, "time_this_iter_s": 38.821998834609985, "time_total_s": 6989.262041091919, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598460d6a8>", "on_episode_end": "<function on_episode_end at 0x7f598460d8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846756a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 6989.262041091919, "timesteps_since_restore": 1994073, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 80.32142857142857, "ram_util_percent": 34.21785714285714}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.00025, "episode_reward_mean": -0.27519679999999996, "episode_len_mean": 483.77, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00025}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.27519679999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.44628788205718, "avg_speed_min": 1.0516263668312582, "avg_speed_max": 5.349498072322796, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.94923332020405, "mean_processing_ms": 3.1236719466582907, "mean_inference_ms": 0.6288251473038667}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2005462, "num_steps_sampled": 2005462, "sample_time_ms": 36575.661, "grad_time_ms": 3206.056, "update_time_ms": 5.651, "opt_peak_throughput": 3466.752, "sample_peak_throughput": 303.88, "opt_samples": 11114.6, "learner": {"av": {"cur_kl_coeff": 0.0001716323895379901, "cur_lr": 9.999999747378752e-06, "total_loss": 0.07569913566112518, "policy_loss": -0.001905467244796455, "vf_loss": 0.07760347425937653, "vf_explained_var": 0.46917375922203064, "kl": 0.0065375687554478645, "entropy": 2.04435658454895, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11389, "done": false, "timesteps_total": 2005462, "episodes_total": 4336, "training_iteration": 179, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-38-48", "timestamp": 1588790328, "time_this_iter_s": 38.920164585113525, "time_total_s": 7028.1822056770325, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460da60>", "on_episode_step": "<function on_episode_step at 0x7f5984675950>", "on_episode_end": "<function on_episode_end at 0x7f5984798378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7028.1822056770325, "timesteps_since_restore": 2005462, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 80.27090909090909, "ram_util_percent": 34.263636363636365}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.0003699999999998, "episode_reward_mean": -0.2101862, "episode_len_mean": 487.15, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.0003699999999998}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.2101862}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.5216611924937746, "avg_speed_min": 1.0480765439167905, "avg_speed_max": 5.349498072322796, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.94916762345783, "mean_processing_ms": 3.123486867726311, "mean_inference_ms": 0.6289927164928553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2016451, "num_steps_sampled": 2016451, "sample_time_ms": 36388.293, "grad_time_ms": 3179.53, "update_time_ms": 5.712, "opt_peak_throughput": 3499.385, "sample_peak_throughput": 305.769, "opt_samples": 11126.4, "learner": {"av": {"cur_kl_coeff": 0.0001716323895379901, "cur_lr": 9.999999747378752e-06, "total_loss": 0.08265791833400726, "policy_loss": -0.003006855957210064, "vf_loss": 0.08566325902938843, "vf_explained_var": 0.3382095694541931, "kl": 0.008759989403188229, "entropy": 1.650136113166809, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10989, "done": false, "timesteps_total": 2016451, "episodes_total": 4356, "training_iteration": 180, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-39-29", "timestamp": 1588790369, "time_this_iter_s": 40.09067225456238, "time_total_s": 7068.272877931595, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f598460d8c8>", "on_episode_end": "<function on_episode_end at 0x7f598460d6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984714510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7068.272877931595, "timesteps_since_restore": 2016451, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 81.15689655172413, "ram_util_percent": 34.286206896551725}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.00054, "episode_reward_mean": -0.12018509999999998, "episode_len_mean": 491.51, "episodes_this_iter": 26, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.12018509999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.535920164715481, "avg_speed_min": 1.0480765439167905, "avg_speed_max": 5.349498072322796, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.943806403545494, "mean_processing_ms": 3.1215072272321422, "mean_inference_ms": 0.6286132197659624}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2028040, "num_steps_sampled": 2028040, "sample_time_ms": 36697.591, "grad_time_ms": 3211.916, "update_time_ms": 5.678, "opt_peak_throughput": 3461.704, "sample_peak_throughput": 302.982, "opt_samples": 11118.7, "learner": {"av": {"cur_kl_coeff": 0.0001716323895379901, "cur_lr": 9.999999747378752e-06, "total_loss": 0.4338569641113281, "policy_loss": -0.0009129985119216144, "vf_loss": 0.4347693920135498, "vf_explained_var": 0.15352387726306915, "kl": 0.003140472574159503, "entropy": 2.1181185245513916, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11589, "done": false, "timesteps_total": 2028040, "episodes_total": 4382, "training_iteration": 181, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-40-09", "timestamp": 1588790409, "time_this_iter_s": 40.7854437828064, "time_total_s": 7109.058321714401, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f598460d7b8>", "on_episode_end": "<function on_episode_end at 0x7f598460d400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59847980d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7109.058321714401, "timesteps_since_restore": 2028040, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 81.10689655172413, "ram_util_percent": 34.28448275862069}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -3.00054, "episode_reward_mean": -0.10268199999999998, "episode_len_mean": 490.23, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": -0.10268199999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.543237665131143, "avg_speed_min": 1.0480765439167905, "avg_speed_max": 5.349498072322796, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.96833897861323, "mean_processing_ms": 3.12168200214812, "mean_inference_ms": 0.6297215152302528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2038966, "num_steps_sampled": 2038966, "sample_time_ms": 36676.641, "grad_time_ms": 3217.424, "update_time_ms": 5.618, "opt_peak_throughput": 3460.221, "sample_peak_throughput": 303.545, "opt_samples": 11133.0, "learner": {"av": {"cur_kl_coeff": 8.581619476899505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09249821305274963, "policy_loss": -0.003874672343954444, "vf_loss": 0.09637072682380676, "vf_explained_var": 0.28943753242492676, "kl": 0.025276508182287216, "entropy": 1.8404510021209717, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10926, "done": false, "timesteps_total": 2038966, "episodes_total": 4403, "training_iteration": 182, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-40-49", "timestamp": 1588790449, "time_this_iter_s": 39.02276611328125, "time_total_s": 7148.0810878276825, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f598460d8c8>", "on_episode_end": "<function on_episode_end at 0x7f598c0e1378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846756a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7148.0810878276825, "timesteps_since_restore": 2038966, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 80.625, "ram_util_percent": 34.28928571428572}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00054, "episode_reward_mean": -0.16268159999999995, "episode_len_mean": 488.93, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": -0.16268159999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.551600979920087, "avg_speed_min": 1.0480765439167905, "avg_speed_max": 5.173479971112404, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.94233616519608, "mean_processing_ms": 3.1199522262144295, "mean_inference_ms": 0.6286195538139903}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2050202, "num_steps_sampled": 2050202, "sample_time_ms": 36634.075, "grad_time_ms": 3224.114, "update_time_ms": 5.662, "opt_peak_throughput": 3436.014, "sample_peak_throughput": 302.399, "opt_samples": 11078.1, "learner": {"av": {"cur_kl_coeff": 0.00012872429215349257, "cur_lr": 9.999999747378752e-06, "total_loss": 0.2686038017272949, "policy_loss": -0.0004079375648871064, "vf_loss": 0.26901018619537354, "vf_explained_var": 0.2678239643573761, "kl": 0.011888738721609116, "entropy": 1.8433735370635986, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11236, "done": false, "timesteps_total": 2050202, "episodes_total": 4427, "training_iteration": 183, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-41-26", "timestamp": 1588790486, "time_this_iter_s": 37.27140259742737, "time_total_s": 7185.35249042511, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f5984675158>", "on_episode_end": "<function on_episode_end at 0x7f59846751e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7185.35249042511, "timesteps_since_restore": 2050202, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 79.96792452830188, "ram_util_percent": 34.284905660377355}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00054, "episode_reward_mean": -0.2551848, "episode_len_mean": 484.76, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00054}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": -0.2551848}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.508487451964442, "avg_speed_min": 1.0480765439167905, "avg_speed_max": 4.998041020593781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.96738456527554, "mean_processing_ms": 3.120273254728624, "mean_inference_ms": 0.6297816494346055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2061033, "num_steps_sampled": 2061033, "sample_time_ms": 36455.923, "grad_time_ms": 3193.865, "update_time_ms": 5.774, "opt_peak_throughput": 3469.464, "sample_peak_throughput": 303.956, "opt_samples": 11081.0, "learner": {"av": {"cur_kl_coeff": 0.00012872429215349257, "cur_lr": 9.999999747378752e-06, "total_loss": 0.3125137984752655, "policy_loss": -0.0049207438714802265, "vf_loss": 0.31743356585502625, "vf_explained_var": 0.26460593938827515, "kl": 0.007342104334384203, "entropy": 1.745081901550293, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10831, "done": false, "timesteps_total": 2061033, "episodes_total": 4448, "training_iteration": 184, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-42-07", "timestamp": 1588790527, "time_this_iter_s": 40.54923391342163, "time_total_s": 7225.9017243385315, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598472a158>", "on_episode_end": "<function on_episode_end at 0x7f598472a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472abf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7225.9017243385315, "timesteps_since_restore": 2061033, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 80.29827586206896, "ram_util_percent": 34.289655172413795}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00051, "episode_reward_mean": -0.15767699999999998, "episode_len_mean": 487.91, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": -0.15767699999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.529540131337941, "avg_speed_min": 1.0504928041026504, "avg_speed_max": 4.998041020593781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.946061217532744, "mean_processing_ms": 3.1186280692020705, "mean_inference_ms": 0.6289743786803821}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2072511, "num_steps_sampled": 2072511, "sample_time_ms": 36416.417, "grad_time_ms": 3196.629, "update_time_ms": 5.896, "opt_peak_throughput": 3465.432, "sample_peak_throughput": 304.195, "opt_samples": 11077.7, "learner": {"av": {"cur_kl_coeff": 0.00012872429215349257, "cur_lr": 9.999999747378752e-06, "total_loss": 0.005995893385261297, "policy_loss": -0.0003342560085002333, "vf_loss": 0.006329771131277084, "vf_explained_var": 0.8420221209526062, "kl": 0.002903538756072521, "entropy": 1.7801920175552368, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11478, "done": false, "timesteps_total": 2072511, "episodes_total": 4473, "training_iteration": 185, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-42-46", "timestamp": 1588790566, "time_this_iter_s": 39.58500599861145, "time_total_s": 7265.486730337143, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f5984798c80>", "on_episode_end": "<function on_episode_end at 0x7f598472aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846751e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7265.486730337143, "timesteps_since_restore": 2072511, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 80.32280701754385, "ram_util_percent": 34.294736842105266}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -3.00051, "episode_reward_mean": -0.21016609999999997, "episode_len_mean": 489.65, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00051}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": -0.21016609999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4680364088098075, "avg_speed_min": 1.0474400425826966, "avg_speed_max": 4.998041020593781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.95534419365984, "mean_processing_ms": 3.1193853090705956, "mean_inference_ms": 0.6294822627395276}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2083274, "num_steps_sampled": 2083274, "sample_time_ms": 36396.776, "grad_time_ms": 3209.216, "update_time_ms": 5.878, "opt_peak_throughput": 3460.814, "sample_peak_throughput": 305.151, "opt_samples": 11106.5, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.22532381117343903, "policy_loss": -0.0014666684437543154, "vf_loss": 0.22679011523723602, "vf_explained_var": 0.173767551779747, "kl": 0.005682972725480795, "entropy": 1.5425198078155518, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10763, "done": false, "timesteps_total": 2083274, "episodes_total": 4493, "training_iteration": 186, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-43-27", "timestamp": 1588790607, "time_this_iter_s": 41.03655505180359, "time_total_s": 7306.5232853889465, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598472a158>", "on_episode_end": "<function on_episode_end at 0x7f59847981e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4ea60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7306.5232853889465, "timesteps_since_restore": 2083274, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 83.69655172413792, "ram_util_percent": 34.30172413793103}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -3.0002599999999995, "episode_reward_mean": -0.21765389999999996, "episode_len_mean": 488.8, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.0002599999999995}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": -0.21765389999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3727122588370264, "avg_speed_min": 1.0464968922927316, "avg_speed_max": 4.829019619479271, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.95590743670871, "mean_processing_ms": 3.1167221420505173, "mean_inference_ms": 0.6291827280287873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2094522, "num_steps_sampled": 2094522, "sample_time_ms": 36182.335, "grad_time_ms": 3190.207, "update_time_ms": 5.861, "opt_peak_throughput": 3487.579, "sample_peak_throughput": 307.501, "opt_samples": 11126.1, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.07489604502916336, "policy_loss": -0.005879182834178209, "vf_loss": 0.08077450096607208, "vf_explained_var": 0.36886435747146606, "kl": 0.01119892206043005, "entropy": 1.5085723400115967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11248, "done": false, "timesteps_total": 2094522, "episodes_total": 4518, "training_iteration": 187, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-44-05", "timestamp": 1588790645, "time_this_iter_s": 37.816922187805176, "time_total_s": 7344.340207576752, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472abf8>", "on_episode_step": "<function on_episode_step at 0x7f598472aa60>", "on_episode_end": "<function on_episode_end at 0x7f5984798c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846751e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4ed08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7344.340207576752, "timesteps_since_restore": 2094522, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 78.60370370370369, "ram_util_percent": 34.298148148148144}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00023, "episode_reward_mean": -0.09513630000000001, "episode_len_mean": 492.7, "episodes_this_iter": 20, "policy_reward_min": {"av": -3.00023}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.09513630000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3884968480074535, "avg_speed_min": 1.0426545342251359, "avg_speed_max": 5.284499753547101, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.96310722174017, "mean_processing_ms": 3.118028499208244, "mean_inference_ms": 0.6297384105610703}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2105554, "num_steps_sampled": 2105554, "sample_time_ms": 36410.337, "grad_time_ms": 3210.393, "update_time_ms": 5.842, "opt_peak_throughput": 3472.503, "sample_peak_throughput": 306.18, "opt_samples": 11148.1, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0037568542174994946, "policy_loss": -0.004434254486113787, "vf_loss": 0.0006762404809705913, "vf_explained_var": 0.9623420834541321, "kl": 0.017949318513274193, "entropy": 1.4006657600402832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11032, "done": false, "timesteps_total": 2105554, "episodes_total": 4538, "training_iteration": 188, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-44-47", "timestamp": 1588790687, "time_this_iter_s": 41.303091526031494, "time_total_s": 7385.643299102783, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714048>", "on_episode_step": "<function on_episode_step at 0x7f5984714378>", "on_episode_end": "<function on_episode_end at 0x7f5984714400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7385.643299102783, "timesteps_since_restore": 2105554, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 83.43898305084745, "ram_util_percent": 34.29830508474576}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00024, "episode_reward_mean": -0.06261409999999999, "episode_len_mean": 494.52, "episodes_this_iter": 25, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.06261409999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3943070294557933, "avg_speed_min": 1.042146374103281, "avg_speed_max": 5.284499753547101, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.96504436444735, "mean_processing_ms": 3.115240167440569, "mean_inference_ms": 0.6294151564878322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2116991, "num_steps_sampled": 2116991, "sample_time_ms": 36331.073, "grad_time_ms": 3212.076, "update_time_ms": 5.771, "opt_peak_throughput": 3472.178, "sample_peak_throughput": 306.98, "opt_samples": 11152.9, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.03141419589519501, "policy_loss": -0.004742612596601248, "vf_loss": 0.03615553304553032, "vf_explained_var": 0.6394416689872742, "kl": 0.019740231335163116, "entropy": 1.200598955154419, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11437, "done": false, "timesteps_total": 2116991, "episodes_total": 4563, "training_iteration": 189, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-45-25", "timestamp": 1588790725, "time_this_iter_s": 38.143860816955566, "time_total_s": 7423.787159919739, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714620>", "on_episode_step": "<function on_episode_step at 0x7f598472aa60>", "on_episode_end": "<function on_episode_end at 0x7f5984798c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7423.787159919739, "timesteps_since_restore": 2116991, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 79.98909090909092, "ram_util_percent": 34.3}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00024, "episode_reward_mean": -0.052604599999999994, "episode_len_mean": 493.34, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": -0.052604599999999994}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.283073395332231, "avg_speed_min": 1.0409100806018712, "avg_speed_max": 5.284499753547101, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.9749074809468, "mean_processing_ms": 3.116229358586561, "mean_inference_ms": 0.6298001648482666}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2127985, "num_steps_sampled": 2127985, "sample_time_ms": 36656.626, "grad_time_ms": 3253.834, "update_time_ms": 5.767, "opt_peak_throughput": 3427.772, "sample_peak_throughput": 304.267, "opt_samples": 11153.4, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.09531224519014359, "policy_loss": -0.002098802477121353, "vf_loss": 0.09741037338972092, "vf_explained_var": 0.3421359062194824, "kl": 0.01051609218120575, "entropy": 1.233841896057129, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10994, "done": false, "timesteps_total": 2127985, "episodes_total": 4584, "training_iteration": 190, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-46-09", "timestamp": 1588790769, "time_this_iter_s": 43.76375365257263, "time_total_s": 7467.550913572311, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472abf8>", "on_episode_step": "<function on_episode_step at 0x7f5984714400>", "on_episode_end": "<function on_episode_end at 0x7f5984714378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4eea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7467.550913572311, "timesteps_since_restore": 2127985, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 86.4, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -3.00024, "episode_reward_mean": 0.08989190000000001, "episode_len_mean": 496.87, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.08989190000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.465814611942209, "avg_speed_min": 1.0409100806018712, "avg_speed_max": 5.284499753547101, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.97867669068975, "mean_processing_ms": 3.113717653530732, "mean_inference_ms": 0.629676685396234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2139406, "num_steps_sampled": 2139406, "sample_time_ms": 36249.102, "grad_time_ms": 3209.052, "update_time_ms": 5.786, "opt_peak_throughput": 3470.371, "sample_peak_throughput": 307.224, "opt_samples": 11136.6, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0021832778584212065, "policy_loss": -0.0023154611699283123, "vf_loss": 0.0044983625411987305, "vf_explained_var": 0.698473334312439, "kl": 0.005840342026203871, "entropy": 1.4162168502807617, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11421, "done": false, "timesteps_total": 2139406, "episodes_total": 4608, "training_iteration": 191, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-46-45", "timestamp": 1588790805, "time_this_iter_s": 36.26239204406738, "time_total_s": 7503.813305616379, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f598c0e1378>", "on_episode_end": "<function on_episode_end at 0x7f598472a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7503.813305616379, "timesteps_since_restore": 2139406, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 77.91538461538461, "ram_util_percent": 34.3}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00024, "episode_reward_mean": 0.09488769999999999, "episode_len_mean": 496.87, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.09488769999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5112183768699667, "avg_speed_min": 1.0409100806018712, "avg_speed_max": 5.04601605006689, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.98083086723843, "mean_processing_ms": 3.1146177109339828, "mean_inference_ms": 0.6299153310064858}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2150468, "num_steps_sampled": 2150468, "sample_time_ms": 36264.35, "grad_time_ms": 3196.281, "update_time_ms": 5.852, "opt_peak_throughput": 3488.492, "sample_peak_throughput": 307.47, "opt_samples": 11150.2, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.003528075758367777, "policy_loss": -0.0020437741186469793, "vf_loss": 0.005571466870605946, "vf_explained_var": 0.810168981552124, "kl": 0.005989190191030502, "entropy": 1.4212031364440918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11062, "done": false, "timesteps_total": 2150468, "episodes_total": 4629, "training_iteration": 192, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-47-24", "timestamp": 1588790844, "time_this_iter_s": 39.047370195388794, "time_total_s": 7542.860675811768, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798620>", "on_episode_step": "<function on_episode_step at 0x7f5984714048>", "on_episode_end": "<function on_episode_end at 0x7f5984714400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7542.860675811768, "timesteps_since_restore": 2150468, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 79.78571428571429, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -3.00024, "episode_reward_mean": 0.09488190000000002, "episode_len_mean": 496.87, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00024}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.09488190000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.548721698329287, "avg_speed_min": 1.0409100806018712, "avg_speed_max": 5.04601605006689, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 38.98291114202916, "mean_processing_ms": 3.112155946803272, "mean_inference_ms": 0.6297672303726456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2161848, "num_steps_sampled": 2161848, "sample_time_ms": 36574.651, "grad_time_ms": 3240.769, "update_time_ms": 5.86, "opt_peak_throughput": 3445.046, "sample_peak_throughput": 305.255, "opt_samples": 11164.6, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004198797978460789, "policy_loss": -0.005471311509609222, "vf_loss": 0.0012718494981527328, "vf_explained_var": 0.8878855109214783, "kl": 0.010339426808059216, "entropy": 1.087471604347229, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11380, "done": false, "timesteps_total": 2161848, "episodes_total": 4653, "training_iteration": 193, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-48-05", "timestamp": 1588790885, "time_this_iter_s": 40.81969475746155, "time_total_s": 7583.680370569229, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714b70>", "on_episode_step": "<function on_episode_step at 0x7f59847980d0>", "on_episode_end": "<function on_episode_end at 0x7f59847981e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7583.680370569229, "timesteps_since_restore": 2161848, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 81.91206896551724, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -0.0008100000000000015, "episode_reward_mean": 0.1274032, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0008100000000000015}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.1274032}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.497815861114168, "avg_speed_min": 1.0409100806018712, "avg_speed_max": 5.04601605006689, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.99410991746584, "mean_processing_ms": 3.1129071505420067, "mean_inference_ms": 0.6303313556414346}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2172997, "num_steps_sampled": 2172997, "sample_time_ms": 36609.411, "grad_time_ms": 3248.553, "update_time_ms": 5.884, "opt_peak_throughput": 3446.581, "sample_peak_throughput": 305.834, "opt_samples": 11196.4, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0022719590924680233, "policy_loss": -0.0023916971404105425, "vf_loss": 0.00011934319627471268, "vf_explained_var": 0.9874081611633301, "kl": 0.006141291931271553, "entropy": 0.9806695580482483, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11149, "done": false, "timesteps_total": 2172997, "episodes_total": 4674, "training_iteration": 194, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-48-46", "timestamp": 1588790926, "time_this_iter_s": 40.97534418106079, "time_total_s": 7624.65571475029, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798950>", "on_episode_step": "<function on_episode_step at 0x7f5984714400>", "on_episode_end": "<function on_episode_end at 0x7f5984714048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984772378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7624.65571475029, "timesteps_since_restore": 2172997, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 81.4322033898305, "ram_util_percent": 34.30508474576271}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -0.0008100000000000015, "episode_reward_mean": 0.1124162, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0008100000000000015}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.1124162}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3396844738133984, "avg_speed_min": 1.0399431491062816, "avg_speed_max": 5.04601605006689, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 38.98985681596648, "mean_processing_ms": 3.1104515157647397, "mean_inference_ms": 0.6299964519269535}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2184433, "num_steps_sampled": 2184433, "sample_time_ms": 36860.766, "grad_time_ms": 3280.744, "update_time_ms": 5.79, "opt_peak_throughput": 3411.482, "sample_peak_throughput": 303.634, "opt_samples": 11192.2, "learner": {"av": {"cur_kl_coeff": 6.436214607674628e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0012703785905614495, "policy_loss": -0.001395664643496275, "vf_loss": 0.00012509853695519269, "vf_explained_var": 0.9853600263595581, "kl": 0.0029251507949084044, "entropy": 0.9923705458641052, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11436, "done": false, "timesteps_total": 2184433, "episodes_total": 4698, "training_iteration": 195, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-49-29", "timestamp": 1588790969, "time_this_iter_s": 42.41832876205444, "time_total_s": 7667.074043512344, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a7b8>", "on_episode_step": "<function on_episode_step at 0x7f598472aa60>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460dae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7667.074043512344, "timesteps_since_restore": 2184433, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 82.94590163934426, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24992, "episode_reward_min": -0.0006600000000000011, "episode_reward_mean": 0.0949262, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0006600000000000011}, "policy_reward_max": {"av": 0.24992}, "policy_reward_mean": {"av": 0.0949262}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.1586365975464283, "avg_speed_min": 1.0399431491062816, "avg_speed_max": 4.75490248641898, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.0125938687026, "mean_processing_ms": 3.1112649985969467, "mean_inference_ms": 0.6307934459690212}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2195560, "num_steps_sampled": 2195560, "sample_time_ms": 37010.06, "grad_time_ms": 3294.354, "update_time_ms": 5.811, "opt_peak_throughput": 3408.438, "sample_peak_throughput": 303.393, "opt_samples": 11228.6, "learner": {"av": {"cur_kl_coeff": 3.218107303837314e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0016897260211408138, "policy_loss": -0.003410263452678919, "vf_loss": 0.001719340798445046, "vf_explained_var": 0.8593254685401917, "kl": 0.03721508011221886, "entropy": 1.1041029691696167, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11127, "done": false, "timesteps_total": 2195560, "episodes_total": 4719, "training_iteration": 196, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-50-12", "timestamp": 1588791012, "time_this_iter_s": 42.66584491729736, "time_total_s": 7709.739888429642, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a1e0>", "on_episode_step": "<function on_episode_step at 0x7f5984714048>", "on_episode_end": "<function on_episode_end at 0x7f5984714400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7709.739888429642, "timesteps_since_restore": 2195560, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 84.21639344262296, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0006000000000000009, "episode_reward_mean": 0.10242809999999998, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0006000000000000009}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.10242809999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2479348353369524, "avg_speed_min": 1.0399431491062816, "avg_speed_max": 5.0055517429928855, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.01270425144415, "mean_processing_ms": 3.1088530713253077, "mean_inference_ms": 0.63048303559515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2206878, "num_steps_sampled": 2206878, "sample_time_ms": 37004.118, "grad_time_ms": 3295.514, "update_time_ms": 5.906, "opt_peak_throughput": 3409.362, "sample_peak_throughput": 303.631, "opt_samples": 11235.6, "learner": {"av": {"cur_kl_coeff": 4.8271609557559714e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0019291579956188798, "policy_loss": -0.0031007279176265, "vf_loss": 0.0011694699060171843, "vf_explained_var": 0.9133244752883911, "kl": 0.04349909722805023, "entropy": 1.3844077587127686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11318, "done": false, "timesteps_total": 2206878, "episodes_total": 4743, "training_iteration": 197, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-50-50", "timestamp": 1588791050, "time_this_iter_s": 37.76994800567627, "time_total_s": 7747.509836435318, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a158>", "on_episode_step": "<function on_episode_step at 0x7f598472aa60>", "on_episode_end": "<function on_episode_end at 0x7f598472abf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7747.509836435318, "timesteps_since_restore": 2206878, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 79.56851851851853, "ram_util_percent": 34.3}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0006500000000000011, "episode_reward_mean": 0.1024185, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0006500000000000011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1024185}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.2492804037231187, "avg_speed_min": 1.0398429733602252, "avg_speed_max": 5.0055517429928855, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.03388734121805, "mean_processing_ms": 3.109646899631049, "mean_inference_ms": 0.6312486642181229}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2218071, "num_steps_sampled": 2218071, "sample_time_ms": 37013.676, "grad_time_ms": 3300.483, "update_time_ms": 5.897, "opt_peak_throughput": 3409.107, "sample_peak_throughput": 303.988, "opt_samples": 11251.7, "learner": {"av": {"cur_kl_coeff": 7.240741251735017e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010449078399688005, "policy_loss": -0.0016990604344755411, "vf_loss": 0.0006537319277413189, "vf_explained_var": 0.9402869939804077, "kl": 0.005772895645350218, "entropy": 1.14716637134552, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11193, "done": false, "timesteps_total": 2218071, "episodes_total": 4764, "training_iteration": 198, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-51-31", "timestamp": 1588791091, "time_this_iter_s": 41.448240756988525, "time_total_s": 7788.9580771923065, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f59847981e0>", "on_episode_end": "<function on_episode_end at 0x7f5984798268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7788.9580771923065, "timesteps_since_restore": 2218071, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 82.99322033898305, "ram_util_percent": 34.30169491525424}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0006500000000000011, "episode_reward_mean": 0.09991000000000001, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0006500000000000011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.09991000000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.17398134040255, "avg_speed_min": 1.0398429733602252, "avg_speed_max": 5.0055517429928855, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.03606202639665, "mean_processing_ms": 3.107266041804441, "mean_inference_ms": 0.630981030110194}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2229413, "num_steps_sampled": 2229413, "sample_time_ms": 37321.498, "grad_time_ms": 3339.03, "update_time_ms": 5.889, "opt_peak_throughput": 3366.906, "sample_peak_throughput": 301.226, "opt_samples": 11242.2, "learner": {"av": {"cur_kl_coeff": 7.240741251735017e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010726000182330608, "policy_loss": -0.001524727325886488, "vf_loss": 0.0004496470792219043, "vf_explained_var": 0.9601065516471863, "kl": 0.03425823897123337, "entropy": 1.0069024562835693, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11342, "done": false, "timesteps_total": 2229413, "episodes_total": 4788, "training_iteration": 199, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-52-13", "timestamp": 1588791133, "time_this_iter_s": 41.6068959236145, "time_total_s": 7830.564973115921, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598461a1e0>", "on_episode_step": "<function on_episode_step at 0x7f59847980d0>", "on_episode_end": "<function on_episode_end at 0x7f5984798c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4e510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7830.564973115921, "timesteps_since_restore": 2229413, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 83.12203389830508, "ram_util_percent": 34.300000000000004}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0006500000000000011, "episode_reward_mean": 0.11740799999999998, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0006500000000000011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.11740799999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.3532406553416125, "avg_speed_min": 1.0398429733602252, "avg_speed_max": 5.0055517429928855, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.052153713123545, "mean_processing_ms": 3.108071526563994, "mean_inference_ms": 0.6316358725891369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2240471, "num_steps_sampled": 2240471, "sample_time_ms": 36997.487, "grad_time_ms": 3296.793, "update_time_ms": 5.862, "opt_peak_throughput": 3411.983, "sample_peak_throughput": 304.037, "opt_samples": 11248.6, "learner": {"av": {"cur_kl_coeff": 0.00010861112241400406, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0022720308043062687, "policy_loss": -0.002309936797246337, "vf_loss": 3.745061258086935e-05, "vf_explained_var": 0.9971027374267578, "kl": 0.004198200535029173, "entropy": 1.1637861728668213, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11058, "done": false, "timesteps_total": 2240471, "episodes_total": 4809, "training_iteration": 200, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-52-53", "timestamp": 1588791173, "time_this_iter_s": 40.10077381134033, "time_total_s": 7870.665746927261, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798268>", "on_episode_step": "<function on_episode_step at 0x7f59847981e0>", "on_episode_end": "<function on_episode_end at 0x7f5984675a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59847726a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7870.665746927261, "timesteps_since_restore": 2240471, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 80.33275862068965, "ram_util_percent": 34.33275862068966}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0006500000000000011, "episode_reward_mean": 0.1249025, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0006500000000000011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1249025}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4107462203056484, "avg_speed_min": 1.0398429733602252, "avg_speed_max": 5.134358134825299, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.04766025947841, "mean_processing_ms": 3.1056989011703093, "mean_inference_ms": 0.6312433796048862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2251919, "num_steps_sampled": 2251919, "sample_time_ms": 37318.638, "grad_time_ms": 3342.789, "update_time_ms": 5.913, "opt_peak_throughput": 3365.842, "sample_peak_throughput": 301.493, "opt_samples": 11251.3, "learner": {"av": {"cur_kl_coeff": 5.430556120700203e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0036279845517128706, "policy_loss": -0.0036644788924604654, "vf_loss": 3.612227737903595e-05, "vf_explained_var": 0.9969730377197266, "kl": 0.006924229208379984, "entropy": 1.0345200300216675, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11448, "done": false, "timesteps_total": 2251919, "episodes_total": 4833, "training_iteration": 201, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-53-33", "timestamp": 1588791213, "time_this_iter_s": 39.93427109718323, "time_total_s": 7910.600018024445, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798400>", "on_episode_step": "<function on_episode_step at 0x7f59847980d0>", "on_episode_end": "<function on_episode_end at 0x7f5988a4e510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59847720d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7910.600018024445, "timesteps_since_restore": 2251919, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 80.67543859649125, "ram_util_percent": 34.352631578947374}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0006500000000000011, "episode_reward_mean": 0.1149128, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0006500000000000011}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1149128}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.264260425493074, "avg_speed_min": 1.039444658503488, "avg_speed_max": 5.134358134825299, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.06772421286033, "mean_processing_ms": 3.106541254882919, "mean_inference_ms": 0.6320129490944262}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2263026, "num_steps_sampled": 2263026, "sample_time_ms": 37619.842, "grad_time_ms": 3390.499, "update_time_ms": 5.855, "opt_peak_throughput": 3319.807, "sample_peak_throughput": 299.198, "opt_samples": 11255.8, "learner": {"av": {"cur_kl_coeff": 5.430556120700203e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.013028458692133427, "policy_loss": -0.013178138062357903, "vf_loss": 0.00014880011440254748, "vf_explained_var": 0.9859104156494141, "kl": 0.01624240167438984, "entropy": 0.9302875995635986, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11107, "done": false, "timesteps_total": 2263026, "episodes_total": 4854, "training_iteration": 202, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-54-16", "timestamp": 1588791256, "time_this_iter_s": 42.53668546676636, "time_total_s": 7953.136703491211, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988b5e378>", "on_episode_step": "<function on_episode_step at 0x7f5984714400>", "on_episode_end": "<function on_episode_end at 0x7f5984714048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598c0e1378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7953.136703491211, "timesteps_since_restore": 2263026, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 84.46, "ram_util_percent": 34.363333333333344}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00013, "episode_reward_mean": 0.1149117, "episode_len_mean": 497.9, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1149117}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.405847088535037, "avg_speed_min": 1.039444658503488, "avg_speed_max": 5.134358134825299, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.05449496567917, "mean_processing_ms": 3.1043358667274425, "mean_inference_ms": 0.6313518736709335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2274495, "num_steps_sampled": 2274495, "sample_time_ms": 37462.021, "grad_time_ms": 3364.257, "update_time_ms": 5.894, "opt_peak_throughput": 3348.347, "sample_peak_throughput": 300.697, "opt_samples": 11264.7, "learner": {"av": {"cur_kl_coeff": 5.430556120700203e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.013938269577920437, "policy_loss": -0.007024010643362999, "vf_loss": 0.020958954468369484, "vf_explained_var": 0.4110395610332489, "kl": 0.0612776018679142, "entropy": 1.0018540620803833, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11469, "done": false, "timesteps_total": 2274495, "episodes_total": 4879, "training_iteration": 203, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-54-55", "timestamp": 1588791295, "time_this_iter_s": 38.98073148727417, "time_total_s": 7992.117434978485, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714378>", "on_episode_step": "<function on_episode_step at 0x7f5984798400>", "on_episode_end": "<function on_episode_end at 0x7f5984546488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4e1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 7992.117434978485, "timesteps_since_restore": 2274495, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 80.43928571428572, "ram_util_percent": 34.378571428571426}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00013, "episode_reward_mean": 0.1174121, "episode_len_mean": 497.9, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1174121}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.449321956803922, "avg_speed_min": 1.039444658503488, "avg_speed_max": 5.134358134825299, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.08018160778, "mean_processing_ms": 3.1051213725885924, "mean_inference_ms": 0.6323319644472494}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2285467, "num_steps_sampled": 2285467, "sample_time_ms": 37465.429, "grad_time_ms": 3364.104, "update_time_ms": 5.805, "opt_peak_throughput": 3343.238, "sample_peak_throughput": 300.197, "opt_samples": 11247.0, "learner": {"av": {"cur_kl_coeff": 8.145833999151364e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0035258419811725616, "policy_loss": -0.003846005769446492, "vf_loss": 0.0003189716371707618, "vf_explained_var": 0.975883960723877, "kl": 0.014632047154009342, "entropy": 1.257314920425415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10972, "done": false, "timesteps_total": 2285467, "episodes_total": 4899, "training_iteration": 204, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-55-36", "timestamp": 1588791336, "time_this_iter_s": 41.006584882736206, "time_total_s": 8033.124019861221, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847980d0>", "on_episode_step": "<function on_episode_step at 0x7f5984714048>", "on_episode_end": "<function on_episode_end at 0x7f5984714400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984772f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8033.124019861221, "timesteps_since_restore": 2285467, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 82.69661016949154, "ram_util_percent": 34.38644067796611}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00013, "episode_reward_mean": 0.1099074, "episode_len_mean": 497.9, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1099074}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.386726669612483, "avg_speed_min": 1.039444658503488, "avg_speed_max": 5.032642190379333, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.06947450962924, "mean_processing_ms": 3.102913874877008, "mean_inference_ms": 0.6317048729933803}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2297014, "num_steps_sampled": 2297014, "sample_time_ms": 37267.224, "grad_time_ms": 3336.716, "update_time_ms": 5.818, "opt_peak_throughput": 3374.006, "sample_peak_throughput": 302.091, "opt_samples": 11258.1, "learner": {"av": {"cur_kl_coeff": 8.145833999151364e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.005936023313552141, "policy_loss": -0.00604348024353385, "vf_loss": 0.0001062148148776032, "vf_explained_var": 0.9915516376495361, "kl": 0.015266346745193005, "entropy": 1.1033999919891357, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11547, "done": false, "timesteps_total": 2297014, "episodes_total": 4924, "training_iteration": 205, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-56-16", "timestamp": 1588791376, "time_this_iter_s": 40.16286540031433, "time_total_s": 8073.286885261536, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f598460d378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8073.286885261536, "timesteps_since_restore": 2297014, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 81.59298245614035, "ram_util_percent": 34.391228070175444}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24994, "episode_reward_min": -1.00013, "episode_reward_mean": 0.10739599999999999, "episode_len_mean": 497.9, "episodes_this_iter": 20, "policy_reward_min": {"av": -1.00013}, "policy_reward_max": {"av": 0.24994}, "policy_reward_mean": {"av": 0.10739599999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3571877980262226, "avg_speed_min": 1.039444658503488, "avg_speed_max": 5.032642190379333, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.09622088688266, "mean_processing_ms": 3.1037285196371327, "mean_inference_ms": 0.6327175569544568}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2307999, "num_steps_sampled": 2307999, "sample_time_ms": 37189.782, "grad_time_ms": 3330.57, "update_time_ms": 5.847, "opt_peak_throughput": 3375.969, "sample_peak_throughput": 302.338, "opt_samples": 11243.9, "learner": {"av": {"cur_kl_coeff": 8.145833999151364e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.011546621099114418, "policy_loss": -0.011606886982917786, "vf_loss": 5.922720811213367e-05, "vf_explained_var": 0.9951412081718445, "kl": 0.01280676294118166, "entropy": 1.1243326663970947, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10985, "done": false, "timesteps_total": 2307999, "episodes_total": 4944, "training_iteration": 206, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-56-58", "timestamp": 1588791418, "time_this_iter_s": 41.83060097694397, "time_total_s": 8115.11748623848, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460d8c8>", "on_episode_step": "<function on_episode_step at 0x7f5984714048>", "on_episode_end": "<function on_episode_end at 0x7f598472a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984675950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4eb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8115.11748623848, "timesteps_since_restore": 2307999, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 83.08166666666666, "ram_util_percent": 34.39333333333334}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1123671, "episode_len_mean": 497.91, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.1123671}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.386298985782935, "avg_speed_min": 1.0391824611954543, "avg_speed_max": 4.746314960112008, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.098478006213305, "mean_processing_ms": 3.1014703207217336, "mean_inference_ms": 0.632453064446548}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2319457, "num_steps_sampled": 2319457, "sample_time_ms": 37527.23, "grad_time_ms": 3370.36, "update_time_ms": 5.872, "opt_peak_throughput": 3340.267, "sample_peak_throughput": 299.993, "opt_samples": 11257.9, "learner": {"av": {"cur_kl_coeff": 8.145833999151364e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.011623954400420189, "policy_loss": -0.0020980332046747208, "vf_loss": 0.013721553608775139, "vf_explained_var": 0.5977969169616699, "kl": 0.005285018589347601, "entropy": 1.1596580743789673, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11458, "done": false, "timesteps_total": 2319457, "episodes_total": 4969, "training_iteration": 207, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-57-40", "timestamp": 1588791460, "time_this_iter_s": 41.54308271408081, "time_total_s": 8156.66056895256, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598460dae8>", "on_episode_step": "<function on_episode_step at 0x7f598460d378>", "on_episode_end": "<function on_episode_end at 0x7f598460d400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a9d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8156.66056895256, "timesteps_since_restore": 2319457, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 83.06271186440678, "ram_util_percent": 34.38983050847458}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1173472, "episode_len_mean": 497.91, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.1173472}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4268143837738814, "avg_speed_min": 1.0391824611954543, "avg_speed_max": 4.436203831342208, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.10399373529292, "mean_processing_ms": 3.102693096262586, "mean_inference_ms": 0.6328319254726086}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2330552, "num_steps_sampled": 2330552, "sample_time_ms": 37385.476, "grad_time_ms": 3351.929, "update_time_ms": 6.017, "opt_peak_throughput": 3355.709, "sample_peak_throughput": 300.868, "opt_samples": 11248.1, "learner": {"av": {"cur_kl_coeff": 8.145833999151364e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003807786153629422, "policy_loss": -0.004587947856634855, "vf_loss": 0.0007785016787238419, "vf_explained_var": 0.9284594655036926, "kl": 0.0203690268099308, "entropy": 1.3118265867233276, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11095, "done": false, "timesteps_total": 2330552, "episodes_total": 4990, "training_iteration": 208, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-58-20", "timestamp": 1588791500, "time_this_iter_s": 39.84783577919006, "time_total_s": 8196.50840473175, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798950>", "on_episode_step": "<function on_episode_step at 0x7f5984798400>", "on_episode_end": "<function on_episode_end at 0x7f5984798620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984798378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984546ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8196.50840473175, "timesteps_since_restore": 2330552, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 82.17719298245615, "ram_util_percent": 34.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.11484319999999998, "episode_len_mean": 497.91, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.11484319999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.398919408431967, "avg_speed_min": 1.0391824611954543, "avg_speed_max": 4.436203831342208, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.11776628152516, "mean_processing_ms": 3.1002649490228076, "mean_inference_ms": 0.6329482360796285}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2341988, "num_steps_sampled": 2341988, "sample_time_ms": 37424.683, "grad_time_ms": 3359.085, "update_time_ms": 6.0, "opt_peak_throughput": 3351.359, "sample_peak_throughput": 300.804, "opt_samples": 11257.5, "learner": {"av": {"cur_kl_coeff": 0.00012218751362524927, "cur_lr": 9.999999747378752e-06, "total_loss": -0.007755685597658157, "policy_loss": -0.007912633940577507, "vf_loss": 0.00015246371913235635, "vf_explained_var": 0.9848045706748962, "kl": 0.03670429065823555, "entropy": 1.0316975116729736, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11436, "done": false, "timesteps_total": 2341988, "episodes_total": 5014, "training_iteration": 209, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-59-02", "timestamp": 1588791542, "time_this_iter_s": 42.0711784362793, "time_total_s": 8238.57958316803, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847980d0>", "on_episode_step": "<function on_episode_step at 0x7f598460d378>", "on_episode_end": "<function on_episode_end at 0x7f598460dae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984714400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8238.57958316803, "timesteps_since_restore": 2341988, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 83.37333333333335, "ram_util_percent": 34.39666666666667}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24984, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1073457, "episode_len_mean": 497.91, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24984}, "policy_reward_mean": {"av": 0.1073457}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3475100218593146, "avg_speed_min": 1.0391824611954543, "avg_speed_max": 4.861791748881356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.12773617579016, "mean_processing_ms": 3.1015175060506484, "mean_inference_ms": 0.6334815818050069}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2353101, "num_steps_sampled": 2353101, "sample_time_ms": 37609.992, "grad_time_ms": 3382.18, "update_time_ms": 6.064, "opt_peak_throughput": 3330.101, "sample_peak_throughput": 299.468, "opt_samples": 11263.0, "learner": {"av": {"cur_kl_coeff": 0.0001832812704378739, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0013124686665832996, "policy_loss": -0.0022637906949967146, "vf_loss": 0.0009502690518274903, "vf_explained_var": 0.9241148829460144, "kl": 0.005742404609918594, "entropy": 1.2323492765426636, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11113, "done": false, "timesteps_total": 2353101, "episodes_total": 5035, "training_iteration": 210, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_18-59-44", "timestamp": 1588791584, "time_this_iter_s": 42.18567180633545, "time_total_s": 8280.765254974365, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798620>", "on_episode_step": "<function on_episode_step at 0x7f5984798400>", "on_episode_end": "<function on_episode_end at 0x7f5984546488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8280.765254974365, "timesteps_since_restore": 2353101, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 82.57868852459016, "ram_util_percent": 34.4016393442623}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24984, "episode_reward_min": -0.0005500000000000008, "episode_reward_mean": 0.12484260000000001, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0005500000000000008}, "policy_reward_max": {"av": 0.24984}, "policy_reward_mean": {"av": 0.12484260000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4414917330238284, "avg_speed_min": 1.0391824611954543, "avg_speed_max": 4.861791748881356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.13886434479053, "mean_processing_ms": 3.0991059782469974, "mean_inference_ms": 0.6335896030100803}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2364435, "num_steps_sampled": 2364435, "sample_time_ms": 37519.992, "grad_time_ms": 3375.675, "update_time_ms": 6.072, "opt_peak_throughput": 3333.141, "sample_peak_throughput": 299.883, "opt_samples": 11251.6, "learner": {"av": {"cur_kl_coeff": 0.0001832812704378739, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004880308639258146, "policy_loss": -0.005837711971253157, "vf_loss": 0.0009566498920321465, "vf_explained_var": 0.9196173548698425, "kl": 0.004122741520404816, "entropy": 1.2806669473648071, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11334, "done": false, "timesteps_total": 2364435, "episodes_total": 5059, "training_iteration": 211, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-00-23", "timestamp": 1588791623, "time_this_iter_s": 38.969629526138306, "time_total_s": 8319.734884500504, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984798378>", "on_episode_step": "<function on_episode_step at 0x7f598460dae8>", "on_episode_end": "<function on_episode_end at 0x7f598460d378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dcf28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8319.734884500504, "timesteps_since_restore": 2364435, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 81.82, "ram_util_percent": 34.40000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -0.0005500000000000008, "episode_reward_mean": 0.12484350000000001, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0005500000000000008}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.12484350000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4730743075603416, "avg_speed_min": 1.0408166926805185, "avg_speed_max": 4.861791748881356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.156519708746636, "mean_processing_ms": 3.100002795254352, "mean_inference_ms": 0.6343929392751808}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2375625, "num_steps_sampled": 2375625, "sample_time_ms": 37437.975, "grad_time_ms": 3361.791, "update_time_ms": 6.176, "opt_peak_throughput": 3349.375, "sample_peak_throughput": 300.761, "opt_samples": 11259.9, "learner": {"av": {"cur_kl_coeff": 9.164063521893695e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0007203957648016512, "policy_loss": 0.00043939717579633, "vf_loss": 0.0002804629039019346, "vf_explained_var": 0.9752909541130066, "kl": 0.005868949927389622, "entropy": 1.323076844215393, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11190, "done": false, "timesteps_total": 2375625, "episodes_total": 5080, "training_iteration": 212, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-01-05", "timestamp": 1588791665, "time_this_iter_s": 41.578415632247925, "time_total_s": 8361.313300132751, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f59846dc598>", "on_episode_end": "<function on_episode_end at 0x7f59846dc8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dcd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59847729d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8361.313300132751, "timesteps_since_restore": 2375625, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 82.41833333333332, "ram_util_percent": 34.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -3.00058, "episode_reward_mean": 0.10231940000000002, "episode_len_mean": 499.74, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.00058}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.10231940000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.526196420796187, "avg_speed_min": 1.0402552068199864, "avg_speed_max": 4.861791748881356, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.15585412847242, "mean_processing_ms": 3.0978587571029745, "mean_inference_ms": 0.6340569222731592}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2386907, "num_steps_sampled": 2386907, "sample_time_ms": 37468.47, "grad_time_ms": 3367.625, "update_time_ms": 6.119, "opt_peak_throughput": 3338.02, "sample_peak_throughput": 300.018, "opt_samples": 11241.2, "learner": {"av": {"cur_kl_coeff": 9.164063521893695e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.08459824323654175, "policy_loss": -0.013524536043405533, "vf_loss": 0.09812036156654358, "vf_explained_var": 0.11578109860420227, "kl": 0.02635802887380123, "entropy": 1.4554224014282227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11282, "done": false, "timesteps_total": 2386907, "episodes_total": 5104, "training_iteration": 213, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-01-44", "timestamp": 1588791704, "time_this_iter_s": 39.3420844078064, "time_total_s": 8400.655384540558, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598c0e1378>", "on_episode_step": "<function on_episode_step at 0x7f5984772840>", "on_episode_end": "<function on_episode_end at 0x7f5984772e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dcf28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984798158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8400.655384540558, "timesteps_since_restore": 2386907, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 81.875, "ram_util_percent": 34.4}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -3.0005899999999994, "episode_reward_mean": 0.0723088, "episode_len_mean": 499.23, "episodes_this_iter": 21, "policy_reward_min": {"av": -3.0005899999999994}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.0723088}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4971251342763083, "avg_speed_min": 1.0388923654442654, "avg_speed_max": 4.828647643756074, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.17240749177766, "mean_processing_ms": 3.0988210885675165, "mean_inference_ms": 0.6348101775318896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2398044, "num_steps_sampled": 2398044, "sample_time_ms": 37573.495, "grad_time_ms": 3381.26, "update_time_ms": 6.158, "opt_peak_throughput": 3329.439, "sample_peak_throughput": 299.618, "opt_samples": 11257.7, "learner": {"av": {"cur_kl_coeff": 0.000137460941914469, "cur_lr": 9.999999747378752e-06, "total_loss": 0.033231016248464584, "policy_loss": -0.00016961021174211055, "vf_loss": 0.0334002785384655, "vf_explained_var": 0.7140194773674011, "kl": 0.0025931852869689465, "entropy": 1.2845640182495117, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11137, "done": false, "timesteps_total": 2398044, "episodes_total": 5125, "training_iteration": 214, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-02-27", "timestamp": 1588791747, "time_this_iter_s": 42.19396424293518, "time_total_s": 8442.849348783493, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc8c8>", "on_episode_step": "<function on_episode_step at 0x7f59846dc598>", "on_episode_end": "<function on_episode_end at 0x7f5984772f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59847729d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984675158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8442.849348783493, "timesteps_since_restore": 2398044, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 83.87833333333332, "ram_util_percent": 34.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24987, "episode_reward_min": -3.0005899999999994, "episode_reward_mean": 0.06981240000000001, "episode_len_mean": 499.23, "episodes_this_iter": 24, "policy_reward_min": {"av": -3.0005899999999994}, "policy_reward_max": {"av": 0.24987}, "policy_reward_mean": {"av": 0.06981240000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.4178625550135093, "avg_speed_min": 1.0388923654442654, "avg_speed_max": 4.828647643756074, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.1744688495098, "mean_processing_ms": 3.0966850738351512, "mean_inference_ms": 0.6344930402904484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2409408, "num_steps_sampled": 2409408, "sample_time_ms": 37628.167, "grad_time_ms": 3388.782, "update_time_ms": 6.189, "opt_peak_throughput": 3316.649, "sample_peak_throughput": 298.696, "opt_samples": 11239.4, "learner": {"av": {"cur_kl_coeff": 6.87304709572345e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0004427066305652261, "policy_loss": -0.000806201423984021, "vf_loss": 0.00036325454129837453, "vf_explained_var": 0.969897449016571, "kl": 0.0035398518666625023, "entropy": 1.4117751121520996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11364, "done": false, "timesteps_total": 2409408, "episodes_total": 5149, "training_iteration": 215, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-03-07", "timestamp": 1588791787, "time_this_iter_s": 40.785741329193115, "time_total_s": 8483.635090112686, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988a4eb70>", "on_episode_step": "<function on_episode_step at 0x7f5988a4eea0>", "on_episode_end": "<function on_episode_end at 0x7f5988a4e2f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5988a4ed08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472aa60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8483.635090112686, "timesteps_since_restore": 2409408, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 81.5491525423729, "ram_util_percent": 34.41694915254238}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24982, "episode_reward_min": -3.0005899999999994, "episode_reward_mean": 0.0598046, "episode_len_mean": 496.84, "episodes_this_iter": 22, "policy_reward_min": {"av": -3.0005899999999994}, "policy_reward_max": {"av": 0.24982}, "policy_reward_mean": {"av": 0.0598046}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3819602753434883, "avg_speed_min": 1.0388923654442654, "avg_speed_max": 4.352109724238156, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.187184335408425, "mean_processing_ms": 3.09807787581255, "mean_inference_ms": 0.6351767194001813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2420554, "num_steps_sampled": 2420554, "sample_time_ms": 37626.906, "grad_time_ms": 3387.414, "update_time_ms": 6.106, "opt_peak_throughput": 3322.741, "sample_peak_throughput": 299.134, "opt_samples": 11255.5, "learner": {"av": {"cur_kl_coeff": 3.436523547861725e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.012696370482444763, "policy_loss": -0.005981288384646177, "vf_loss": 0.018675509840250015, "vf_explained_var": 0.3868512213230133, "kl": 0.06252586841583252, "entropy": 1.0924034118652344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11146, "done": false, "timesteps_total": 2420554, "episodes_total": 5171, "training_iteration": 216, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-03-49", "timestamp": 1588791829, "time_this_iter_s": 41.80293345451355, "time_total_s": 8525.4380235672, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675950>", "on_episode_step": "<function on_episode_step at 0x7f5984546ea0>", "on_episode_end": "<function on_episode_end at 0x7f5988b5e378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8525.4380235672, "timesteps_since_restore": 2420554, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 84.20169491525425, "ram_util_percent": 34.400000000000006}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24982, "episode_reward_min": -3.0005899999999994, "episode_reward_mean": 0.0723178, "episode_len_mean": 495.98, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0005899999999994}, "policy_reward_max": {"av": 0.24982}, "policy_reward_mean": {"av": 0.0723178}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.317773912042886, "avg_speed_min": 1.0388923654442654, "avg_speed_max": 4.299707105274214, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.19921815760115, "mean_processing_ms": 3.095802295194707, "mean_inference_ms": 0.6350039187489095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2431752, "num_steps_sampled": 2431752, "sample_time_ms": 37654.273, "grad_time_ms": 3397.605, "update_time_ms": 6.128, "opt_peak_throughput": 3305.122, "sample_peak_throughput": 298.226, "opt_samples": 11229.5, "learner": {"av": {"cur_kl_coeff": 5.1547856855904683e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.007458612788468599, "policy_loss": -0.0003801397397182882, "vf_loss": 0.007837794721126556, "vf_explained_var": 0.6389347314834595, "kl": 0.018617579713463783, "entropy": 0.9828796982765198, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11198, "done": false, "timesteps_total": 2431752, "episodes_total": 5194, "training_iteration": 217, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-04-31", "timestamp": 1588791871, "time_this_iter_s": 41.91866683959961, "time_total_s": 8567.3566904068, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675158>", "on_episode_step": "<function on_episode_step at 0x7f5988a4e2f0>", "on_episode_end": "<function on_episode_end at 0x7f5988a4eea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472aa60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5984772488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8567.3566904068, "timesteps_since_restore": 2431752, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 83.26666666666667, "ram_util_percent": 34.44000000000001}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -3.0005899999999994, "episode_reward_mean": 0.044838200000000016, "episode_len_mean": 493.37, "episodes_this_iter": 23, "policy_reward_min": {"av": -3.0005899999999994}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.044838200000000016}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2785051934023146, "avg_speed_min": 1.0391605535159874, "avg_speed_max": 4.299707105274214, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 39.224090142843245, "mean_processing_ms": 3.098147266917361, "mean_inference_ms": 0.6360087757027518}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2442958, "num_steps_sampled": 2442958, "sample_time_ms": 38016.652, "grad_time_ms": 3445.581, "update_time_ms": 6.076, "opt_peak_throughput": 3262.324, "sample_peak_throughput": 295.676, "opt_samples": 11240.6, "learner": {"av": {"cur_kl_coeff": 5.1547856855904683e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.01186456624418497, "policy_loss": -0.0011115440865978599, "vf_loss": 0.012975904159247875, "vf_explained_var": 0.3978346288204193, "kl": 0.00407634349539876, "entropy": 0.7739449143409729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11206, "done": false, "timesteps_total": 2442958, "episodes_total": 5217, "training_iteration": 218, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-05-16", "timestamp": 1588791916, "time_this_iter_s": 43.95088028907776, "time_total_s": 8611.307570695877, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988a4ed08>", "on_episode_step": "<function on_episode_step at 0x7f5984546488>", "on_episode_end": "<function on_episode_end at 0x7f5984546ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59845d6f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8611.307570695877, "timesteps_since_restore": 2442958, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 85.25714285714287, "ram_util_percent": 34.46825396825397}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.00081, "episode_reward_mean": 0.05984450000000001, "episode_len_mean": 492.71, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.00081}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.05984450000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3161274641574803, "avg_speed_min": 1.0391605535159874, "avg_speed_max": 4.561166844824571, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.23745742688002, "mean_processing_ms": 3.095188597998563, "mean_inference_ms": 0.6357596952597617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2454069, "num_steps_sampled": 2454069, "sample_time_ms": 38042.084, "grad_time_ms": 3451.782, "update_time_ms": 6.147, "opt_peak_throughput": 3247.047, "sample_peak_throughput": 294.624, "opt_samples": 11208.1, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.0027088329661637545, "policy_loss": -0.0022347092162817717, "vf_loss": 0.004943040199577808, "vf_explained_var": 0.6758662462234497, "kl": 0.01961761713027954, "entropy": 1.1843514442443848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11111, "done": false, "timesteps_total": 2454069, "episodes_total": 5239, "training_iteration": 219, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-05-58", "timestamp": 1588791958, "time_this_iter_s": 42.38773822784424, "time_total_s": 8653.695308923721, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988b5e378>", "on_episode_step": "<function on_episode_step at 0x7f59847729d8>", "on_episode_end": "<function on_episode_end at 0x7f5984772e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984772840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8653.695308923721, "timesteps_since_restore": 2454069, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 83.25409836065573, "ram_util_percent": 34.48524590163935}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.00081, "episode_reward_mean": 0.05484510000000001, "episode_len_mean": 492.71, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.00081}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.05484510000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3406064353835343, "avg_speed_min": 1.0399730726352185, "avg_speed_max": 4.561166844824571, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.26740272692204, "mean_processing_ms": 3.0975250243412398, "mean_inference_ms": 0.6368655673257504}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2465345, "num_steps_sampled": 2465345, "sample_time_ms": 38128.669, "grad_time_ms": 3466.17, "update_time_ms": 6.12, "opt_peak_throughput": 3238.272, "sample_peak_throughput": 294.382, "opt_samples": 11224.4, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.001074666273780167, "policy_loss": -0.0015364603605121374, "vf_loss": 0.00046157397446222603, "vf_explained_var": 0.9462649822235107, "kl": 0.00865952018648386, "entropy": 1.1045055389404297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11276, "done": false, "timesteps_total": 2465345, "episodes_total": 5262, "training_iteration": 220, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-06-41", "timestamp": 1588792001, "time_this_iter_s": 43.194843769073486, "time_total_s": 8696.890152692795, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984772f28>", "on_episode_step": "<function on_episode_step at 0x7f5984546ea0>", "on_episode_end": "<function on_episode_end at 0x7f59846dc6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4ed08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8696.890152692795, "timesteps_since_restore": 2465345, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 84.16129032258064, "ram_util_percent": 34.49193548387097}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.0005000000000002, "episode_reward_mean": 0.0898259, "episode_len_mean": 496.22, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0005000000000002}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.0898259}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4907507549214256, "avg_speed_min": 1.079900478264215, "avg_speed_max": 4.561166844824571, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.279680687134345, "mean_processing_ms": 3.094443397289315, "mean_inference_ms": 0.6365060199491056}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2476582, "num_steps_sampled": 2476582, "sample_time_ms": 38135.988, "grad_time_ms": 3474.585, "update_time_ms": 6.043, "opt_peak_throughput": 3227.638, "sample_peak_throughput": 294.071, "opt_samples": 11214.7, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0019819282460957766, "policy_loss": -0.002956090262159705, "vf_loss": 0.0009739479864947498, "vf_explained_var": 0.9218366146087646, "kl": 0.008225166238844395, "entropy": 1.0898000001907349, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11237, "done": false, "timesteps_total": 2476582, "episodes_total": 5284, "training_iteration": 221, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-07-21", "timestamp": 1588792041, "time_this_iter_s": 39.12608504295349, "time_total_s": 8736.016237735748, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f5984772e18>", "on_episode_end": "<function on_episode_end at 0x7f59847729d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8736.016237735748, "timesteps_since_restore": 2476582, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 81.71964285714284, "ram_util_percent": 34.489285714285714}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.0005000000000002, "episode_reward_mean": 0.10731349999999998, "episode_len_mean": 498.83, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0005000000000002}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.10731349999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5552364507770027, "avg_speed_min": 1.0989014072008967, "avg_speed_max": 4.561166844824571, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.29558562916334, "mean_processing_ms": 3.095640970621844, "mean_inference_ms": 0.6373218739036107}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2487892, "num_steps_sampled": 2487892, "sample_time_ms": 38058.42, "grad_time_ms": 3462.381, "update_time_ms": 6.065, "opt_peak_throughput": 3242.48, "sample_peak_throughput": 294.986, "opt_samples": 11226.7, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004629337694495916, "policy_loss": -0.005178323481231928, "vf_loss": 0.0005485963192768395, "vf_explained_var": 0.9557320475578308, "kl": 0.01506504975259304, "entropy": 1.186413288116455, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11310, "done": false, "timesteps_total": 2487892, "episodes_total": 5307, "training_iteration": 222, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-08-01", "timestamp": 1588792081, "time_this_iter_s": 40.68069505691528, "time_total_s": 8776.696932792664, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984772840>", "on_episode_step": "<function on_episode_step at 0x7f598472a9d8>", "on_episode_end": "<function on_episode_end at 0x7f598472a1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8776.696932792664, "timesteps_since_restore": 2487892, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 82.56034482758622, "ram_util_percent": 34.48793103448276}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.0005000000000002, "episode_reward_mean": 0.1248014, "episode_len_mean": 498.83, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0005000000000002}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.1248014}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7111854694370687, "avg_speed_min": 1.0989014072008967, "avg_speed_max": 4.561166844824571, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.301515676113986, "mean_processing_ms": 3.0933065601043395, "mean_inference_ms": 0.6369393993789672}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2499111, "num_steps_sampled": 2499111, "sample_time_ms": 38084.033, "grad_time_ms": 3463.67, "update_time_ms": 6.054, "opt_peak_throughput": 3239.454, "sample_peak_throughput": 294.622, "opt_samples": 11220.4, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -4.97835389978718e-05, "policy_loss": -0.0013648569583892822, "vf_loss": 0.0013149222359061241, "vf_explained_var": 0.893415629863739, "kl": 0.005991166923195124, "entropy": 1.2611027956008911, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11219, "done": false, "timesteps_total": 2499111, "episodes_total": 5329, "training_iteration": 223, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-08-41", "timestamp": 1588792121, "time_this_iter_s": 39.611064434051514, "time_total_s": 8816.307997226715, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988b5e378>", "on_episode_step": "<function on_episode_step at 0x7f5984772e18>", "on_episode_end": "<function on_episode_end at 0x7f598460d730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4eea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8816.307997226715, "timesteps_since_restore": 2499111, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 81.73571428571428, "ram_util_percent": 34.496428571428574}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24986, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1347953, "episode_len_mean": 497.93, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24986}, "policy_reward_mean": {"av": 0.1347953}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.814303027293822, "avg_speed_min": 1.0989014072008967, "avg_speed_max": 4.22356685528631, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.302157840880646, "mean_processing_ms": 3.094355636967742, "mean_inference_ms": 0.6374195651347729}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2510360, "num_steps_sampled": 2510360, "sample_time_ms": 37676.25, "grad_time_ms": 3406.461, "update_time_ms": 5.999, "opt_peak_throughput": 3297.147, "sample_peak_throughput": 298.108, "opt_samples": 11231.6, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.016082637012004852, "policy_loss": -0.002603201661258936, "vf_loss": 0.018685506656765938, "vf_explained_var": 0.49684277176856995, "kl": 0.01312825083732605, "entropy": 1.1647661924362183, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11249, "done": false, "timesteps_total": 2510360, "episodes_total": 5352, "training_iteration": 224, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-09-19", "timestamp": 1588792159, "time_this_iter_s": 37.54318308830261, "time_total_s": 8853.851180315018, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847729d8>", "on_episode_step": "<function on_episode_step at 0x7f598472a1e0>", "on_episode_end": "<function on_episode_end at 0x7f598472a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e1ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8853.851180315018, "timesteps_since_restore": 2510360, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 79.36481481481485, "ram_util_percent": 34.49814814814815}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.13731359999999998, "episode_len_mean": 497.93, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.13731359999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9367199203202325, "avg_speed_min": 1.0989014072008967, "avg_speed_max": 4.866234307687513, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.29320800165064, "mean_processing_ms": 3.091808154325069, "mean_inference_ms": 0.6368357100525359}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2521627, "num_steps_sampled": 2521627, "sample_time_ms": 37316.956, "grad_time_ms": 3365.126, "update_time_ms": 6.042, "opt_peak_throughput": 3334.764, "sample_peak_throughput": 300.719, "opt_samples": 11221.9, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.001912547624669969, "policy_loss": 0.0005769077688455582, "vf_loss": 0.0013354195980355144, "vf_explained_var": 0.8854532837867737, "kl": 0.00861660111695528, "entropy": 0.9352980256080627, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11267, "done": false, "timesteps_total": 2521627, "episodes_total": 5375, "training_iteration": 225, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-09-56", "timestamp": 1588792196, "time_this_iter_s": 36.78100538253784, "time_total_s": 8890.632185697556, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f598472aa60>", "on_episode_end": "<function on_episode_end at 0x7f598472a7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59847980d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dc950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8890.632185697556, "timesteps_since_restore": 2521627, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 78.40377358490565, "ram_util_percent": 34.49622641509434}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.1448202, "episode_len_mean": 497.93, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1448202}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0405129188854234, "avg_speed_min": 1.3564134383331954, "avg_speed_max": 4.866234307687513, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.28488688441341, "mean_processing_ms": 3.0929469482861385, "mean_inference_ms": 0.6370688913279221}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2532888, "num_steps_sampled": 2532888, "sample_time_ms": 36966.152, "grad_time_ms": 3320.815, "update_time_ms": 6.084, "opt_peak_throughput": 3382.723, "sample_peak_throughput": 303.883, "opt_samples": 11233.4, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0027697866316884756, "policy_loss": -0.0030191747937351465, "vf_loss": 0.0002489062899257988, "vf_explained_var": 0.9811558723449707, "kl": 0.018634023144841194, "entropy": 0.9476736187934875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11261, "done": false, "timesteps_total": 2532888, "episodes_total": 5397, "training_iteration": 226, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-10-34", "timestamp": 1588792234, "time_this_iter_s": 37.863080978393555, "time_total_s": 8928.49526667595, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f598472a9d8>", "on_episode_end": "<function on_episode_end at 0x7f59846dc268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dcea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8928.49526667595, "timesteps_since_restore": 2532888, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 80.05555555555554, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.147334, "episode_len_mean": 497.93, "episodes_this_iter": 23, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.147334}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0814507852885265, "avg_speed_min": 1.3706750462420612, "avg_speed_max": 4.866234307687513, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.26899128133212, "mean_processing_ms": 3.0903669108707037, "mean_inference_ms": 0.6363649683813485}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2544164, "num_steps_sampled": 2544164, "sample_time_ms": 36638.354, "grad_time_ms": 3276.432, "update_time_ms": 6.009, "opt_peak_throughput": 3430.927, "sample_peak_throughput": 306.815, "opt_samples": 11241.2, "learner": {"av": {"cur_kl_coeff": 2.5773928427952342e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002727745333686471, "policy_loss": -0.003547077300027013, "vf_loss": 0.0008192402310669422, "vf_explained_var": 0.9315856695175171, "kl": 0.0037130455020815134, "entropy": 1.1149938106536865, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11276, "done": false, "timesteps_total": 2544164, "episodes_total": 5420, "training_iteration": 227, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-11-12", "timestamp": 1588792272, "time_this_iter_s": 38.19926977157593, "time_total_s": 8966.694536447525, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a158>", "on_episode_step": "<function on_episode_step at 0x7f598472a7b8>", "on_episode_end": "<function on_episode_end at 0x7f598472aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e18c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 8966.694536447525, "timesteps_since_restore": 2544164, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 80.74259259259259, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": -0.0007700000000000014, "episode_reward_mean": 0.16234360000000003, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0007700000000000014}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.16234360000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.1063479455028307, "avg_speed_min": 1.3706750462420612, "avg_speed_max": 5.165244858088423, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.258084169183604, "mean_processing_ms": 3.0914853855956643, "mean_inference_ms": 0.6365850470723156}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2555428, "num_steps_sampled": 2555428, "sample_time_ms": 36098.512, "grad_time_ms": 3202.838, "update_time_ms": 6.004, "opt_peak_throughput": 3511.573, "sample_peak_throughput": 311.564, "opt_samples": 11247.0, "learner": {"av": {"cur_kl_coeff": 1.2886964213976171e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0014493877533823252, "policy_loss": -0.0015914991963654757, "vf_loss": 0.000141782162245363, "vf_explained_var": 0.9884583950042725, "kl": 0.025641879066824913, "entropy": 0.7762115597724915, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11264, "done": false, "timesteps_total": 2555428, "episodes_total": 5442, "training_iteration": 228, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-11-50", "timestamp": 1588792310, "time_this_iter_s": 37.81634759902954, "time_total_s": 9004.510884046555, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847980d0>", "on_episode_step": "<function on_episode_step at 0x7f598472a1e0>", "on_episode_end": "<function on_episode_end at 0x7f598472a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e19d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9004.510884046555, "timesteps_since_restore": 2555428, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 79.05185185185184, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24989, "episode_reward_min": -0.0006800000000000011, "episode_reward_mean": 0.139872, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0006800000000000011}, "policy_reward_max": {"av": 0.24989}, "policy_reward_mean": {"av": 0.139872}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9167664423052617, "avg_speed_min": 1.3706750462420612, "avg_speed_max": 5.165244858088423, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.25060773365967, "mean_processing_ms": 3.0890563155600113, "mean_inference_ms": 0.6360100943368607}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2566682, "num_steps_sampled": 2566682, "sample_time_ms": 36088.936, "grad_time_ms": 3194.235, "update_time_ms": 5.989, "opt_peak_throughput": 3525.508, "sample_peak_throughput": 312.043, "opt_samples": 11261.3, "learner": {"av": {"cur_kl_coeff": 1.9330445866216905e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0003190089773852378, "policy_loss": -0.0003354151558596641, "vf_loss": 1.6286383470287547e-05, "vf_explained_var": 0.9976708292961121, "kl": 0.006077887956053019, "entropy": 0.39285746216773987, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11254, "done": false, "timesteps_total": 2566682, "episodes_total": 5465, "training_iteration": 229, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-12-32", "timestamp": 1588792352, "time_this_iter_s": 42.20504069328308, "time_total_s": 9046.715924739838, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a7b8>", "on_episode_step": "<function on_episode_step at 0x7f59846e1048>", "on_episode_end": "<function on_episode_end at 0x7f59846e1d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e11e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9046.715924739838, "timesteps_since_restore": 2566682, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 82.39672131147539, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -0.0006800000000000011, "episode_reward_mean": 0.13237169999999998, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0006800000000000011}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.13237169999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8505651956680835, "avg_speed_min": 1.5618384801018685, "avg_speed_max": 5.165244858088423, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.248539653281824, "mean_processing_ms": 3.090087318111297, "mean_inference_ms": 0.636496122691356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2577870, "num_steps_sampled": 2577870, "sample_time_ms": 35766.218, "grad_time_ms": 3145.425, "update_time_ms": 6.096, "opt_peak_throughput": 3577.418, "sample_peak_throughput": 314.613, "opt_samples": 11252.5, "learner": {"av": {"cur_kl_coeff": 1.9330445866216905e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.003186677349731326, "policy_loss": -0.004307229071855545, "vf_loss": 0.001120013534091413, "vf_explained_var": 0.9111735224723816, "kl": 0.02802598476409912, "entropy": 0.7583355903625488, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11188, "done": false, "timesteps_total": 2577870, "episodes_total": 5487, "training_iteration": 230, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-13-12", "timestamp": 1588792392, "time_this_iter_s": 39.48084902763367, "time_total_s": 9086.196773767471, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a158>", "on_episode_step": "<function on_episode_step at 0x7f598472a1e0>", "on_episode_end": "<function on_episode_end at 0x7f59847980d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e19d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dcea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9086.196773767471, "timesteps_since_restore": 2577870, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 81.72321428571429, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -0.0004800000000000006, "episode_reward_mean": 0.12487979999999997, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0004800000000000006}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.12487979999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.799993343283615, "avg_speed_min": 1.5287387398650252, "avg_speed_max": 5.165244858088423, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.2460808566199, "mean_processing_ms": 3.0877196991574225, "mean_inference_ms": 0.6359930771669727}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2589180, "num_steps_sampled": 2589180, "sample_time_ms": 35823.574, "grad_time_ms": 3150.08, "update_time_ms": 6.125, "opt_peak_throughput": 3574.449, "sample_peak_throughput": 314.313, "opt_samples": 11259.8, "learner": {"av": {"cur_kl_coeff": 2.899566970882006e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0033650610130280256, "policy_loss": -0.0033924446906894445, "vf_loss": 2.6992327548214234e-05, "vf_explained_var": 0.9976892471313477, "kl": 0.013515256345272064, "entropy": 0.7227702140808105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11310, "done": false, "timesteps_total": 2589180, "episodes_total": 5510, "training_iteration": 231, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-13-52", "timestamp": 1588792432, "time_this_iter_s": 39.747071743011475, "time_total_s": 9125.943845510483, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f598472a9d8>", "on_episode_step": "<function on_episode_step at 0x7f59846e1d90>", "on_episode_end": "<function on_episode_end at 0x7f59846e1048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dcc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9125.943845510483, "timesteps_since_restore": 2589180, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 80.8122807017544, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.2499, "episode_reward_min": -0.0004800000000000006, "episode_reward_mean": 0.1148909, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0004800000000000006}, "policy_reward_max": {"av": 0.2499}, "policy_reward_mean": {"av": 0.1148909}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7354975941547623, "avg_speed_min": 1.5287387398650252, "avg_speed_max": 4.963325228642783, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.248523404579245, "mean_processing_ms": 3.0887742749716525, "mean_inference_ms": 0.6365815283135754}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2600364, "num_steps_sampled": 2600364, "sample_time_ms": 35719.04, "grad_time_ms": 3140.646, "update_time_ms": 6.047, "opt_peak_throughput": 3581.174, "sample_peak_throughput": 314.88, "opt_samples": 11247.2, "learner": {"av": {"cur_kl_coeff": 2.899566970882006e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002536199288442731, "policy_loss": -0.0027110741939395666, "vf_loss": 0.00017454905901104212, "vf_explained_var": 0.9834499955177307, "kl": 0.01120192464441061, "entropy": 0.42708808183670044, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11184, "done": false, "timesteps_total": 2600364, "episodes_total": 5532, "training_iteration": 232, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-14-31", "timestamp": 1588792471, "time_this_iter_s": 39.540371894836426, "time_total_s": 9165.48421740532, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714400>", "on_episode_step": "<function on_episode_step at 0x7f5984546ea0>", "on_episode_end": "<function on_episode_end at 0x7f5984546488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984772e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9165.48421740532, "timesteps_since_restore": 2600364, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 80.99107142857143, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -0.0004800000000000006, "episode_reward_mean": 0.1198888, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0004800000000000006}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.1198888}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.78478569124256, "avg_speed_min": 1.5287387398650252, "avg_speed_max": 4.963325228642783, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.245549171695096, "mean_processing_ms": 3.0864488667750902, "mean_inference_ms": 0.636059483229292}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2611671, "num_steps_sampled": 2611671, "sample_time_ms": 35633.027, "grad_time_ms": 3127.279, "update_time_ms": 6.052, "opt_peak_throughput": 3599.295, "sample_peak_throughput": 315.887, "opt_samples": 11256.0, "learner": {"av": {"cur_kl_coeff": 2.899566970882006e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.011472118087112904, "policy_loss": -0.011526383459568024, "vf_loss": 5.300336124491878e-05, "vf_explained_var": 0.9958828091621399, "kl": 0.043601296842098236, "entropy": 0.7975068092346191, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11307, "done": false, "timesteps_total": 2611671, "episodes_total": 5555, "training_iteration": 233, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-15-10", "timestamp": 1588792510, "time_this_iter_s": 38.61739158630371, "time_total_s": 9204.101608991623, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714048>", "on_episode_step": "<function on_episode_step at 0x7f598460d378>", "on_episode_end": "<function on_episode_end at 0x7f59846dcc80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5988a4e2f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e1d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9204.101608991623, "timesteps_since_restore": 2611671, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 79.35535714285713, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -0.00012, "episode_reward_mean": 0.12239270000000001, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.00012}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.12239270000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.796732255911908, "avg_speed_min": 1.5287387398650252, "avg_speed_max": 4.989055156959928, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.24389236354046, "mean_processing_ms": 3.087428366202317, "mean_inference_ms": 0.6365617302480451}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2622906, "num_steps_sampled": 2622906, "sample_time_ms": 35827.533, "grad_time_ms": 3157.887, "update_time_ms": 6.008, "opt_peak_throughput": 3563.965, "sample_peak_throughput": 314.133, "opt_samples": 11254.6, "learner": {"av": {"cur_kl_coeff": 4.3493502744240686e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0009232388692907989, "policy_loss": -0.0010529119754210114, "vf_loss": 0.00012944525224156678, "vf_explained_var": 0.9893794059753418, "kl": 0.005310740787535906, "entropy": 0.6631721258163452, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11235, "done": false, "timesteps_total": 2622906, "episodes_total": 5577, "training_iteration": 234, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-15-50", "timestamp": 1588792550, "time_this_iter_s": 39.79417133331299, "time_total_s": 9243.895780324936, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984675950>", "on_episode_step": "<function on_episode_step at 0x7f5984546ea0>", "on_episode_end": "<function on_episode_end at 0x7f598460d7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598460d730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988aab598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9243.895780324936, "timesteps_since_restore": 2622906, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 80.76140350877192, "ram_util_percent": 34.50350877192982}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.1298899, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1298899}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.8804593069128184, "avg_speed_min": 1.5287387398650252, "avg_speed_max": 4.989055156959928, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.23616802131229, "mean_processing_ms": 3.085060957150574, "mean_inference_ms": 0.6359543680982286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2634207, "num_steps_sampled": 2634207, "sample_time_ms": 35888.186, "grad_time_ms": 3158.383, "update_time_ms": 5.937, "opt_peak_throughput": 3564.482, "sample_peak_throughput": 313.697, "opt_samples": 11258.0, "learner": {"av": {"cur_kl_coeff": 4.3493502744240686e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0013427156955003738, "policy_loss": -0.0026434569153934717, "vf_loss": 0.0013002266641706228, "vf_explained_var": 0.8955087065696716, "kl": 0.011870968155562878, "entropy": 0.666780412197113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11301, "done": false, "timesteps_total": 2634207, "episodes_total": 5600, "training_iteration": 235, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-16-27", "timestamp": 1588792587, "time_this_iter_s": 37.389747619628906, "time_total_s": 9281.285527944565, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546488>", "on_episode_step": "<function on_episode_step at 0x7f59846dcc80>", "on_episode_end": "<function on_episode_end at 0x7f598460d378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846bcbf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9281.285527944565, "timesteps_since_restore": 2634207, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 79.30188679245285, "ram_util_percent": 34.5}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.1249006, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1249006}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.841474661300312, "avg_speed_min": 1.2006703395619724, "avg_speed_max": 4.989055156959928, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.235239806444035, "mean_processing_ms": 3.0860806784263755, "mean_inference_ms": 0.636452191777278}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2645325, "num_steps_sampled": 2645325, "sample_time_ms": 36312.994, "grad_time_ms": 3209.428, "update_time_ms": 5.9, "opt_peak_throughput": 3503.334, "sample_peak_throughput": 309.633, "opt_samples": 11243.7, "learner": {"av": {"cur_kl_coeff": 4.3493502744240686e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.017387349158525467, "policy_loss": -0.017706701532006264, "vf_loss": 0.00031854063854552805, "vf_explained_var": 0.9668042659759521, "kl": 0.018619250506162643, "entropy": 0.5836935043334961, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11118, "done": false, "timesteps_total": 2645325, "episodes_total": 5622, "training_iteration": 236, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-17-10", "timestamp": 1588792630, "time_this_iter_s": 42.61086392402649, "time_total_s": 9323.896391868591, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aabc80>", "on_episode_step": "<function on_episode_step at 0x7f5988aabb70>", "on_episode_end": "<function on_episode_end at 0x7f5988aab7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984714048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e17b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9323.896391868591, "timesteps_since_restore": 2645325, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 83.12786885245902, "ram_util_percent": 34.501639344262294}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.1199075, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.1199075}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.812696043179526, "avg_speed_min": 1.2006703395619724, "avg_speed_max": 4.989055156959928, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.23369185695779, "mean_processing_ms": 3.083768868825368, "mean_inference_ms": 0.6359485925985144}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2656665, "num_steps_sampled": 2656665, "sample_time_ms": 36444.787, "grad_time_ms": 3228.895, "update_time_ms": 5.852, "opt_peak_throughput": 3484.195, "sample_peak_throughput": 308.689, "opt_samples": 11250.1, "learner": {"av": {"cur_kl_coeff": 4.3493502744240686e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.006476941052824259, "policy_loss": -0.006530785467475653, "vf_loss": 5.149286153027788e-05, "vf_explained_var": 0.9941622614860535, "kl": 0.05406597629189491, "entropy": 0.6300528049468994, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11340, "done": false, "timesteps_total": 2656665, "episodes_total": 5645, "training_iteration": 237, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-17-50", "timestamp": 1588792670, "time_this_iter_s": 39.70837378501892, "time_total_s": 9363.60476565361, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e11e0>", "on_episode_step": "<function on_episode_step at 0x7f59846e1ae8>", "on_episode_end": "<function on_episode_end at 0x7f5984546ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984546488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9363.60476565361, "timesteps_since_restore": 2656665, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 80.85964912280701, "ram_util_percent": 34.526315789473685}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.11241430000000001, "episode_len_mean": 500.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.11241430000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.722106368956046, "avg_speed_min": 1.0414497352833714, "avg_speed_max": 5.038370155026316, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.23671837688553, "mean_processing_ms": 3.084813762042655, "mean_inference_ms": 0.6365500168469173}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2667834, "num_steps_sampled": 2667834, "sample_time_ms": 36711.986, "grad_time_ms": 3269.119, "update_time_ms": 5.799, "opt_peak_throughput": 3438.419, "sample_peak_throughput": 306.183, "opt_samples": 11240.6, "learner": {"av": {"cur_kl_coeff": 6.524025229737163e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0033951508812606335, "policy_loss": -0.0034163605887442827, "vf_loss": 2.0835379473282956e-05, "vf_explained_var": 0.998087465763092, "kl": 0.0057710912078619, "entropy": 0.7037158012390137, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11169, "done": false, "timesteps_total": 2667834, "episodes_total": 5667, "training_iteration": 238, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-18-31", "timestamp": 1588792711, "time_this_iter_s": 40.889708518981934, "time_total_s": 9404.494474172592, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aab598>", "on_episode_step": "<function on_episode_step at 0x7f5988aabb70>", "on_episode_end": "<function on_episode_end at 0x7f59846e1d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e17b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4ef28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9404.494474172592, "timesteps_since_restore": 2667834, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 82.21551724137932, "ram_util_percent": 34.52413793103448}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24991, "episode_reward_min": -0.0004700000000000006, "episode_reward_mean": 0.10492169999999999, "episode_len_mean": 500.0, "episodes_this_iter": 23, "policy_reward_min": {"av": -0.0004700000000000006}, "policy_reward_max": {"av": 0.24991}, "policy_reward_mean": {"av": 0.10492169999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6470186538088014, "avg_speed_min": 1.040031505370422, "avg_speed_max": 5.341212082269724, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.23775688609951, "mean_processing_ms": 3.0825458003268533, "mean_inference_ms": 0.6361581165076213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2679143, "num_steps_sampled": 2679143, "sample_time_ms": 36334.261, "grad_time_ms": 3218.478, "update_time_ms": 5.718, "opt_peak_throughput": 3494.229, "sample_peak_throughput": 309.518, "opt_samples": 11246.1, "learner": {"av": {"cur_kl_coeff": 6.524025229737163e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0046411314979195595, "policy_loss": -0.0046794055961072445, "vf_loss": 3.762191772693768e-05, "vf_explained_var": 0.9971631169319153, "kl": 0.009999033063650131, "entropy": 0.8282973170280457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11309, "done": false, "timesteps_total": 2679143, "episodes_total": 5690, "training_iteration": 239, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-19-09", "timestamp": 1588792749, "time_this_iter_s": 37.9211049079895, "time_total_s": 9442.415579080582, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc950>", "on_episode_step": "<function on_episode_step at 0x7f59846dc268>", "on_episode_end": "<function on_episode_end at 0x7f59846dc1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e1bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9442.415579080582, "timesteps_since_restore": 2679143, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 78.20555555555556, "ram_util_percent": 34.55370370370369}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.11241519999999999, "episode_len_mean": 498.18, "episodes_this_iter": 22, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.11241519999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8086664255698097, "avg_speed_min": 1.040031505370422, "avg_speed_max": 5.341212082269724, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.236454329190636, "mean_processing_ms": 3.0835171463219075, "mean_inference_ms": 0.6366561634570914}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2690409, "num_steps_sampled": 2690409, "sample_time_ms": 36262.888, "grad_time_ms": 3208.807, "update_time_ms": 5.672, "opt_peak_throughput": 3507.191, "sample_peak_throughput": 310.342, "opt_samples": 11253.9, "learner": {"av": {"cur_kl_coeff": 6.524025229737163e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.022620707750320435, "policy_loss": -0.006353968754410744, "vf_loss": 0.028973031789064407, "vf_explained_var": 0.30754023790359497, "kl": 0.0252615287899971, "entropy": 0.7711116075515747, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11266, "done": false, "timesteps_total": 2690409, "episodes_total": 5712, "training_iteration": 240, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-19-48", "timestamp": 1588792788, "time_this_iter_s": 38.669727087020874, "time_total_s": 9481.085306167603, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aab7b8>", "on_episode_step": "<function on_episode_step at 0x7f5988aab598>", "on_episode_end": "<function on_episode_end at 0x7f5988a4ef28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e17b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598460d598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9481.085306167603, "timesteps_since_restore": 2690409, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 79.13214285714285, "ram_util_percent": 34.558928571428574}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.0924185, "episode_len_mean": 493.59, "episodes_this_iter": 25, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.0924185}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8856665362451555, "avg_speed_min": 1.040031505370422, "avg_speed_max": 5.341212082269724, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.224769483285634, "mean_processing_ms": 3.0825565165902344, "mean_inference_ms": 0.6360304729741916}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2701825, "num_steps_sampled": 2701825, "sample_time_ms": 36087.466, "grad_time_ms": 3181.262, "update_time_ms": 5.61, "opt_peak_throughput": 3540.89, "sample_peak_throughput": 312.144, "opt_samples": 11264.5, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 0.026611171662807465, "policy_loss": -0.0068951817229390144, "vf_loss": 0.03350551053881645, "vf_explained_var": 0.36029052734375, "kl": 0.008627164177596569, "entropy": 0.7178957462310791, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11416, "done": false, "timesteps_total": 2701825, "episodes_total": 5737, "training_iteration": 241, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-20-25", "timestamp": 1588792825, "time_this_iter_s": 37.7163770198822, "time_total_s": 9518.801683187485, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aabb70>", "on_episode_step": "<function on_episode_step at 0x7f59846dc1e0>", "on_episode_end": "<function on_episode_end at 0x7f59846dc268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846ead08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9518.801683187485, "timesteps_since_restore": 2701825, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 79.17592592592594, "ram_util_percent": 34.5611111111111}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.0949205, "episode_len_mean": 493.59, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.0949205}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8980421033508548, "avg_speed_min": 1.040031505370422, "avg_speed_max": 5.341212082269724, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.216844330693576, "mean_processing_ms": 3.082085745795501, "mean_inference_ms": 0.6364095650463636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2712948, "num_steps_sampled": 2712948, "sample_time_ms": 36084.07, "grad_time_ms": 3182.208, "update_time_ms": 5.709, "opt_peak_throughput": 3537.921, "sample_peak_throughput": 312.005, "opt_samples": 11258.4, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0040069157257676125, "policy_loss": -0.005021627061069012, "vf_loss": 0.0010138987563550472, "vf_explained_var": 0.9106890559196472, "kl": 0.008297079242765903, "entropy": 0.6479898691177368, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11123, "done": false, "timesteps_total": 2712948, "episodes_total": 5758, "training_iteration": 242, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-21-05", "timestamp": 1588792865, "time_this_iter_s": 39.51653075218201, "time_total_s": 9558.318213939667, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1510>", "on_episode_step": "<function on_episode_step at 0x7f59846e1ae8>", "on_episode_end": "<function on_episode_end at 0x7f59846e1f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846dcc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9558.318213939667, "timesteps_since_restore": 2712948, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 81.45535714285714, "ram_util_percent": 34.567857142857136}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.0001600000000002, "episode_reward_mean": 0.0924248, "episode_len_mean": 493.59, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.0001600000000002}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.0924248}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.898734195835499, "avg_speed_min": 1.0986034249564334, "avg_speed_max": 5.2119339327653815, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.20986377332124, "mean_processing_ms": 3.081377197526414, "mean_inference_ms": 0.6357951482963137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2724321, "num_steps_sampled": 2724321, "sample_time_ms": 36160.991, "grad_time_ms": 3194.244, "update_time_ms": 5.69, "opt_peak_throughput": 3526.656, "sample_peak_throughput": 311.524, "opt_samples": 11265.0, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0036790582817047834, "policy_loss": -0.0037075316067785025, "vf_loss": 2.7901516659767367e-05, "vf_explained_var": 0.9968743920326233, "kl": 0.005847521126270294, "entropy": 0.4558201730251312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11373, "done": false, "timesteps_total": 2724321, "episodes_total": 5782, "training_iteration": 243, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-21-45", "timestamp": 1588792905, "time_this_iter_s": 39.506755352020264, "time_total_s": 9597.824969291687, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846dc1e0>", "on_episode_step": "<function on_episode_step at 0x7f59846e1378>", "on_episode_end": "<function on_episode_end at 0x7f59846e17b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846e1bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9597.824969291687, "timesteps_since_restore": 2724321, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 81.41250000000001, "ram_util_percent": 34.583928571428565}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24996, "episode_reward_min": -1.00011, "episode_reward_mean": 0.09492739999999998, "episode_len_mean": 495.41, "episodes_this_iter": 21, "policy_reward_min": {"av": -1.00011}, "policy_reward_max": {"av": 0.24996}, "policy_reward_mean": {"av": 0.09492739999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8698756698627625, "avg_speed_min": 1.2156578525614377, "avg_speed_max": 5.2119339327653815, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.20517595843315, "mean_processing_ms": 3.0809373508398017, "mean_inference_ms": 0.6362377051549382}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2735482, "num_steps_sampled": 2735482, "sample_time_ms": 36157.072, "grad_time_ms": 3194.076, "update_time_ms": 5.798, "opt_peak_throughput": 3524.525, "sample_peak_throughput": 311.353, "opt_samples": 11257.6, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.004420085344463587, "policy_loss": -0.005356616340577602, "vf_loss": 0.0009349595056846738, "vf_explained_var": 0.9077189564704895, "kl": 0.01602840982377529, "entropy": 0.57160484790802, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11161, "done": false, "timesteps_total": 2735482, "episodes_total": 5803, "training_iteration": 244, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-22-24", "timestamp": 1588792944, "time_this_iter_s": 39.75417375564575, "time_total_s": 9637.579143047333, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984546ea0>", "on_episode_step": "<function on_episode_step at 0x7f59846e1ae8>", "on_episode_end": "<function on_episode_end at 0x7f59846dc268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dcc80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988aabb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9637.579143047333, "timesteps_since_restore": 2735482, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 81.12105263157895, "ram_util_percent": 34.58771929824561}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -1.00011, "episode_reward_mean": 0.08990589999999997, "episode_len_mean": 495.41, "episodes_this_iter": 24, "policy_reward_min": {"av": -1.00011}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.08990589999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8269468205143404, "avg_speed_min": 1.2156578525614377, "avg_speed_max": 5.2119339327653815, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.20773464936535, "mean_processing_ms": 3.0791886482212396, "mean_inference_ms": 0.6358497020020182}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2746848, "num_steps_sampled": 2746848, "sample_time_ms": 36407.705, "grad_time_ms": 3232.995, "update_time_ms": 5.812, "opt_peak_throughput": 3484.107, "sample_peak_throughput": 309.388, "opt_samples": 11264.1, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.002700597047805786, "policy_loss": -0.0038206297904253006, "vf_loss": 0.001118960208259523, "vf_explained_var": 0.8981210589408875, "kl": 0.010976219549775124, "entropy": 0.8423071503639221, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11366, "done": false, "timesteps_total": 2746848, "episodes_total": 5827, "training_iteration": 245, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-23-05", "timestamp": 1588792985, "time_this_iter_s": 40.28587222099304, "time_total_s": 9677.865015268326, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59846e1048>", "on_episode_step": "<function on_episode_step at 0x7f59846e17b8>", "on_episode_end": "<function on_episode_end at 0x7f59846e1378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f598472a7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846ead90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9677.865015268326, "timesteps_since_restore": 2746848, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 81.08965517241377, "ram_util_percent": 34.596551724137925}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0007600000000000013, "episode_reward_mean": 0.11240249999999997, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0007600000000000013}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.11240249999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.775729683814659, "avg_speed_min": 1.2156578525614377, "avg_speed_max": 5.0421250393995845, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.20111159891385, "mean_processing_ms": 3.0795810280887013, "mean_inference_ms": 0.6360296668638923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2757976, "num_steps_sampled": 2757976, "sample_time_ms": 36104.02, "grad_time_ms": 3193.704, "update_time_ms": 5.866, "opt_peak_throughput": 3527.283, "sample_peak_throughput": 312.018, "opt_samples": 11265.1, "learner": {"av": {"cur_kl_coeff": 9.786038572201505e-05, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0010363726178184152, "policy_loss": -0.0010772617533802986, "vf_loss": 3.885749538312666e-05, "vf_explained_var": 0.9964167475700378, "kl": 0.020788975059986115, "entropy": 0.6173381805419922, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11128, "done": false, "timesteps_total": 2757976, "episodes_total": 5848, "training_iteration": 246, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-23-44", "timestamp": 1588793024, "time_this_iter_s": 39.18121790885925, "time_total_s": 9717.046233177185, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aab598>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f5984772e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984772488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846bc1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9717.046233177185, "timesteps_since_restore": 2757976, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 80.60357142857143, "ram_util_percent": 34.59642857142857}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0007600000000000013, "episode_reward_mean": 0.11489320000000001, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": -0.0007600000000000013}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.11489320000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.779683184676462, "avg_speed_min": 1.2156578525614377, "avg_speed_max": 5.0421250393995845, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.21343236668323, "mean_processing_ms": 3.0781385962326278, "mean_inference_ms": 0.6360695817691007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2769291, "num_steps_sampled": 2769291, "sample_time_ms": 36110.437, "grad_time_ms": 3191.986, "update_time_ms": 5.849, "opt_peak_throughput": 3528.399, "sample_peak_throughput": 311.893, "opt_samples": 11262.6, "learner": {"av": {"cur_kl_coeff": 0.00014679056766908616, "cur_lr": 9.999999747378752e-06, "total_loss": 0.006552602164447308, "policy_loss": 0.006517525762319565, "vf_loss": 1.267369862034684e-05, "vf_explained_var": 0.9616559743881226, "kl": 0.15261664986610413, "entropy": 0.6004159450531006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11315, "done": false, "timesteps_total": 2769291, "episodes_total": 5872, "training_iteration": 247, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-24-24", "timestamp": 1588793064, "time_this_iter_s": 39.75577640533447, "time_total_s": 9756.80200958252, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5988aabc80>", "on_episode_step": "<function on_episode_step at 0x7f59846bc9d8>", "on_episode_end": "<function on_episode_end at 0x7f59846bca60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846bc8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846e1f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9756.80200958252, "timesteps_since_restore": 2769291, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 81.20350877192983, "ram_util_percent": 34.59649122807017}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24995, "episode_reward_min": -0.0007600000000000013, "episode_reward_mean": 0.1073983, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -0.0007600000000000013}, "policy_reward_max": {"av": 0.24995}, "policy_reward_mean": {"av": 0.1073983}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.6801559141918188, "avg_speed_min": 1.186758684184801, "avg_speed_max": 5.183548230191142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.203789525276456, "mean_processing_ms": 3.078447444786387, "mean_inference_ms": 0.6361184919704659}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2780417, "num_steps_sampled": 2780417, "sample_time_ms": 36278.855, "grad_time_ms": 3210.586, "update_time_ms": 5.882, "opt_peak_throughput": 3506.619, "sample_peak_throughput": 310.327, "opt_samples": 11258.3, "learner": {"av": {"cur_kl_coeff": 0.00022018585877958685, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0028854249976575375, "policy_loss": -0.0029309464152902365, "vf_loss": 4.470131898415275e-05, "vf_explained_var": 0.9959487318992615, "kl": 0.003726761555299163, "entropy": 0.4830871820449829, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11126, "done": false, "timesteps_total": 2780417, "episodes_total": 5893, "training_iteration": 248, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-25-07", "timestamp": 1588793107, "time_this_iter_s": 42.76175880432129, "time_total_s": 9799.56376838684, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984772e18>", "on_episode_step": "<function on_episode_step at 0x7f598460d400>", "on_episode_end": "<function on_episode_end at 0x7f59846bc950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846bc1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f598472a158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9799.56376838684, "timesteps_since_restore": 2780417, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 84.09180327868853, "ram_util_percent": 34.5983606557377}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": 0.0, "episode_reward_mean": 0.11741339999999999, "episode_len_mean": 500.0, "episodes_this_iter": 24, "policy_reward_min": {"av": 0.0}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.11741339999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.7115781385819093, "avg_speed_min": 1.186758684184801, "avg_speed_max": 5.183548230191142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.221297194869884, "mean_processing_ms": 3.077075575161303, "mean_inference_ms": 0.6362175607660042}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2791830, "num_steps_sampled": 2791830, "sample_time_ms": 36490.338, "grad_time_ms": 3235.761, "update_time_ms": 5.885, "opt_peak_throughput": 3482.55, "sample_peak_throughput": 308.813, "opt_samples": 11268.7, "learner": {"av": {"cur_kl_coeff": 0.00011009292938979343, "cur_lr": 9.999999747378752e-06, "total_loss": -0.0012068218784406781, "policy_loss": -0.0012504563201218843, "vf_loss": 4.308095958549529e-05, "vf_explained_var": 0.9961374998092651, "kl": 0.005033607594668865, "entropy": 0.538715660572052, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11413, "done": false, "timesteps_total": 2791830, "episodes_total": 5917, "training_iteration": 249, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-25-47", "timestamp": 1588793147, "time_this_iter_s": 40.28770184516907, "time_total_s": 9839.85147023201, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f5984714048>", "on_episode_step": "<function on_episode_step at 0x7f59846dc1e0>", "on_episode_end": "<function on_episode_end at 0x7f59846dc268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f59846dc950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f5988a4e1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9839.85147023201, "timesteps_since_restore": 2791830, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 83.20350877192982, "ram_util_percent": 34.599999999999994}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
{"episode_reward_max": 0.24993, "episode_reward_min": 0.0, "episode_reward_mean": 0.1099146, "episode_len_mean": 500.0, "episodes_this_iter": 21, "policy_reward_min": {"av": 0.0}, "policy_reward_max": {"av": 0.24993}, "policy_reward_mean": {"av": 0.1099146}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.595565448306294, "avg_speed_min": 1.186758684184801, "avg_speed_max": 5.183548230191142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 39.215273375104644, "mean_processing_ms": 3.0774206478096566, "mean_inference_ms": 0.6363308394476032}, "off_policy_estimator": {}, "info": {"num_steps_trained": 2802922, "num_steps_sampled": 2802922, "sample_time_ms": 36757.161, "grad_time_ms": 3278.79, "update_time_ms": 5.849, "opt_peak_throughput": 3431.541, "sample_peak_throughput": 306.098, "opt_samples": 11251.3, "learner": {"av": {"cur_kl_coeff": 0.00011009292938979343, "cur_lr": 9.999999747378752e-06, "total_loss": 0.000467381119960919, "policy_loss": 0.0003823536681011319, "vf_loss": 8.4196355601307e-05, "vf_explained_var": 0.9918136596679688, "kl": 0.007537256460636854, "entropy": 0.3719209134578705, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 11092, "done": true, "timesteps_total": 2802922, "episodes_total": 5938, "training_iteration": 250, "experiment_id": "cb0a0e17c4b84dbfa93d460be819caf6", "date": "2020-05-06_19-26-29", "timestamp": 1588793189, "time_this_iter_s": 41.7678747177124, "time_total_s": 9881.619344949722, "pid": 104353, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 15, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\"\n        ],\n        \"num_pedestrians\": 12,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"52.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.8\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.6\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.4\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"random\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.2\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"0.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_time\": \"2.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f59847980d0>", "on_episode_step": "<function on_episode_step at 0x7f598472a1e0>", "on_episode_end": "<function on_episode_end at 0x7f598472aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7f5984772e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(21,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f59846bc7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 9881.619344949722, "timesteps_since_restore": 2802922, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 82.72666666666667, "ram_util_percent": 34.60166666666666}, "num_healthy_workers": 15, "trial_id": "f43955e2", "experiment_tag": "3_gamma=0.999,lr=1e-05"}
